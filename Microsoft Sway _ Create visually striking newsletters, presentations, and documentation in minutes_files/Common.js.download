function fidoCallback(t){}function capturePerformanceMetric(t){var e=0,n=window.PageExecutionBegin;return n&&(e=Date.now()-n.getTime()),!IsPerformanceModeOn&&StoryApp.Utilities.query.has(StoryApp.Common.UrlHelper.URLParamPerfTest)&&(IsPerformanceModeOn=!0,PerformanceMetrics=[]),IsPerformanceModeOn&&PerformanceMetrics.push({operation:t,elapsedMilliseconds:e}),e}var __extends=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),StoryApp;!function(t){!function(t){var e=function(){function t(e){void 0===e&&(e={}),this.activityFreshness=0,this.inactiveTime=0,this.totalActiveTime=0,this.dependencies={clearInterval:e.clearInterval||clearInterval.bind(window),now:e.now||platform.now.bind(platform),setInterval:e.setInterval||setInterval.bind(window)},this.activityFreshness=t.newFreshnessLevel,this.activityTime=this.dependencies.now(),this.start()}return t.prototype.getActivityFreshness=function(){return this.activityFreshness},t.prototype.getMillisecondsSinceActive=function(){return this.dependencies.now()-this.activityTime},t.prototype.receiveActivity=function(){this.activityFreshness=t.newFreshnessLevel,this.start()},t.prototype.getTotalInactiveTime=function(){return 0===this.activityFreshness?this.inactiveTime+(this.dependencies.now()-this.activityTime):this.inactiveTime},t.prototype.getTotalActiveTime=function(){return this.totalActiveTime},t.prototype.start=function(){var e=this;void 0===this.tickInterval&&(this.inactiveTime+=this.dependencies.now()-this.activityTime,this.tickInterval=this.dependencies.setInterval(function(){return e.tick()},t.tickRate))},t.prototype.stop=function(){this.dependencies.clearInterval(this.tickInterval),this.tickInterval=void 0},t.prototype.tick=function(){this.activityFreshness--,this.activityTime=this.dependencies.now(),this.totalActiveTime+=t.tickRate,0===this.activityFreshness&&this.stop()},t.newFreshnessLevel=180,t.tickRate=1e3,t}();t.ActivityMonitor=e}(t.Utilities||(t.Utilities={}))}(StoryApp||(StoryApp={}));var Diag;!function(t){!function(t){t[t.msoulscat_Story_Site=1100]="msoulscat_Story_Site",t[t.msoulscat_Story_RequestManager=1101]="msoulscat_Story_RequestManager",t[t.msoulscat_Story_AddContent=1102]="msoulscat_Story_AddContent",t[t.msoulscat_Story_Storyline=1103]="msoulscat_Story_Storyline",t[t.msoulscat_Story_Automation=1104]="msoulscat_Story_Automation",t[t.msoulscat_Story_Preview=1105]="msoulscat_Story_Preview",t[t.msoulscat_Story_InteractionModel=1106]="msoulscat_Story_InteractionModel",t[t.msoulscat_Story_Feedback=1107]="msoulscat_Story_Feedback",t[t.msoulscat_Story_FeedbackData=1108]="msoulscat_Story_FeedbackData",t[t.msoulscat_Story_ContextualUI=1109]="msoulscat_Story_ContextualUI",t[t.msoulscat_Story_DocumentImport=1110]="msoulscat_Story_DocumentImport",t[t.msoulscat_Story_Style=1111]="msoulscat_Story_Style"}(t.ULSCat||(t.ULSCat={}))}(Diag||(Diag={}));var CommonBindings;!function(t){!function(t){!function(t){!function(t){var e=function(t){function e(e,n,o){var i=t.call(this,void 0)||this;return i.element=e,i.viewElement=o,i}return __extends(e,t),e.prototype.init=function(t){this.inViewportCallback=t.onVisibilityChanged;var e={threshold:1,rootMargin:t.rootMargin};this.observer=new IntersectionObserver(this.observerCallback.bind(this),e),this.observer.observe(this.element)},e.prototype.observerCallback=function(t,e){for(var n=0,o=t;n<o.length;n++){var i=o[n];this.inViewportCallback.call(this.viewElement,i.isIntersecting)}},e}(Disposable);t.BindingBase=e}(t.InViewportWatcher||(t.InViewportWatcher={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(CommonBindings||(CommonBindings={}));var StoryApp;!function(t){!function(t){!function(t){t[t.LandingPageReady=0]="LandingPageReady",t[t.MySwaysPageReady=1]="MySwaysPageReady",t[t.StoryPageReady=2]="StoryPageReady",t[t.StoryEditPageReady=3]="StoryEditPageReady",t[t.LandingPageDispose=4]="LandingPageDispose",t[t.MySwaysPageDispose=5]="MySwaysPageDispose",t[t.StoryPageDispose=6]="StoryPageDispose",t[t.StoryEditPageDispose=7]="StoryEditPageDispose"}(t.MessageType||(t.MessageType={}));var e=function(){function t(){this.firedMessages={},this.messageHandlers={}}return t.getInstance=function(){return t.currentInstance},t.prototype.fireMessage=function(t){this.firedMessages[t]=!0;var e=this.messageHandlers[t];e&&e.forEach(function(t){return platform.setImmediate(t)})},t.prototype.onMessage=function(t,e){void 0===this.messageHandlers[t]&&(this.messageHandlers[t]=[]),this.messageHandlers[t].push(e),this.firedMessages[t]&&platform.setImmediate(e)},t.currentInstance=new t,t}();t.MessageBus=e}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var CommonBindings;!function(t){!function(t){!function(t){!function(t){var e=function(){function t(t,e,n){this.el=t,this.ve=n}return t.prototype.dispose=function(){this.messageHandler&&removeEventListener("message",this.messageHandler,!1)},t.prototype.init=function(t){var e=this;if(t.fn){var n=this.messageHandler=function(n){n.source===e.el.contentWindow&&t.fn.call(t.context,n.data)};addEventListener("message",n,!1)}},t.prototype.postMessage=function(t){this.el.contentWindow.postMessage(t,"*")},t}();t.BindingBase=e}(t.Message||(t.Message={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(CommonBindings||(CommonBindings={}));var StoryApp;!function(t){!function(e){var n=function(){function e(e,n){if(void 0===n&&(n=!1),null==e||e<1)throw t.RethrowLogger.createError("Invalid capacity parameter.");this.buffer=new Array(e),this.capacity=e,this.isOverwriting=n,this.head=0,this.size=0}return e.prototype.enqueue=function(e){if(!this.isOverwriting&&this.size===this.capacity)throw t.RethrowLogger.createError("Can't enqueue into a full buffer.");var n=(this.head+this.size)%this.capacity;this.buffer[n]=e,this.size<this.capacity?this.size++:this.head=(this.head+1)%this.capacity},e.prototype.dequeue=function(){if(0===this.size)throw t.RethrowLogger.createError("Can't dequeue from an empty buffer.");var e=this.buffer[this.head];return this.size--,this.head=(this.head+1)%this.capacity,e},e.prototype.peek=function(){if(0!==this.size)return this.buffer[this.head]},e.prototype.getSize=function(){return this.size},e.prototype.clear=function(){this.head=0,this.size=0},e.prototype.toArray=function(){return this.capacity>=this.head+this.size?this.buffer.slice(this.head,this.head+this.size):this.buffer.slice(this.head,this.capacity).concat(this.buffer.slice(0,(this.head+this.size)%this.capacity))},e}();e.CircularBuffer=n}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){var e=function(){function t(){this.commonHeaders={}}return t.prototype.addCommonHeader=function(t,e){this.commonHeaders[t]=e},t.prototype.getCommonHeader=function(t){return this.commonHeaders[t]},t.prototype.setCommonHeaders=function(e,n,o){if(this.commonHeaders)for(var i in this.commonHeaders)e.setRequestHeader(i,this.commonHeaders[i]);CommonSettings.AnonUserId&&e.setRequestHeader(t.AnonUserKeyHeader,CommonSettings.AnonUserId),o&&CommonSettings.UserSessionId&&e.setRequestHeader(t.UserSessionIdHeader,CommonSettings.UserSessionId),n&&e.setRequestHeader(CommonSettings.CanaryHeader,CommonSettings.Canary)},t.CorrelationIdHeader="X-CorrelationId",t.UserSessionIdHeader="X-UserSessionId",t.StoryIdHeader="X-StoryId",t.LookupIdHeader="X-LookupId",t.WebClientVersionHeader="X-WebClientVersion",t.NativeClientVersionHeader="X-NativeClientVersion",t.ClientTypeHeader="X-ClientType",t.ClientBuildVersionHeader="X-ClientBuild",t.AnonUserKeyHeader="anonuserid",t}();t.CommonRequestHeaders=e}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var ControlAttributes;!function(t){t.Attributes={Disabled:"disabled"},t.DisabledState={Enabled:void 0,Disabled:"disabled"}}(ControlAttributes||(ControlAttributes={}));var StoryApp;!function(t){!function(e){!function(n){var o=function(){function o(){}return o.createAndShow=function(t,e){(new o).initDialog(t,e)},o.prototype.initDialog=function(o,i){var r={messages:[Resources.FeedbackIntentQuestion],description:Resources.FeedbackIntentQuestion,lightDismiss:!0,lightDismissOnClickDialogWrapper:!0,dialogType:n.DialogType.Info,dialogCssClass:{value:"HelpDialog"},dialogContentsContainerCssClass:"HelpDialogTitle",dialogContentCssClass:"dlg HelpDialogContent",buttonsArgs:[{buttonId:ClientAction.ButtonId.HelpDialog_OfficeDotCom,caption:{value:Resources.FeedbackHelp2},isDefault:!1,isNeutralButton:!0,dismissOnAction:!0,onAction:function(t,e){window.open(CommonSettings.OfficeDotComHelpURL)}},{buttonId:ClientAction.ButtonId.HelpDialog_AnswersForum,caption:{value:Resources.FeedbackSwayForum},isDefault:!1,isNeutralButton:!0,dismissOnAction:!0,onAction:function(t,e){window.open(CommonSettings.SwayAnswersForumURL)}},{buttonId:ClientAction.ButtonId.AppBar_Feedback,caption:{value:Resources.GiveFeedback},isDefault:!1,isNeutralButton:!0,dismissOnAction:!0,onAction:function(e,n){t.Common.AppBarAction.getInstance().ShowFeedback(t.Preload.resourceFactory)}}]};o&&r.buttonsArgs.addunique(this.getReportViolationButtonArgs()),i&&r.buttonsArgs.addunique(this.getAboutButtonArgs()),this._dlg=e.Common.DialogManager.createAndShow(r)},o.prototype.getReportViolationButtonArgs=function(){return{buttonId:ClientAction.ButtonId.HelpDialog_ReportAViolation,caption:{value:Resources.FeedbackReportViolation2},isDefault:!1,isNeutralButton:!0,dismissOnAction:!0,onAction:function(e,n){var o=window.StoryPageSettings;void 0===o||void 0===o.LookupId?StoryLog.TraceTag(595957464,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.error,"Tried to open Report a Violation page from a non-story page"):window.open(t.Common.UrlHelper.getInstance().reportViolationPageUrl(o.LookupId))}}},o.prototype.getAboutButtonArgs=function(){return{buttonId:ClientAction.ButtonId.HelpDialog_About,caption:{value:Resources.AboutButton},isDefault:!1,isNeutralButton:!0,dismissOnAction:!0,onAction:this.showAboutDialog}},o.prototype.showAboutDialog=function(){var e=t.Common.UrlHelper.getInstance().getPrivacyStatementUrl(),n=CommonSettings.NativeClientBuildVersion;n||StoryLog.TraceTag(596460702,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.error,"Showing About dialog when client build version is unknown");var o=void 0,i={title:Resources.AboutDialogTitle,messages:[ResourceManager.ResolveString(Resources.AboutDialogVersionLabel,[n])],description:Resources.AboutDialogTitle,lightDismiss:!0,dialogType:t.View.ViewElements.DialogType.Info,dialogWrapperCssClass:{value:"CenteredDialog AboutDialog"},getInitialActiveChild:function(){return o.getButtonVEs()[3].getControl()},buttonsArgs:[{caption:{value:Resources.LicenseTermsLink},linkUrl:"https://go.microsoft.com/fwlink/?LinkID=524989",dismissOnAction:!1},{caption:{value:Resources.ThirdPartyLink},linkUrl:"https://go.microsoft.com/fwlink/?LinkId=618893",dismissOnAction:!1},{caption:{value:Resources.PrivacyLink},linkUrl:e,dismissOnAction:!1},{caption:{value:Resources.ButtonOK},dismissOnAction:!0,isNeutralButton:!0}]},r=t.View.Common.DialogManager.getInstance();return o=r.createDialog(i),r.showDialog(o),TDB.EventPropagation.Bypass},o}();n.HelpDialog=o}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=function(){function n(){}return n.createAndShow=function(e){var o=n.createDialog(e);return o.updateContent(n.createIframe(o,e)),t.View.Common.DialogManager.showDialog(o),o},n.createDialog=function(e){var n=document.body.style.overflow,o={title:e.title,noFocus:!1,dialogWrapperCssClass:e.dialogCssWrapperClass,dialogCssClass:e.dialogCssClass,dialogContentWrapperClass:e.dialogContentWrapperCssClass,dialogType:e.dialogType,dialogLogMessage:e.dialogLogMessage,lightDismiss:!1,frostOpacity:.65,ariaLive:Aria.AriaLiveValue.Off,description:e.description,onShowing:function(){document.body.style.overflow="hidden",e.onShowing&&e.onShowing.call(e.context)},onClose:function(){document.body.style.overflow=n,e.onClose&&e.onClose.call(e.context)},context:e.context,onKeyDown:e.onKeyDown,buttonsArgs:e.buttonsArgs};return t.View.Common.DialogManager.createDialog(o)},n.createIframe=function(t,n){var o={contentUrl:n.contentUrl,cssClassName:n.iFrameCssClass,onload:function(e){return t.centerDialog(),!n.onload||n.onload.call(n.context)},context:n.context,sandboxed:{value:!0},iframeMessageHandler:n.iframeMessageHandler};return new TDB.ChildArgs(e.IframeVE,o)},n}();e.IframeDialog=n}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n;!function(t){t[t.enthusiast=0]="enthusiast",t[t.netNew=1]="netNew",t[t.influential=2]="influential"}(n=e.ContactMeTriggerType||(e.ContactMeTriggerType={}));var o=function(){function o(t,e,n){this.notificationBar=t,this.type=e,this.numStories=n,this.errorMessage=TDB.watchableTag(596477088,null,"")}return o.prototype.canShow=function(){if(t.Utilities.query.has(t.Common.UrlHelper.URLParamContactMe)||t.Utilities.query.has(t.Common.UrlHelper.URLParamContactMeNetNew)||t.Utilities.query.has(t.Common.UrlHelper.URLParamContactMeInfluential))return!0;var e=this.getPersistentData();return $(window).width()>500&&!e.completed&&(e.dismissCount||0)<3&&(!e.lastDismissed||new Date(e.lastDismissed).getTime()+864e5<(new Date).getTime())},o.prototype.showNotification=function(){this.canShow()&&(this.notification=this.notificationBar.addNotification({notificationSource:e.NotificationSource.ContactMe,notificationType:e.NotificationType.Info,messages:[{text:this.type===n.influential?Resources.ContactMeNotificationInfluential:Resources.ContactMeNotification},{text:Resources.PrivacyLink,url:"https://go.microsoft.com/fwlink/p/?LinkId=316968"}],buttons:[{buttonId:ClientAction.ButtonId.ContactMe_OpenSurvey,text:{value:Resources.ContactMeNotificationYes},onClick:this.onNotificationClick,context:this}],onDismissed:this.onNotificationDismissed,dismissContext:this},!1),StoryLog.StructuredTraceTag(596477089,Diag.ULSCat.msoulscat_Story_Feedback,Diag.ULSTraceLevel.info,"Showing ContactMe notification",{trigger:n[this.type]}))},o.prototype.onNotificationClick=function(t){return this.notification.dismiss(),this.showDialog(),TDB.EventPropagation.PreventDefault},o.prototype.onNotificationDismissed=function(){var t=new ClientAction.SimpleClientActionData(ClientAction.ActionType.ContactMeDismissNotification,Diag.ULSCat.msoulscat_Story_Feedback);t.setTelemetryData({trigger:n[this.type]}),ActionLogger.RecordClientAction(t);var e=this.getPersistentData();e.dismissCount=(e.dismissCount||0)+1,e.lastDismissed=(new Date).toISOString(),this.setPersistentData(e)},o.prototype.showDialog=function(){var e=[{checkboxOptions:[],tabOrder:[],hasTextBox:!0,question:Resources.ContactMeDialogName,id:"name",questionType:t.View.ViewElements.QuestionType.Checkbox},{checkboxOptions:[],tabOrder:[],hasTextBox:!0,question:Resources.ContactMeDialogPhoneNumber,id:"phone",questionType:t.View.ViewElements.QuestionType.Checkbox},{checkboxOptions:[],tabOrder:[],hasTextBox:!0,question:Resources.ContactMeDialogEmailAddress,id:"email",questionType:t.View.ViewElements.QuestionType.Checkbox},{checkboxOptions:[],tabOrder:[],hasTextBox:!0,question:Resources.ContactMeDialogTime,textBoxLength:1e3,id:"time",questionType:t.View.ViewElements.QuestionType.Checkbox},{checkboxOptions:[Resources.ContactMeDialogAge],tabOrder:[0],id:"age",questionType:t.View.ViewElements.QuestionType.Checkbox},{checkboxOptions:[],tabOrder:[],question:Resources.ContactMeDialogRequired,id:"required",questionType:t.View.ViewElements.QuestionType.Checkbox}],n={onSubmit:this.onDialogSubmit,onCancel:this.onDialogCancel,context:this,questions:e,title:Resources.ContactMeDialogTitle,messages:[Resources.ContactMeDialogText],dialogContentCssClass:"contactMeSurvey",errorMessage:this.errorMessage,okText:Resources.ContactMeDialogSubmit,cancelText:Resources.ContactMeDialogCancel};new SurveyDialog(n).show()},o.prototype.onDialogSubmit=function(e){var o=this,i=e.name.textboxValue,r=e.phone.textboxValue,a=e.email.textboxValue,s=e.time.textboxValue,l=e.age.checkboxOptions[Resources.ContactMeDialogAge];if(!i||!r||!l)return TDB.applyUpdate(function(){o.errorMessage.setValue(Resources.ContactMeDialogError)}),!1;$.ajax({url:t.Common.UrlHelper.getInstance().contactMeResultsUrl(),type:"POST",data:JSON.stringify({name:i,phone:r,email:a,time:s,type:n[this.type],numStories:this.numStories}),contentType:t.RequestManager.JsonContentType});var u=this.getPersistentData();return u.completed=!0,this.setPersistentData(u),!0},o.prototype.onDialogCancel=function(){ActionLogger.RecordClientAction(new ClientAction.SimpleClientActionData(ClientAction.ActionType.ContactMeCancelDialog,Diag.ULSCat.msoulscat_Story_Feedback))},o.prototype.getPersistentData=function(){var t=localStorage.getItem("contactMe"),e={};if(t)try{e=JSON.parse(t)}catch(t){StoryLog.TraceTag(596477090,Diag.ULSCat.msoulscat_Story_Feedback,Diag.ULSTraceLevel.warning,"Can't fetch ContactMe data from local storage.")}return e},o.prototype.setPersistentData=function(t){try{localStorage.setItem("contactMe",JSON.stringify(t))}catch(t){StoryLog.TraceTag(596477091,Diag.ULSCat.msoulscat_Story_Feedback,Diag.ULSTraceLevel.warning,"Can't store ContactMe data in local storage. Exception: "+t.name+": "+t.message)}},o}();e.ContactMeDialog=o}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(n){var o;!function(t){t[t.EntryTextbox=1]="EntryTextbox",t[t.SubmitButton=2]="SubmitButton",t[t.CancelButton=3]="CancelButton"}(o=n.PasswordEntryDialogTabOrder||(n.PasswordEntryDialogTabOrder={}));var i=function(){function i(t,o,i){var r=this,a={onEnterClicked:function(){r.submitPassword()}},s={dialogWrapperCssClass:{value:"PasswordEntryDialog"},title:Resources.SharingPasswordEntryDialogTitle,description:Resources.SharingPasswordEntryDialogTitle,messages:[Resources.SharingPasswordEntryDialogMessage],allowCancel:!1,dialogLogMessage:"Password Entry Dialog",dialogType:n.DialogType.Question,width:500,lightDismiss:!1,buttonsArgs:this.generatePasswordEntryButtonArgs(),contentArgs:new TDB.ChildArgs(n.PasswordEntryDialogContentVE,a,function(t){r.passwordEntryDialogContent=t})};this.dialog=e.Common.DialogManager.createDialog(s),this.lookupId=t,this.onSuccess=o,this.onCancel=i}return i.prototype.showDialog=function(){e.Common.DialogManager.showDialog(this.dialog)},i.createAndShow=function(t,e,n){var o=new i(t,e,n);return o.showDialog(),o},i.prototype.submitPassword=function(){var e=this,n={Password:this.passwordEntryDialogContent.getPasswordText()};this.passwordEntryDialogContent.setLoadingSpinnerVisibility(!0),$.ajax(t.Common.UrlHelper.getInstance().getPasswordSubmissionUrl(this.lookupId),{data:JSON.stringify(n),name:"SubmitPassword",description:"Submit sway password",type:"POST",contentType:t.RequestManager.JsonContentType,success:function(){e.passwordEntryDialogContent.setLoadingSpinnerVisibility(!1),StoryLog.TraceTag(596477076,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Password validation successful"),e.onSuccess()},error:function(t,n,o){switch(StoryLog.StructuredTraceTag(596477077,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Password validation failed",{textStatus:n,errorThrown:o,statusCode:t?t.status.toString():null}),t.status){case 404:e.showSwayNotAvailableDialog();break;default:e.passwordEntryDialogContent.setLoadingSpinnerVisibility(!1),e.passwordEntryDialogContent.setErrorMessageVisible(!0)}}})},i.prototype.showSwayNotAvailableDialog=function(){var e=this;StoryLog.TraceTag(596477078,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Showing Sway not available dialog");var n=[{caption:{value:Resources.ButtonOK},isDefault:!0,onAction:function(){e.onCancel()},id:"passwordEntrySwayNotFoundOk"}],o={title:Resources.DeletedDialogTitle,description:Resources.DeletedDialogTitle,allowCancel:!1,messages:[Resources.NativeDeletedDialogBody],buttonsArgs:n};t.View.Common.DialogManager.closeCurrentDialog(),t.View.Common.DialogManager.createAndShow(o)},i.prototype.generatePasswordEntryButtonArgs=function(){var t=this;return[{id:"passwordEntryDialogSubmit",tabIndex:o.SubmitButton,caption:{value:Resources.SharingPasswordEntryDialogSubmitButton},isDefault:!0,dismissOnAction:!1,onAction:function(e,n){var o=new ClientAction.ButtonClickAction(ClientAction.ButtonId.PasswordEntryDialogSubmit,Diag.ULSCat.msoulscat_Story_Site);ActionLogger.RecordClientAction(o),t.submitPassword()}},{id:"passwordEntryDialogCancel",tabIndex:o.CancelButton,caption:{value:Resources.SharingPasswordEntryDialogCancelButton},isDefault:!1,dismissOnAction:!1,onAction:function(e,n){var o=new ClientAction.ButtonClickAction(ClientAction.ButtonId.PasswordEntryDialogCancel,Diag.ULSCat.msoulscat_Story_Site);ActionLogger.RecordClientAction(o),t.onCancel()},isNeutralButton:!0}]},i}();n.PasswordEntryDialog=i}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var SharingDisabledDialog=function(){function t(){}return t.prototype.initShareNotEnabledDialog=function(){var t={title:Resources.NyiShareDialogTitle,description:Resources.NyiShareDialogTitle,messages:[Resources.NyiShareDialogBody],width:500,noFocus:!0,dialogType:StoryApp.View.ViewElements.DialogType.Info,buttonsArgs:[{caption:{value:Resources.ButtonClose},isDefault:!0,dismissOnAction:!0,id:"idshButtonDismiss"}]};this.dialog=StoryApp.View.Common.DialogManager.createAndShow(t)},t.show=function(){(new t).show()},t.prototype.show=function(){this.initShareNotEnabledDialog()},t}(),StoryApp;!function(t){!function(t){!function(t){function e(){for(var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],e="",n=(new Date).getTime(),o=0;o<32&&n>0;o++)8!=o&&12!=o&&16!=o&&20!=o||(e+="-"),e+=t[n%16],n=Math.floor(n/16);for(;o<32;o++)8!=o&&12!=o&&16!=o&&20!=o||(e+="-"),e+=t[Math.floor(16*Math.random())];return e}t.generateGuid=e}(t.GuidGenerator||(t.GuidGenerator={}))}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){var e=function(){function t(){}return t.prototype.localeSupportsGlyphIconText=function(e){return t.unsupportedLocales.indexOf(e)<0},t.eaLanguages=["ja-jp","zh-cn","zh-tw","ko-kr"],t.indicLanguages=["hi-in","kn-in","ml-in","ta-in","te-in"],t.unsupportedLocales=t.eaLanguages.concat(t.indicLanguages),t}();t.GlyphIconSupportVerifier=e}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){var e=function(){function e(){}return e.getTextForPasswordScope=function(e){switch(e){case t.StoryPasswordScope.Everybody:return Resources.SharingPasswordScopeEverybody;case t.StoryPasswordScope.Editors:return Resources.SharingPasswordScopeEditors;default:return Resources.SharingPasswordScopeEverybody}},e.MaxPasswordLength=1e3,e}();t.PasswordHelper=e}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){var e=function(){function t(){}return t.obscureEmailPII=function(t){return t=t.replace(new RegExp("[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+.[a-zA-Z0-9-.]+"),"<PII INFORMATION OBSCURED>"),t=t.replace(new RegExp("[a-zA-Z0-9_.+-]+%40[a-zA-Z0-9-]+.[a-zA-Z0-9-.]+"),"<PII INFORMATION OBSCURED>")},t}();t.PIIHelper=e}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){var n=function(){function e(){}return e.isCopySupported=function(){return t.Utilities.supportsClipboard()||t.Utilities.supportsClipboard_Experimental()},e.copyHTMLText=function(n,o,i){if(void 0===i&&(i=!1),e.isCopySupported()){var r=$(n),a=r.text()||r.val();t.Utilities.supportsClipboard()?window.clipboardData.setData("Text",a):e.copyTextUsingExperimentalFeatures(a),$(o).focus(),i&&r.select()}else TDB.raiseRecoverableError("Trying to copy text to clipboard, but the clipboard is not supported.",TDB.LogLevel.error)},e.copyTextUsingExperimentalFeatures=function(e){if(t.Utilities.browser.isiOS){(i=document.createElement("span")).textContent=e,document.body.appendChild(i);var n=document.createRange();n.selectNodeContents(i);var o=window.getSelection();o.removeAllRanges(),o.addRange(n),t.Utilities.execDocumentCommand("copy"),o.removeAllRanges(),document.body.removeChild(i)}else{var i=document.createElement("input");i.value=e,document.body.appendChild(i),$(i).select(),t.Utilities.execDocumentCommand("copy"),document.body.removeChild(i)}},e}();e.TextCopyHelper=n}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){var e=function(){function t(t){this.args=t,this.tickCount=0}return t.prototype.startTimer=function(){var t=this;this.timerInterval||(this.timerInterval=platform.setInterval(function(){t.tickCount++,t.args.tickCallback.call(t.args.context),t.tickCount===t.args.numberOfTicks&&t.stopTimer()},this.args.tickInterval))},t.prototype.stopTimer=function(){this.timerInterval&&(clearInterval(this.timerInterval),this.timerInterval=void 0)},t.prototype.resetTimer=function(){this.stopTimer(),this.tickCount=0},t}();t.Timer=e}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){var n=t.View.ViewElements,o=t.Common;!function(t){t[t.Authoring=0]="Authoring",t[t.MySways=1]="MySways"}(e.WhatsNewPage||(e.WhatsNewPage={}));var i;!function(t){t[t.Internal=-1]="Internal",t[t.Disabled=0]="Disabled"}(i=e.WhatsNewDailogVersion||(e.WhatsNewDailogVersion={}));!function(t){t[t.Web=0]="Web",t[t.Win10=1]="Win10"}(e.WhatsNewPlatform||(e.WhatsNewPlatform={}));var r=function(){function r(){this.isIframeLoaded=!1,this.dialogWrapperCssClass=TDB.watchableTag(596477021,this,"CenteredDialog WhatsNewDialogWrapperHidden")}return r.showWhatsNewDialogWithDelay=function(e,n,o){void 0===o&&(o=CommonSettings.WhatsNewDialogVersion);var a=new r;return!CommonSettings.IsPublish&&(o>i.Disabled||a.isInternalUsage(o))?(t.Utilities.setTimeoutIfSpecified(CommonSettings.JAWSDialogDelay,this,function(){a.showWhatsNewDialog(e,n,o)}),a):null},r.prototype.isInternalUsage=function(t){return t&&t===i.Internal&&o.Environment.getInstance().areInternalFeaturesEnabled()},r.prototype.showWhatsNewDialog=function(t,o,i){var r=this,a=e.UrlHelper.getInstance().getWhatsNewFeaturesUrl(i,o);this.page=t,TDB.applyUpdate(function(){r.dialogWrapperCssClass.setValue("CenteredDialog WhatsNewDialogWrapperHidden")});var s={contentUrl:a,title:Resources.WhatsNewDialogTitle,description:Resources.WhatsNewDialogTitle,dialogLogMessage:"What's new dialog",dialogType:n.DialogType.Info,dialogCssWrapperClass:{watchable:this.dialogWrapperCssClass},dialogContentWrapperCssClass:"WhatsNewIFrameWrapper",iFrameCssClass:"WhatsNewIFrameContainer",onShowing:function(){return r.dialogShown(i)},onClose:this.dialogClosed,onload:function(){return r.iframeLoaded(i)},onKeyDown:this.keyDown,iframeMessageHandler:this.iframeMessageHandler,buttonsArgs:[{caption:{value:Resources.ButtonOK},isDefault:!0,dismissOnAction:!0,isNeutralButton:!0}],context:this};this.dialog=n.IframeDialog.createAndShow(s)},r.prototype.getCurrentDialog=function(){return this.dialog},r.prototype.dialogShown=function(t){CommonSettings.WhatsNewDialogVersion=0,StoryLog.StructuredTraceTag(20285392,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"What's new dialog is shown",{version:t.toString(),page:this.page.toString()})},r.prototype.dialogClosed=function(){StoryLog.TraceTag(20285393,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"What's new dialog is closed"),delete this.dialog},r.prototype.keyDown=function(t){if(t.keyCode===KeyCodeType.TabKey){var e=this.dialog.getContent(),n=this.dialog.getVE().getActivatableChildren();if(n.length>0){if(t.shiftKey&&n[0].isActivated())return e.getIframeMessageBinding().postMessage("focusLastElement"),!1;if(ArrayExtensions.last(n).isActivated()&&!t.shiftKey)return e.getIframeMessageBinding().postMessage("focusFirstElement"),!1}}return!0},r.prototype.iframeMessageHandler=function(t){if("focus"===t.action){var e=ArrayExtensions.lastOrDefault(this.dialog.getVE().getActivatableChildren());e&&e.activate()}else if("height"===t.action){var n=this.dialog.getContent(),o=t.height;n.setHeight(o),this.dialog.centerDialog()}},r.prototype.iframeLoaded=function(t){var n=this;return StoryLog.TraceTag(596452437,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"What's New Dialog iframe loaded."),this.isIframeLoaded=!0,TDB.applyUpdate(function(){n.dialogWrapperCssClass.setValue("CenteredDialog WhatsNewDialogWrapper"),platform.setImmediate(function(){var t=n.dialog.getVE();t&&t.enter()})}),$.get(e.UrlHelper.getInstance().getUpdateLastSeenWhatsNewUrl(t)).done(function(){StoryLog.TraceTag(596477022,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Last seen What's new dialog version has been updated")}).fail(function(t,e,n){StoryLog.StructuredTraceTag(596477023,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"Last seen What's new dialog version was not updated",{ErrorStatus:e,ErrorThrown:n,Status:t?t.status.toString():null})}),!0},r}();e.WhatsNewHelper=r}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var HistoryManager;!function(t){function e(t,e,i,r){if(void 0===t&&(t=window.history),void 0===e&&(e=function(t){return window.onpopstate=t}),void 0===i&&(i=window.document),void 0===r&&(r=function(t,e){return $(i).trigger(t,e)}),!t||!e)throw StoryApp.RethrowLogger.createError("historyImpl or setOnPopState parameters must not be set to undefined/null (overriding default)");if(!n||n.getHistoryImpl()!==t){if(n&&!UnitTestMode)throw StoryApp.RethrowLogger.createError("historyImpl should not change between calls to getHistoryManagerInstance()");var a=window.StoryPageSettings,s=!1;a&&(s=a.Mode===StoryViewMode.Embedded),n=new o({historyImpl:t,setOnPopState:e,document:i,noOpMode:s,eventTrigger:r})}return n}var n;t.getHistoryManagerInstance=e;var o=function(){function t(t){var e=this;this.dependencies=t,this.clientDictionary={},this.clientArgsSerializedDictionary={},this.contextSwitches={},this.dependencies.setOnPopState(function(t){return e.onPopState(t)}),this.clientCounter=0,this.mutex=new StoryApp.Common.Mutex}return t.prototype.getUniqueClientId=function(t){return(null!=t?t:"")+this.clientCounter++},t.prototype.getHistoryImpl=function(){return this.dependencies.historyImpl},t.prototype.registerClient=function(t,e){return this.clientDictionary[t]&&StoryLog.StructuredTraceTag(596477017,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Registered client under same key",{key:t}),this.clientDictionary[t]=e,new i(t,this)},t.prototype.serializeAndUnregisterClient=function(t){var e=this.clientDictionary[t];e?(this.clientArgsSerializedDictionary[t]=e.serialize(),delete this.clientDictionary[t]):StoryLog.StructuredTraceTag(596477018,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Unregistering nonexistent client",{key:t})},t.prototype.deserializeClientArgs=function(t){var e=this.clientArgsSerializedDictionary[t];return e?JSON.parse(e):null},t.prototype.getClient=function(t){return this.clientDictionary[t]},t.prototype.navigate=function(t,e,n,o,i){void 0===o&&(o=null),void 0===i&&(i=!1),this.navigationContextUrl=t,this.contextSwitches[t]={stateSwitch:e,stateData:n,documentTitle:o},this.clientPushReplaceState(i,null,null,o,t),null!=o&&this.dependencies.document&&(this.dependencies.document.title=o),this.onPageChanged(t,o)},t.prototype.onPopState=function(t){var e,n,o=this,i=t.state;i&&(i.navigationContextUrl&&i.navigationContextUrl!=this.navigationContextUrl&&(this.navigationContextUrl=i.navigationContextUrl,(e=this.contextSwitches[i.navigationContextUrl])||(StoryLog.StructuredTraceTag(596477019,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Navigating to URL due to lost history context",{URL:this.navigationContextUrl}),StoryApp.Utilities.assignWindowLocation(this.navigationContextUrl))),i.clientKey&&(n=this.clientDictionary[i.clientKey]),(e||n)&&this.mutex.synchronize(function(){var t=Task.fromResult({});return e&&(StoryPerformance.PerformanceManager.getInstance().markUserAction("History.popState"),o.dependencies.document&&null!=e.documentTitle&&(o.dependencies.document.title=e.documentTitle),t=e.stateSwitch(e.stateData,i.clientKey),o.onPageChanged(i.navigationContextUrl,e.documentTitle)),t.then(function(){e&&(n=o.clientDictionary[i.clientKey]),n&&(e&&n.onContextChange(),n.onPopState(i.clientState))}).toPromise()}))},t.prototype.safeHistoryOperation=function(t,e){try{return this.dependencies.noOpMode?e:t()}catch(t){StoryLog.StructuredTraceTag(596477020,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"History operation failed",{Exception:t})}return e},t.prototype.clientLength=function(){var t=this;return this.safeHistoryOperation(function(){return t.dependencies.historyImpl.length},0)},t.prototype.clientState=function(){var t=this,e=this.safeHistoryOperation(function(){return t.dependencies.historyImpl.state});return e?e.clientState:null},t.prototype.clientBack=function(){var t=this;this.safeHistoryOperation(function(){return t.dependencies.historyImpl.back()})},t.prototype.clientForward=function(){var t=this;this.safeHistoryOperation(function(){return t.dependencies.historyImpl.forward()})},t.prototype.clientGo=function(t){var e=this;this.safeHistoryOperation(function(){return e.dependencies.historyImpl.go(t)})},t.prototype.clientPushReplaceState=function(t,e,n,o,i){var r=this,a={navigationContextUrl:this.navigationContextUrl,clientKey:e,clientState:n};this.safeHistoryOperation(function(){if(t)r.dependencies.historyImpl.replaceState(a,o,i);else{var n=r.dependencies.historyImpl.state;!e||n&&n.clientKey||r.dependencies.historyImpl.replaceState({navigationContextUrl:r.navigationContextUrl,clientKey:e,clientState:null},o,i),r.dependencies.historyImpl.pushState(a,o,i)}})},t.prototype.onPageChanged=function(t,e){this.dependencies.eventTrigger(StoryApp.Common.EventNames.PageChanged,{pathname:StoryApp.Utilities.getUrlPathname(t),title:e})},t}(),i=function(){function t(t,e){this.key=t,this.historyManager=e}return Object.defineProperty(t.prototype,"scrollRestoration",{get:function(){return"auto"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return this.historyManager.clientLength()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this.historyManager.clientState()},enumerable:!0,configurable:!0}),t.prototype.back=function(){this.historyManager.clientBack()},t.prototype.forward=function(){this.historyManager.clientForward()},t.prototype.go=function(t){this.historyManager.clientGo(t)},t.prototype.pushState=function(t,e,n){this.historyManager.clientPushReplaceState(!1,this.key,t,e,n)},t.prototype.replaceState=function(t,e,n){this.historyManager.clientPushReplaceState(!0,this.key,t,e,n)},t}()}(HistoryManager||(HistoryManager={}));var StoryApp;!function(t){!function(t){var e;!function(t){t[t.Unknown=0]="Unknown",t[t.Landing=1]="Landing",t[t.MySways=2]="MySways",t[t.Story=3]="Story",t[t.None=4]="None"}(e=t.NavigationContextType||(t.NavigationContextType={})),t.NavigationContext={InitialType:function(t){switch(t){case"Explore":return e.Landing;case"Home":case"MyStories":return e.MySways;case"StoryPage":return e.Story;default:return e.Unknown}}(window.CurrentPage),CurrentType:e.None,IsConsumption:!1,IsAuthoringPlay:!1}}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){var e=function(){function t(){this.openPopusCallCount=0,this.auditCallCount=0,this.lastSentRequest=null,this.createPublicThumbnailCallCount=0}return t.prototype.sendChangeSharingRequest=function(t,e,n,o){this.lastSentRequest=t;var i=$.Deferred();return i.resolve(),i},t.prototype.openPopup=function(t,e,n){return this.openPopusCallCount++,null},t.prototype.dispatchAuditShareStoryRequest=function(t,e){this.auditCallCount++},t.prototype.sendGetSuggestedUsers=function(t,e,n,o){},t.prototype.sendGetGroupMembersRequest=function(t,e,n){},t.prototype.getThumbnail=function(t,e,n){e({title:"Story title",description:"Story description",thumbnail:"thumbnailId"},void 0,void 0)},t.prototype.createPublicThumbnail=function(t,e,n,o){this.createPublicThumbnailCallCount++},t.prototype.setPassword=function(t,e,n,o){},t.prototype.removePassword=function(t,e,n){},t}();t.MockSharingManagerApi=e}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){var e=function(){function t(t){this._initializer=t}return t.prototype.get=function(){return this.instance||(this.instance=this._initializer()),this.instance},t}();t.Lazy=e}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var StoryLimitType;!function(t){t[t.Free=0]="Free",t[t.Premium=1]="Premium",t[t.Old=2]="Old"}(StoryLimitType||(StoryLimitType={}));var LimitMessageType;!function(t){t[t.None=1]="None",t[t.ExactOnLimit=2]="ExactOnLimit",t[t.Warning=4]="Warning",t[t.Error=8]="Error"}(LimitMessageType||(LimitMessageType={}));var LimitData=function(){function t(){}return t}(),LimitDataCounter=function(){function t(){}return t}(),StoryApp;!function(t){!function(e){var n=function(){function e(){if(e.instance)throw t.RethrowLogger.createError("Can't create page compartment manager directly. Use getInstance() instead.");this.nextCompartmentId=0,this.compartments=[]}return e.getInstance=function(){return this.instance||(this.instance=new e),this.instance},e.prototype.createNewPageCompartment=function(){return this.compartments.push({}),t.Common.NavigationContext._NONPROD_pageId=this.nextCompartmentId,this.nextCompartmentId++},e.prototype.removePageCompartment=function(e){if(this.nextCompartmentId<=e)throw t.RethrowLogger.createError("Invalid compartment ID");var n=this.compartments[e];for(var o in n)if(n.hasOwnProperty(o)){var i=n[o];"function"==typeof i.dispose&&i.dispose()}delete this.compartments[e]},e.prototype.createAccessor=function(t){var e=this;return{get:function(n){return e.getGlobalObjectFromCompartment(n,t)},set:function(n,o){return e.setGlobalObjectInCompartment(n,t,o)}}},e.prototype.isCompartmentAvailable=function(t){return!!this.compartments[t]},e.prototype.setGlobalObjectInCompartment=function(e,n,o){if(this.nextCompartmentId<=e)throw t.RethrowLogger.createError("Invalid compartment ID");var i=this.compartments[e];if(!i)throw t.RethrowLogger.createError("Setting object in an already deleted compartment");i[n]=o},e.prototype.getGlobalObjectFromCompartment=function(e,n){if(this.nextCompartmentId<=e)throw t.RethrowLogger.createError("Invalid compartment ID");var o=this.compartments[e];if(!o)throw t.RethrowLogger.createError("Getting object from an already deleted compartment");return o[n]},e}();e.PageCompartmentManager=n}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var RemoveViewedStories;!function(t){var e=function(){function e(){}return e.prototype.removeViewedStoryFromUserList=function(e,n,o){ActionLogger.RecordClientAction(new ClientAction.RemoveViewedStoryActionData);var i=StoryApp.Common.UrlHelper.getInstance().removeViewedStoryUrl();$.ajax(i,{name:"RemoveViewedStory",description:"removing given viewed story",type:"POST",contentType:StoryApp.RequestManager.JsonContentType,dataType:"json",data:JSON.stringify(t.RemoveViewedSwayRequest.RemoveViewedStoryRequest(e)),headers:{clientCorrelation:CommonSettings.CorrelationId}}).then(function(t,e,o){n(jQuery.parseJSON(o.responseText),o.getResponseHeader(StoryApp.Common.CommonRequestHeaders.CorrelationIdHeader))},o)},e}();t.RemoveViewedSwayServerInterface=e}(RemoveViewedStories||(RemoveViewedStories={}));var StoryApp;!function(t){!function(e){var n=function(){function e(){}return e.prototype.sendChangeSharingRequest=function(e,n,o,i){return $.ajax(t.Common.UrlHelper.getInstance().sharingChangeLinkUrl(n),{name:"SharingChangeLink",description:"Change sharing",type:"POST",data:JSON.stringify(e),contentType:t.RequestManager.JsonContentType,dataType:"json"}).then(o,i)},e.prototype.openPopup=function(n,o,i){var r=t.Utilities.format("{0},width={1},height={2},left={3},top={4}",o,i.width,i.height,e.popupScreenOffset.x,e.popupScreenOffset.y);return window.open(n,"_blank",r)},e.prototype.dispatchAuditShareStoryRequest=function(e,n){$.get(t.Common.UrlHelper.getInstance().shareStoryUrl(e,n)).fail(function(){StoryLog.TraceTag(596477136,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Request to share story failed")})},e.prototype.sendGetSuggestedUsers=function(e,n,o,i){$.ajax(t.Common.UrlHelper.getInstance().getSearchUsersUrl(e,n),{name:"SearchUsers",type:"GET",dataType:"json"}).then(o,i)},e.prototype.sendGetGroupMembersRequest=function(e,n,o){$.ajax(t.Common.UrlHelper.getInstance().getGetGroupMembersURL(e),{name:"GetGroupMembers",type:"GET",description:"Get Group Members",dataType:"json"}).then(n,o)},e.prototype.getThumbnail=function(e,n,o){$.ajax(t.Common.UrlHelper.getInstance().getThumbnailUrl(e),{name:"Thumbnail",type:"GET",contentType:t.RequestManager.JsonContentType,dataType:"json"}).then(n,o)},e.prototype.createPublicThumbnail=function(e,n,o,i){$.ajax(t.Common.UrlHelper.getInstance().getCreatePublicThumbnail(e,n),{name:"CreatePublicThumbnail",type:"PUT",contentType:t.RequestManager.JsonContentType,dataType:"json"}).then(o,i)},e.prototype.setPassword=function(e,n,o,i){$.ajax(t.Common.UrlHelper.getInstance().getPasswordUrl(e),{name:"SetPassword",description:"Set sway password",data:JSON.stringify(n),dataType:"json",type:"POST",contentType:t.RequestManager.JsonContentType}).then(o,i)},e.prototype.removePassword=function(e,n,o){$.ajax(t.Common.UrlHelper.getInstance().getPasswordUrl(e),{type:"DELETE"}).then(n,o)},e.popupScreenOffset={x:20,y:20},e}();e.SharingManagerApi=n}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var StoryPerformance;!function(t){function e(){TDB.setPerfMeasurementFunction(n)}function n(t,e){o.getInstance().measurePerformance(t,e)}t.init=e,t.perfMeasurement=n;var o=function(){function t(){this.timeOrigin=0}return t.getInstance=function(){if(!t.instance){var e=null;try{CommonSettings.AuthoringFromLandingPageContextEnabled||(e=window.sessionStorage)}catch(t){}t.getCustomInstance(window.performance,e)}return t.instance},t.getCustomInstance=function(e,n){return t.instance||(t.instance=new t),t.instance.perf=e,t.instance.storage=n,t.instance},t.prototype.isPerformanceSupported=function(){return!!(this.perf&&this.perf.timing&&this.perf.getEntriesByType&&this.perf.mark&&this.perf.measure&&this.perf.now)},t.prototype.saveToStorage=function(){try{this.storage&&this.storage.setItem&&"object"==typeof JSON&&JSON.stringify&&(this.storage.setItem(t.storagePrefix+"resources",JSON.stringify(this.ensureJsonizable(this.getResources()))),this.storage.setItem(t.storagePrefix+"marks",JSON.stringify(this.ensureJsonizable(this.getMarks()))),this.storage.setItem(t.storagePrefix+"measures",JSON.stringify(this.ensureJsonizable(this.getMeasures()))),this.storage.setItem(t.storagePrefix+"timing",JSON.stringify(this.timing)))}catch(t){}},t.prototype.clearStorage=function(){try{this.storage&&this.storage.clear&&this.storage.clear()}catch(t){}},t.prototype.loadFromStorage=function(t){try{if(this.storage&&this.storage.getItem&&"object"==typeof JSON&&JSON.parse)return JSON.parse(this.storage.getItem(t))}catch(t){}return null},t.prototype.loadNetworkTimingFromStorage=function(){var e=this.loadFromStorage(t.storagePrefix+"timing");return e&&"number"!=typeof e.navigationStart?null:e},t.prototype.loadResourcesTimingsFromStorage=function(){var e=this.loadFromStorage(t.storagePrefix+"resources"),n=t.performanceEntryProperties.concat(t.performanceResourceTimingProperties);return e&&!e.every(function(t){return Obj.hasProperties(t,n)})?null:e},t.prototype.loadMarksFromStorage=function(){var e=this.loadFromStorage(t.storagePrefix+"marks");return e&&!e.every(function(e){return Obj.hasProperties(e,t.performanceEntryProperties)})?null:e},t.prototype.loadMeasuresFromStorage=function(){var e=this.loadFromStorage(t.storagePrefix+"measures");return e&&!e.every(function(e){return Obj.hasProperties(e,t.performanceEntryProperties)})?null:e},t.prototype.createMeasure=function(t,e,n){var o={name:t,startTime:e.startTime,duration:n.startTime-e.startTime,entryType:"measure",toJSON:function(){return JSON.stringify(o)}};return o},t.prototype.measurePerformance=function(t,e){var n="PERF:"+t+"_start",o="PERF:"+t+"_end";this.mark(n),e(),this.mark(o),this.measure(t,n,o)},t.prototype.clearAll=function(){this.clearMarks(),this.clearMeasures(),this.clearResourceTimings()},t.prototype.getTransferSize=function(t){var e=-1;return"number"==typeof t.transferSize&&(e=t.transferSize),e},t.prototype.getSecureConnectionStart=function(t){var e=-1;return t&&"number"==typeof t.secureConnectionStart&&(e=t.secureConnectionStart),e},t.prototype.markUserAction=function(t){this.mark("PERF_ACTION:"+t)},t.prototype.filterUserActionMarks=function(t){if(t)return this.getMarksStartingWith(t,"PERF_ACTION:")},t.prototype.getMarksStartingWith=function(t,e){if(t)return t.filter(function(t){return t.name.slice(0,e.length)===e})},t.prototype.timingEntryToJson=function(t){var e={};for(var n in t)"number"!=typeof t[n]&&"string"!=typeof t[n]||(e[n]=t[n]);return e},t.prototype.ensureJsonizable=function(t){var e=this;return t&&t.length>0&&("function"!=typeof t[0].toJSON||0===Object.keys(t[0].toJSON()).length)&&t.forEach(function(t){return t.toJSON=function(){return e.timingEntryToJson(t)}}),t},t.prototype.getResources=function(){return this.getEntriesByType("resource")},t.prototype.filterAjaxTimings=function(t,e){if(t)return t.filter(function(t){return"xmlhttprequest"===t.initiatorType&&0!==t.responseEnd&&(!e||t.startTime>=e)})},t.prototype.filterResources=function(t,e){if(t)return t.filter(function(t){return e.some(function(e){return t.name.slice(-e.length)===e})})},t.prototype.getAggregatedMeasure=function(t,e){if(t&&0!==t.length){var n=1/0;t.forEach(function(t){return n=Math.min(n,t.startTime)});var o=n;t.forEach(function(t){return o=0!==t.duration?Math.max(o,t.startTime+t.duration):o});var i={startTime:n,duration:o-n,entryType:"measure",name:e,toJSON:function(){return JSON.stringify(i)}};return i}},t.prototype.getSimpleThroughput=function(t){var e=this,n=this.getAggregatedMeasure(t);return{transferSizeInKiloBits:8*t.reduce(function(t,n){return t+e.getTransferSize(n)},0)/1024,duration:.001*n.duration}},t.prototype.getAggregateThroughput=function(t,e){var n=this,o={bandwidth:-1,cached:0,transferred:0,transferredDataSize:0};if(t&&e&&(t=t.filter(function(t){return t.startTime>=e})),!t||0===t.length||-1===this.getTransferSize(t[0]))return o;var i=t.filter(function(t){return 0!==n.getTransferSize(t)}),r=i.sort(function(t,e){return t.responseStart-e.responseStart});if(o.bandwidth=0,o.cached=t.length-i.length,o.transferred=i.length,0===r.length)return o;for(var a=0,s=0,l=0;a<r.length;){for(var u=1,c=r[a].responseEnd;a+u<r.length&&r[a+u].responseStart<=c;)c=Math.max(c,r[a+u].responseEnd),u++;var d=this.getSimpleThroughput(r.slice(a,a+u));s+=d.transferSizeInKiloBits,l+=d.duration,a+=u}return o.transferredDataSize=s/8,o.bandwidth=s/l,o},t.prototype.buildTTFVPerformanceReport=function(t,e){var n=[".js",".css"],o=this.filterUserActionMarks(this.getMarks()),i=!1;o&&0!==o.length||(i=(o=this.filterUserActionMarks(this.loadMarksFromStorage()))&&0!==o.length);var r=o&&o.length>0?ArrayExtensions.last(o):void 0,a=this.filterResources(this.getResources(),n),s=!r||i?0:r.startTime,l=StoryApp.Utilities.query.has(StoryApp.Common.UrlHelper.URLParamDetailedJSPerf);return{e2e:this.buildEndToEndTimingOutput(t,r,i),navigation:this.buildNavigateTimingOutput(e),resources:this.buildResourcesTimingOutput(a,s),ajax:this.buildAjaxTimingOutput(r,i),javascript:this.buildJsPerfOutput(s,l),bandwidth:JSON.stringify(this.getAggregateThroughput(a,s)),userAgent:navigator.userAgent}},t.prototype.buildResourcesTimingOutput=function(t,e){var n=null;if(t&&0!==t.length){var o=t.filter(function(t){return t.startTime>=e});n=this.getAggregatedMeasure(o)}return JSON.stringify({startTime:Math.round(n?n.startTime:0),duration:Math.round(n?n.duration:0)})},t.prototype.buildJsPerfOutputFromIndex=function(t,e,n){for(var o="",i=!0,r=t[n],a=r.startTime+r.duration;a<=e;){var s='{"n":"'+r.name+'","s":'+r.startTime.toFixed(1)+',"d":'+r.duration.toFixed(1);if(o+=i?s:","+s,i=!1,++n>=t.length){o+="}";break}var l=t[n];if(l.startTime<a){var u=this.buildJsPerfOutputFromIndex(t,a,n);if(o+=',"c":['+u.output+"]",(n=u.index)>=t.length){o+="}";break}l=t[n]}o+="}",a=(r=l).startTime+r.duration}return{output:o,index:n}},t.prototype.buildJsPerfOutput=function(t,e){var n=this.getMeasures();if(!n||0===n.length)return"";if(0===(n=n.filter(function(e){return e.startTime>=t}).sort(function(t,e){var n=t.startTime-e.startTime;return 0===n?e.duration-t.duration:n})).length)return"";var o=n[0].startTime,i=0;return n.forEach(function(t){return i=Math.max(i,t.startTime+t.duration)}),'{"n":"JS","s":'+o.toFixed(1)+',"d":'+(i-o).toFixed(1)+',"c":['+(e?this.buildJsPerfOutputFromIndex(n,i,0).output:"")+"]}"},t.prototype.buildAjaxTimingOutput=function(t,e){void 0===e&&(e=!1);var n="",o=[],i=0,r=t?t.startTime:0;if(e){var a=this.loadResourcesTimingsFromStorage(),s=this.loadNetworkTimingFromStorage();a&&s&&(i=this.timing.navigationStart-s.navigationStart,o=this.filterAjaxTimings(a,r))}var l=this.filterAjaxTimings(this.getResources(),e?void 0:r);return(l?o.concat(l):o).forEach(function(t,e){return n+=JSON.stringify({n:StoryApp.Utilities.removeQueryStringFromUrl(t.name.substring(t.name.lastIndexOf("/")+1)),s:e<o.length?Math.round(t.startTime-i):Math.round(t.startTime),d:Math.round(t.duration),r:Math.round(t.responseEnd-t.responseStart)})+","}),"["+n.substring(0,n.length-1)+"]"},t.prototype.buildNavigateTimingOutput=function(t){var e=this.timing;t&&""!==t||(e=null);var n=this.getSecureConnectionStart(e);return JSON.stringify({name:t,navigationStart:e?e.navigationStart:0,dns:e&&0!==e.domainLookupStart?e.domainLookupEnd-e.domainLookupStart:0,ssl:n>0?e.connectEnd-n:n,requestStart:e?e.requestStart:0,duration:e?e.responseStart-e.fetchStart:0,download:e?e.responseEnd-e.responseStart:0})},t.prototype.buildEndToEndTimingOutput=function(t,e,n){void 0===n&&(n=!1);var o=this.timing;if(!o)return"ERROR";var i=o.navigationStart,r="N/A";if(e)if(r=e.name,n){var a=this.loadNetworkTimingFromStorage();a&&(i=a.navigationStart+e.startTime)}else i=o.navigationStart+e.startTime;return JSON.stringify({e2eName:t,userActionName:r,e2eStart:i,userActionStartRelative:i-o.navigationStart,duration:Math.round(o.navigationStart+this.now()-i)})},Object.defineProperty(t.prototype,"navigation",{get:function(){return this.perf&&this.perf.navigation?this.perf.navigation:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timing",{get:function(){return this.perf&&this.perf.timing?this.perf.timing:null},enumerable:!0,configurable:!0}),t.prototype.clearMarks=function(t){this.perf&&this.perf.clearMarks&&this.perf.clearMarks(t)},t.prototype.clearMeasures=function(t){this.perf&&this.perf.clearMeasures&&this.perf.clearMeasures(t)},t.prototype.clearResourceTimings=function(){this.perf&&this.perf.clearResourceTimings&&this.perf.clearResourceTimings()},t.prototype.getEntries=function(){return this.perf&&this.perf.getEntries?this.perf.getEntries():null},t.prototype.getEntriesByName=function(t,e){return this.perf&&this.perf.getEntriesByName?this.perf.getEntriesByName(t,e):null},t.prototype.getEntriesByType=function(t){return this.perf&&this.perf.getEntriesByType?this.perf.getEntriesByType(t):null},t.prototype.getMarks=function(t){return this.perf&&this.perf.getEntriesByType?this.perf.getEntriesByType("mark"):null},t.prototype.getMeasures=function(t){return this.perf&&this.perf.getEntriesByType?this.perf.getEntriesByType("measure"):null},t.prototype.mark=function(t){this.perf&&this.perf.mark&&this.perf.mark(t)},t.prototype.measure=function(t,e,n){this.perf&&this.perf.measure&&this.perf.measure(t,e,n)},t.prototype.now=function(){return this.perf&&this.perf.now?this.perf.now():0},t.prototype.setResourceTimingBufferSize=function(t){this.perf&&this.perf.setResourceTimingBufferSize&&this.perf.setResourceTimingBufferSize(t)},t.prototype.toJSON=function(){return this.perf&&this.perf.toJSON?this.perf.toJSON():null},t.prototype.onresourcetimingbufferfull=function(){},t.prototype.addEventListener=function(){},t.prototype.removeEventListener=function(){},t.prototype.dispatchEvent=function(){return!1},t.storagePrefix="sway::Perf::",t.performanceEntryProperties=["duration","entryType","name","startTime"],t.performanceResourceTimingProperties=["connectEnd","connectStart","domainLookupEnd","domainLookupStart","fetchStart","initiatorType","redirectEnd","redirectStart","requestStart","responseEnd","responseStart"],t}();t.PerformanceManager=o}(StoryPerformance||(StoryPerformance={}));var ConditionalExecute=function(){function t(t,e){this.action=t,this.conditions=e.slice(),this.conditionalExecute()}return t.prototype.setCondition=function(t){this.conditions&&(ArrayExtensions.removeFirst(this.conditions,t),this.conditionalExecute())},t.prototype.conditionalExecute=function(){0===this.conditions.length&&this.action&&(this.action(),this.action=void 0,this.conditions=void 0)},t}(),StoryApp;!function(t){!function(t){var e=function(){function t(){this.busy=!1,this.queue=[]}return t.prototype.synchronize=function(t){this.queue.push(t),this.busy||this.dequeue()},t.prototype.dequeue=function(){this.busy=!0;var t=this.queue.shift();t?this.execute(t):this.busy=!1},t.prototype.execute=function(t){var e=this;t().always(function(){return e.dequeue()})},t}();t.Mutex=e}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){var n=function(){function n(){}return n.getInstance=function(){return n.instance||(n.instance=new n),n.instance},n.setInstance=function(t){n.instance=t},n.clearInstance=function(){n.instance=void 0},n.prototype.baseStoryUrl=function(t){return"/s/"+t},n.prototype.baseDecomposeUrl=function(t){return"/decompose/"+t},n.prototype.errorUrl=function(t,e,n){var o="/oops?CauseSessionId="+CommonSettings.UserSessionId+"&Cause="+t;return n&&(o+="&logAsInfo=true"),e&&(o+="&ta="+encodeURIComponent(e)),o},n.prototype.versionedSwayUrlPrefix=function(t){return"/sway/v"+n.swayUrlVersion+"/"+t+"/"},n.prototype.versionedUserUrlPrefix=function(){return"/user/v"+n.userUrlVersion+"/"},n.prototype.signInUrlRedirect=function(t){var e="/auth/signinurl";return t&&(e+="?redirectUrl="+t),e},n.prototype.redirectSilentSignInUrl=function(){return"/auth/redirectsilentsigninurl"},n.prototype.getHRDv2PageUrl=function(){return"signin"},n.prototype.getSSOUrl=function(){return CommonSettings.SiteRootUrl+"home/sso"},n.prototype.logStackTraceUrl=function(t){return(t?this.versionedSwayUrlPrefix(t):this.versionedUserUrlPrefix())+"logStackTrace"},n.prototype.exploreUrl=function(){return"/"},n.prototype.mySwaysUrl=function(){return"/my"},n.prototype.absoluteMySwaysUrl=function(){return CommonSettings.SiteRootUrl+"my"},n.prototype.playUrl=function(t){return this.viewUrl(t)+"?"+n.URLParamPlayMode},n.prototype.authoringPlayUrl=function(t){return this.viewUrl(t)+"?"+n.URLParamAuthoringPlayMode+"=true"},n.prototype.wacUrl=function(t){return this.authoringPlayUrl(t)+"&publish"},n.prototype.tutorialVideosUrl=function(){return"https://go.microsoft.com/fwlink/?LinkID=620102"},n.prototype.getFeaturedSwaysUrl=function(){return"https://go.microsoft.com/fwlink/?linkid=848842"},n.prototype.getFeaturedSwaysEduUrl=function(){return"https://go.microsoft.com/fwlink/?linkid=849031"},n.prototype.getPrivacyStatementUrl=function(){return"https://go.microsoft.com/fwlink/?LinkID=521839"},n.prototype.viewUrl=function(t){return CommonSettings.SiteRootUrl+t},n.prototype.shareLinkUrl=function(t){return t?CommonSettings.ShareRootUrl+t:""},n.prototype.trackedShareLinkUrl=function(t,e,n){var o=this.shareLinkUrl(t);if(!CommonSettings.SiteTrackedSharingUrlsEnabled)return o;var i=[];e&&i.push("ref="+e),n&&i.push("loc="+n);var r=i.join("&");return r&&(o=o+"?"+r),o},n.prototype.embedUrl=function(t){return CommonSettings.ShareRootUrl+"s/"+t+"/embed"},n.prototype.deleteStoryUrl=function(t){return this.baseStoryUrl(t)+"/delete"},n.prototype.deleteStoriesUrl=function(){return CommonSettings.SiteRootUrl+"my/deletestories"},n.prototype.getRecycleBinSwaysUrl=function(){return CommonSettings.SiteRootUrl+"my/getrecyclebinsways"},n.prototype.restoreStoriesUrl=function(){return CommonSettings.SiteRootUrl+"my/restorestories"},n.prototype.obliterateStoryUrl=function(t){return this.baseStoryUrl(t)+"/obliterate"},n.prototype.removeViewedStoryUrl=function(){return CommonSettings.SiteRootUrl+"my/removeviewedstory"},n.prototype.sharingChangeLinkUrl=function(t){return"/sharing/"+t+"/change"},n.prototype.shareStoryUrl=function(t,e){return"/sharing/"+t+"/share?shareTarget="+e},n.prototype.syncUrl=function(t){return this.baseStoryUrl(t)+"/sync"},n.prototype.joinUrl=function(t){return this.baseStoryUrl(t)+"/join"},n.prototype.createAndJoinUrl=function(){return"/json/createjoin"},n.prototype.createAndJoinFromDocUrl=function(){return"/json/createjoinfromdoc"},n.prototype.getStorySettingsUrl=function(t){return this.baseStoryUrl(t)+"/getstorysettings"},n.prototype.getMyStoriesSettingsUrl=function(){return this.versionedUserUrlPrefix()+"getmystoriessettings"},n.prototype.renewSubscriptionUrl=function(t,e,n){return this.baseStoryUrl(t)+"/renew/"+e+"?editToken="+n},n.prototype.leaveUrl=function(t,e){return this.baseStoryUrl(t)+"/leave/"+e},n.prototype.readOnlyUrl=function(t){return this.viewUrl(t)+"?readonly=true"},n.prototype.storyJoinResultUrl=function(t,e){return this.viewUrl(t)+"?readonly=true&joinResult="+e},n.prototype.knownWorldsUrl=function(t){return this.getVersionedSwayBaseUrl(t)+"worlds"},n.prototype.listFontSetOptionsUrl=function(t,e,n,o){return this.getVersionedSwayBaseUrl(t)+"styles/"+e+"/fontSetOptions/"+n+"/"+(o||"")},n.prototype.getBase64StylePreviewImagesUrl=function(t){return this.getVersionedSwayBaseUrl(t)+"styles/base64previewimages"},n.prototype.getStyleGalleryUrl=function(t,e){return this.getVersionedSwayBaseUrl(t)+"styles/gallery/"+e},n.prototype.getAnimationLevelForStyleUrl=function(t,e){return this.getVersionedSwayBaseUrl(t)+"styles/"+e+"/animationLevel"},n.prototype.suggestedColorSetsUrl=function(t,e){return this.baseStoryUrl(t)+"/suggestedcolors?maxVariationsPerImage="+e},n.prototype.customColorSetsUrl=function(t,e){return this.baseStoryUrl(t)+"/customcolorsets?maxVariationsPerImage="+e},n.prototype.duplicateStoryUrl=function(t){return n.VersionedUserBaseUrl+"copySway("+t+")"},n.prototype.exportStoryAllowedUrl=function(t){return this.baseStoryUrl(t)+"/exportstoryallowed"},n.prototype.exportStoryUrl=function(t){return this.baseStoryUrl(t)+"/exportstory"},n.prototype.exportStoryStatusUrl=function(t){return this.baseStoryUrl(t)+"/exportstorystatus"},n.prototype.exportStoryGetUrl=function(t,e,n,o,i,r,a){var s=this.baseStoryUrl(t)+"/exportstoryget?fileType="+e+"&outputType="+o+"&etag="+i+"&cacheVersion="+r+"&filename="+n;return a&&(s+="&inline=true"),s},n.prototype.changeAudienceUrl=function(t){return"/sharing/"+t+"/changeAudience"},n.prototype.getAudienceUrl=function(t){return"/sharing/"+t+"/getAudience"},n.prototype.addAuthorUrl=function(t,e){return this.baseStoryUrl(e)+"/addauthor"},n.prototype.getEditorsUrl=function(t){return this.baseStoryUrl(t)+"/editors"},n.prototype.removeEditorUrl=function(t,e){return this.baseStoryUrl(e)+"/removeEditor?editorId="+t},n.prototype.mediaBaseUrl=function(t){return t?CommonSettings.SiteCDNRootUrl:CommonSettings.SiteRootUrl},n.prototype.imageUrl=function(t,e,n,o,i,r,a){var s=a?"&embeddedHost=true":"",l=i?"&filterEffectsFormula="+i:"";return this.mediaBaseUrl(r)+"s/"+t+"/images/"+n+"?quality="+e.toString()+"&allowAnimation="+o+s+l},n.prototype.mediaUrl=function(t,e,n,o){return this.mediaBaseUrl(o)+"s/"+t+"/media/"+e+"?expectedType="+encodeURIComponent(n)},n.prototype.getAMSVideoStreamUrl=function(t){return this.baseStoryUrl(t)+"/getAMSVideoStreamingInfoV2"},n.prototype.getAMSAudioStreamUrl=function(t){return this.baseStoryUrl(t)+"/AMSAudioStreamingInfo"},n.prototype.remoteStaticImageUrl=function(t){return"/story/remotestaticimages/"+t},n.prototype.getImageCropsUrl=function(t){return this.baseStoryUrl(t)+"/imagecrops"},n.prototype.truncateFileName=function(t){var e=CommonSettings.LocalVideoMaxFileNameLength,n=t.lastIndexOf(".");if(n>e){return t.substr(0,e-"...".length)+"..."+t.substr(n)}return t},n.prototype.beginUploadUrl=function(t){return n.ApiBaseUrl+"upload/"+this.getFilenameForUploadUrl(t)+"/begin"},n.prototype.uploadFragmentUrl=function(t,e,o,i){return n.ApiBaseUrl+"upload/"+this.getFilenameForUploadUrl(t)+"/"+e+"/fragment/"+o+"/"+i},n.prototype.endUploadUrl=function(t,e){return n.ApiBaseUrl+"upload/"+this.getFilenameForUploadUrl(t)+"/"+e+"/end"},n.prototype.getFilenameForUploadUrl=function(t){return encodeURIComponent(this.truncateFileName(t))},n.prototype.decomposeSearchUrl=function(t){return this.baseDecomposeUrl(t)+"/search"},n.prototype.decomposeBrowseUrl=function(t){return this.baseDecomposeUrl(t)+"/browse"},n.prototype.decomposeNextUrl=function(t){return this.baseDecomposeUrl(t)+"/next"},n.prototype.decomposeReportUrl=function(t){return"/decompose/report"},n.prototype.decomposeUploadUrl=function(t){return this.baseDecomposeUrl(t)+"/upload"},n.prototype.getSuggestionsUrl=function(t){return this.baseDecomposeUrl(t)+"/getsuggestions"},n.prototype.getSuggestionClustersUrl=function(t){return this.baseDecomposeUrl(t)+"/getsuggestionclusters"},n.prototype.getSuggestedContentDumpUrl=function(t){return this.baseStoryUrl(t)+"/scdump"},n.prototype.getDocumentClassUrl=function(t){return this.baseStoryUrl(t)+"/documentclass"},n.prototype.suggestedNlDesignUrl=function(t){return this.baseStoryUrl(t)+"/suggestednldesign"},n.prototype.getMyStoriesUrl=function(){return"/my/getmystories"},n.prototype.getMyEditableStoriesUrl=function(){return"/my/getmyeditablestories"},n.prototype.getMyViewedStoriesUrl=function(){return"/user/v"+n.userUrlVersion+"/viewhistory"},n.prototype.storyAnalyticsUrl=function(t){return this.getVersionedSwayBaseUrl(t)+"analytics"},n.prototype.myStoriesAnalyticsUrl=function(){return n.ApiBaseUrl+"mystoriesanalytics"},n.prototype.editableStoriesAnalyticsUrl=function(){return n.ApiBaseUrl+"editablestoriesanalytics"},n.prototype.myStoriesViewCountUrl=function(){return n.ApiBaseUrl+"mystoriesviewcount"},n.prototype.editableStoriesViewCountUrl=function(){return n.ApiBaseUrl+"editablestoriesviewcount"},n.prototype.storyUploadUrl=function(){return"/json/storyupload"},n.prototype.getPublicStoriesUrl=function(){return"/my/getstories"},n.prototype.getTemplateStoriesUrl=function(){return"/my/gettemplatestories"},n.prototype.getUserTemplateStoriesUrl=function(){return"/my/getusertemplatestories"},n.prototype.getEducationStoriesUrl=function(){return"/my/geteducationstories"},n.prototype.getEmbeddedStoryInfoUrl=function(t){return"/"+t+"/embeddedStoryInfo"},n.prototype.getEmbeddedOneDriveInfoUrl=function(){return"/json/embeddedOneDriveInfo"},n.prototype.getCreateFacebookStoryUrl=function(){return"/json/createfacebookstory"},n.prototype.getLegacyCreateStoryUrl=function(){return"/story/create"},n.prototype.getFacebookConnectUrl=function(t){return"/json/getfacebookconnecturl?redirectUrl="+t},n.prototype.accessibilityViewUrl=function(t,e,o){var i=new RegExp(t+"/embed$","i").test(window.location.pathname)?this.embedUrl(t):CommonSettings.SiteRootUrl+t;return e?this.maintainEmbedHostMode(i,o):this.maintainEmbedHostMode(i+"?"+n.URLParamAccessible+"="+n.URLParamValueTrue,o)},n.prototype.isAccessibilityView=function(e){return t.Utilities.query.fetch(n.URLParamAccessible).toLowerCase()===n.URLParamValueTrue},n.prototype.maintainEmbedHostMode=function(t,e){return/\/embed/i.test(t)?null==e||0===e?t:(t+=-1!==t.indexOf("?")?"&":"?",t+="host="+EmbedHostType[e]):t},n.prototype.storyRestoreUrl=function(t,e){return this.viewUrl(t)+"#content="+e},n.prototype.getStoryUrl=function(t,e){return this.baseStoryUrl(t)+"/get?currentClientVersion="+e},n.prototype.getLayoutUrl=function(t,e,n){return this.baseStoryUrl(t)+"/getLayout?clientVersion="+e+"&contentId="+n},n.prototype.documentIngestionCreateUrl=function(){return n.ApiBaseUrl+"story/createfromdoc"},n.prototype.documentEmbedFromBlobIdUrl=function(t){return n.ApiBaseUrl+"story("+t+")/documentembedfromblobid"},n.prototype.documentIngestionInsertUrl=function(t){return n.ApiBaseUrl+"story("+t+")/appenddoc"},n.prototype.documentEmbedFromOneDriveUrl=function(t){return n.ApiBaseUrl+"story("+t+")/documentembedfromonedrive"},n.prototype.uploadFileToBlobUrl=function(t){return n.ApiBaseUrl+"story("+t+")/createblobidfromfile"},n.prototype.documentIngestionInsertFromBlobIdUrl=function(t){return n.ApiBaseUrl+"story("+t+")/appenddocfromblobid"},n.prototype.documentIngestionInsertFromOneDriveUrl=function(t){return n.ApiBaseUrl+"story("+t+")/appendoddoc"},n.prototype.reportViolationPageUrl=function(t){return this.baseStoryUrl(t)+"/reportviolation?sessionId="+CommonSettings.UserSessionId},n.prototype.remoteUlsUrl=function(){return CommonSettings.SiteRootUrl+Diag.UploadingUlsHost.defaultRemoteUlsUrl},n.prototype.internalFlightUrl=function(){return CommonSettings.SiteRootUrl+"home/internalflight?redirectUrl="+encodeURIComponent(window.location.href)},n.prototype.toggleMockedPremiumFeaturesUrl=function(){return CommonSettings.SiteRootUrl+"home/togglemockedpremiumfeatures?redirectUrl="+encodeURIComponent(window.location.href)},n.prototype.agaveHostResourcesUrl=function(){return CommonSettings.ContentBaseUrl+"AppsForOffice/"},n.prototype.twitterIFrameUrl=function(e,n,o){return CommonSettings.ContentBaseUrl+(t.Utilities.query.has(t.Common.UrlHelper.URLParamTestTweet)?"Test":"")+"TwitterFrame.html#"+e+"x"+n+"x"+o},n.prototype.siteDisabledUrl=function(){return CommonSettings.SiteRootUrl+"home/error/brs"},n.prototype.externalEmbedUrl=function(){return"/externalembed"},n.prototype.unsupportedBrowserUrl=function(){return"/unsupportedbrowser"},n.prototype.nlSearchUrl=function(t){return this.baseStoryUrl(t)+"/nlsearch"},n.prototype.getDownloadUrl=function(t){var e=t;return e.indexOf("?")<0?e+="?":e+="&",e+="download=true"},n.prototype.refactorReferrerUrl=function(t){var e="";return t&&(e=t.replace(/\?.*/,"")),e},n.prototype.refactorUrlForCampaignTracking=function(t){var e,n="",o="",i=!0;if(t){if((e=t.split("?")).length>1)for(var r=e[1].split("&"),a=0;a<r.length;a++)0===r[a].indexOf("utm_")&&(i?(i=!1,o="?"+r[a]):o+="&"+r[a]);n=""===o?e[0]:e[0]+o}return n},n.prototype.getUrlForUnprocessedImage=function(t){return t},n.prototype.curatedColorOptionsUrl=function(t,e){return this.getVersionedSwayBaseUrl(t)+"/styles/"+e+"/curatedColorOptions"},n.prototype.absoluteDocsJournalUrl=function(){return CommonSettings.CastUrl?CommonSettings.CastUrl+"me#journal":""},n.prototype.absoluteDocsAboutUrl=function(){return CommonSettings.CastUrl?CommonSettings.CastUrl+"me":""},n.prototype.getCastEditUrl=function(t){var o=e.UserState.getInstance().getUserProvider(),i=e.UserState.getInstance().getUserEmail();return CommonSettings.CastEditUrl+t+"?"+n.authProviderParameter+encodeURIComponent(o)+"&"+n.authUponParameter+encodeURIComponent(i)},n.prototype.getCastProfileUrl=function(){var t=e.UserState.getInstance().getUserProvider(),o=e.UserState.getInstance().getUserEmail();return CommonSettings.CastProfileUrl+"?"+n.authProviderParameter+encodeURIComponent(t)+"&"+n.authUponParameter+encodeURIComponent(o)},n.prototype.getCastPublishAadUrl=function(t){var n=e.UserState.getInstance().getUserProvider(),o=e.UserState.getInstance().getUserEmail(),i=CommonSettings.UserLocaleString;return CommonSettings.CastPublishAADUrl+t+"?auth_pvr="+encodeURIComponent(n)+"&auth_upn="+encodeURIComponent(o)+"&omkt="+encodeURIComponent(i)},n.prototype.getCastRedirectLink=function(){var o=decodeURIComponent(t.Utilities.query.fetch(n.URLParamDone)||""),i=o.toLowerCase();return o?0==i.indexOf("javascript:")||0==i.indexOf("data:")?null:0==i.indexOf("https://")||0==i.indexOf("http://")?CommonSettings.CastUrl&&0==i.indexOf(CommonSettings.CastUrl.toLowerCase())?o:!e.Environment.getInstance().isProductionEnvironment()&&this.isCastPrUri(o)?o:null:CommonSettings.CastUrl?CommonSettings.CastUrl+o:null:null},n.prototype.isCastUri=function(n){var o=n.toLowerCase(),i="https://"+t.Utilities.extractHostnameFromUrl(o);return!!(""!==n&&CommonSettings.CastUrl&&CommonSettings.CastUrl.toLowerCase().indexOf(i)>=0||!e.Environment.getInstance().isProductionEnvironment()&&this.isCastPrUri(n))},n.prototype.supportsNotifications=function(t){return this.isCastUri(t)},n.prototype.isCastPrUri=function(t){for(var e=[/^https{0,1}:\/\/osisvcpr[0-9]{4}\.int\.docs\.com(\/|$)/,/^https{0,1}:\/\/osisvcpr[0-9]{4}\.int-docs\.com(\/|$)/,/^https{0,1}:\/\/[a-zA-Z0-9-]+\.dev\.int\.docs\.com(\/|$)/,/^https{0,1}:\/\/[a-zA-Z0-9-]+\.dev\.int-docs\.com(\/|$)/],n=0;n<e.length;n++)if(e[n].exec(t))return!0;return!1},n.prototype.updateCalloutShownCount=function(){return"/json/updateCalloutShownCount"},n.prototype.logStoryFeedbackUrl=function(t){return this.baseStoryUrl(t)+"/logStoryFeedback"},n.prototype.contactMeResultsUrl=function(){return"/json/surveyResults"},n.prototype.getSearchApiUrl=function(t,e,n){return this.baseStoryUrl(t)+"/searchContent?query="+e+"&options="+n},n.prototype.getContentSourcesUrl=function(t){return this.baseStoryUrl(t)+"/contentSources"},n.prototype.getPasswordUrl=function(t){return this.baseStoryUrl(t)+"/password"},n.prototype.getPasswordSubmissionUrl=function(t){return this.baseStoryUrl(t)+"/submitpassword"},n.prototype.getLoadingSpinnerUrl=function(){return CommonSettings.ContentBaseUrl+"LoadingBlackSpinner.gif"},n.prototype.getGetOutlineForTopicUrl=function(){return"/json/getoutlinefortopic"},n.prototype.getGetOutlineAndJoinStoryForTopicUrl=function(){return"/json/getoutlineandjoinstoryfortopic"},n.prototype.getEnabledLanguagesList=function(t,e){return"/json/getenabledlanguages?styleId="+t+"&fontSetId="+e},n.prototype.getUpdateLastSeenWhatsNewUrl=function(t){return"/json/updatelastseenwhatsnew?versionShown="+t},n.prototype.getWhatsNewFeaturesUrl=function(t,e){return CommonSettings.SiteRootUrl+"whatsnewfeatures/"+t+"/"+e},n.prototype.getThumbnailUrl=function(t){return this.versionedSwayUrlPrefix(t)+"thumbnail"},n.prototype.getThumbnailImageUrl=function(e,n,o,i,r,a){return this.mediaBaseUrl(a)+this.versionedSwayUrlPrefix(e)+t.Utilities.format("thumbnailImage?imageId={0}&width={1}&height={2}&isPreview={3}",n,o,i,r?"true":"false")},n.prototype.getCreatePublicThumbnail=function(t,e){return this.versionedSwayUrlPrefix(t)+"createPublicThumbnail?imageId="+e},n.prototype.closedCaptionUrl=function(t,e,n){return this.mediaBaseUrl(n)+"s/"+t+"/closedCaptions/"+e},n.prototype.getShareToFacebookUrl=function(t){return"https://www.facebook.com/sharer.php?u="+encodeURIComponent(t)+"&display=popup"},n.prototype.getShareToLinkedInUrl=function(e,n,o){return t.Utilities.format("https://www.linkedin.com/shareArticle?mini=true&url={0}&title={1}&summary={2}&source={3}",encodeURIComponent(e),encodeURIComponent(n),encodeURIComponent(o),encodeURIComponent(Resources.ProductNameShort))},n.prototype.getShareToTwitterUrl=function(t,e){return"https://twitter.com/share?url="+encodeURIComponent(t)+"&text="+encodeURIComponent(e)},n.prototype.getParameterByName=function(t,e,n){e||(e=window.location.href);var o="[?&]"+(t=t.replace(/[\[\]]/g,"\\$&"))+"(=([^&#]*)|&|#|$)",i=(n?new RegExp(o,"i"):new RegExp(o)).exec(e);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null},n.prototype.getSearchUsersUrl=function(t,e){return"/sharing/searchusers?tenantId="+encodeURIComponent(t)+"&searchQuery="+encodeURIComponent(e)},n.prototype.getGetGroupMembersURL=function(t){return"/sharing/getgroupmembers?objectId="+t},n.prototype.getHomepageContent=function(t){return CommonSettings.ContentBaseUrl+t},n.prototype.getCrossOriginVideo=function(t){return CommonSettings.ContentBaseUrl+"HomepageVideos/"+t},n.prototype.getCookieUrl=function(){return CommonSettings.SiteRootUrl+"home/ping?purpose=cookie"},n.prototype.getStoryGlyphIconsUrl=function(){return CommonSettings.ContentBaseUrl+"story.png"},n.prototype.getWorldIconUrl=function(t){return CommonSettings.ContentBaseUrl+"Layout"+t+".png"},n.prototype.getVersionedSwayBaseUrl=function(e){if(!e)throw t.RethrowLogger.createError("Invalid lookup ID");return n.VersionedSwayBaseUrl+e+"/"},n.prototype.getReportViolationApiUrl=function(e){if(!e)throw t.RethrowLogger.createError("Invalid lookup ID");return"/swayavert/reportviolationavert/"+e},n.prototype.getTestRavPageUrl=function(t){return"/testing/rav/?path="+encodeURIComponent(window.location.pathname)+"&cid="+CommonSettings.UserSessionId+(t?"&sid="+t:"")},n.prototype.getUnversionedContentUrl=function(t){return CommonSettings.UnversionedContentBaseUrl+t},n.prototype.getNativeLightweightSignOutUrl=function(){return"/nativelightweight/signout"},n.prototype.getNativeLightweightSignInUrl=function(t){var e="/nativelightweight/signin";return t&&(e+="?dest="+t),e},n.prototype.getNativeLightweightGetCookieUrl=function(){return"/nativelightweight/getcookie"},n.prototype.getNativeLightweightAadAuthSignInUrl=function(){return"/auth/signin"},n.prototype.getIsAuthenticatedAbsoluteUrl=function(){return CommonSettings.SiteRootUrl+"home/IsAuthenticated"},n.prototype.getOffice365UpsellUrl=function(){return"https://products.office.com/compare-all-microsoft-office-products?tab=1"},n.prototype.getSwayPrivacyHelpArticleLink=function(){return"https://go.microsoft.com/fwlink/?linkid=864808"},n.prototype.getDocumentIngestionStatusUrl=function(){return CommonSettings.SiteRootUrl+"json/getdocumentingestionstatus"},n.prototype.getPublishedStoryViewUrl=function(t){return this.viewUrl(t)+"?publish"},n.prototype.getSwayUrlOnOfficeCom=function(){return e.O365ShellService.getInstance().swayHomeUrl},n.URLParamAccessible="accessible",n.URLParamAllowIframeUnloading="allowiframeunloading",n.URLParamAllowUnloadingImages="allowunloadingimages",n.URLParamAnimationsDisabled="animationsdisabled",n.URLParamAuthoringPlayMode="authoringPlay",n.URLParamAutoScroll="autoscroll",n.URLParamContactMe="contactMe",n.URLParamContactMeInfluential="contactMeInfluential",n.URLParamContactMeNetNew="contactMeNetNew",n.URLParamCountView="countView",n.URLParamCull="cull",n.URLParamCustomScroll="customscroll",n.URLParamDebugState="DebugState",n.URLParamDefaultSignInTimeoutOverride="defaultsignintimeoutoverride",n.URLParamDest="dest",n.URLParamDetailedJSPerf="detailedJSPerf",n.URLParamDone="done",n.URLParamDSILogging="dsilogging",n.URLParamEdit="edit",n.URLParamEmulateProd="emulateprod",n.URLParamFirstRun="firstRun",n.URLParamFontScale="fontScale",n.URLParamFriction="friction",n.URLParamHost="host",n.URLParamJoinResult="joinResult",n.URLParamLayoutRounding="layoutrounding",n.URLParamLayoutV2="layoutv2",n.URLParamLowFi="lowfi",n.URLParamMain="main",n.URLParamMRURef="ref",n.URLParamMRURefExpectedValue="swaymru",n.URLParamNoChrome="nochrome",n.URLParamNoCulling="noculling",n.URLParamNoThrow="nothrow",n.URLParamNoZMenu="nozmenu",n.URLParamPageSize="pageSize",n.URLParamPerfTest="perfTest",n.URLParamPlayMode="play",n.URLParamReadOnly="readonly",n.URLParamRedirect="redirect",n.URLParamRetry="retry",n.URLParamStorylinevirtualization="storylinevirtualization",n.URLParamTelemetryMode="telemetryMode",n.URLParamTestQueue="testqueue",n.URLParamTestTweet="testtweet",n.URLParamTouchMultiplier="touchmul",n.URLParamValidateStoryboards="validateStoryboards",n.URLParamWebLog="weblog",n.URLParamValueFalse="false",n.URLParamValueTrue="true",n.URLParamAuthPvr="auth_pvr",n.URLParamAuthUpn="auth_upn",n.accessibilityTipsUrl="https://support.office.com/article/c8d9638b-bd09-446f-80a5-234af71e42d9",n.ApiBaseUrl="/api/1.0/",n.swayUrlVersion="1.0",n.userUrlVersion="1.0",n.VersionedSwayBaseUrl="/sway/v"+n.swayUrlVersion+"/",n.VersionedUserBaseUrl="/user/v"+n.userUrlVersion+"/",n.authProviderParameter="auth_pvr=",n.authUponParameter="auth_upn=",n}();e.UrlHelper=n}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var AppType;!function(t){t[t.Unknown=0]="Unknown",t[t.WindowsPhoneApp=1]="WindowsPhoneApp",t[t.iOSApp=2]="iOSApp",t[t.AndroidApp=3]="AndroidApp",t[t.WebApp=4]="WebApp",t[t.WinRTApp=5]="WinRTApp",t[t.Win10Lightweight=6]="Win10Lightweight"}(AppType||(AppType={}));var Aria;!function(t){t.Attributes={Atomic:"aria-atomic",Busy:"aria-busy",Controls:"aria-controls",Describedby:"aria-describedby",Disabled:"aria-disabled",Dropeffect:"aria-dropeffect",Flowto:"aria-flowto",Grabbed:"aria-grabbed",Haspopup:"aria-haspopup",Hidden:"aria-hidden",Invalid:"aria-invalid",Label:"aria-label",Labelledby:"aria-labelledby",Live:"aria-live",Owns:"aria-owns",Relevant:"aria-relevant",Autocomplete:"aria-autocomplete",Checked:"aria-checked",Expanded:"aria-expanded",Level:"aria-level",Multiline:"aria-multiline",Multiselectable:"aria-multiselectable",Orientation:"aria-orientation",Pressed:"aria-pressed",Readonly:"aria-readonly",Required:"aria-required",Selected:"aria-selected",Sort:"aria-sort",Valuemax:"aria-valuemax",Valuemin:"aria-valuemin",Valuenow:"aria-valuenow",Valuetext:"aria-valuetext",Activedescendant:"aria-activedescendant",Posinset:"aria-posinset",Setsize:"aria-setsize",Role:"role",TabIndex:"tabindex",Title:"title",Id:"id"},t.CheckboxState={True:"true",False:"false",Mixed:"mixed"};var e=function(){function e(){}return e.fromBoolean=function(e){return e?t.BooleanState.True:t.BooleanState.False},e.True="true",e.False="false",e}();t.BooleanState=e;!function(t){t[t.Off=0]="Off",t[t.Polite=1]="Polite",t[t.Assertive=2]="Assertive"}(t.AriaLiveValue||(t.AriaLiveValue={})),t.AriaDropEffectValue={Copy:"copy",Move:"move",Link:"link",Execute:"execute",Popup:"popup",None:"none"}}(Aria||(Aria={}));var Aria;!function(t){t.Roles={Alert:"alert",Alertdialog:"alertdialog",Application:"application",Article:"article",Banner:"banner",Button:"button",Checkbox:"checkbox",Columnheader:"columnheader",Combobox:"combobox",Complementary:"complementary",Contentinfo:"contentinfo",Definition:"definition",Dialog:"dialog",Directory:"directory",Document:"document",Form:"form",Grid:"grid",Gridcell:"gridcell",Group:"group",Heading:"heading",Img:"img",Link:"link",List:"list",Listbox:"listbox",Listitem:"listitem",Log:"log",Main:"main",Marquee:"marquee",Math:"math",Menu:"menu",Menubar:"menubar",Menuitem:"menuitem",Menuitemcheckbox:"menuitemcheckbox",Menuitemradio:"menuitemradio",Navigation:"navigation",Note:"note",Option:"option",Presentation:"presentation",Progressbar:"progressbar",Radio:"radio",Radiogroup:"radiogroup",Region:"region",Row:"row",Rowgroup:"rowgroup",Rowheader:"rowheader",Scrollbar:"scrollbar",Search:"search",Separator:"separator",Slider:"slider",Spinbutton:"spinbutton",Status:"status",Tab:"tab",Tablist:"tablist",Tabpanel:"tabpanel",Textbox:"textbox",Timer:"timer",Toolbar:"toolbar",Tooltip:"tooltip",Tree:"tree",Treegrid:"treegrid",Treeitem:"treeitem"}}(Aria||(Aria={}));var StoryApp;!function(t){!function(t){!function(t){!function(t){t[t.Canvas=0]="Canvas",t[t.StoryLine=1]="StoryLine",t[t.OOUI=2]="OOUI"}(t.AuthoringState||(t.AuthoringState={}))}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var CommonBindings;!function(t){!function(t){!function(t){!function(t){var e=function(){function t(t,e,n){this._element=t}return t.prototype.updateClassName=function(t,e){this._element.className=e||""},t}();t.BindingBase=e}(t.ClassName||(t.ClassName={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(CommonBindings||(CommonBindings={}));var CommonBindings;!function(t){!function(t){!function(t){!function(t){var e=function(){function t(t,e,n){this._element=t,this._viewElement=n}return t.prototype.updateCopyHtml=function(t,e){var n=$(e).html();$(this._element).html(n)},t}();t.BindingBase=e}(t.CopyHtml||(t.CopyHtml={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(CommonBindings||(CommonBindings={}));var CommonBindings;!function(t){!function(t){!function(t){!function(t){var e;!function(t){t[t.Full=0]="Full",t[t.GlyphOnly=1]="GlyphOnly",t[t.Overflow=2]="Overflow"}(e=t.MenuItemState||(t.MenuItemState={}));var n;!function(t){t[t.Step1=0]="Step1",t[t.Step2=1]="Step2",t[t.Step3=2]="Step3",t[t.Step4=3]="Step4",t[t.NextToLastStep=3]="NextToLastStep",t[t.LastStep=4]="LastStep"}(n=t.MenuResizeStep||(t.MenuResizeStep={}));var o=function(){function t(){}return t}();t.MenuChunkData=o;var i=function(){function i(t,e,n){this._element=t,this._visible=!1,this._menuChunks=[],this._notifyMenuItemResize=TDB.notifierTag(596477121,this)}return i.prototype.updateVisible=function(t){this._visible=t,this._visible&&(this._resizeHandler||(this._resizeHandler=StoryApp.Utilities.onResize(this.updateLayout,this))),!this._visible&&this._resizeHandler&&(this._resizeHandler.dispose(),this._resizeHandler=void 0)},i.prototype.updateChunks=function(t,e){this._widthBuffer=e.widthBuffer,this.updateVisible(e.visible),t.watch(this._notifyMenuItemResize),this._menuChunks=e.menuChunks;for(var n=this._menuChunks.length,o=0;o<n;o++){var i=this._menuChunks[o];if(i)for(var r=i.getMenuItems(t),a=r.length,s=0;s<a;s++)r[s].getViewElementVisible(t)}this.updateLayout()},i.prototype.updateLayout=function(){var e=this;if(this._visible&&null!=this._menuChunks&&0!=this._menuChunks.length){for(var n=$(this._element).innerWidth()+this._widthBuffer,o=this._menuChunks.length,i=0,r=0;r<o;r++){var a=this._menuChunks[r],s=a.getMenuItems(),l=s.length,u=0;a.getOverflowButtonVisible()?u+=a.getOverflowButtonWidth():CommonSettings.IsAuthenticated||(u+=t.Binding.overflowMenuWidth);for(var c=0;c<l;c++){var d=s[c];d.getViewElementVisible()&&(u+=d.getItemWidth())}i+=u}TDB.applyUpdate(function(){i>=n?e.shrinkLayout(n,i):i<n&&e.growLayout(n,i)},TDB.Justification.DynamicMenu)}},i.prototype.shrinkLayout=function(t,i){for(var r={},a=n.Step2,s=i;s>=t&&a<=n.LastStep;){for(var l=this._menuChunks.length-1;s>=t&&l>=0;){void 0===r[l]&&(r[l]=new o,r[l].menuChunk=this._menuChunks[l],r[l].overflowVisible=r[l].menuChunk.getOverflowButtonVisible(),r[l].overflowElementChange=0);var u=r[l];u.currentProjectedWidth=s;for(var c=u.menuChunk.getMenuItems(),d=c.length-1;u.currentProjectedWidth>=t&&d>=0;){var p=c[d],g=p.getViewElementVisible(),h=p.stateMap[a];if(g&&void 0!==h&&h!==p.state.getValue())switch(h){case e.GlyphOnly:if(!this.shrinkToGlyphOnly(p,u))return;break;case e.Overflow:this.showInOverflow(p,u)}d--}s=u.currentProjectedWidth,l--}a++}},i.prototype.growLayout=function(t,i){var r={};if(!(t<=i))for(var a=n.NextToLastStep,s=i;a>=n.Step1;){for(var l=this._menuChunks.length,u=0;u<l;){void 0===r[u]&&(r[u]=new o,r[u].menuChunk=this._menuChunks[u],r[u].overflowVisible=r[u].menuChunk.getOverflowButtonVisible(),r[u].overflowElementChange=0);var c=r[u];c.currentProjectedWidth=s;for(var d=c.menuChunk.getMenuItems(),p=d.length,g=0;g<p;){var h=d[g],m=h.getViewElementVisible(),y=h.stateMap[a],f=h.state.getValue();if(m&&void 0!==y&&y!==f)if(f===e.Overflow){if(!this.hideInOverflow(h,y,t,c))return}else if(!this.growToFull(h,t,c))return;g++}s=c.currentProjectedWidth,u++}a--}},i.prototype.shrinkToGlyphOnly=function(t,n){if(t.state.getValue()!=e.Full)return!0;if(t.needToRecalcWidth(e.GlyphOnly))return t.state.setValue(e.GlyphOnly),this._notifyMenuItemResize.notify(),!1;var o=t.getItemWidth();return t.state.setValue(e.GlyphOnly),n.currentProjectedWidth=n.currentProjectedWidth-o+t.getItemWidth(),!0},i.prototype.showInOverflow=function(t,n){if(t.state.getValue()!=e.Overflow){var o=t.getItemWidth();t.state.setValue(e.Overflow),n.overflowElementChange++;var i=0;!n.overflowVisible&&n.menuChunk.predictOverflowButtonVisible(n.overflowElementChange)&&(n.overflowVisible=!0,i+=n.menuChunk.getOverflowButtonWidth()),n.currentProjectedWidth=n.currentProjectedWidth-o+i}},i.prototype.hideInOverflow=function(t,n,o,i){if(t.state.getValue()!=e.Overflow||n==e.Overflow)return!0;if(t.needToRecalcWidth(n))return t.state.setValue(n),this._notifyMenuItemResize.notify(),!1;var r=t.getWidthForState(n);i.overflowElementChange--;var a=0;return i.overflowVisible&&!i.menuChunk.predictOverflowButtonVisible(i.overflowElementChange)&&(a=i.menuChunk.getOverflowButtonWidth()),i.currentProjectedWidth+r-a<o&&(0!=a&&(i.overflowVisible=!1),i.currentProjectedWidth=i.currentProjectedWidth+r-a,t.state.setValue(n),!0)},i.prototype.growToFull=function(t,n,o){if(t.state.getValue()!==e.GlyphOnly)return!0;if(t.needToRecalcWidth(e.Full))return t.state.setValue(e.Full),this._notifyMenuItemResize.notify(),!1;var i=t.getWidthForState(e.Full),r=t.getItemWidth(),a=o.currentProjectedWidth-r+i;return a<n&&(o.currentProjectedWidth=a,t.state.setValue(e.Full),!0)},i.prototype.dispose=function(){this._resizeHandler&&(this._resizeHandler.dispose(),this._resizeHandler=void 0)},i.overflowMenuWidth=52,i}();t.BindingBase=i}(t.DynamicMenu||(t.DynamicMenu={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(CommonBindings||(CommonBindings={}));var CommonBindings;!function(t){!function(t){!function(t){!function(t){var e=function(){function t(t,e,n){this._transitionDefault="opacity 0.3s ease",this._element=t,this._viewElement=n,this._visible=!0,this._disabled=!1,this._overrideDisplay=!0,this._useVisibility=!1,this._opacityWhenVisible="1"}return t.prototype.init=function(t){var e=this;this._disabled=t.disabled,this._disabled||(t.transitionIn?this._transitionIn=t.transitionIn:this._transitionIn=this._transitionDefault,t.transitionOut?this._transitionOut=t.transitionOut:this._transitionOut=this._transitionDefault,t.visibleInit!=this._visible&&(this._visible=t.visibleInit),void 0!==t.overrideDisplay&&(this._overrideDisplay=t.overrideDisplay),t.useVisibility&&(this._useVisibility=t.useVisibility),this._visible?this._element.style.transition=this._transitionIn:this._element.style.transition=this._transitionOut,void 0!==t.opacityWhenVisible&&(this._opacityWhenVisible=t.opacityWhenVisible.toString()),this._element.style.opacity=this._visible?this._opacityWhenVisible:"0",!this._visible&&this._overrideDisplay&&(this._useVisibility?this._element.style.visibility="hidden":this._element.style.display="none"),this._transitionEndHandler=function(n){if(n.target==e._element){var o=t.context?t.context:e._viewElement;e._visible&&t.onVisible&&t.onVisible.apply(o),!e._visible&&t.onHidden&&t.onHidden.apply(o),e.hideIfNeeded()}},$(this._element).on("transitionend",this._transitionEndHandler))},t.prototype.updateFadeVisible=function(t,e){var n=this;if(null!=e.disabled&&(this._disabled=e.disabled),!this._disabled){var o=e.transitionIn||this._transitionIn,i=e.transitionOut||this._transitionOut,r=e.visible?o:i,a=this._visible?this._transitionIn:this._transitionOut;if(this._visible!==e.visible||r!==a){this._visible=e.visible,this.showIfNeeded(),this._transitionIn=o,this._transitionOut=i,this._element.style.transition=r;var s=void 0!==e.transitionDelay?e.transitionDelay:0;platform.setTimeout(function(){var t=n._element.style,e=n._visible?n._opacityWhenVisible:"0";t.opacity===e?n.hideIfNeeded():t.opacity=e},s),"none"==r&&this.hideIfNeeded()}}},t.prototype.showIfNeeded=function(){this._visible&&this._overrideDisplay&&(this._useVisibility?this._element.style.visibility="":this._element.style.display="")},t.prototype.hideIfNeeded=function(){!this._visible&&this._overrideDisplay&&(this._useVisibility?this._element.style.visibility="hidden":this._element.style.display="none")},t.prototype.dispose=function(){this._transitionEndHandler&&$(this._element).off("transitionend",this._transitionEndHandler)},t}();t.BindingBase=e}(t.FadeVisible||(t.FadeVisible={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(CommonBindings||(CommonBindings={}));var CommonBindings;!function(t){!function(t){!function(t){!function(t){var e;!function(t){t[t.Up=0]="Up",t[t.Left=1]="Left",t[t.Right=2]="Right",t[t.Down=3]="Down"}(e=t.Direction||(t.Direction={}));var n=["calloutTop-in 366ms linear 1 both","calloutLeft-in 366ms linear 1 both","calloutRight-in 366ms linear 1 both","calloutBottom-in 366ms linear 1 both"],o=["calloutTop-out 200ms linear 1 both","calloutLeft-out 200ms linear 1 both","calloutRight-out 200ms linear 1 both","calloutBottom-out 200ms linear 1 both"],i=function(){function t(t,n,o){this.animationEndEventString="webkitAnimationEnd oanimationend MSAnimationEnd animationend",this._element=t,this._viewElement=o,this._visible=!1,this._disabled=!1,this._delay="1.0s",this._direction=e.Up}return t.prototype.init=function(t){var e=this;this._disabled=t.disabled,this._disabled||(t.visibleInit!=this._visible&&(this._visible=t.visibleInit),void 0!==t.delay&&(this._delay=t.delay),void 0!==t.direction&&(this._direction=t.direction),this._element.style.opacity=this._visible?"1":"0",this._element.style.transition="opacity 200ms linear",this._element.style.position="absolute",this._animationEndHandler=function(){e._element.style.animation="none",void 0!==t.animationEndAction&&t.animationEndAction.call(t.context)},$(this._element).on(this.animationEndEventString,this._animationEndHandler))},t.prototype.updateCalloutFade=function(t,e){var i=this;this._disabled||this._visible!==e.visible&&(this._visible=e.visible,this._visible&&(this._element.style.display=""),$(this._element).on(this.animationEndEventString,this._animationEndHandler),platform.setImmediate(function(){i._visible?(i._element.style.animation=e.inAnimation||n[i._direction],i._element.style.animationDelay=i._delay,platform.setImmediate(function(){i._element.style.transitionDelay=i._delay,i._element.style.opacity="1"})):(i._element.style.animation=e.outAnimation||o[i._direction],i._element.style.animationDelay="0s",i._element.style.transitionDelay="0s",i._element.style.opacity="0",platform.setTimeout(function(){i._element.style.animation="none",i.dispose()},210))}))},t.prototype.dispose=function(){this._animationEndHandler&&$(this._element).off(this.animationEndEventString,this._animationEndHandler)},t}();t.BindingBase=i}(t.CalloutFade||(t.CalloutFade={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(CommonBindings||(CommonBindings={}));var CommonBindings;!function(t){!function(t){!function(t){!function(t){var e=function(){function t(t,e,n){this.padding=0,this._element=t,this.parentDom=e,this._viewElement=n}return t.prototype.adjustLayout=function(){var t=this,e=this._element.scrollWidth>(this.padding>0?this.parentDom.clientWidth-this.padding:this._element.offsetWidth);e!=this.isOverflow.getValue()&&TDB.applyUpdate(function(){t.isOverflow.setValue(e)},TDB.Justification.TextMeasurement)},t.prototype.init=function(t){this.isOverflow=t,this._onResize=StoryApp.Utilities.onResize(this.adjustLayout,this)},t.prototype.updateOverflow=function(t,e){this.padding=e,this.adjustLayout()},t.prototype.dispose=function(){this._onResize.dispose()},t}();t.BindingBase=e}(t.Overflow||(t.Overflow={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(CommonBindings||(CommonBindings={}));var CommonBindings;!function(t){!function(t){!function(t){!function(t){var e=function(){function t(t,e,n){this._element=t,this._updateCalled=!1,this._scrollMargin=0}return t.prototype.init=function(t){this._scrollMargin=t},t.prototype.updateScrollIntoView=function(t,e){if(this._updateCalled)for(var n=$(this._element).offset().top,o=n+$(this._element).outerHeight(!0),i=this._element;void 0!=i.parentNode;){if("auto"==$(i).css("overflow-y")||"scroll"==$(i).css("overflow-y")){if(void 0!==e){var r=e-o;$(i).scrollTop($(i).scrollTop()-r);break}var a=$(i).offset().top,s=a+$(i).height();if(a>n-this._scrollMargin||a>o-this._scrollMargin){l=$(i).scrollTop();l-=a-n+this._scrollMargin,$(i).scrollTop(l)}else if(o+this._scrollMargin>s||n+this._scrollMargin>s){var l=$(i).scrollTop();l+=o-s+this._scrollMargin,$(i).scrollTop(l)}break}i=i.parentNode}else this._updateCalled=!0},t}();t.BindingBase=e}(t.ScrollIntoView||(t.ScrollIntoView={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(CommonBindings||(CommonBindings={}));var CommonBindings;!function(t){!function(t){!function(t){!function(t){var e=function(){function t(t,e,n){this._element=t}return t.prototype.updateSelectText=function(t,e){if(t.watchValue(e))try{StoryApp.Utilities.browser.isChrome?this._element.select():this._element.setSelectionRange(0,this._element.value.length)}catch(t){this._element.select()}},t}();t.BindingBase=e}(t.SelectText||(t.SelectText={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(CommonBindings||(CommonBindings={}));var CommonBindings;!function(t){!function(t){!function(t){!function(t){function e(){return"translateX("+(CommonSettings.SiteUiRtl?"":"-")+"100%)"}var n=function(){function t(t,e,n){this._element=t,this._viewElement=n}return t.prototype.init=function(){var t=this;this._element.style.transition=".367s",this._element.style.transform=e(),this._element.style.display="",this._transitionEndHandler=function(e){e.target==t._element&&(t._visible||(t._element.style.display="none"))},$(this._element).on("transitionend",this._transitionEndHandler)},t.prototype.updateSlidePaneVisible=function(t,n){var o=this;this._visible!==n&&(this._visible=n,this._visible&&(this._element.style.display=""),platform.setTimeout(function(){o._element.style.transform=o._visible?"":e()},0))},t.prototype.dispose=function(){this._transitionEndHandler&&$(this._element).off("transitionend",this._transitionEndHandler)},t}();t.BindingBase=n}(t.SlidePaneVisible||(t.SlidePaneVisible={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(CommonBindings||(CommonBindings={}));var CommonBindings;!function(t){!function(t){!function(t){!function(t){var e=function(){function t(t,e,n){this._element=t,this._viewElement=n}return t.prototype.init=function(t){this._visible=t,t||(this._element.style.display="none")},t.prototype.updateSlideVisible=function(t,e){var n=this;if(this._visible!==e.visible){this._visible=e.visible;var o=void 0!=e.duration?e.duration:200;$(this._element).stop(!0,!0),e.visible?$(this._element).slideDown({duration:o,complete:function(t,o){e.done&&e.done.call(n._viewElement,t,o)}}):$(this._element).slideUp({duration:o,complete:function(t,o){e.done&&e.done.call(n._viewElement,t,o)}})}},t}();t.BindingBase=e}(t.SlideVisible||(t.SlideVisible={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(CommonBindings||(CommonBindings={}));var CommonBindings;!function(t){!function(t){!function(t){!function(t){var e=function(t){function e(e,n,o){var i=t.call(this,void 0)||this;return i._element=e,i._viewElement=o,i}return __extends(e,t),e.prototype.init=function(t){var e=this;this._updateHeight=t,this.addResource(StoryApp.Utilities.onResize(this.setHeight,this)),platform.setImmediate(function(){return e.setHeight(!0)})},e.prototype.setHeight=function(t){var e=$(this._element).height();(t||e!==this._prevHeight)&&(this._prevHeight=e,this._updateHeight.call(this._viewElement,e))},e}(Disposable);t.BindingBase=e}(t.HeightWatcher||(t.HeightWatcher={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(CommonBindings||(CommonBindings={}));var CommonBindings;!function(t){!function(t){!function(t){!function(t){var e=function(){function t(e,n,o){var i=this;i._element=e,i.listening=!1,i.isDragging=!1,i.delayDispose=!1,this.eventTypes=this.getEventNames(),i.touchHandler=function(e){var o={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",touchcancel:void 0,MSPointerDown:"mousedown",MSPointerMove:"mousemove",MSPointerUp:"mouseup",MSPointerCancel:void 0,pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointercancel:void 0,lostpointercapture:void 0},r=i.getCommonTouchObjectFromEvent(e);if(r){var a=o[e.type];"mousedown"===a&&(i.startLocation=new Point,i.startLocation.left=r.screenX,i.startLocation.top=r.screenY,i.grandParentDom=n.parentElement),"mousedown"===a&&(i.isDragging=!0);var s=document.createEvent("MouseEvent");s.initMouseEvent(a,!0,!0,window,1,r.screenX,r.screenY,r.clientX,r.clientY,!1,!1,!1,!1,0,null);var l=(!i.grandParentDom||i.grandParentDom.contains(r.target)?r.target:i.grandParentDom).dispatchEvent(s);if("mouseup"===a||"touchcancel"===e.type||"MSPointerCancel"===e.type||"pointercancel"===e.type||"lostpointercapture"===e.type){if("mouseup"==a){var u=Number.MAX_VALUE;i.startLocation&&(u=Math.sqrt(Math.pow(i.startLocation.left-r.screenX,2)+Math.pow(i.startLocation.top-r.screenY,2))),u<t.minDistanceForClick&&((s=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,window,1,r.screenX,r.screenY,r.clientX,r.clientY,!1,!1,!1,!1,0,null),r.target.dispatchEvent(s)||e.stopPropagation()),i.startLocation=void 0}i.isDragging=!1,i.delayDispose&&(i.delayDispose=!1,i.dispose())}e.preventDefault(),l||e.stopPropagation()}}}return t.prototype.getCommonTouchObjectFromEvent=function(t){if(t.changedTouches)return t.changedTouches[0];var e=t;if(TDB.Touch.isTouchType(e))return{screenX:e.screenX,screenY:e.screenY,clientX:e.clientX,clientY:e.clientY,target:e.target}},t.prototype.updateTouchToMouse=function(t,e){var n=e.enabled;if(n&&!this.listening){for(var o=0,i=this.eventTypes;o<i.length;o++){s=i[o];this._element.addEventListener(s,this.touchHandler,!0)}this.listening=!0}if(!n&&this.listening){for(var r=0,a=this.eventTypes;r<a.length;r++){var s=a[r];this._element.removeEventListener(s,this.touchHandler,!0)}this.listening=!1}},t.prototype.getEventNames=function(){return TDB.Touch.shouldUsePointerEvents()?["pointerdown","pointermove","pointerup","pointercancel","lostpointercapture"]:navigator.msPointerEnabled?["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerCancel"]:["touchstart","touchmove","touchend","touchcancel"]},t.prototype.dispose=function(){this.isDragging?this.delayDispose=!0:(this._element.removeEventListener("touchstart",this.touchHandler,!0),this._element.removeEventListener("touchmove",this.touchHandler,!0),this._element.removeEventListener("touchend",this.touchHandler,!0),this._element.removeEventListener("touchcancel",this.touchHandler,!0))},t.minDistanceForClick=10,t}();t.BindingBase=e}(t.TouchToMouse||(t.TouchToMouse={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(CommonBindings||(CommonBindings={}));var CommonBindings;!function(t){!function(t){!function(t){!function(t){var e=function(t){function e(e,n,o){var i=t.call(this,void 0)||this;return i._element=e,i._viewElement=o,i}return __extends(e,t),e.prototype.init=function(t){var e=this;this._updateWidth=t,this.addResource(StoryApp.Utilities.onResize(this.setWidth,this)),platform.setImmediate(function(){return e.setWidth(!0)})},e.prototype.setWidth=function(t){var e=$(this._element).width();(t||e!==this._prevWidth)&&(this._prevWidth=e,this._updateWidth.call(this._viewElement,e))},e}(Disposable);t.BindingBase=e}(t.WidthWatcher||(t.WidthWatcher={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(CommonBindings||(CommonBindings={}));var CommonBindings;!function(t){!function(t){!function(t){!function(t){function e(t,e){t=StoryApp.Utilities.safeCallback(t);var n=function(e){t.call(n.context,e)};return n.context=e,e=null,n}var n=function(){function t(t,e,n){this._element=t,this._playerReady=!1}return t.prototype.dispose=function(){if(this._player&&(this._player.destroy(),this._player=null,this._events))for(var t in this._events)delete this._events[t].context},t.prototype.updateCreate=function(t,n){if(this.dispose(),n.videoId){var o=n.playerEvents;this._events={};for(var i in o)this._events[i]=e(o[i],n.playerEventsContext);this.initPlayer({videoId:n.videoId,playerVars:n.playerParams,events:this._events},n.resourceFactory,n.playerCallback,n.playerCallbackContext)}},t.prototype.updateResize=function(t,e){this._playerWidth=e.width,this._playerHeight=e.height,this._player&&this._player.setSize(e.width,e.height)},t.prototype.initPlayer=function(t,e,n,o){var i=this;return e.loadResource(21).then(function(e){0===e.state&&i.createPlayer(t,n,o)})},t.prototype.createPlayer=function(t,e,n){void 0!==this._playerWidth&&(t.width=this._playerWidth),void 0!==this._playerHeight&&(t.height=this._playerHeight);var o=document.createElement("div");this._element.appendChild(o),this._player=new YT.Player(o,t),e.call(n,this._player)},t}();t.BindingBase=n}(t.YouTubePlayer||(t.YouTubePlayer={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(CommonBindings||(CommonBindings={}));var CommonBindings;!function(t){!function(t){!function(t){!function(t){var e;!function(t){t[t.Pinch=0]="Pinch",t[t.MouseWheel=1]="MouseWheel",t[t.Keyboard=2]="Keyboard"}(e=t.ZoomEventType||(t.ZoomEventType={}));var n=Modernizr.prefixed("transform"),o=window.requestAnimationFrame||window.msRequestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){platform.setTimeout(t,1e3/60)},i=function(){function t(t,e,n){this._domlistener=Obj.implement(this,{domAttached:this.onDomAttached,domDetached:this.onDomDetached}),this._element=t,this._viewElement=n,this._initialized=!1}return t.prototype.init=function(t){this._initArgs=t},t.prototype.updateZoomable=function(t,e){this._enabled=e,e?this._listeningDomEvents||(this._viewElement.addDomListener(this._domlistener),this._elementInDom=$.contains(document.documentElement,this._element),this._listeningDomEvents=!0):this._listeningDomEvents&&(this._viewElement.removeDomListener(this._domlistener),this._listeningDomEvents=!1),this.resolveActivation()},t.prototype.onDomAttached=function(t){this._elementInDom=!0,this.resolveActivation()},t.prototype.onDomDetached=function(t){this._elementInDom=!1,this.resolveActivation()},t.prototype.resolveActivation=function(){this._enabled&&this._elementInDom?this.activateZooming():this.deactivateZooming()},t.prototype.activateZooming=function(){var e=this;this._activated||(this._activated=!0,this._isManipulating=!1,this._initArgs.mouseWheelZoomDisabled||$(this._element).on("mousewheel DOMMouseScroll",$.proxy(this.onMouseWheel,this)),this._initArgs.keyboardZoomDisabled||this._viewElement.registerShortcut(t.c_keyboardShortcuts.map(function(t){return TDB.ShortcutIdentifier.createShortcutIdentifier(t)}),this,this._initArgs.keyboardShortcutProcessor),this._initArgs.onActivate&&this._initArgs.onActivate.call(this._initArgs.context),this._initArgs.resourceFactory.loadResource(6).then(function(){e._hammerManager=new Hammer.Manager(e._element),e._hammerManager.on("hammer.input",e.onHammerInput.bind(e)),e._initArgs.pinchZoomDisabled||(e._hammerManager.add(new Hammer.Pinch({threshold:0})),e._hammerManager.set({touchAction:"pan-x pan-y"}),e._hammerManager.on("pinchstart",e.onPinchStart.bind(e)),e._hammerManager.on("pinchmove",e.onPinchMove.bind(e)),e._hammerManager.on("pinchend pinchcancel",e.onPinchEnd.bind(e)))}))},t.prototype.deactivateZooming=function(){var e=this;this._activated&&(this._activated=!1,this.deinitialize(),this._isManipulating&&this._initArgs.onManipulationEnd&&this._initArgs.onManipulationEnd.call(this._initArgs.context),this._initArgs.onDeactivate&&this._initArgs.onDeactivate.call(this._initArgs.context),this._initArgs.mouseWheelZoomDisabled||$(this._element).off("mousewheel DOMMouseScroll",this.onMouseWheel),this._initArgs.resourceFactory.loadResource(6).then(function(){e.deactivateHammerPan(),e._hammerManager.off("hammer.input"),e._initArgs.pinchZoomDisabled||e._hammerManager.off("pinchstart pinchmove pinchend pinchcancel"),e._hammerManager.destroy(),e._hammerManager=void 0,e._initArgs.keyboardZoomDisabled||e._viewElement.unregisterShortcut(t.c_keyboardShortcuts.map(function(t){return TDB.ShortcutIdentifier.createShortcutIdentifier(t)}),e,e._initArgs.keyboardShortcutProcessor)}))},t.prototype.activateHammerPan=function(){if(!this._hammerPanActivated){var t=this._hammerManager.add(new Hammer.Pan({threshold:0,pointers:0})),e=this._hammerManager.get("pinch");e&&t.recognizeWith(e),this._hammerManager.on("panstart panmove",this.onPan.bind(this)),this._hammerManager.set({touchAction:"none"}),this._hammerPanActivated=!0}},t.prototype.deactivateHammerPan=function(){this._hammerPanActivated&&(this._hammerManager.off("panstart panmove"),this._hammerManager.remove(this._hammerManager.get("pan")),this._hammerManager.set({touchAction:"pan-x pan-y"}),this._hammerPanActivated=!1)},t.prototype.saveOriginalProperties=function(){this._originalOnDragStart=this._element.ondragstart,this._childrenProperties=[];for(var t=this._element.children.length,e=0;e<t;e++)this._childrenProperties[e]=new r(this._element.children[e])},t.prototype.restoreOriginalProperties=function(){for(var t=this._element.children.length,e=this,o=0;o<t;o++)!function(t){var o=e._element.children[t],i=ArrayExtensions.firstOrDefault(e._childrenProperties,function(t){return t.childElement==o});i&&(e._element.children[t].style[n]=i.originalTransform)}(o);this._element.ondragstart=this._originalOnDragStart},t.prototype.initialize=function(){if(!this._initialized&&this._element.children.length>0){this.saveOriginalProperties(),this._element.ondragstart=function(){return!1},$(this._element).addClass(t.c_domInsertAnimationClass),$(this._element).on("animationstart msAnimationStart webkitAnimationStart",$.proxy(this.onChildAdded,this));var e=this._element.getBoundingClientRect();this._childrenBoundingRectAbsolute=this.calculateElementsBoundingRect(this._childrenProperties.map(function(t){return t.childElement})),this._childrenBoundingRect=new Rect(this._childrenBoundingRectAbsolute.left-e.left,this._childrenBoundingRectAbsolute.top-e.top,this._childrenBoundingRectAbsolute.width,this._childrenBoundingRectAbsolute.height),this._containerRect=new Rect(0,0,e.width,e.height),this._containerRectAbsolute=new Rect(e.left,e.top,e.width,e.height),this._scaleTransformFillX=this._containerRect.width/this._childrenBoundingRect.width,this._scaleTransformFillY=this._containerRect.height/this._childrenBoundingRect.height,this._maxZoomScale=t.c_maxGreaterThanContainerSize*Math.max(this._scaleTransformFillX,this._scaleTransformFillY);for(var n=0;n<this._childrenProperties.length;n++)this.calculateChildPosition(this._childrenProperties[n]);this._currentZoomTransform=new a(0,0,1),this._previousEventTransform=new a(0,0,1),this._updateRequested=!1,this._enteredZoom=!1,this._initialized=!0}},t.prototype.deinitialize=function(){this._initialized&&(this.restoreOriginalProperties(),$(this._element).removeClass(t.c_domInsertAnimationClass),$(this._element).off("animationstart msAnimationStart webkitAnimationStart",this.onChildAdded),this._childrenProperties=[],this._previousEventTransform=null,this._currentZoomTransform=null,this._childrenBoundingRect=null,this._childrenBoundingRectAbsolute=null,this._containerRect=null,this._containerRectAbsolute=null,this._enteredZoom=!1,this._initialized=!1)},t.prototype.handleShortcutKey=function(n){var o=this._element.getBoundingClientRect(),i=n.keyCode==KeyCodeType.AddKey||n.keyCode==KeyCodeType.EqualKey||n.keyCode==KeyCodeType.EqualFFKey,r=n.keyCode==KeyCodeType.SubtractKey||n.keyCode==KeyCodeType.MinusKey||n.keyCode==KeyCodeType.MinusFFKey;if(i||r){this.zoomEventStart();var a=i?t.c_keyboardZoomScaleFactor:1/t.c_keyboardZoomScaleFactor;this.zoomEventProcess(a,o.left+o.width/2,o.top+o.height/2,e.Keyboard),this.zoomEventEnd()}else{var s=o.width*t.c_keyboardPanScreenFractionDelta,l=o.height*t.c_keyboardPanScreenFractionDelta;n.keyCode==KeyCodeType.RightArrowKey?s=-s:n.keyCode!=KeyCodeType.LeftArrowKey&&(s=0),n.keyCode==KeyCodeType.DownArrowKey?l=-l:n.keyCode!=KeyCodeType.UpArrowKey&&(l=0),this.pan(s,l)}return TDB.EventPropagation.PreventDefault},t.prototype.onMouseWheel=function(n){if(!n.ctrlKey)return!0;this.zoomEventStart();var o=n.originalEvent.wheelDelta||-30*n.originalEvent.detail,i=1+Math.abs(o/t.c_mouseWheelZoomScaleFactor);return o<0&&(i=1/i),this.zoomEventProcess(i,n.originalEvent.clientX,n.originalEvent.clientY,e.MouseWheel),this.zoomEventEnd(),!1},t.prototype.onPinchStart=function(){var t=this;StoryApp.RethrowLogger.logIfError(function(){t.zoomEventStart()})},t.prototype.onPinchMove=function(t){var n=this;StoryApp.RethrowLogger.logIfError(function(){n.zoomEventProcess(t.scale,t.center.x,t.center.y,e.Pinch)})},t.prototype.onPinchEnd=function(){var t=this;StoryApp.RethrowLogger.logIfError(function(){t.zoomEventEnd()})},t.prototype.zoomEventStart=function(){this.initialize(),this._initialized&&(this._previousEventTransform.scale=1)},t.prototype.zoomEventProcess=function(e,n,o,i){if(this._initialized){var r=this.applyTransform(this._childrenBoundingRectAbsolute,this._currentZoomTransform),a=e/this._previousEventTransform.scale;this._previousEventTransform.scale=e,a=Math.max(a,1/this._currentZoomTransform.scale),a=Math.min(a,this._maxZoomScale/this._currentZoomTransform.scale),this._currentZoomTransform.scale*=a,this._currentZoomTransform.scale<1+t.c_scaleThreshold&&(this._currentZoomTransform.scale=1),this._currentZoomTransform.scale>this._maxZoomScale-t.c_scaleThreshold&&(this._currentZoomTransform.scale=this._maxZoomScale),this.tryZoomEnter(i),1!==a&&this._initArgs.onZoomChange&&this._initArgs.onZoomChange.call(this._initArgs.context,i,this._currentZoomTransform.scale);var s=void 0,l=void 0;this._currentZoomTransform.scale<=this._scaleTransformFillX?this._currentZoomTransform.translateX=0:(s=((s=n-this.calculateOffsetSinceInitialization().left)-r.left)/r.width,this._currentZoomTransform.translateX+=(.5-s)*r.width*(a-1)),this._currentZoomTransform.scale<=this._scaleTransformFillY?this._currentZoomTransform.translateY=0:(l=((l=o-this.calculateOffsetSinceInitialization().top)-r.top)/r.height,this._currentZoomTransform.translateY+=(.5-l)*r.height*(a-1)),this.fillContainer(),this.requestElementUpdate()}},t.prototype.zoomEventEnd=function(){this._initialized&&this.tryZoomExit()},t.prototype.onHammerInput=function(t){var e=this;StoryApp.RethrowLogger.logIfError(function(){t.isFirst?(e._isManipulating=!0,e._initArgs.onManipulationStart&&platform.setImmediate(function(){return e._initArgs.onManipulationStart.call(e._initArgs.context)})):t.isFinal&&(e._isManipulating=!1,e._initArgs.onManipulationEnd&&platform.setImmediate(function(){return e._initArgs.onManipulationEnd.call(e._initArgs.context)}),e.tryZoomExit()),(e._enteredZoom||t.pointers.length>1)&&t.preventDefault()})},t.prototype.tryZoomEnter=function(t){var e=this;this._enteredZoom||(this._enteredZoom=!0,this._initArgs.resourceFactory.loadResource(6).then(function(){e.activateHammerPan(),e._initArgs.onZoomEnter&&platform.setImmediate(function(){return e._initArgs.onZoomEnter.call(e._initArgs.context,t)})}))},t.prototype.tryZoomExit=function(){var t=this;this._enteredZoom&&1===this._currentZoomTransform.scale&&!this._isManipulating&&(this._enteredZoom=!1,this._initArgs.resourceFactory.loadResource(6).then(function(){t.deactivateHammerPan(),t._initArgs.onZoomExit&&platform.setImmediate(function(){return t._initArgs.onZoomExit.call(t._initArgs.context)})}))},t.prototype.onPan=function(t){if("panstart"==t.type&&(this._previousEventTransform.translateX=0,this._previousEventTransform.translateY=0),t.pointers.length==this._lastPanEventTouchCount){var e=t.deltaX-this._previousEventTransform.translateX,n=t.deltaY-this._previousEventTransform.translateY;this.pan(e,n)}this._previousEventTransform.translateX=t.deltaX,this._previousEventTransform.translateY=t.deltaY,this._lastPanEventTouchCount=t.pointers.length},t.prototype.pan=function(t,e){this._initialized&&(this._scaleTransformFillX<this._currentZoomTransform.scale?this._currentZoomTransform.translateX+=t:this._currentZoomTransform.translateX=0,this._scaleTransformFillY<this._currentZoomTransform.scale?this._currentZoomTransform.translateY+=e:this._currentZoomTransform.translateY=0,this.fillContainer(),this.requestElementUpdate())},t.prototype.onChildAdded=function(e){if(e.originalEvent.animationName==t.c_domInsertAnimationName){var n=e.srcElement||e.target;this._childrenProperties.some(function(t){return t.childElement==n})||this.updateTransform()}},t.prototype.requestElementUpdate=function(){var t=this;this._updateRequested||(this._updateRequested=!0,o(function(){t.updateTransform(),t._updateRequested=!1}))},t.prototype.fillContainer=function(){var t=this.applyTransform(this._childrenBoundingRect,this._currentZoomTransform),e=t.left-this._containerRect.left,n=this._containerRect.right-t.right,o=t.top-this._containerRect.top,i=this._containerRect.bottom-t.bottom;e<0&&n>0?this._currentZoomTransform.translateX+=Math.min(-e,n):e>0&&n<0&&(this._currentZoomTransform.translateX-=Math.min(e,-n)),o<0&&i>0?this._currentZoomTransform.translateY+=Math.min(-o,i):o>0&&i<0&&(this._currentZoomTransform.translateY-=Math.min(o,-i))},t.prototype.calculateElementsBoundingRect=function(t){var e=t.map(function(t){var e=t.getBoundingClientRect();return new Rect(e.left,e.top,e.width,e.height)});return(new Rect).boundingRect(e)},t.prototype.calculateChildPosition=function(t){var e=this.calculateOffsetSinceInitialization(),n=t.childElement.getBoundingClientRect();t.positionInBoundingRect=new Rect(n.left-e.left-this._childrenBoundingRectAbsolute.left,n.top-e.top-this._childrenBoundingRectAbsolute.top,n.width,n.height)},t.prototype.calculateChildZoomTransform=function(t,e,n){var o=t.translateX,i=t.translateY,r=n.left*t.scale,s=n.top*t.scale;return o+=r-n.left-e.width*(t.scale-1)/2,i+=s-n.top-e.height*(t.scale-1)/2,o+=n.width*(t.scale-1)/2,i+=n.height*(t.scale-1)/2,new a(o,i,t.scale)},t.prototype.calculateOffsetSinceInitialization=function(){var t=this._element.getBoundingClientRect();return new Point(t.left-this._containerRectAbsolute.left,t.top-this._containerRectAbsolute.top)},t.prototype.applyTransform=function(t,e){var n=new Rect(t.left+e.translateX,t.top+e.translateY,t.width,t.height);return n.left-=n.width*(e.scale-1)/2,n.top-=n.height*(e.scale-1)/2,n.width*=e.scale,n.height*=e.scale,n},t.prototype.updateTransform=function(){if(this._initialized)for(var t=this._element.children.length,e=this,o=0;o<t;o++)!function(t){var o=e._element.children[t],i=ArrayExtensions.firstOrDefault(e._childrenProperties,function(t){return t.childElement==o});i||(i=new r(o),e._childrenProperties.push(i),e.calculateChildPosition(i));var a=i.originalTransform,s=e.calculateChildZoomTransform(e._currentZoomTransform,e._childrenBoundingRect,i.positionInBoundingRect),l="translate3d("+(s.translateX/i.originalScale).toFixed(3)+"px, "+(s.translateY/i.originalScale).toFixed(3)+"px, 0px) scale("+s.scale.toFixed(3)+")";o.style[n]=a?a+" "+l:l}(o)},t.prototype.dispose=function(){this.deactivateZooming(),this._listeningDomEvents&&this._viewElement.removeDomListener(this._domlistener),this._initArgs=null},t.c_domInsertAnimationClass="ZoomableBindingDomInsert",t.c_domInsertAnimationName="zoomableBindingDomInsert",t.c_maxGreaterThanContainerSize=3,t.c_keyboardShortcuts=["Ctrl+AddKey","Ctrl+SubtractKey","Ctrl+EqualKey","Ctrl+EqualFFKey","Ctrl+MinusKey","Ctrl+MinusFFKey","Ctrl+UpArrowKey","Ctrl+DownArrowKey","Ctrl+LeftArrowKey","Ctrl+RightArrowKey"],t.c_keyboardPanScreenFractionDelta=.05,t.c_keyboardZoomScaleFactor=1.1,t.c_mouseWheelZoomScaleFactor=1e3,t.c_scaleThreshold=1e-6,t}();t.BindingBase=i;var r=function(){function t(t){this.childElement=t,this.originalTransform=t.style[n],this.originalScale=t.getBoundingClientRect().width/t.offsetWidth}return t}(),a=function(){function t(t,e,n){this.translateX=t,this.translateY=e,this.scale=n}return t}()}(t.Zoomable||(t.Zoomable={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(CommonBindings||(CommonBindings={}));var CommonBindings;!function(t){!function(t){!function(t){!function(t){var e=function(t){function e(e,n,o,i,r){var a=t.call(this,e,n,o)||this;a._ve=o,a._classNameArgs=r;var s=a._classNameWatcher=TDB.watcherTag(4800663,a,i,a._resolveClassName);return i._subscribeToWatchable(s,TDB.UpdatePhase.WriteOnly),a._classNameWatcher.resolve(),a}return __extends(e,t),e.prototype.update=function(t){var e=this;t==TDB.UpdatePhase.WriteOnly&&e._classNameWatcher.resolve()},e.prototype._resolveClassName=function(t){var e=this,n=e._classNameArgs.call(e._ve,t);e.updateClassName(t,n)},e}(t.BindingBase);t.Binding=e}(t.ClassName||(t.ClassName={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(CommonBindings||(CommonBindings={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(e,n,o,i,r,a){var s=t.call(this,e,n,o)||this;s._ve=o,s.init(r),s._fadeVisibleArgs=a;var l=s._fadeVisibleWatcher=TDB.watcherTag(4800663,s,i,s._resolveFadeVisible);return i._subscribeToWatchable(l,TDB.UpdatePhase.WriteOnly),s._fadeVisibleWatcher.resolve(),s}return __extends(e,t),e.prototype.update=function(t){var e=this;t==TDB.UpdatePhase.WriteOnly&&e._fadeVisibleWatcher.resolve()},e.prototype._resolveFadeVisible=function(t){var e=this,n=e._fadeVisibleArgs.call(e._ve,t);e.updateFadeVisible(t,n)},e}(t.BindingBase);t.Binding=e}(t.FadeVisible||(t.FadeVisible={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(CommonBindings||(CommonBindings={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(e,n,o,i,r,a){var s=t.call(this,e,n,o)||this;s._ve=o,s.init(r),s._scrollIntoViewArgs=a;var l=s._scrollIntoViewWatcher=TDB.watcherTag(4800663,s,i,s._resolveScrollIntoView);return i._subscribeToWatchable(l,TDB.UpdatePhase.ReadWrite),s}return __extends(e,t),e.prototype.update=function(t){var e=this;t==TDB.UpdatePhase.ReadWrite&&e._scrollIntoViewWatcher.resolve()},e.prototype._resolveScrollIntoView=function(t){var e=this,n=e._scrollIntoViewArgs.call(e._ve,t);e.updateScrollIntoView(t,n)},e}(t.BindingBase);t.Binding=e}(t.ScrollIntoView||(t.ScrollIntoView={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(CommonBindings||(CommonBindings={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(e,n,o,i,r){var a=t.call(this,e,n,o)||this;a._ve=o,a.init(),a._slidePaneVisibleArgs=r;var s=a._slidePaneVisibleWatcher=TDB.watcherTag(4800663,a,i,a._resolveSlidePaneVisible);return i._subscribeToWatchable(s,TDB.UpdatePhase.ReadWrite),a}return __extends(e,t),e.prototype.update=function(t){var e=this;t==TDB.UpdatePhase.ReadWrite&&e._slidePaneVisibleWatcher.resolve()},e.prototype._resolveSlidePaneVisible=function(t){var e=this,n=e._slidePaneVisibleArgs.call(e._ve,t);e.updateSlidePaneVisible(t,n)},e}(t.BindingBase);t.Binding=e}(t.SlidePaneVisible||(t.SlidePaneVisible={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(CommonBindings||(CommonBindings={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(e,n,o,i,r,a){var s=t.call(this,e,n,o)||this;s._ve=o,s.init(r),s._slideVisibleArgs=a;var l=s._slideVisibleWatcher=TDB.watcherTag(4800663,s,i,s._resolveSlideVisible);return i._subscribeToWatchable(l,TDB.UpdatePhase.ReadWrite),s}return __extends(e,t),e.prototype.update=function(t){var e=this;t==TDB.UpdatePhase.ReadWrite&&e._slideVisibleWatcher.resolve()},e.prototype._resolveSlideVisible=function(t){var e=this,n=e._slideVisibleArgs.call(e._ve,t);e.updateSlideVisible(t,n)},e}(t.BindingBase);t.Binding=e}(t.SlideVisible||(t.SlideVisible={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(CommonBindings||(CommonBindings={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(e,n,o,i,r){var a=t.call(this,e,n,o)||this;a._ve=o,a._selectTextArgs=r;var s=a._selectTextWatcher=TDB.watcherTag(4800663,a,i,a._resolveSelectText);return i._subscribeToWatchable(s,TDB.UpdatePhase.ReadWrite),a}return __extends(e,t),e.prototype.update=function(t){var e=this;t==TDB.UpdatePhase.ReadWrite&&e._selectTextWatcher.resolve()},e.prototype._resolveSelectText=function(t){var e=this,n=e._selectTextArgs.call(e._ve,t);e.updateSelectText(t,n)},e}(t.BindingBase);t.Binding=e}(t.SelectText||(t.SelectText={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(CommonBindings||(CommonBindings={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(e,n,o,i,r){var a=t.call(this,e,n,o)||this;return a._ve=o,a.init(r),a}return __extends(e,t),e.prototype.update=function(t){},e}(t.BindingBase);t.Binding=e}(t.WidthWatcher||(t.WidthWatcher={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(CommonBindings||(CommonBindings={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(e,n,o,i,r){var a=t.call(this,e,n,o)||this;return a._ve=o,a.init(r),a}return __extends(e,t),e.prototype.update=function(t){},e}(t.BindingBase);t.Binding=e}(t.HeightWatcher||(t.HeightWatcher={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(CommonBindings||(CommonBindings={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(e,n,o,i,r){var a=t.call(this,e,n,o)||this;a._ve=o,a._copyHtmlArgs=r;var s=a._copyHtmlWatcher=TDB.watcherTag(4800663,a,i,a._resolveCopyHtml);return i._subscribeToWatchable(s,TDB.UpdatePhase.ReadWrite),a}return __extends(e,t),e.prototype.update=function(t){var e=this;t==TDB.UpdatePhase.ReadWrite&&e._copyHtmlWatcher.resolve()},e.prototype._resolveCopyHtml=function(t){var e=this,n=e._copyHtmlArgs.call(e._ve,t);e.updateCopyHtml(t,n)},e}(t.BindingBase);t.Binding=e}(t.CopyHtml||(t.CopyHtml={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(CommonBindings||(CommonBindings={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(e,n,o,i,r,a){var s=t.call(this,e,n,o)||this;s._ve=o,s._createArgs=r;l=s._createWatcher=TDB.watcherTag(4800663,s,i,s._resolveCreate);i._subscribeToWatchable(l,TDB.UpdatePhase.WriteOnly),s._resizeArgs=a;var l=s._resizeWatcher=TDB.watcherTag(4800663,s,i,s._resolveResize);return i._subscribeToWatchable(l,TDB.UpdatePhase.WriteOnly),s._createWatcher.resolve(),s._resizeWatcher.resolve(),s}return __extends(e,t),e.prototype.update=function(t){var e=this;t==TDB.UpdatePhase.WriteOnly&&(e._createWatcher.resolve(),e._resizeWatcher.resolve())},e.prototype._resolveCreate=function(t){var e=this,n=e._createArgs.call(e._ve,t);e.updateCreate(t,n)},e.prototype._resolveResize=function(t){var e=this,n=e._resizeArgs.call(e._ve,t);e.updateResize(t,n)},e}(t.BindingBase);t.Binding=e}(t.YouTubePlayer||(t.YouTubePlayer={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(CommonBindings||(CommonBindings={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(e,n,o,i,r){var a=t.call(this,e,n,o)||this;a._ve=o,a._chunksArgs=r;var s=a._chunksWatcher=TDB.watcherTag(4800663,a,i,a._resolveChunks);return i._subscribeToWatchable(s,TDB.UpdatePhase.ReadWrite),a}return __extends(e,t),e.prototype.update=function(t){var e=this;t==TDB.UpdatePhase.ReadWrite&&e._chunksWatcher.resolve()},e.prototype._resolveChunks=function(t){var e=this,n=e._chunksArgs.call(e._ve,t);e.updateChunks(t,n)},e}(t.BindingBase);t.Binding=e}(t.DynamicMenu||(t.DynamicMenu={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(CommonBindings||(CommonBindings={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(e,n,o,i,r,a){var s=t.call(this,e,n,o)||this;s._ve=o,s.init(r),s._calloutFadeArgs=a;var l=s._calloutFadeWatcher=TDB.watcherTag(4800663,s,i,s._resolveCalloutFade);return i._subscribeToWatchable(l,TDB.UpdatePhase.WriteOnly),s._calloutFadeWatcher.resolve(),s}return __extends(e,t),e.prototype.update=function(t){var e=this;t==TDB.UpdatePhase.WriteOnly&&e._calloutFadeWatcher.resolve()},e.prototype._resolveCalloutFade=function(t){var e=this,n=e._calloutFadeArgs.call(e._ve,t);e.updateCalloutFade(t,n)},e}(t.BindingBase);t.Binding=e}(t.CalloutFade||(t.CalloutFade={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(CommonBindings||(CommonBindings={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(e,n,o,i,r,a){var s=t.call(this,e,n,o)||this;s._ve=o,s.init(r),s._zoomableArgs=a;var l=s._zoomableWatcher=TDB.watcherTag(4800663,s,i,s._resolveZoomable);return i._subscribeToWatchable(l,TDB.UpdatePhase.ReadWrite),s}return __extends(e,t),e.prototype.update=function(t){var e=this;t==TDB.UpdatePhase.ReadWrite&&e._zoomableWatcher.resolve()},e.prototype._resolveZoomable=function(t){var e=this,n=e._zoomableArgs.call(e._ve,t);e.updateZoomable(t,n)},e}(t.BindingBase);t.Binding=e}(t.Zoomable||(t.Zoomable={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(CommonBindings||(CommonBindings={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(e,n,o,i,r){var a=t.call(this,e,n,o)||this;a._ve=o,a._touchToMouseArgs=r;var s=a._touchToMouseWatcher=TDB.watcherTag(4800663,a,i,a._resolveTouchToMouse);return i._subscribeToWatchable(s,TDB.UpdatePhase.ReadWrite),a}return __extends(e,t),e.prototype.update=function(t){var e=this;t==TDB.UpdatePhase.ReadWrite&&e._touchToMouseWatcher.resolve()},e.prototype._resolveTouchToMouse=function(t){var e=this,n=e._touchToMouseArgs.call(e._ve,t);e.updateTouchToMouse(t,n)},e}(t.BindingBase);t.Binding=e}(t.TouchToMouse||(t.TouchToMouse={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(CommonBindings||(CommonBindings={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(e,n,o,i,r,a){var s=t.call(this,e,n,o)||this;s._ve=o,s.init(r),s._overflowArgs=a;var l=s._overflowWatcher=TDB.watcherTag(4800663,s,i,s._resolveOverflow);return i._subscribeToWatchable(l,TDB.UpdatePhase.ReadWrite),s}return __extends(e,t),e.prototype.update=function(t){var e=this;t==TDB.UpdatePhase.ReadWrite&&e._overflowWatcher.resolve()},e.prototype._resolveOverflow=function(t){var e=this,n=e._overflowArgs.call(e._ve,t);e.updateOverflow(t,n)},e}(t.BindingBase);t.Binding=e}(t.Overflow||(t.Overflow={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(CommonBindings||(CommonBindings={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(e,n,o,i,r){var a=t.call(this,e,n,o)||this;return a._ve=o,a.init(r),a}return __extends(e,t),e.prototype.update=function(t){},e}(t.BindingBase);t.Binding=e}(t.Message||(t.Message={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(CommonBindings||(CommonBindings={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(e,n,o,i,r){var a=t.call(this,e,n,o)||this;return a._ve=o,a.init(r),a}return __extends(e,t),e.prototype.update=function(t){},e}(t.BindingBase);t.Binding=e}(t.InViewportWatcher||(t.InViewportWatcher={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(CommonBindings||(CommonBindings={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(){function t(){}return t.prototype.getHomeText=function(){return Resources.ProductNameShort},t.prototype.getAdditionalBrandCssClasses=function(){return""},t.prototype.getAlternateHomeButtonHref=function(){return null},t.prototype.getStringCardDeckTitlePlaceholder=function(){return Resources.CardDeckStoryTitlePlaceholder},t.prototype.getStringFirstRunAddTitleHeader=function(){return Resources.FirstRunAddSwayTitleV2},t.prototype.getStringFirstRunAddTitleHeaderNonEmpty=function(){return Resources.FirstRunAddSwayTitleHeaderNew},t.prototype.getStringBasicContentPageSearchIntro=function(){return""},t.prototype.getStringStylePaneSelectionDescription=function(){return Resources.StylePaneSelectionDescription},t.prototype.getStringFirstRunPreviewHeaderHeader=function(){return Resources.FirstRunPreviewHeaderV2},t.prototype.getStringFirstRunPlayButtonHeader=function(){return Resources.FirstRunPlayButtonV2},t.prototype.getStringPublishButtonFRE=function(){return null},t.prototype.getStringPublishButtonFREReader=function(){},t.prototype.getCanRemixWorld=function(){return!0},t.prototype.getAuthorsButtonVisible=function(){return!0},t.prototype.getNavigationButtonVisible=function(){return!0},t.prototype.getPoweredByButtonVisible=function(){return!1},t.prototype.getShareButtonVisible=function(){return!0},t.prototype.getSwayManagementVisible=function(){return!0},t.prototype.getTutorialButtonVisible=function(){return!0},t.prototype.getPublishButtonFREVisible=function(){return!1},t.prototype.getEmbeddedSwayOverflowMenuVisible=function(){return!0},t}();t.SwayDefaultBrandingProvider=e}(t.Branding||(t.Branding={}))}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getHomeText=function(){return Resources.CastName},e.prototype.getAdditionalBrandCssClasses=function(){return t.prototype.getAdditionalBrandCssClasses.call(this)+" brandDocs"},e.prototype.getAlternateHomeButtonHref=function(){return CommonSettings.CastUrl?CommonSettings.CastUrl:t.prototype.getAlternateHomeButtonHref.call(this)},e.prototype.getStringCardDeckTitlePlaceholder=function(){return Resources.DocsJournalCardDeckTitlePlaceholder},e.prototype.getStringFirstRunAddTitleHeader=function(){return Resources.DocsJournalFirstRunAddTitleHeaderNew},e.prototype.getStringFirstRunAddTitleHeaderNonEmpty=function(){return Resources.DocsJournalFirstRunAddTitleHeaderNew},e.prototype.getStringBasicContentPageSearchIntro=function(){return Resources.DocsJournalBasicContentPageSearchIntro},e.prototype.getStringStylePaneSelectionDescription=function(){return Resources.DocsJournalStylePaneSelectionDescription},e.prototype.getStringFirstRunPreviewHeaderHeader=function(){return Resources.DocsJournalFirstRunPreviewHeaderHeaderNew},e.prototype.getStringFirstRunPlayButtonHeader=function(){return Resources.DocsJournalFirstRunPlayButtonHeader},e.prototype.getStringPublishButtonFRE=function(){return Resources.FirstRunJournalPublishButtonHeader},e.prototype.getStringPublishButtonFREReader=function(){return Resources.FirstRunPublishButtonReader},e.prototype.getCanRemixWorld=function(){return!1},e.prototype.getAuthorsButtonVisible=function(){return!1},e.prototype.getNavigationButtonVisible=function(){return!1},e.prototype.getPoweredByButtonVisible=function(){return!0},e.prototype.getShareButtonVisible=function(){return!1},e.prototype.getSwayManagementVisible=function(){return!1},e.prototype.getTutorialButtonVisible=function(){return!1},e.prototype.getPublishButtonFREVisible=function(){return!!CommonSettings.FREPublishButtonEnabled},e.prototype.getEmbeddedSwayOverflowMenuVisible=function(){return!1},e}(t.SwayDefaultBrandingProvider);t.DocsJournalBrandingProvider=e}(t.Branding||(t.Branding={}))}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getHomeText=function(){return Resources.CastName},e.prototype.getAdditionalBrandCssClasses=function(){return t.prototype.getAdditionalBrandCssClasses.call(this)+" brandDocs"},e.prototype.getAlternateHomeButtonHref=function(){return CommonSettings.CastUrl?CommonSettings.CastUrl:t.prototype.getAlternateHomeButtonHref.call(this)},e.prototype.getStringCardDeckTitlePlaceholder=function(){return Resources.DocsJournalCardDeckTitlePlaceholder},e.prototype.getStringFirstRunAddTitleHeader=function(){return Resources.DocsAboutFirstRunAddTitleHeaderNew},e.prototype.getStringFirstRunAddTitleHeaderNonEmpty=function(){return Resources.DocsAboutFirstRunAddTitleHeaderNew},e.prototype.getStringBasicContentPageSearchIntro=function(){return Resources.DocsAboutBasicContentPageSearchIntro},e.prototype.getStringStylePaneSelectionDescription=function(){return Resources.DocsAboutStylePaneSelectionDescription},e.prototype.getStringFirstRunPreviewHeaderHeader=function(){return Resources.DocsAboutFirstRunPreviewHeaderHeaderNew},e.prototype.getStringFirstRunPlayButtonHeader=function(){return Resources.DocsJournalFirstRunPlayButtonHeader},e.prototype.getStringPublishButtonFRE=function(){return Resources.FirstRunAboutPublishButtonHeader},e.prototype.getStringPublishButtonFREReader=function(){return Resources.FirstRunPublishButtonReader},e.prototype.getAuthorsButtonVisible=function(){return!1},e.prototype.getPoweredByButtonVisible=function(){return!0},e.prototype.getShareButtonVisible=function(){return!1},e.prototype.getSwayManagementVisible=function(){return!1},e.prototype.getTutorialButtonVisible=function(){return!1},e.prototype.getPublishButtonFREVisible=function(){return!!CommonSettings.FREPublishButtonEnabled},e.prototype.getEmbeddedSwayOverflowMenuVisible=function(){return!1},e}(t.SwayDefaultBrandingProvider);t.DocsAboutBrandingProvider=e}(t.Branding||(t.Branding={}))}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){function e(){return null!==T&&A==CommonSettings.Branding||(T=CommonSettings.Branding===StoryBrandingMode.DocsJournal?new t.DocsJournalBrandingProvider:CommonSettings.Branding===StoryBrandingMode.DocsAbout?new t.DocsAboutBrandingProvider:new t.SwayDefaultBrandingProvider,A=CommonSettings.Branding),T}function n(){return e().getCanRemixWorld()}function o(){return e().getHomeText()}function i(){return e().getAdditionalBrandCssClasses()}function r(){return e().getAlternateHomeButtonHref()}function a(){return e().getStringCardDeckTitlePlaceholder()}function s(){return e().getStringFirstRunAddTitleHeader()}function l(){return e().getStringFirstRunAddTitleHeaderNonEmpty()}function u(){return e().getStringBasicContentPageSearchIntro()}function c(){return e().getStringStylePaneSelectionDescription()}function d(){return e().getStringFirstRunPreviewHeaderHeader()}function p(){return e().getStringFirstRunPlayButtonHeader()}function g(){return e().getStringPublishButtonFRE()}function h(){return e().getStringPublishButtonFREReader()}function m(){return e().getAuthorsButtonVisible()}function y(){return e().getNavigationButtonVisible()}function f(){return e().getPoweredByButtonVisible()}function S(){return e().getShareButtonVisible()}function C(){return e().getSwayManagementVisible()}function v(){return e().getTutorialButtonVisible()}function _(){return e().getPublishButtonFREVisible()}function w(){return e().getEmbeddedSwayOverflowMenuVisible()}var T=null,A=null;t.canRemixWorld=n,t.getHomeText=o,t.getAdditionalBrandCssClasses=i,t.getAlternateHomeButtonHref=r,t.getStringCardDeckTitlePlaceholder=a,t.getStringFirstRunAddTitleHeader=s,t.getStringFirstRunAddTitleHeaderNonEmpty=l,t.getStringBasicContentPageSearchIntro=u,t.getStringStylePaneSelectionDescription=c,t.getStringFirstRunPreviewHeaderHeader=d,t.getStringFirstRunPlayButtonHeader=p,t.getStringPublishButtonFRE=g,t.getStringPublishButtonFREReader=h,t.authorsButtonVisible=m,t.navigationButtonVisible=y,t.poweredByButtonVisible=f,t.shareButtonVisible=S,t.swayManagementVisible=C,t.tutorialButtonVisible=v,t.publishButtonFREVisible=_,t.embedSwayOverflowMenuVisible=w}(t.Branding||(t.Branding={}))}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(){function t(){}return t.prototype.isCreationAllowed=function(t){return!!CommonSettings.AuthoringFromLandingPageContextEnabled||!t},t}();t.CreationPolicy=e}(t.Common||(t.Common={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var Delete;!function(t){var e=function(){function e(){}return e.prototype.moveStoryToRecycleBinRequest=function(t,e,n){ActionLogger.RecordClientAction(new ClientAction.DeleteStoryActionData);var o=StoryApp.Common.UrlHelper.getInstance().deleteStoryUrl(t);$.ajax(o,{name:"DeleteStory",description:"Delete a given remix",type:"POST",contentType:StoryApp.RequestManager.JsonContentType,dataType:"json",headers:{clientCorrelation:CommonSettings.CorrelationId}}).then(function(t,n,o){e($.parseJSON(o.responseText),o.getResponseHeader(StoryApp.Common.CommonRequestHeaders.CorrelationIdHeader))},n)},e.prototype.moveStoriesToRecycleBinRequest=function(e,n,o){ActionLogger.RecordClientAction(new ClientAction.DeleteStoriesActionData("The user moved some stories to recycle bin")),$.ajax(StoryApp.Common.UrlHelper.getInstance().deleteStoriesUrl(),{name:"DeleteStories",description:"Delete stories whose ids are in the request body",type:"POST",contentType:StoryApp.RequestManager.JsonContentType,dataType:"json",data:JSON.stringify(t.DeleteSwaysRequest.MoveToRecycleBinRequest(e))}).then(function(t,e,o){n($.parseJSON(o.responseText),o.getResponseHeader(StoryApp.Common.CommonRequestHeaders.CorrelationIdHeader))},o)},e.prototype.restoreStoriesFromRecycleBinRequest=function(e,n,o){ActionLogger.RecordClientAction(new ClientAction.RestoreStoriesActionData("The user restored some stories from recycle bin")),$.ajax(StoryApp.Common.UrlHelper.getInstance().restoreStoriesUrl(),{name:"RestoreStories",description:"Restore stories whose ids are in the request body",type:"POST",contentType:StoryApp.RequestManager.JsonContentType,dataType:"json",data:JSON.stringify(t.RestoreSwaysRequest.RestoreFromRecycleBinRequest(e))}).then(function(t,e,o){n($.parseJSON(o.responseText),o.getResponseHeader(StoryApp.Common.CommonRequestHeaders.CorrelationIdHeader))},o)},e.prototype.deleteStoriesFromRecycleBinRequest=function(e,n,o){ActionLogger.RecordClientAction(new ClientAction.DeleteStoriesActionData("The user deleted some stories from recycle bin")),$.ajax(StoryApp.Common.UrlHelper.getInstance().deleteStoriesUrl(),{name:"DeleteStories",description:"Delete stories whose ids are in the request body",type:"POST",contentType:StoryApp.RequestManager.JsonContentType,dataType:"json",data:JSON.stringify(t.DeleteSwaysRequest.DeleteFromRecycleBinRequest(e))}).then(function(t,e,o){n($.parseJSON(o.responseText),o.getResponseHeader(StoryApp.Common.CommonRequestHeaders.CorrelationIdHeader))},o)},e.prototype.getRecycleBinSwaysRequest=function(t,e){ActionLogger.RecordClientAction(new ClientAction.GetRecycleBinSwaysActionData("The user requested all stories from recycle bin")),$.ajax(StoryApp.Common.UrlHelper.getInstance().getRecycleBinSwaysUrl(),{name:"GetRecycleBinSways",description:"Return recycle bin sways",type:"GET",contentType:StoryApp.RequestManager.JsonContentType,dataType:"json"}).then(function(e,n,o){t($.parseJSON(o.responseText),o.getResponseHeader(StoryApp.Common.CommonRequestHeaders.CorrelationIdHeader))},e)},e.prototype.obliterateStoryRequest=function(t,e,n){ActionLogger.RecordClientAction(new ClientAction.ActionData(ClientAction.ActionType.ObliterateStory));var o=StoryApp.Common.UrlHelper.getInstance().obliterateStoryUrl(t);$.ajax(o,{name:"ObliterateStory",description:"Obliterate a given story from storage",type:"POST",contentType:StoryApp.RequestManager.JsonContentType,dataType:"json",headers:{clientCorrelation:CommonSettings.CorrelationId}}).then(e,n)},e}();t.DeleteServerInterface=e}(Delete||(Delete={}));var StoryApp;!function(t){!function(e){!function(e){var n=function(){function e(t,e,n){this._lookupId=t,this._storyTitle=e,this._castUrl=n}return e.createAndShow=function(t,n,o){BRSDialog.showIfAuthoringDisabled()||new e(t,n,o).initDialog()},e.prototype.initDialog=function(){var e=this,n=this._storyTitle?ResourceManager.ResolveString(Resources.SharingCastEditOwnerDialogBodyWithStoryTitle,[this._storyTitle]):Resources.SharingCastEditOwnerDialogBody,o={title:Resources.SharingCastEditOwnerDialogTitle,description:Resources.SharingCastEditOwnerDialogTitle,messages:[n],lightDismiss:!1,dialogType:t.View.ViewElements.DialogType.Info,buttonsArgs:[{caption:{value:Resources.SharingCastEditOwnerDialogSignin},isDefault:!0,dismissOnAction:!1,onAction:function(t,n){e.signIn()}},{caption:{value:Resources.SharingCastEditOwnerDialogReturn},dismissOnAction:!1,onAction:function(e,n){var o=t.Common.UrlHelper.getInstance().getCastRedirectLink();o&&(window.location.href=o)},isNeutralButton:!0}]};this._dlg=t.View.Common.DialogManager.createAndShow(o)},e.prototype.signIn=function(){this._dlg.close(),t.Identity.getActions().signIn()},e}();e.CastEditOwnerDialog=n}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=function(){function n(t){this._freDialogArgs=t,this._isSmallScreen={compute:new TDB.ReusingComputedOptionArgs(this,this.isSmallScreen)}}return n.createAndShow=function(t){var e=new n(t);return e.show(),e},n.prototype.show=function(){var n=this,o={noFocus:!1,dialogWrapperCssClass:{value:"freDialogWrapperOverride"},dialogCssClass:{compute:new TDB.ComputedOptionArgs(this,this.FREDialogBackgroundClassName)},dialogContentCssClass:"freDialogContentOverride",dialogType:e.DialogType.Info,lightDismiss:!1,frostOpacity:this._freDialogArgs.frostOpacity,ariaLive:Aria.AriaLiveValue.Off,description:Resources.FREDialogPage1Title1,onShowing:function(){StoryLog.TraceTag(596477080,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"FRE multi-page dialog opened.")},onClose:function(){StoryLog.TraceTag(596477081,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"FRE multi-page dialog closed."),n._freDialogArgs&&n._freDialogArgs.onClose&&n._freDialogArgs.onClose()},buttonsArgs:[{caption:{value:""},isDefault:!1,dismissOnAction:!0,onAction:function(){StoryLog.TraceTag(596477082,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"FRE multi-page dismiss dialog button pressed.")},id:"dismissFRE",customGlyphButton:{buttonId:ClientAction.ButtonId.DialogButton,cssClass:{value:"freDialogCloseButton"},description:{value:Resources.FREDialogDismissButtonDescription},fontIconName:{value:FontIcons.FRECarouselDialogDismissIcon},fontIconSizeClass:FontIcons.FRECarouselDialogDismissIconSize}}],contentArgs:this.createDialogCarousel()};t.View.Common.DialogManager.createAndShow(o)},n.prototype.createDialogCarousel=function(){var t=this,n={carouselContentFactory:this,numberOfCarouselVEs:3,indexButtonDescriptions:[Resources.FREDialogIndexButton1Description,Resources.FREDialogIndexButton2Description,Resources.FREDialogIndexButton3Description],isSmallScreen:this._isSmallScreen};return new TDB.ChildArgs(e.FRECarouselVE,n,function(e){t._carousel=e})},n.prototype.getFRECarousel=function(){return this._carousel},n.prototype.createDialogContent=function(n,o){var i;switch(n){case 0:var r={isSmallScreen:this._isSmallScreen};i=new TDB.ChildArgs(e.FREPage1VE,r),StoryLog.TraceTag(596477083,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"FRECarouselDialog::createDialogContent: Page1 created.");break;case 1:var a={isSmallScreen:this._isSmallScreen,animationsPaused:{watchable:o},timerIntervalMs:1e3,imagesLarge:[Icons.FREDialogPage2ImageLarge_Sway,Icons.FREDialogPage2ImageLarge_OneDrive,Icons.FREDialogPage2ImageLarge_Flickr,Icons.FREDialogPage2ImageLarge_Bing,Icons.FREDialogPage2ImageLarge_PicHit,Icons.FREDialogPage2ImageLarge_YouTube],imagesSmall:[Icons.FREDialogPage2ImageSmall_Sway,Icons.FREDialogPage2ImageSmall_OneDrive,Icons.FREDialogPage2ImageSmall_Flickr,Icons.FREDialogPage2ImageSmall_Bing,Icons.FREDialogPage2ImageSmall_PicHit,Icons.FREDialogPage2ImageSmall_YouTube]};i=new TDB.ChildArgs(e.FREPage2VE,a),StoryLog.TraceTag(596477084,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"FRECarouselDialog::createDialogContent: Page2 created.");break;case 2:var s={isSmallScreen:this._isSmallScreen,animationsPaused:{watchable:o},timerIntervalMs:3e3,imagesLargeLtr:[Icons.FREDialogPage3ImageLarge_1,Icons.FREDialogPage3ImageLarge_2,Icons.FREDialogPage3ImageLarge_3,Icons.FREDialogPage3ImageLarge_4],imagesSmallLtr:[Icons.FREDialogPage3ImageSmall_1,Icons.FREDialogPage3ImageSmall_2,Icons.FREDialogPage3ImageSmall_3,Icons.FREDialogPage3ImageSmall_4],imagesLargeRtl:[Icons.FREDialogPage3ImageLarge_1_Rtl,Icons.FREDialogPage3ImageLarge_2_Rtl,Icons.FREDialogPage3ImageLarge_3_Rtl,Icons.FREDialogPage3ImageLarge_4_Rtl],imagesSmallRtl:[Icons.FREDialogPage3ImageSmall_1_Rtl,Icons.FREDialogPage3ImageSmall_2_Rtl,Icons.FREDialogPage3ImageSmall_3_Rtl,Icons.FREDialogPage3ImageSmall_4_Rtl],subtitleCssLarge:["frePage3SubtitleLarge1","frePage3SubtitleLarge2","frePage3SubtitleLarge3","frePage3SubtitleLarge4"],subtitleCssSmall:["frePage3SubtitleSmall1","frePage3SubtitleSmall2","frePage3SubtitleSmall3","frePage3SubtitleSmall4"]};i=new TDB.ChildArgs(e.FREPage3VE,s),StoryLog.TraceTag(596477085,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"FRECarouselDialog::createDialogContent: Page3 created.");break;default:throw t.RethrowLogger.createError("FRE dialog page not supported")}return i},n.prototype.isSmallScreen=function(t){var e=this._freDialogArgs.windowWidth.getWatchedValue(t),o=this._freDialogArgs.windowHeight.getWatchedValue(t),i=o>e,r=i?n.screenWidth_680:n.screenWidth_1024,a=n.screenHeight_600;return e<r||!i&&o<a},n.prototype.isNarrowScreen=function(t){return this._freDialogArgs.windowWidth.getWatchedValue(t)<n.screenWidth_360},n.prototype.FREDialogBackgroundClassName=function(t){var e=this.isSmallScreen(t)?"freDialogBackgroundSmall":"freDialogBackgroundLarge";return this.isNarrowScreen(t)&&(e+=" freDialogBackgroundNarrow"),e},n.screenWidth_360=360,n.screenWidth_680=680,n.screenWidth_1024=1024,n.screenHeight_600=600,n}();e.FRECarouselDialog=n}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=function(){function e(t,e){this._lookupId=t,this._joinResult=e,this._title=this.getTitle(e),this._message=this.getMessage(e)}return e.createAndShow=function(t,n){e.shouldShow(n)&&new e(t,n).show()},e.shouldShow=function(t){return t===StoryJoinResult.IncompatibleWithOtherAuthor||t===StoryJoinResult.IncompatibleWithOwnClient||t===StoryJoinResult.TooManyAuthors},e.prototype.show=function(){var e={title:this._title,description:this._title,dialogType:t.View.ViewElements.DialogType.Info};e.messages=[this._message],e.buttonsArgs=[{caption:{value:Resources.IncompatibleAuthorDialogViewOnlyButton},dismissOnAction:!0,onAction:function(){t.Utilities.query.has(t.Common.UrlHelper.URLParamJoinResult)&&window.history.replaceState(null,"",window.location.pathname+t.Utilities.query.erase(t.Common.UrlHelper.URLParamJoinResult)),t.Utilities.query.has(t.Common.UrlHelper.URLParamReadOnly)&&window.history.replaceState(null,"",window.location.pathname+t.Utilities.query.erase(t.Common.UrlHelper.URLParamReadOnly))}}],this._dlg=t.View.Common.DialogManager.createAndShow(e)},e.prototype.getTitle=function(e){switch(e){case StoryJoinResult.IncompatibleWithOtherAuthor:return Resources.IncompatibleWithOtherAuthorDialogTitle;case StoryJoinResult.IncompatibleWithOwnClient:return Resources.IncompatibleWithOwnClientDialogTitle;case StoryJoinResult.TooManyAuthors:return Resources.TooManyAuthorsDialogTitle}throw t.RethrowLogger.createError("Unexpected StoryJoinResult: "+e)},e.prototype.getMessage=function(e){switch(e){case StoryJoinResult.IncompatibleWithOtherAuthor:return Resources.IncompatibleWithOtherAuthorDialogMessage;case StoryJoinResult.IncompatibleWithOwnClient:return Resources.IncompatibleWithOwnClientDialogMessage;case StoryJoinResult.TooManyAuthors:return Resources.TooManyAuthorsDialogMessage}throw t.RethrowLogger.createError("Unexpected StoryJoinResult: "+e)},e}();e.AuthorJoinFailDialog=n}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=t.View.ViewElements,o=function(){function o(t,e){this._currentUserEmail=t,this._expectedUser=e}return o.createAndShow=function(t,e){BRSDialog.showIfAuthoringDisabled()||new o(t,e).initDialog()},o.prototype.initDialog=function(){var o=this,i={user:this._expectedUser,message:ResourceManager.ResolveString(Resources.EditStoryWrongUserDialogMessage,[this._currentUserEmail])},r={dialogType:e.DialogType.Info,description:ResourceManager.ResolveString(Resources.EditStoryWrongUserDialogMessage,[this._currentUserEmail]),lightDismiss:!0,buttonsArgs:[{caption:{value:Resources.SignIn},isDefault:!0,dismissOnAction:!1,onAction:function(t,e){o.signIn()}}],contentArgs:new TDB.ChildArgs(n.EditStoryDialogVE,i)};this._dlg=t.View.Common.DialogManager.createAndShow(r)},o.prototype.signIn=function(){this._dlg.close(),t.Identity.getActions().signIn()},o}();e.EditStoryWrongUserDialog=o}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=t.Common,o=function(){function o(t,e){this.lookupId=t,this.castViewUrl=e.castViewUrl,e.callback&&(this.publishCallback=e.callback),this.sharingManager=e.sharingManager}return o.createAndShowPublish=function(t,e){new o(t,e).showPublish()},o.createAndShowUnpublish=function(t,e){new o(t,e).showUnpublish()},o.createAndShowAlreadyPublished=function(t,e){new o(t,e).showAlreadyPublished()},o.prototype.showPublish=function(){var n={url:Resources.AttributionLinkUrl,message:Resources.AttributionLink,context:this,class:"NeutralHyperlinks",target:"_blank"},i=ResourceManager.resolveWithViewElementArgs(Resources.AttributionMessage,[n]),r={title:Resources.SharingCastPublishDialogTitle,description:Resources.SharingCastPublishDialogTitle,messages:[Resources.SharingCastPublishDialogBody],width:o.s_dialogWidth,noFocus:!0,dialogType:e.DialogType.Question,buttonsArgs:[{caption:{value:Resources.SharingCastPublish},onAction:$.proxy(this.onPublishButtonOK,this),isDefault:!0,dismissOnAction:!1,id:"publishButtonOK"},{caption:{value:Resources.ButtonCancel},id:"publishButtonCancel",isNeutralButton:!0}],contentArgs:new TDB.ChildArgs(e.DynamicMessageVE,i)};this.dlg=t.View.Common.DialogManager.createAndShow(r),StoryLog.TraceTag(596477065,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,"PublishCastDialog - showPublish")},o.prototype.showUnpublish=function(){var n={title:Resources.SharingCastPublishRemoveConfirmationDialogTitle,description:Resources.SharingCastPublishRemoveConfirmationDialogTitle,messages:[Resources.SharingCastPublishRemoveConfirmationDialogBody],width:o.s_dialogWidth,noFocus:!0,dialogType:e.DialogType.Question,buttonsArgs:[{caption:{value:Resources.SharingCastPublishRemove},onAction:$.proxy(this.onUnpublishButtonOK,this),isDefault:!0,dismissOnAction:!1,id:"unpublishButtonOK"},{caption:{value:Resources.ButtonCancel},id:"unpublishButtonCancel",isNeutralButton:!0}]};this.dlg=t.View.Common.DialogManager.createAndShow(n),StoryLog.TraceTag(596477066,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,"PublishCastDialog - showUnpublish")},o.prototype.showAlreadyPublished=function(){var n={title:Resources.DocsDotComPublishedDialogTitle,description:Resources.DocsDotComPublishedDialogTitle,messages:[Resources.DocsDotComPublishedDialogBody],width:o.s_dialogWidth,noFocus:!0,dialogType:e.DialogType.Question,buttonsArgs:[{caption:{value:Resources.SharingCastPublishViewNow},onAction:$.proxy(this.onAlreadyPublishedManageOnDocsDotCom,this),isDefault:!0,dismissOnAction:!1,id:"manageOnDocsDotComButton"},{caption:{value:Resources.SharingCastPublishRemove},isNeutralButton:!0,onAction:$.proxy(this.onAlreadyPublishedUnpublish,this),id:"unpublishButton"}]};this.dlg=t.View.Common.DialogManager.createAndShow(n),StoryLog.TraceTag(596477067,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,"PublishCastDialog - showAlreadyPublished")},o.prototype.onAlreadyPublishedManageOnDocsDotCom=function(e){t.View.Common.DialogManager.closeCurrentDialog(),window.open(this.castViewUrl.getValue(),"_blank")},o.prototype.onAlreadyPublishedUnpublish=function(e){t.View.Common.DialogManager.closeCurrentDialog(),this.showUnpublish()},o.prototype.onPublishButtonOK=function(i){if(t.View.Common.DialogManager.closeCurrentDialog(),this.publishCallback){var r={dialogType:e.DialogType.Info,title:Resources.SharingCastPublishDialogTitle,description:Resources.SharingCastPublishDialogTitle,width:o.s_dialogWidth,contentArgs:new TDB.ChildArgs(e.DialogLoadingSpinnerVE,{})};this.dlg=t.View.Common.DialogManager.createAndShow(r),this.sharingManager.publishSwayToCast(this.lookupId,$.proxy(this.onPublishSuccess,this),$.proxy(this.onError,this))}else window.open(n.UrlHelper.getInstance().getCastPublishAadUrl(this.lookupId),"_blank");StoryLog.TraceTag(596477068,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,"PublishCastDialog - onPublishButtonOK")},o.prototype.onUnpublishButtonOK=function(n){t.View.Common.DialogManager.closeCurrentDialog();var i={dialogType:e.DialogType.Info,title:Resources.SharingCastPublishRemoveConfirmationDialogTitle,description:Resources.SharingCastPublishRemoveConfirmationDialogTitle,width:o.s_dialogWidth,contentArgs:new TDB.ChildArgs(e.DialogLoadingSpinnerVE,{})};this.dlg=t.View.Common.DialogManager.createAndShow(i),this.sharingManager.unpublishFromCast(this.lookupId,StoryAudience.Unknown,$.proxy(this.onUnpublishSuccess,this),$.proxy(this.onError,this)),StoryLog.TraceTag(596477069,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,"PublishCastDialog - onUnpublishButtonOK")},o.prototype.onPublishSuccess=function(n,i,r){if(this.publishCallback&&this.publishCallback(n.castId,n.castViewUrl),t.View.Common.DialogManager.closeCurrentDialog(),CommonSettings.SitePublishToCastSuccessDialogEnabled){var a={title:Resources.SharingCastPublishSuccessDialogTitle,description:Resources.SharingCastPublishSuccessDialogTitle,messages:[Resources.SharingCastPublishSuccessDialogBody],width:o.s_dialogWidth,noFocus:!0,dialogType:e.DialogType.Question,buttonsArgs:[{caption:{value:Resources.SharingCastPublishSuccessDialogConfirm},onAction:$.proxy(this.navigateToCastEdit,this,n.castId),isDefault:!0,dismissOnAction:!0,id:"publishSuccessButtonOK"},{caption:{value:Resources.SharingCastPublishSuccessDialogCancel},id:"publishSuccessButtonCancel",isNeutralButton:!0}]};this.dlg=t.View.Common.DialogManager.createAndShow(a)}StoryLog.TraceTag(596477070,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,"PublishCastDialog - onPublishSuccess")},o.prototype.onUnpublishSuccess=function(e,n,o){this.publishCallback&&this.publishCallback(e.castId,e.castViewUrl),t.View.Common.DialogManager.closeCurrentDialog(),StoryLog.TraceTag(596477071,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,"PublishCastDialog - onUnpublishSuccess")},o.prototype.navigateToCastEdit=function(t){t&&(window.open(n.UrlHelper.getInstance().getCastEditUrl(t),"_blank"),StoryLog.TraceTag(596477072,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,"PublishCastDialog - navigateToCastEdit"))},o.prototype.navigateToCastProfile=function(t){window.open(n.UrlHelper.getInstance().getCastProfileUrl(),"_blank"),StoryLog.TraceTag(596477073,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,"PublishCastDialog - navigateToCastProfile")},o.prototype.onError=function(e,n,o){var i=this;if(410==e.status)return this.publishCallback&&this.publishCallback(null,null),void this.dlg.close();if(400==e.status){var r=$.parseJSON(e.responseText);if(r&&null!=r.errorCode&&r.errorCode===ChangeLinkErrorCode.CastProfileRequired)return void this.showDocsAccountError()}t.Utilities.browser.isWebkit&&0==e.status&&"error"==n&&""==o?platform.setTimeout(function(){i.showError(n,o)},1e3):this.showError(n,o)},o.prototype.showError=function(n,i){t.View.Common.DialogManager.closeCurrentDialog();var r={dialogType:e.DialogType.Error,title:Resources.SharingCastPublishErrorDialogTitle,description:Resources.SharingCastPublishErrorDialogTitle,messages:[Resources.SharingCastPublishErrorDialogBody],width:o.s_dialogWidth,noFocus:!0,buttonsArgs:[{caption:{value:Resources.ButtonOK},isDefault:!0,dismissOnAction:!0,isNeutralButton:!0,id:"publishErrorOK"}]};this.dlg=t.View.Common.DialogManager.createAndShow(r),StoryLog.TraceTag(596477074,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,"PublishCastDialog - showError")},o.prototype.showDocsAccountError=function(){t.View.Common.DialogManager.closeCurrentDialog();var n={dialogType:e.DialogType.Error,title:Resources.SharingCastPublishProfileErrorDialogTitle,description:Resources.SharingCastPublishProfileErrorDialogTitle,messages:[Resources.SharingCastPublishProfileErrorDialogBody],width:o.s_dialogWidth,noFocus:!0,buttonsArgs:[{caption:{value:Resources.SharingCastPublishProfileErrorDialogSignInButton},isDefault:!0,dismissOnAction:!0,immediateOnAction:$.proxy(this.navigateToCastProfile,this),id:"publishDocsAccountErrorSignIn"},{caption:{value:Resources.ButtonCancel},isNeutralButton:!0,id:"publishDocsAccountErrorCancel"}]};this.dlg=t.View.Common.DialogManager.createAndShow(n),StoryLog.TraceTag(596477075,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,"PublishCastDialog - showDocsAccountError")},o.s_dialogWidth=548,o}();e.PublishCastDialog=o}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=function(){function n(){}return n.createAndShow=function(t){return(new n).show(t)},n.prototype.show=function(n){var o=[{caption:{value:n.acceptButtonText},isDefault:!0,dismissOnAction:!0}],i={title:n.title,description:n.title,dialogType:e.DialogType.Info,lightDismiss:!1,messages:n.messages,buttonsArgs:o};return t.View.Common.DialogManager.createAndShow(i)},n}();e.MessageDialog=n}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=function(){function n(t){this._cancel=t}return n.createAndShow=function(t){new n(t).show()},n.prototype.show=function(){var o="",i={title:o=CommonSettings.Branding==StoryBrandingMode.DocsJournal&&CommonSettings.NewDocsJournalPublishingStringEnabled?Resources.DocsJournalPublishingDialogTitle:Resources.SharingCastPublishDialogTitle,description:o,width:n.s_dialogWidth,noFocus:!0,dialogType:e.DialogType.Info,contentArgs:new TDB.ChildArgs(e.DialogLoadingSpinnerVE,{}),buttonsArgs:[{caption:{value:Resources.ButtonCancel},onAction:$.proxy(this._cancel,this),id:"publishAppBarButtonCancel",isNeutralButton:!0}]};this._dlg=t.View.Common.DialogManager.createAndShow(i)},n.s_dialogWidth=548,n}();e.PublishFromAppBarDialog=n}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=t.View.ViewElements,o=function(){function e(){}return e.createAndShow=function(t){return(new e).show(t)},e.prototype.show=function(e){var o=this,i=[{caption:{value:e.acceptButtonText},isDefault:!0,dismissOnAction:!1,onAction:function(t,n){o.onCommit(e.onAccept,e.context)},tooltip:e.acceptButtonTooltip,id:"accept"}];e.cancelButtonText&&e.onCancel&&i.push({caption:{value:e.cancelButtonText},isDefault:!1,isNeutralButton:!0,dismissOnAction:!0,onAction:function(t,n){o.onCommit(e.onCancel,e.context)},tooltip:e.cancelButtonTooltip,id:"cancel"});var r=new TDB.ChildArgs(n.DialogTextInputVE,{description:e.textInputDescription||"",initialValue:e.initialValue,textInputCss:e.textInputCss,placeholder:e.textInputPlaceholder||"",onEnter:function(){o.onCommit(e.onAccept,e.context)},label:e.label,errorMessage:e.textInputErrorMessage||"",errorMessageCss:e.textInputErrorMessageCss||"",textInputTooltip:e.textInputTooltip}),a={title:e.title,description:e.title,noFocus:!1,dialogType:t.View.ViewElements.DialogType.Info,lightDismiss:!0,buttonsArgs:i,allowCancel:e.allowEsc,contentArgs:r};return this._dlg=t.View.Common.DialogManager.createAndShow(a),this._dlg},e.prototype.onCommit=function(t,e){var n=this._dlg.getContent().getText();t.call(e,n)},e}();e.TextInputDialog=o}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=function(){function n(){}return n.createAndShow=function(t,e){return void 0===e&&(e=!1),(new n).show(t,e)},n.prototype.show=function(n,o){void 0===o&&(o=!1);var i={handleGlobalKeyEvent:function(t,e){t.stopPropagation(),t.preventDefault()},handleGlobalMouseEvent:function(t,e,n){},touchStart:function(t){return!0},touchMove:function(t){return!0},touchStop:function(t){return!0}};e.DomEventRegister.getInstance().registerEventHandler(i);var r={title:n,description:n,dialogType:e.DialogType.Info,allowCancel:!1,ariaRole:Aria.Roles.Progressbar,ariaLive:Aria.AriaLiveValue.Assertive,accessibilityMessage:{value:n},dialogContentCssClass:"progressDialog",lightDismiss:o,onClose:function(){return e.DomEventRegister.getInstance().unregisterEventHandler(i)},contentArgs:new TDB.ChildArgs(e.DialogLoadingSpinnerVE,{})};return t.View.Common.DialogManager.createAndShow(r)},n}();e.ProgressDialog=n}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=function(){function n(){}return n.prototype.createAndShow=function(){this.dialogVE=this.createDialog(),t.View.Common.DialogManager.showDialog(this.dialogVE)},n.prototype.createDialog=function(){var n=this,o={buttonId:ClientAction.ButtonId.CreateOutline_CreateButton,context:this,cssClass:{value:"segoeUI dlgButton createOutlineButton"},text:{value:Resources.CreateOutlineDialogCreateButton}},i={buttonId:ClientAction.ButtonId.CreateOutline_CancelButton,context:this,cssClass:{value:"segoeUI dlgButtonNeutral createOutlineButton"},text:{value:Resources.CreateOutlineDialogCancelButton}},r={title:Resources.CreateOutlineDialogTitle,description:Resources.CreateOutlineDialogTitle,buttonsArgs:[{caption:{value:Resources.CreateOutlineDialogCreateButton},dismissOnAction:!1,onAction:function(t,e){ActionLogger.RecordClientAction(new ClientAction.SimpleClientActionData(ClientAction.ActionType.CreateOutlineDialog,Diag.ULSCat.msoulscat_Story_Site)),n._dialogContent.createOutline()},isDefault:!0,customTextButton:o},{caption:{value:Resources.ButtonCancel},customTextButton:i}],dialogType:e.DialogType.Question,getInitialActiveChild:function(){return n.getInitialActiveChild()},frostOpacity:.65,dialogContentCssClass:"outlineDialogContent",dialogWrapperCssClass:{value:"outlineDialog"},dialogLogMessage:"Create outline dialog",contentArgs:new TDB.ChildArgsNoModel(e.OutlineDialogContentVE,function(t){n._dialogContent=t})};return t.View.Common.DialogManager.createDialog(r)},n.prototype.getInitialActiveChild=function(){return this._dialogContent.getInitialActiveChild()},n.prototype.setOnCloseTestingCallback=function(t){this.dialogVE.setOnCloseTestingCallback(t)},n}();e.OutlineDialog=n}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=function(){function n(t,e,o){this._lookupId=t,this._editToken=e,this._storyTitle=o,n.dialogTitle=Resources.EditTokenRetrievalDialogTitle}return n.createAndShow=function(t,e,o){BRSDialog.showIfAuthoringDisabled()||new n(t,e,o).show()},n.prototype.show=function(){var e=this,o={title:n.dialogTitle,description:n.dialogTitle,dialogType:t.View.ViewElements.DialogType.Info};o.messages=this._storyTitle?[ResourceManager.ResolveString(Resources.EditTokenRetrievalDialogDescription,[this._storyTitle])]:[Resources.EditTokenRetrievalDialogDescriptionNoTitle],o.buttonsArgs=[{caption:{value:Resources.EditTokenRetrievalDialogEditButton},isDefault:!0,dismissOnAction:!1,onAction:function(t,n){e.retrieveEditToken()}},{caption:{value:Resources.EditTokenRetrievalDialogViewOnlyButton},dismissOnAction:!1,onAction:function(n,o){t.Common.UserStories.getInstance().loadStory(e._lookupId,!1,!0)},isNeutralButton:!0}],this._dlg=t.View.Common.DialogManager.createAndShow(o)},n.prototype.retrieveEditToken=function(){var o=this;t.View.Common.DialogManager.closeCurrentDialog(),e.ProgressDialog.createAndShow(n.dialogTitle),$.ajax(t.Common.UrlHelper.getInstance().addAuthorUrl(this._lookupId,this._editToken),{name:"EditTokenRetrieval",description:"Retrieving edit token",type:"POST",success:function(e,n,i){t.Common.UserStories.getInstance().loadStory(o._lookupId,!t.Utilities.browser.isMobile)},error:function(t,e,n){o.showError(e,n)}})},n.prototype.showError=function(e,n){t.View.Common.DialogManager.closeCurrentDialog();var o={title:Resources.EditTokenRetrievalDialogTitle,description:Resources.EditTokenRetrievalDialogTitle,dialogType:t.View.ViewElements.DialogType.Info,messages:[Resources.EditTokenRetrievalDialogGenericError],lightDismiss:!0,buttonsArgs:[{caption:{value:Resources.ButtonOK},isDefault:!0,dismissOnAction:!0}]};this._dlg=t.View.Common.DialogManager.createAndShow(o)},n}();e.EditTokenRetrievalDialog=n}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var EmbedHostType;!function(t){t[t.none=0]="none",t[t.dd=1]="dd",t[t.ddprofile=2]="ddprofile"}(EmbedHostType||(EmbedHostType={}));var StoryApp;!function(t){!function(t){var e=function(){function t(){}return t.PageChanged="PageChanged",t.StoryViewModeChanged="StoryViewModeChanged",t}();t.EventNames=e}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){var n=function(){function e(e,n,o){void 0===o&&(o=250),t.Utilities.throttledEvent(this,this.registerEventCallback,o,e,n)}return e.prototype.registerEventCallback=function(t){this.eventCallback=t},e.prototype.activate=function(t){this.eventCallback(t)},e}();e.EventThrottler=n}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var FontIcons={AppBarOverflowButtonIcon:"IconHintBarEllipses",AppBarOverflowButtonIconSize:"fontIconSize20x20",DoughboyIcon:"IconDoughboy",DoughboyIconLargeSize:"fontIconSize48x48",DoughboyIconMediumSize:"fontIconSize32x32",DoughboyIconSmallSize:"fontIconSize20x20",DoughboyIconSuggestedPerson:"fontIconSize26x26",DoughboyIconSelectedPerson:"fontIconSize24x24",AppSwitcherWaffleIcon:"IconOfficeAppSwitcher",AppSwitcherWaffleIconSize:"fontIconSize20x20",ClosePaneIcon:"IconCancelGlyph",ClosePaneIconSize:"fontIconSize20x20",OverflowMenuItemButtonIconSize:"fontIconSize20x20",OverflowMenuCreateNewButtonIcon:"Iconplussignglyph",OverflowMenuFeedbackButtonIcon:"IconSendASmileQuickCommand",OverflowMenuDuplicateButtonIcon:"IconDuplicateSway",OverflowMenuMySwaysButtonIcon:"Icon23_16_N",OverflowMenuOpenUrlButtonIcon:"IconOpen",MsaButtonIcon:"IconMicrosoftLogoWhite",MsaButtonIconSize:"fontIconSize32x32",AadButtonIcon:"IconOrgIDBadgeWhite",AadButtonIconSize:"fontIconSize32x32",RefreshMenuButtonIcon:"IconSyncNowQuickCommand_Glyph",RefreshMenuButtonIconSize:"fontIconSize24x24",CameraIcon:"IconCamera",PlayHeaderButtonIcon:"IconPlay",PlayHeaderButtonIconSize:"fontIconSize20x20",RemoveViewedStoryIcon:"IconCancelGlyph",RemoveViewedStoryIconSize:"fontIconSize24x24",SearchIcon:"Iconsearch",SearchIconSize:"fontIconSize16x16",ClearSearchIconSize:"fontIconSize13x13",CoAuthorHeaderButtonIcon:"IconSharingSet_Start_Glyph",CoAuthorHeaderButtonIconSize:"fontIconSize20x20",UndoButtonIcon:"IconUndoQuickCommand_Glyph",UndoButtonIconSize:"fontIconSize20x20",RedoButtonIcon:"IconRedoQuickCommand_Glyph",RedoButtonIconSize:"fontIconSize20x20",PermanentDeleteStoryIcon:"IconTrashCan",RecycleBinButtonIconSize:"fontIconSize20x20",RestoreStoryButtonIcon:"IconUndoQuickCommand_Glyph",RestoreAllStoriesIcon:"IconRestoreAll",DeleteAllStoriesIcon:"IconEmptyRecycleBin",CarouselNextIcon:"IconRightChevron",CarouselNextIconSize:"fontIconSize10x32",CarouselPreviousIcon:"IconLeftChevron",CarouselPreviousIconSize:"fontIconSize10x32",LeftArrowGreyIcon:"IconBackChevron",LeftArrowGreyIconSize:"fontIconSize24x24",DropdownChevronIcon:"IconDownChevron",DropdownChevronIconSize:"fontIconSize24x24",SwayWatermarkIcon:"IconLogo_Sway",SwayWatermarkIconSize:"fontIconSize20x20",CheckboxFontIcon:"IconCommonControlCheckboxCheck",CheckboxFontIconSize:"fontIconSize16x16",CustomColorDeleteIcon:"IconCancelGlyph",CustomColorDeleteIconSize:"fontIconSize16x16",CastIcon:"IconShareToDocs",CastIconSize:"fontIconSize24x24",PreviewEmbedIcon:"IconHtmlEmbed",PreviewEmbedIconSize:"fontIconSize20x20",PreviewEmbedIconSize24:"fontIconSize24x24",SocialIconSize:"fontIconSize20x20",SocialDocsDotComIcon:"IconDocsLogoWhite",SocialFacebookIcon:"IconShareOnFacebook",SocialTwitterIcon:"IconShareOnTwitter",SocialLinkedInIcon:"IconShareToLinkedIn",SocialYammerIcon:"IconShareToYammer",SocialGoogleplusIcon:"IconShareToGooglePlus",SocialSharethisIcon:"IconMoreShareThisOptions",SocialOverflowIcon:"IconHintBarEllipses",ShareButtonIcon:"IconShareGlyph",ShareButtonIconSize:"fontIconSize20x20",ExpandOpenRestIcon:"IconCommentCollapse",ExpandClosedRestIcon:"IconCommentExpand",ExpandOpenRestIconSize:"fontIconSize16x16",CopyLinkIcon:"IconCopy",CopyLinkIconSize:"fontIconSize24x24",RemovePersonSize:"fontIconSize8x8",LuggageIcon:"IconLuggage",GlobeIcon:"IconGlobe",AddAssignmentStageIcon:"IconAddAssignmentStage",PeopleWithExistingAccessPermissionsIcon:"IconPeopleWithExistingAccessPermissions",SharingLevelIconSize:"fontIconSize24x24",CreateFromNewIcon:"Iconplussignglyph",CreateFromNewIconSize:"fontIconSize24x24",CreateFromDocIcon:"IconUploadMedia",CreateFromDocIconSize:"fontIconSize24x24",CreateOutlineIcon:"Icon13_16_N",CreateOutlineIconSize:"fontIconSize16x16",UploadIcon:"IconUploadMedia",UploadIconSize:"fontIconSize24x24",ShareIcon:"IconShareGlyph",ShareIconSize:"fontIconSize36x36",ShareIconSizeMySwaysPage:"fontIconSize28x28",DeleteIcon:"IconTrashCan",DeleteIconSize:"fontIconSize36x36",DeleteIconSizeMySwaysPage:"fontIconSize28x28",StoryTileDuplicateIcon:"IconDuplicateSway",StoryTileDuplicateIconSize:"fontIconSize36x36",StoryTileDuplicateIconSizeMySwaysPage:"fontIconSize28x28",StoryOverflowIcon:"IconHintBarEllipses",StoryOverflowIconSize:"fontIconSize20x20",StoryTileCoAuthorsIcon:"IconPeopleOnly",StoryTileCoAuthorsIconSize:"fontIconSize20x20",MySwaysDropdownIcon:"IconDownChevron",MySwaysDropdownIconSize:"fontIconSize16x16",EnvelopeIcon:"IconEnvelope",EnvelopeIconSize:"fontIconSize24x24",FacebookIcon:"IconShareOnFacebook",FacebookIconSize:"fontIconSize24x24",TwitterIcon:"IconShareOnTwitter",TwitterIconSize:"fontIconSize24x24",LinkedInIcon:"IconShareToLinkedIn",LinkedInIconSize:"fontIconSize24x24",LinkIcon:"IconShareasLink",LinkIconSize:"fontIconSize24x24",AddAuthorIcon:"IconSharingSet_Start_Glyph",AddAuthorIconSize:"fontIconSize24x24",TilePlayIcon:"IconPlay",TilePlayIconSize:"fontIconSize36x36",TilePlayIconSizeMySwaysPage:"fontIconSize28x28",TileViewCount:"IconNavLinkVisibleGlyph",TileViewCountSize:"fontIconSize12x12",FRECarouselDialogDismissIcon:"IconCancelGlyph",FRECarouselDialogDismissIconSize:"fontIconSize20x20",FRECarouselNextIcon:"IconLargeChevronRight",FRECarouselNextIconSize:"fontIconSize24x24",FRECarouselPreviousIcon:"IconLargeChevronLeft",FRECarouselPreviousIconSize:"fontIconSize24x24",FRECarouselPlayIcon:"IconPlayVideoWhite",FRECarouselPlayIconSize:"fontIconSize16x16",FRECarouselPauseIcon:"IconPause",FRECarouselPauseIconSize:"fontIconSize16x16",FollowFacebookIcon:"IconShareOnFacebook",FollowFacebookIconSize:"fontIconSize32x32",FollowTwitterIcon:"IconShareOnTwitter",FollowTwitterIconSize:"fontIconSize32x32",FollowBlogIcon:"IconFollowBlog",FollowBlogIconSize:"fontIconSize32x32",PreviousIcon:"IconLeftChevron",PreviousIconSize:"fontIconSize32x32",NextIcon:"IconRightChevron",NextIconSize:"fontIconSize32x32",PreviewShareThisIcon:"IconShareGlyph",PreviewShareThisIconSize:"fontIconSize20x20",PreviewOverflowIcon:"IconHintBarEllipses",PreviewOverflowIconSize:"fontIconSize20x20",PreviewEnterFullscreenIcon:"IconEnterFullscreenHover",PreviewEnterFullscreenIconSize:"fontIconSize20x20",PreviewExitFullscreenIcon:"IconExitFullscreenHover",PreviewSmallEmbedIconIcon:"IconHtmlEmbed",PreviewSmallEmbedIconIconSize:"fontIconSize16x16",PreviewFacebookIcon:"IconShareOnFacebook",PreviewFacebookIconSize:"fontIconSize20x20",PreviewTwitterIcon:"IconShareOnTwitter",PreviewTwitterIconSize:"fontIconSize20x20",PreviewLinkedInIcon:"IconShareToLinkedIn",PreviewLinkedInIconSize:"fontIconSize20x20",PreviewLinkIcon:"IconShareasLink",PreviewLinkIconSize:"fontIconSize20x20",PreviewEditIcon:"IconEditGeneric",PreviewEditIconSize:"fontIconSize20x20",PreviewEditTemplateIcon:"IconEditGeneric",PreviewEditTemplateIconSize:"fontIconSize32x32",NavigateHomeIcon:"IconNavigateToTopCircle",NavigateHomeIconSize:"fontIconSize24x24",NavigateForwardIcon:"IconLargeChevronRight",NavigateForwardIconSize:"fontIconSize24x24",NavigateBackIcon:"IconLargeChevronLeft",NavigateBackIconSize:"fontIconSize24x24",ExpandCaptionIcon:"IconCardCaption",ExpandCaptionIconSize:"fontIconSize20x20",FullScreenIcon:"IconEnterFullscreenHover",FullScreenIconSize:"fontIconSize20x20",CloseButtonIcon:"IconCancelGlyph",CloseButtonIconSize:"fontIconSize24x24",PlayMediaButtonIcon:"IconPlay",PlayMediaButtonIconSize:"fontIconSize32x32",PauseMediaButtonIcon:"IconPause",PauseMediaButtonIconSize:"fontIconSize32x32",PlayAudioButtonIcon:"IconPlay",PlayAudioButtonIconSize:"fontIconSize20x20",PauseAudioButtonIcon:"IconPause",VolumeMuteAudioIcon:"IconVolumeMute",VolumeLowAudioIcon:"IconVolumeLow",VolumeMediumAudioIcon:"IconVolumeMedium",VolumeHighAudioIcon:"IconAnimFxMediaAudio",VolumeAudioIconSize:"fontIconSize20x20",ConsumptionWorldSwitchIcon:"IconConsumptionWorldSwitch",ConsumptionWorldSwitchIconSize:"fontIconSize20x20",ConsumptionSettingsIcon:"IconGear",ConsumptionSettingsIconSize:"fontIconSize20x20",AutoplayResumeIcon:"IconPlay",AutoplayResumeIconSize:"fontIconSize20x20",AutoplayPauseIcon:"IconPause",AutoplayPauseIconSize:"fontIconSize20x20",AutoplayStopIcon:"IconStop",AutoplayStopIconSize:"fontIconSize20x20",AutoplaySettingsIcon:"IconGear",AutoplaySettingsIconSize:"fontIconSize20x20",ClosedCaptionIcon:"IconClosedCaption",ClosedCaptionIconSize:"fontIconSize20x20",ChunkedScrollerIconSize:"fontIconSize24x24",AddContentCloseIcon:"IconCancelGlyph",AddContentCloseIconSize:"fontIconSize20x20",AddContentCloseLegalIcon:"IconCancelGlyph",AddContentCloseLegalIconSize:"fontIconSize13x13",AddContentDocumentIconSize:"fontIconSize32x32",AddContentWordIcon:"IconSaveAsWordDocx",AddContentPowerPointIcon:"IconSaveAsPowerPointPptx",AddContentExcelIcon:"IconSaveAsExcelXlsx",AddContentPDFIcon:"IconPdfFile",AddContentDefaultDocumentIcon:"IconHtmlEmbed",AddContentReportButton:"IconWarning_MessageBar",AddContentReportButtonSize:"reportButtonIconSize",TwitterIconSmall:"IconShareOnTwitter",TwitterIconSmallSize:"fontIconSize16x16",VideoIcon:"IconInsertMovieFromFile",VideoIconSize:"fontIconSize24x24",VideoSocketIconSize:"fontIconSize32x32",LivingImageIcon:"IconLivingImage",LivingImageIconSize:"fontIconSize24x24",WikipediaWIcon:"IconWikipediaIndicator",WikipediaWIconSize:"fontIconSize16x16",BingbIcon:"IconSourceIcon_Bing",BingbIconSize:"fontIconSize16x16",AddSourceOptionIconSize:"fontIconSize20x20",MyDeviceOptionIconSize:"fontIconSize20x20",SourceOptionIconSize:"fontIconSize20x20",SourceSelectorIcon:"IconDownChevron",SourceSelectorIconSize:"fontIconSize20x20",CardDeckOpenAndCloseIcon:"IconLeftChevron",CardDeckOpenAndCloseIconSize:"fontIconSize32x32",CardDeckCoAuthorPresenceIcon:"IconSharingSet_NumberActivelySharing_Glyph",CardDeckCoAuthorPresenceIconSize:"fontIconSize20x20",CardDeckMenuHeaderIcon:"IconAddHeader",CardDeckMenuHeaderIconSize:"fontIconSize20x20",CardDeckMenuLinkIcon:"IconShareasLink",CardDeckMenuLinkIconSize:"fontIconSize20x20",CardDeckMenuBulletsIcon:"IconBullets",CardDeckMenuBulletsIconSize:"fontIconSize20x20",CardDeckMenuBulletsRtlIcon:"IconBulletsRTL",CardDeckMenuBulletsRtlIconSize:"fontIconSize20x20",CardDeckMenuNumbersIcon:"IconNumbering",CardDeckMenuNumbersIconSize:"fontIconSize20x20",CardDeckMenuNumbersRtlIcon:"IconNumberingRTL",CardDeckMenuNumbersRtlIconSize:"fontIconSize20x20",CardDeckMenuLeftToRightIcon:"IconTextDirectionLeftToRight",CardDeckMenuLeftToRightIconSize:"fontIconSize20x20",CardDeckMenuRightToLeftIcon:"IconTextDirectionRightToLeft",CardDeckMenuRightToLeftIconSize:"fontIconSize20x20",CardMenuPromoteIcon:"IconLeftChevron",CardMenuPromoteIconSize:"fontIconSize20x20",CardMenuDemoteIcon:"IconRightChevron",CardMenuDemoteIconSize:"fontIconSize20x20",CardMenuDeleteIcon:"IconDeleteCard",CardMenuDeleteIconSize:"fontIconSize20x20",CardMenuGroupIcon:"IconGroupCommand",CardMenuGroupIconSize:"fontIconSize20x20",CardMenuGroupTypeIcon:"IconGroupType",CardMenuGroupTypeIconSize:"fontIconSize20x20",CardMenuUngroupIcon:"IconUngroup",CardMenuUngroupIconSize:"fontIconSize20x20",CardMenuOptionsIcon:"IconPaintbrush",CardMenuOptionsIconSize:"fontIconSize20x20",CardMenuFocusIcon:"IconFocusPoints",CardMenuFocusIconSize:"fontIconSize20x20",CardMenuAudioRecordIcon:"IconInsertaudio",CardMenuAudioRecordIconSize:"fontIconSize20x20",EmphasizeWhiteIcon:"Icon13_16_N",EmphasizeWhiteIconSize:"fontIconSize20x20",CardMenuOverflowIcon:"IconHintBarEllipses",CardMenuOverflowIconSize:"fontIconSize20x20",CardMenuPurchaseIcon:"IconBuyImage",CardMenuPurchaseIconSize:"fontIconSize24x24",CardDeckGrabHandlesIcon:"IconCardHandle",CardDeckGrabHandlesIconSize:"fontIconSize20x20",CardProgressIconSize:"fontIconSize20x20",CardProgressPauseIcon:"IconPause",CardProgressPlayIcon:"IconPlay",CardProgressRetryIcon:"IconRetryTransfer",CardProgressCloseIcon:"IconCancelGlyph",CardOptionIconSize:"fontIconSize20x20",PlaceholderIconSize:"fontIconSize24x24",ChartCardPlaceholderIcon:"IconChartCard",TweetPlaceholderIcon:"IconShareOnTwitter",ImagePlaceholderIcon:"IconAddMediaCard",VideoPlaceholderIcon:"IconInsertMovieFromFile",AudioPlaceholderIcon:"IconAnimFxMediaAudio",ContentPlaceholderIcon:"Iconplussignglyph",EmbedPlaceholderIconSize:"fontIconSize24x24",AudioIcon:"IconAnimFxMediaAudio",AudioIconSize:"fontIconSize24x24",JackUploadIcon:"IconUploadMedia",JackAddCamera:"IconCamera",JackAudioRecord:"IconInsertaudio",JackDiamondIcon:"IconJackMenuPlus",JackDiamondIconSize:"fontIconSize12x12",CardTextIcon:"IconAddTextCard",CardTextIconSize:"fontIconSize24x24",CardHeaderIcon:"IconAddHeader",CardHeaderIconSize:"fontIconSize24x24",CardSubheaderIcon:"IconSubhead",CardImageIcon:"IconAddMediaCard",CardVideoIcon:"IconInsertMovieFromFile",CardTweetIcon:"IconShareOnTwitter",CardAudioIcon:"IconAnimFxMediaAudio",CardEmbedIcon:"IconHtmlEmbed",CardChartIcon:"IconChartCard",CardGroupIcon:"IconGroupCard",CardStackIcon:"IconStackCard",CardComparisonIcon:"IconComparisonCard",CardSlideshowIcon:"IconSlideshowCard",CardUniformGridIcon:"IconGridCard",CardWordIcon:"IconSaveAsWordDocxWhite",CardPowerPointIcon:"IconSaveAsPowerPointPptxWhite",CardExcelIcon:"IconSaveAsExcelXlsxWhite",CollapseIcon:"IconCommentCollapse",ComparisonSlider:"IconComparisonSlider",ExpandIcon:"IconCommentExpand",ExpandIconSize:"fontIconSize16x16",PopularityMetricIcon:"IconChart",PopularityMetricIconSize:"fontIconSize20x20",RecordingDialogCloseIcon:"IconCancelGlyph",RecordingDialogCloseIconSize:"fontIconSize20x20",RecordingDialogStopButtonIcon:"IconCheckboxUnchecked",RecordingDialogStopButtonIconSize:"fontIconSize16x16",RecordingDialogPauseButtonIcon:"IconPause",RecordingDialogPauseButtonIconSize:"fontIconSize20x20",RecordingDialogAddToSwayButtonIcon:"IconCommonControlCheckboxCheck",RecordingDialogAddToSwayButtonIconSize:"fontIconSize20x20",RecordingDialogReRecordButtonIcon:"IconInsertaudio",RecordingDialogReRecordButtonIconSize:"fontIconSize20x20",RecordingDialogDeleteButtonIcon:"IconTrashCan",RecordingDialogDeleteButtonIconSize:"fontIconSize20x20",CardCopiedIcon:"IconCopy",CardCopiedIconSize:"fontIconSize20x20",CopyLinkContextIcon:"IconShareasLink",CopyLinkContextIconSize:"fontIconSize20x20",DeleteContextIcon:"IconDeleteCard",DeleteContextIconSize:"fontIconSize20x20",EditContextIcon:"IconEditGeneric",EditContextIconSize:"fontIconSize20x20",FocusPointsContextIcon:"IconFocusPoints",FocusPointsContextIconSize:"fontIconSize20x20",EmphasisIconSize:"fontIconSize20x20",EmphasisVeryIcon:"IconIntense",EmphasisMoreIcon:"IconModerate",EmphasisNoneIcon:"IconSubtle",OriginalSizeIcon:"IconOriginalSize",PurchaseContextIcon:"IconBuyImage",PurchaseContextIconSize:"fontIconSize20x20",CloseCalloutIcon:"IconCancelGlyph",CloseCalloutButtonIconSize:"fontIconSize20x20",DigitalPrintCalloutShareIcon:"IconShareGlyph",DigitalPrintCalloutShareIconSize:"fontIconSize36x36",DigitalPrintCalloutEditIcon:"IconEditGeneric",DigitalPrintCalloutEditIconSize:"fontIconSize36x36",StarIcon:"IconStar",StarIconSize:"fontIconSize24x24",SearchOptionsIcon:"IconGear",SearchOptionsIconSize:"fontIconSize16x16",BrowseIssuesIcon:"IconRightChevron",BrowseIssuesIconSize:"fontIconSize24x24",NoIssueCheckmarkIcon:"IconCommonControlCheckboxCheck",NoIssueCheckmarkIconSize:"fontIconSize20x20",NextIssueIcon:"IconRightChevron",NextIssueIconSize:"fontIconSize24x24",PreviousIssueIcon:"IconLeftChevron",PreviousIssueIconSize:"fontIconSize24x24",ToCViewOpenIcon:"IconTableofContents",ToCViewOpenIconSize:"fontIconSize24x24",ToCViewHomeIcon:"IconHome",ToCViewHomeIconSize:"fontIconSizeDynamic",ToCViewLeftPaddleIcon:"IconLeftChevron",ToCViewLeftPaddleIconSize:"fontIconSizeDynamic",ToCViewRightPaddleIcon:"IconRightChevron",ToCViewRightPaddleIconSize:"fontIconSizeDynamic",WhatsNewViewCountIcon:"IconViewCount",WhatsNewViewCountIconSize:"fontIconSize32x32",ExportQuestionnaireCloseIcon:"IconCancelGlyph",ExportQuestionnaireCloseIconSize:"fontIconSize20x20",PrintIcon:"IconPrint",PrintIconSize:"fontIconSize32x32",ExportIcon:"IconExportFile",ExportIconSize:"fontIconSize32x32",SwayBarDesignIcon:"IconChartChangeColors",SwayBarIconSize:"fontIconSize17x17"},FontLoadTest;!function(t){function e(t,e,r,s,l){if(i[t])return i[t];i[t]=TDB.watchableTag(596477202,null,n.Testing);var u=new a(t,e),c=0,d=0,p=function(){c++,u.isLoaded()?(StoryLog.StructuredTraceTag(596477203,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Loading of font succeeded.",{fontFamily:t,succeedAfterFail:(d>0).toString()}),u.dispose(),TDB.applyUpdate(function(){i[t].setValue(n.Loaded)},TDB.Justification.TextMeasurement)):c>10*r?i[t].getValue()==n.FailedAndTesting?++d>10*s?(l&&o.NotificationBarViewModel.getNotificationBar(l).addNotification({messages:[{text:Resources.FontLoadErrorMessage}],notificationSource:o.NotificationSource.FontLoadError,notificationType:o.NotificationType.Warning,showInConsumptionView:!0},!0,!0),StoryLog.TraceTag(596477204,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"Loading of font completely failed. Giving up. Font: "+t),u.dispose(),TDB.applyUpdate(function(){i[t].setValue(n.Failed)},TDB.Justification.TextMeasurement)):platform.setTimeout(p,100):(StoryLog.TraceTag(596477205,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"Loading of font failed. Font: "+t),TDB.applyUpdate(function(){i[t].setValue(n.FailedAndTesting)},TDB.Justification.TextMeasurement),s>0?platform.setTimeout(p,100):u.dispose()):platform.setTimeout(p,100)};return p(),i[t]}var n,o=StoryApp.View.ViewElements;!function(t){t[t.Testing=0]="Testing",t[t.FailedAndTesting=1]="FailedAndTesting",t[t.Failed=2]="Failed",t[t.Loaded=3]="Loaded"}(n=t.FontLoadState||(t.FontLoadState={}));var i={};t.registerCustomFont=e;var r=function(){function t(t,e,n){this.testSpan=t,this.initialWidth=e,this.initialHeight=n}return t}(),a=function(){function t(e,n){this.testSpans=[];for(var o=t.fontFamilies.length,i=0;i<o;i++){var a=this.createSpan(t.fontFamilies[i],n);document.body.appendChild(a),this.testSpans.push(new r(a,a.clientWidth,a.clientHeight)),a.style.fontFamily=e+(""!==t.fontFamilies[i]?",":"")+t.fontFamilies[i]}}return t.prototype.isLoaded=function(){for(var e=t.fontFamilies.length,n=0;n<e;n++)if(this.testSpans[n].initialWidth!==this.testSpans[n].testSpan.clientWidth||this.testSpans[n].initialHeight!==this.testSpans[n].testSpan.clientHeight)return!0;return!1},t.prototype.dispose=function(){for(var t=this.testSpans.length,e=0;e<t;e++)this.testSpans[e].testSpan.parentNode&&this.testSpans[e].testSpan.parentNode===document.body&&document.body.removeChild(this.testSpans[e].testSpan)},t.prototype.createSpan=function(t,e){var n=document.createElement("span");return n.textContent=e,n.style.fontFamily=t,n.style.position="absolute",n.style.top="-10000px",n.style.visibility="hidden",n.style.fontSize="250px",n.style.fontVariant="normal",n.style.fontWeight="normal",n.style.letterSpacing="0px",n},t.fontFamilies=["Arial,Helvetica,sans-serif","'Courier New', Courier, monospace"],t}()}(FontLoadTest||(FontLoadTest={}));var StoryApp;!function(t){!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.addHandler=function(t,e,o){var i=new n(this,t,e,o);return this.addResource(i),i},e.prototype.fire=function(t){this.resources&&this.resources.forEach(function(e){return e.fire(t)})},e}(DisposableHolder);t.EventSource=e;var n=function(){function t(t,e,n,o){this.event=t,this.parent=e,this.context=n,this.handler=o,this.parent&&this.parent.addResource(this)}return t.prototype.fire=function(t){this.handler&&this.handler.call(this.context,t)},t.prototype.dispose=function(){this.event&&this.event.removeResource(this),this.parent&&this.parent.removeResource(this),this.event=null,this.context=null,this.handler=null,this.parent=null},t}();t.EventRegistration=n}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var FontIconsMapping={IconHintBarEllipses:["IconHintBarEllipsesLayer1"],IconDownChevron:["IconDownChevronLayer1"],IconBackChevron:["IconBackChevronLayer1"],IconSharingSet_Start_Glyph:["IconSharingSet_Start_GlyphLayer1"],IconShareGlyph:["IconShareGlyphLayer1"],IconSharingSet_NumberActivelySharing_Glyph:["IconSharingSet_NumberActivelySharing_GlyphLayer1"],IconOneDriveLogoContextMenu:["IconOneDriveLogoContextMenuLayer1"],IconCancelGlyph:["IconCancelGlyphLayer1"],IconUploadMedia:["IconUploadMediaLayer1"],Iconsearch:["IconsearchLayer1"],IconOneNote:["IconOneNoteLayer1"],IconRightChevron:["IconRightChevronLayer1"],IconUndoQuickCommand_Glyph:["IconUndoQuickCommand_GlyphLayer1"],IconRedoQuickCommand_Glyph:["IconRedoQuickCommand_GlyphLayer1"],IconHamburger:["IconHamburgerLayer1"],IconEnterFullscreenHover:["IconEnterFullscreenHoverLayer1"],IconExitFullscreenHover:["IconExitFullscreenHoverLayer1"],IconSaveAsWordDocx:["IconSaveAsWordDocxLayer1","IconSaveAsWordDocxLayer2","IconSaveAsWordDocxLayer3","IconSaveAsWordDocxLayer4","IconSaveAsWordDocxLayer5"],IconSaveAsPowerPointPptx:["IconSaveAsPowerPointPptxLayer1","IconSaveAsPowerPointPptxLayer2","IconSaveAsPowerPointPptxLayer3","IconSaveAsPowerPointPptxLayer4","IconSaveAsPowerPointPptxLayer5","IconSaveAsPowerPointPptxLayer6"],IconSaveAsExcelXlsx:["IconSaveAsExcelXlsxLayer1","IconSaveAsExcelXlsxLayer2","IconSaveAsExcelXlsxLayer3","IconSaveAsExcelXlsxLayer4","IconSaveAsExcelXlsxLayer5","IconSaveAsExcelXlsxLayer6"],Icon23_16_N:["Icon23_16_NLayer1"],IconAddHeader:["IconAddHeaderLayer1"],IconAddMediaCard:["IconAddMediaCardLayer1"],IconAddTextCard:["IconAddTextCardLayer1"],IconBuildPresentation:["IconBuildPresentationLayer1"],IconBullets:["IconBulletsLayer1"],IconCamera:["IconCameraLayer1"],IconCardHandle:["IconCardHandleLayer1"],IconChartCard:["IconChartCardLayer1"],IconChartChangeColors:["IconChartChangeColorsLayer1"],IconComparisonCard:["IconComparisonCardLayer1"],IconCreateNewsletter:["IconCreateNewsletterLayer1"],IconCrop:["IconCropLayer1"],IconDeleteCard:["IconDeleteCardLayer1"],IconDoughboy:["IconDoughboyLayer1","IconDoughboyLayer2"],IconDownChevronLarge:["IconDownChevronLargeLayer1"],IconDuplicateSway:["IconDuplicateSwayLayer1"],IconEditGeneric:["IconEditGenericLayer1"],IconExtraSmall:["IconExtraSmallLayer1"],IconFocusPoints:["IconFocusPointsLayer1"],IconGraph:["IconGraphLayer1"],IconGridCard:["IconGridCardLayer1"],IconGroupCard:["IconGroupCardLayer1"],IconGroupCommand:["IconGroupCommandLayer1"],IconGroupType:["IconGroupTypeLayer1"],IconHtmlEmbed:["IconHtmlEmbedLayer1"],IconInsertMenu:["IconInsertMenuLayer1"],IconInsertPictureSimple:["IconInsertPictureSimpleLayer1"],IconIntense:["IconIntenseLayer1"],IconMakeTutorial:["IconMakeTutorialLayer1"],IconModerate:["IconModerateLayer1"],IconMoreShareThisOptions:["IconMoreShareThisOptionsLayer1","IconMoreShareThisOptionsLayer2"],IconNavigateToTopCircle:["IconNavigateToTopCircleLayer1"],IconNumbering:["IconNumberingLayer1"],IconOfficeAppSwitcher:["IconOfficeAppSwitcherLayer1"],IconPaintbrush:["IconPaintbrushLayer1"],IconPause:["IconPauseLayer1"],IconPdfFile:["IconPdfFileLayer1","IconPdfFileLayer2","IconPdfFileLayer3"],IconPlay:["IconPlayLayer1"],Iconplussignglyph:["IconplussignglyphLayer1"],IconRemix:["IconRemixLayer1"],IconRemoveImage:["IconRemoveImageLayer1"],IconShareasLink:["IconShareasLinkLayer1"],IconShareByEmail:["IconShareByEmailLayer1","IconShareByEmailLayer2"],IconShareOnFacebook:["IconShareOnFacebookLayer1","IconShareOnFacebookLayer2"],IconShareOnTwitter:["IconShareOnTwitterLayer1"],IconShareToBlogger:["IconShareToBloggerLayer1","IconShareToBloggerLayer2"],IconShareToDocs:["IconShareToDocsLayer1","IconShareToDocsLayer2","IconShareToDocsLayer3","IconShareToDocsLayer4"],IconShareToGooglePlus:["IconShareToGooglePlusLayer1"],IconShareToLinkedIn:["IconShareToLinkedInLayer1","IconShareToLinkedInLayer2"],IconShareToPinterest:["IconShareToPinterestLayer1","IconShareToPinterestLayer2"],IconShareToReddit:["IconShareToRedditLayer1","IconShareToRedditLayer2","IconShareToRedditLayer3"],IconShareToTumblr:["IconShareToTumblrLayer1","IconShareToTumblrLayer2"],IconShareToYammer:["IconShareToYammerLayer1"],IconShareVacation:["IconShareVacationLayer1"],IconShowcase:["IconShowcaseLayer1"],IconSlideshowCard:["IconSlideshowCardLayer1"],IconSourceIcon_Flikr:["IconSourceIcon_FlikrLayer1","IconSourceIcon_FlikrLayer2"],IconSourceIcon_Pichit:["IconSourceIcon_PichitLayer1"],IconLeftChevron:["IconLeftChevronLayer1"],IconSubtle:["IconSubtleLayer1"],IconSyncNowQuickCommand_Glyph:["IconSyncNowQuickCommand_GlyphLayer1"],IconTutorialVideos:["IconTutorialVideosLayer1"],IconUngroup:["IconUngroupLayer1"],IconVideoCard:["IconVideoCardLayer1"],IconWikipediaIndicator:["IconWikipediaIndicatorLayer1"],Icon13_16_N:["Icon13_16_NLayer1"],IconTrashCan:["IconTrashCanLayer1"],IconSendAFrown:["IconSendAFrownLayer1"],IconStackCard:["IconStackCardLayer1"],IconAnimFxMediaAudio:["IconAnimFxMediaAudioLayer1"],IconFollowBlog:["IconFollowBlogLayer1"],IconGear:["IconGearLayer1"],IconInsertMovieFromFile:["IconInsertMovieFromFileLayer1"],IconRetryTransfer:["IconRetryTransferLayer1"],IconOfficeAssistant:["IconOfficeAssistantLayer1"],IconSendASmileQuickCommand:["IconSendASmileQuickCommandLayer1"],IconOpenJackMenu:["IconOpenJackMenuLayer1"],IconChangePicture:["IconChangePictureLayer1"],IconCardCaption:["IconCardCaptionLayer1","IconCardCaptionLayer2","IconCardCaptionLayer3"],IconOpen:["IconOpenLayer1"],IconCommentCollapse:["IconCommentCollapseLayer1"],IconCommentExpand:["IconCommentExpandLayer1"],IconLogo_Sway:["IconLogo_SwayLayer1"],IconLogoSwayTeal:["IconLogoSwayTealLayer1"],IconPeopleOnly:["IconPeopleOnlyLayer1"],IconSourceIcon_Bing:["IconSourceIcon_BingLayer1"],IconSourceIcon_YouTube:["IconSourceIcon_YouTubeLayer1"],IconInfo:["IconInfoLayer1"],Iconcheckmarkglyph:["IconcheckmarkglyphLayer1"],IconCheckbox:["IconCheckboxLayer1"],IconCheckboxUnchecked:["IconCheckboxUncheckedLayer1"],IconLargeChevronLeft:["IconLargeChevronLeftLayer1"],IconLargeChevronRight:["IconLargeChevronRightLayer1"],IconClose:["IconCloseLayer1"],IconOrgIDBadgeWhite:["IconOrgIDBadgeWhiteLayer1"],IconOriginalSize:["IconOriginalSizeLayer1","IconOriginalSizeLayer2"],IconSaveAsExcelXlsxWhite:["IconSaveAsExcelXlsxWhiteLayer1"],IconSaveAsPowerPointPptxWhite:["IconSaveAsPowerPointPptxWhiteLayer1"],IconSaveAsWordDocxWhite:["IconSaveAsWordDocxWhiteLayer1"],IconLivingImage:["IconLivingImageLayer1"],IconMicrosoftLogoWhite:["IconMicrosoftLogoWhiteLayer1"],IconShutterstock:["IconShutterstockLayer1","IconShutterstockLayer2"],IconBuyImage:["IconBuyImageLayer1","IconBuyImageLayer2"],IconStarFilled:["IconStarFilledLayer1"],IconStar:["IconStarLayer1","IconStarLayer2"],IconPlayVideoWhite:["IconPlayVideoWhiteLayer1"],IconComparisonSlider:["IconComparisonSliderLayer1"],IconNoSignal:["IconNoSignalLayer1","IconNoSignalLayer2","IconNoSignalLayer3"],IconSourceIcon_Delve:["IconSourceIcon_DelveLayer1","IconSourceIcon_DelveLayer2","IconSourceIcon_DelveLayer3","IconSourceIcon_DelveLayer4"],IconSourceIcon_O365Video:["IconSourceIcon_O365VideoLayer1","IconSourceIcon_O365VideoLayer2","IconSourceIcon_O365VideoLayer3","IconSourceIcon_O365VideoLayer4","IconSourceIcon_O365VideoLayer5"],IconTable:["IconTableLayer1","IconTableLayer2","IconTableLayer3","IconTableLayer4"],IconConsumptionWorldSwitch:["IconConsumptionWorldSwitchLayer1","IconConsumptionWorldSwitchLayer2","IconConsumptionWorldSwitchLayer3","IconConsumptionWorldSwitchLayer4"],IconCommonControlCheckboxBorder:["IconCommonControlCheckboxBorderLayer1"],IconCommonControlCheckboxCheck:["IconCommonControlCheckboxCheckLayer1"],IconCommonControlCheckboxFill:["IconCommonControlCheckboxFillLayer1"],IconCommonControlRadioButtonBorder:["IconCommonControlRadioButtonBorderLayer1"],IconCommonControlRadioButtonCircle:["IconCommonControlRadioButtonCircleLayer1"],IconCommonControlRadioButtonFill:["IconCommonControlRadioButtonFillLayer1"],IconChart:["IconChartLayer1"],IconPlatformButtoniPhone:["IconPlatformButtoniPhoneLayer1","IconPlatformButtoniPhoneLayer2"],IconPlatformButtonWeb:["IconPlatformButtonWebLayer1","IconPlatformButtonWebLayer2"],IconPlatformButtonWindows:["IconPlatformButtonWindowsLayer1","IconPlatformButtonWindowsLayer2"],IconPlatformButtoniPad:["IconPlatformButtoniPadLayer1","IconPlatformButtoniPadLayer2"],IconPlatformButtoniOS:["IconPlatformButtoniOSLayer1","IconPlatformButtoniOSLayer2"],IconForkKnife:["IconForkKnifeLayer1","IconForkKnifeLayer2"],IconPlane:["IconPlaneLayer1","IconPlaneLayer2"],IconNavLinkVisibleGlyph:["IconNavLinkVisibleGlyphLayer1"],IconBulletsRTL:["IconBulletsRTLLayer1","IconBulletsRTLLayer2"],IconNumberingRTL:["IconNumberingRTLLayer1","IconNumberingRTLLayer2"],IconTextDirectionRightToLeft:["IconTextDirectionRightToLeftLayer1","IconTextDirectionRightToLeftLayer2"],IconTextDirectionLeftToRight:["IconTextDirectionLeftToRightLayer1","IconTextDirectionLeftToRightLayer2"],IconUpChevronLarge:["IconUpChevronLargeLayer1"],IconDocsLogoWhite:["IconDocsLogoWhiteLayer1"],IconChartTypeParentBarChart:["IconChartTypeParentBarChartLayer1","IconChartTypeParentBarChartLayer2","IconChartTypeParentBarChartLayer3"],IconChartTypeParentColumnChart:["IconChartTypeParentColumnChartLayer1","IconChartTypeParentColumnChartLayer2","IconChartTypeParentColumnChartLayer3"],IconChartTypePercentStackedColumn:["IconChartTypePercentStackedColumnLayer1","IconChartTypePercentStackedColumnLayer2","IconChartTypePercentStackedColumnLayer3","IconChartTypePercentStackedColumnLayer4","IconChartTypePercentStackedColumnLayer5","IconChartTypePercentStackedColumnLayer6"],IconChartTypePercentStackedBar:["IconChartTypePercentStackedBarLayer1","IconChartTypePercentStackedBarLayer2","IconChartTypePercentStackedBarLayer3","IconChartTypePercentStackedBarLayer4","IconChartTypePercentStackedBarLayer5","IconChartTypePercentStackedBarLayer6"],IconChartTypeParentAreaChart:["IconChartTypeParentAreaChartLayer1","IconChartTypeParentAreaChartLayer2","IconChartTypeParentAreaChartLayer3"],IconChartTypeParentPieChart:["IconChartTypeParentPieChartLayer1","IconChartTypeParentPieChartLayer2","IconChartTypeParentPieChartLayer3"],IconChartTypeDoughnut:["IconChartTypeDoughnutLayer1","IconChartTypeDoughnutLayer2","IconChartTypeDoughnutLayer3"],IconChartTypeLine:["IconChartTypeLineLayer1","IconChartTypeLineLayer2"],IconChartTypePercentStackedArea:["IconChartTypePercentStackedAreaLayer1","IconChartTypePercentStackedAreaLayer2","IconChartTypePercentStackedAreaLayer3"],IconDIYProject:["IconDIYProjectLayer1","IconDIYProjectLayer2"],IconPresentationTemplate:["IconPresentationTemplateLayer1","IconPresentationTemplateLayer2","IconPresentationTemplateLayer3"],IconStudentPaper:["IconStudentPaperLayer1","IconStudentPaperLayer2","IconStudentPaperLayer3","IconStudentPaperLayer4"],IconResearchProject:["IconResearchProjectLayer1","IconResearchProjectLayer2"],IconPortfolioTemplate:["IconPortfolioTemplateLayer1","IconPortfolioTemplateLayer2","IconPortfolioTemplateLayer3"],IconResumeTemplate:["IconResumeTemplateLayer1","IconResumeTemplateLayer2","IconResumeTemplateLayer3"],IconVacation:["IconVacationLayer1","IconVacationLayer2"],IconRecipe:["IconRecipeLayer1","IconRecipeLayer2"],IconHome:["IconHomeLayer1","IconHomeLayer2"],IconSlideSorterView:["IconSlideSorterViewLayer1"],IconBlogTemplate:["IconBlogTemplateLayer1","IconBlogTemplateLayer2","IconBlogTemplateLayer3"],IconArtificialIntelligence:["IconArtificialIntelligenceLayer1","IconArtificialIntelligenceLayer2"],IconVolumeLow:["IconVolumeLowLayer1","IconVolumeLowLayer2"],IconVolumeMedium:["IconVolumeMediumLayer1","IconVolumeMediumLayer2"],IconVolumeMute:["IconVolumeMuteLayer1","IconVolumeMuteLayer2","IconVolumeMuteLayer3"],IconRestoreAll:["IconRestoreAllLayer1","IconRestoreAllLayer2","IconRestoreAllLayer3"],IconEmptyRecycleBin:["IconEmptyRecycleBinLayer1","IconEmptyRecycleBinLayer2","IconEmptyRecycleBinLayer3"],IconWarning_MessageBar:["IconWarning_MessageBarLayer1"],IconClosedCaption:["IconClosedCaptionLayer1"],IconTableofContents:["IconTableofContentsLayer1"],IconStop:["IconStopLayer1","IconStopLayer2"],IconInsertaudio:["IconInsertaudioLayer1","IconInsertaudioLayer2"],IconCopy:["IconCopyLayer1","IconCopyLayer2","IconCopyLayer3"],IconPictureStylesGallery:["IconPictureStylesGalleryLayer1","IconPictureStylesGalleryLayer2","IconPictureStylesGalleryLayer3","IconPictureStylesGalleryLayer4","IconPictureStylesGalleryLayer5","IconPictureStylesGalleryLayer6","IconPictureStylesGalleryLayer7","IconPictureStylesGalleryLayer8"],IconJotInsertAudioRecordingShort:["IconJotInsertAudioRecordingShortLayer1","IconJotInsertAudioRecordingShortLayer2","IconJotInsertAudioRecordingShortLayer3"],IconReplay:["IconReplayLayer1","IconReplayLayer2","IconReplayLayer3"],IconViewedDocument:["IconViewedDocumentLayer1","IconViewedDocumentLayer2","IconViewedDocumentLayer3","IconViewedDocumentLayer4"],IconJackMenuPlus:["IconJackMenuPlusLayer1"],IconSubhead:["IconSubheadLayer1","IconSubheadLayer2"],IconViewCount:["IconViewCountLayer1"],IconEnvelope:["IconEnvelopeLayer1","IconEnvelopeLayer2"],IconPrint:["IconPrintLayer1","IconPrintLayer2","IconPrintLayer3","IconPrintLayer4"],IconExportFile:["IconExportFileLayer1","IconExportFileLayer2","IconExportFileLayer3"],IconHorizontalLayout:["IconHorizontalLayoutLayer1","IconHorizontalLayoutLayer2","IconHorizontalLayoutLayer3","IconHorizontalLayoutLayer4","IconHorizontalLayoutLayer5"],IconColor:["IconColorLayer1","IconColorLayer2","IconColorLayer3","IconColorLayer4","IconColorLayer5","IconColorLayer6","IconColorLayer7"],IconAddMyBrand:["IconAddMyBrandLayer1","IconAddMyBrandLayer2","IconAddMyBrandLayer3","IconAddMyBrandLayer4","IconAddMyBrandLayer5"],IconAnalytics:["IconAnalyticsLayer1"],IconMobileDevices:["IconMobileDevicesLayer1"],IconLuggage:["IconLuggageLayer1","IconLuggageLayer2"],IconGlobe:["IconGlobeLayer1","IconGlobeLayer2"],IconAddAssignmentStage:["IconAddAssignmentStageLayer1","IconAddAssignmentStageLayer2","IconAddAssignmentStageLayer3","IconAddAssignmentStageLayer4"],IconPeopleWithExistingAccessPermissions:["IconPeopleWithExistingAccessPermissionsLayer1","IconPeopleWithExistingAccessPermissionsLayer2","IconPeopleWithExistingAccessPermissionsLayer3","IconPeopleWithExistingAccessPermissionsLayer4","IconPeopleWithExistingAccessPermissionsLayer5"],IconLanguageCommandsFlyoutAnchor:["IconLanguageCommandsFlyoutAnchorLayer1","IconLanguageCommandsFlyoutAnchorLayer2"]},StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(e,n){var o=t.call(this,e)||this;return o.components=n.components,o}return __extends(e,t),e.prototype.componentsArgs=function(){return this.components},e}(TDB.FocusableViewElement);t.CompositeVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=t.Common,o=function(t){function o(e,n){var o=t.call(this,e,{features:TDB.ControlSetFeatures.HorizontalList|TDB.ControlSetFeatures.TabInto|TDB.ControlSetFeatures.PreserveFocusContext|TDB.ControlSetFeatures.TabDisabled})||this;return o.entityPicker=e,o.args=n,o.model=n.model,o.entityPickerInputFocus=TDB.watchableTag(595981504,o,!1),o}return __extends(o,t),o.prototype.entityListArgs=function(t){var n={createEntityArgs:this.args.createSelectedEntity,tabIndex:0};return new TDB.ChildArgs(e.EntityListVE,n)},o.prototype.entityPickerInputArgs=function(){var t={cssClass:"entityPickerInput",onInput:this.args.onInput,description:Resources.SharingInvitePeopleDescription,placeholder:{watchable:TDB.watcherTag(595981505,this,this,this.calculatePlaceholderText)},handleKeyDown:this.handleKeyDown,context:this,tabIndex:1,domFocus:this.entityPickerInputFocus};return new TDB.ChildArgs(e.TextBoxVE,t)},o.prototype.calculatePlaceholderText=function(t){return 0==this.entityList.getItems(t).length?Resources.SharingInvitePeoplePlaceholder:""},o.prototype.ifSpinnerArgs=function(t){return this.model.getWatchedValue(t).state===e.EntityPickerModelState.Searching},o.prototype.waitingSpinnerAttrArgs=function(){return{src:n.UrlHelper.getInstance().getLoadingSpinnerUrl()}},o.prototype.getSelectedEntityItems=function(t){return this.entityList.getItems(t)},o.prototype.clearSelection=function(){this.entityList.clearList()},o.prototype.handleLeftKey=function(){if(0==this.entityPickerInput.getSelectionPositionStart()){var t=this.entityList.getFocusableChildren();t&&t.length>0&&t.last()instanceof TDB.Control&&t.last().activate()}},o.prototype.handleBackspaceKey=function(){if(0==this.entityPickerInput.getSelectionPositionStart()&&0==this.entityPickerInput.getSelectionPositionEnd()){var t=this.entityList.getFocusableChildren();return t&&t.length>0&&t.last()instanceof TDB.Control&&t.last().activate(),!0}return!1},o.prototype.removeEntity=function(t){this.entityList.removeEntity(t)},o.prototype.getInputValue=function(t){return this.entityPickerInput.getText(t)},o.prototype.addEntity=function(t){this.entityList.addEntity(t)},o.prototype.getGroupMembersAndRemoveGroup=function(t,e){this.removeEntity(e);for(var n=0;n<t.length;n++)this.addEntity(t[n]);this.clearSuggestedFlagsAndInputText()},o.prototype.mouseDown=function(t){return this.entityPickerInput.activate(),t.preventDefault(),t.stopPropagation(),TDB.EventPropagation.Bypass},o.prototype.addEntityAndClearText=function(t){this.addEntity(t),this.clearSuggestedFlagsAndInputText(),this.enter()},o.prototype.clearSuggestedFlagsAndInputText=function(){this.entityPicker.updateModel(e.EntityPickerModelState.Ready,[],!0),this.entityPickerInput.setText(""),this.args.onInput&&this.args.onInput(void 0)},o.prototype.addSelectedEntity=function(){var t=this.entityPicker.model.getValue().suggestedEntities.firstOrDefault(function(t){return t.selected.getValue()});t&&this.addEntityAndClearText(t)},o.prototype.getActivatableChildren=function(){var t=[];return(t=this.entityList.getActivatableChildren()).push(this.entityPickerInput),t},o.prototype.handleKeyDown=function(t){switch(t.keyCode){case KeyCodeType.LeftArrowKey:this.handleLeftKey();break;case KeyCodeType.DownArrowKey:if(this.entityPicker.getSuggestedList()&&this.entityPicker.getSuggestedList().areSuggestionsAvailable())return this.entityPicker.getSuggestedList().enter(),TDB.EventPropagation.PreventDefault}return TDB.EventPropagation.Bypass},o.prototype.isEntityPickerInputFocused=function(t){return this.entityPickerInputFocus.getWatchedValue(t)},o}(TDB.ControlSet);e.PeoplePickerSelectedResultsVEBase=o}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(e,n){var o=t.call(this,e,{features:TDB.ControlSetFeatures.VerticalList|TDB.ControlSetFeatures.TabInto|TDB.ControlSetFeatures.TabDisabled|TDB.ControlSetFeatures.Isolated|TDB.ControlSetFeatures.NoWrappingNavigation})||this;return o.entityPicker=e,o.args=n,o.model=n.model,o}return __extends(e,t),e.prototype.entitySuggestionsArgs=function(t){var e=this;return this.model.getWatchedValue(t).suggestedEntities.map(function(t){return e.args.createSuggestedEntity(t)})},e.prototype.keyDown=function(e){return e.keyCode===KeyCodeType.UpArrowKey&&this.entitySuggestions.length>0&&this.entitySuggestions[0].isActivated()?(this.entityPicker.getSelectedList().enter(),TDB.EventPropagation.Bypass):t.prototype.keyDown.call(this,e)},e.prototype.areSuggestionsAvailable=function(){return this.model.getValue().suggestedEntities.length>0},e}(TDB.ControlSet);t.PeoplePickerSuggestedResultsVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=t.Common,o=function(){function o(t,e,n,o){this.lookupId=t,this.storyTitle=e,this.onSaveAsTemplate=o,this.myStoriesUrl=n}return o.createAndShow=function(t,e,n,i){new o(t,e,n,i).show()},o.prototype.show=function(){var n=this,o={title:Resources.SaveAsTemplate,acceptButtonText:Resources.SaveAsTemplateDialogSaveButton,cancelButtonText:Resources.ButtonCancel,cancelButtonTooltip:Resources.ButtonCancel,initialValue:this.storyTitle,textInputDescription:Resources.SaveAsTemplateDialogDescription,textInputCss:"DuplicateStoryDialogTextInput",context:this,onAccept:function(t){var e=n.textEntryDialog.getContent();n.saveAsTemplate(e.getText())},onCancel:function(){t.View.Common.DialogManager.closeCurrentDialog()},allowEsc:!0,label:Resources.SaveAsTemplateNewNameInputLabel,textInputTooltip:Resources.SaveAsTemplateDialogTextboxTooltip,acceptButtonTooltip:Resources.SaveAsTemplateDialogSaveButton};this.textEntryDialog=e.TextInputDialog.createAndShow(o)},o.prototype.saveAsTemplate=function(n){var i=this;t.View.Common.DialogManager.closeCurrentDialog(),e.ProgressDialog.createAndShow(Resources.SaveAsTemplateDialogProgressTitle);var r={title:n,timezoneOffset:-(new Date).getTimezoneOffset(),isUserTemplate:!0};$.ajax(t.Common.UrlHelper.getInstance().duplicateStoryUrl(this.lookupId),{name:"DuplicatingStory",description:"Duplicating a story",type:"POST",data:JSON.stringify(r),contentType:t.RequestManager.JsonContentType,dataType:"json",timeout:o.timeout}).then(function(t){return i.onSaveAsTemplateSuccess()},function(t,e,o){return i.onSaveAsTemplateError(t,n)})},o.prototype.onSaveAsTemplateSuccess=function(){n.AppBarAction.getInstance().GoToMyStories()},o.prototype.onSaveAsTemplateError=function(e,n){var o=this;if(t.View.Common.DialogManager.closeCurrentDialog(),t.Identity.isPasswordRequiredError(e))t.View.ViewElements.PasswordEntryDialog.createAndShow(this.lookupId,function(){o.saveAsTemplate(n)},function(){t.View.Common.DialogManager.closeCurrentDialog()});else{var i={title:Resources.SaveAsTemplate,description:Resources.SaveAsTemplate,noFocus:!1,dialogType:t.View.ViewElements.DialogType.Info,lightDismiss:!0,messages:[Resources.SaveAsTemplateDialogGenericError],buttonsArgs:[{caption:{value:Resources.ButtonOK},isDefault:!0,dismissOnAction:!0}]};t.View.Common.DialogManager.createAndShow(i)}},o.timeout=3e5,o}();e.SaveAsTemplateDialog=o}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(){function t(){}return t}();t.ExportRequest=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){var n=function(){function n(){}return n.prototype.getAjaxSettings=function(n,o){return{url:e.UrlHelper.getInstance().joinUrl(n),data:JSON.stringify(o),cache:!1,dataType:"json",type:"POST",timeout:CommonSettings.LoadTimeoutMilliseconds,contentType:t.RequestManager.JsonContentType}},n.prototype.join=function(t,e,n){$.ajax(this.getAjaxSettings(t,e)).done(function(t){return n.resolve(t)}).fail(function(t,e,o){return n.reject(t,e,o)})},n}();e.AjaxJoiner=n}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){t.inAutomation=!1}(t.OM||(t.OM={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){var n=t.View.ViewElements,o=function(){function o(){}return o.buildCreateAndJoinRequest=function(t,e,n){return{renderingClientInfo:this.createRenderingClientInfo(),firstRun:this.isFirstRun(),returnPerformanceDetails:IsPerformanceModeOn,clientVersion:CommonSettings.LowWatermarkServiceVersion,worldOverride:t,styleOverride:e,enhancementId:n}},o.buildJoinStoryRequest=function(t,e,n){return{clientVersion:null!=t?t:CommonSettings.LowWatermarkServiceVersion,renderingClientInfo:e?e():this.createRenderingClientInfo(),returnPerformanceDetails:IsPerformanceModeOn,includeSettingsPackages:n}},o.buildGetStoryRequestData=function(n,o,i){return{clientDevice:CommonSettings.ClientDevice,width:n.toString(),height:o.toString(),isAccessibleMode:i,knownRenderModelKeys:[],inEmbedHostMode:t.Utilities.query.fetch(e.UrlHelper.URLParamHost)===e.UrlHelper.URLParamValueTrue,returnPerformanceDetails:IsPerformanceModeOn,isEmbedded:!1,countView:t.Utilities.query.fetch(e.UrlHelper.URLParamCountView).toLowerCase()!==e.UrlHelper.URLParamValueFalse}},o.isFirstRun=function(){var t=e.UrlHelper.getInstance().getParameterByName("firstRun",null,!0);return null!=t&&"true"===t.toLowerCase()},o.createRenderingClientInfo=function(){var t=e.Environment.getInstance().getWindowSize();return{clientDevice:CommonSettings.ClientDevice,viewportWidth:t.w,viewportHeight:t.h-UX.topBarHeight,editMode:!0,embedHostMode:EmbedHostType.none,accessible:e.UrlHelper.getInstance().isAccessibilityView(),viewOptionOverrides:null}},o.updatePersistentCommonSettings=function(t){CommonSettings.IsFirstRun=t.IsFirstRun,CommonSettings.ContextualHintData=t.ContextualHintData,CommonSettings.WhatsNewDialogVersion=t.WhatsNewDialogVersion},o.updateTransientCommonSettings=function(t){CommonSettings.Action=t.Action,CommonSettings.Controller=t.Controller,CommonSettings.IsTemplateSway=t.IsTemplateSway},o.processCreateAndJoinResponse=function(t,e){this.processSinglePageAppActionResponse(t.lookupId,t.settingsPackagesDictionary,!0,t.joinResponse,void 0,e)},o.processJoinResponse=function(t,e,n,o){this.processSinglePageAppActionResponse(t,e.settingsPackagesDictionary,!1,e,n,o)},o.processGetSettingsResponse=function(t,e,n,o){this.processSinglePageAppActionResponse(t,e,!1,void 0,n,o)},o.processSinglePageAppActionResponse=function(i,r,a,s,l,u){var c,d,p,g=r.StoryPageEditSettings;try{c=JSON.parse(r.CommonSettings),d=JSON.parse(r.StoryPageSettings),p=g?JSON.parse(g):void 0}catch(t){StoryLog.StructuredTraceTag(596464272,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.error,"Failed parsing SPA response",t)}if(o.versionMatch(c)&&d&&(!s||s.joined&&p)){var h=l||"",m={CommonSettings:c,StoryPageSettings:d,StoryPageEditSettings:p,StoryJoinResponse:s},y=t.Preload.driver;(t.Common.NavigationContext.InitialType!==t.Common.NavigationContextType.Story||t.Common.NavigationContext.IsConsumption)&&(y=t.Preload.differentialDriver),y.queueOnLoad().then(function(){t.RethrowLogger.logIfError(function(){t.View.Common.DialogManager.closeCurrentDialog(),e.NavigationContext.StoryPageInitialize(m,null,!1).then(function(){m.StoryJoinResponse=void 0;var n=m.StoryPageSettings.PageTitle?m.StoryPageSettings.PageTitle:Resources.ProductNameShort;HistoryManager.getHistoryManagerInstance().navigate(t.Common.UrlHelper.getInstance().viewUrl(i)+h,function(t,n){return e.NavigationContext.StoryPageInitialize(t,n,!0)},m,n)})})})}else{var f=t.Utilities.toEnum(s&&s.joinResult,StoryJoinResult);!a&&o.versionMatch(c)&&n.AuthorJoinFailDialog.shouldShow(f)?(o.hideLoadingBarrierAndDialog(),n.AuthorJoinFailDialog.createAndShow(i,f)):null!=u?u():(o.hideLoadingBarrierAndDialog(),o.showRefreshPageDialog())}},o.hideLoadingBarrierAndDialog=function(){UX.LoadingBarrier.hide(),t.View.Common.DialogManager.getInstance().closeCurrentDialog()},o.versionMatch=function(t){return t&&CommonSettings.LowWatermarkServiceVersion===t.LowWatermarkServiceVersion},o.showRefreshPageDialog=function(){var e={title:Resources.GenericErrorDialogTitle,description:Resources.GenericErrorDialogText,messages:[Resources.RefreshPageNotification],dialogLogMessage:"Refresh Page: reset required",dialogType:n.DialogType.Error,buttonsArgs:[{caption:{value:Resources.GenericErrorDialogButtonText},isDefault:!0,onAction:function(t,e){return window.location.reload()}}]};t.View.Common.DialogManager.createAndShow(e)},o.retrieveMyStoriesSettings=function(t){return CommonSettings.AuthoringFromLandingPageContextEnabled&&!1===this.myStoriesSettingsAvailable.getWatchedValue(t)&&!this.myStoriesSettingsRequestStarted&&(this.myStoriesSettingsRequestStarted=!0,this.doMyStoriesSettingsRequest(3)),this.myStoriesSettingsAvailable.getValue()},o.doMyStoriesSettingsRequest=function(e){var n=this;$.ajax(t.Common.UrlHelper.getInstance().getMyStoriesSettingsUrl(),{dataType:"json"}).then(function(t){window.MyStoriesSettings=t,TDB.applyUpdate(function(){return n.myStoriesSettingsAvailable.setValue(!0)})},function(t,o,i){var r={status:t.status,textStatus:o,errorThrown:i,retryCount:e};StoryLog.StructuredTraceTag(596465681,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Call to retrieveMyStoriesSettings has failed.",r),"timeout"===o&&e>0&&n.doMyStoriesSettingsRequest(e-1)})},o.myStoriesSettingsRequestStarted=!1,o.myStoriesSettingsAvailable=TDB.watchableTag(596465680,void 0,"object"==typeof window.MyStoriesSettings),o}();e.SinglePageAppHelper=o}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var FirstModel=function(){function t(){}return t.signalSuccessEvent=function(e){if(swayConsumptionFirstModel){swayConsumptionFirstModel.data=e;var n=document.createEvent("Event");n.initEvent(t.FirstModelReadyEventName,!0,!0),document.dispatchEvent(n)}},t.signalFailureEvent=function(e,n,o,i){if(StoryLog.StructuredTraceTag(596477056,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,i,{status:e.status,textStatus:n,errorThrown:o}),swayConsumptionFirstModel){swayConsumptionFirstModel.data=void 0,swayConsumptionFirstModel.height=void 0,swayConsumptionFirstModel.width=void 0;var r=document.createEvent("Event");r.initEvent(t.FirstModelFailedEventName,!0,!0),document.dispatchEvent(r)}},t.FirstModelReadyEventName="firstModelReady",t.FirstModelFailedEventName="firstModelFailed",t}(),StoryApp;!function(t){!function(e){var n=function(){function n(){this.createStoryDisabled=!1}return n.getInstance=function(){return n.instance||(n.instance=new n),n.instance},n.setInstance=function(t){n.instance=t},n.clearInstance=function(){n.instance=void 0},n.prototype.onLoadingStory=function(t,e,n,o,i,r){return StoryPerformance.PerformanceManager.getInstance().markUserAction("onLoadingStory"),!(CommonSettings.AuthoringFromLandingPageContextEnabled&&!i)||(e&&"Mobile"!==CommonSettings.ClientDevice?this.submitJoinStory(t,r):this.submitGetStory(t,o,r),!1)},n.prototype.loadStory=function(e,n,o,i,r){if(this.onLoadingStory(e,n,o,i,r)){var a=t.Common.UrlHelper.getInstance();t.Utilities.assignWindowLocation(n?a.viewUrl(e):a.playUrl(e))}},n.prototype.createStoryOrSignIn=function(n,o){var i=CommonSettings.IsAuthenticated&&e.Environment.getInstance().shouldShowAuthoringEntrypoints();StoryLog.StructuredTraceTag(596477024,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"CommonMain : createStoryOrSignIn",{CurrentPage:window.location.pathname,EntryPoint:n,IsAuthenticated:CommonSettings.IsAuthenticated.toString(),AnonUserId:CommonSettings.AnonUserId,CreatingStory:i.toString()});{if(!i)return CommonSettings.IsAuthenticated?void t.Utilities.assignWindowLocation(t.Common.UrlHelper.getInstance().mySwaysUrl()):void t.Identity.getActions().signIn(o);this.submitCreateStoryAsync(!1)}},n.prototype.submitCreateStoryAsync=function(n,o,i,r){var a=this,s=new DeferredTask;if(BRSDialog.showIfAuthoringDisabled())return Task.fromResult(!1);if(this.createStoryDisabled)return Task.fromResult(!1);if(!r&&CommonSettings.AuthoringFromLandingPageContextEnabled)return s=this.submitCreateAndJoinStory(n,o,i);StoryPerformance.PerformanceManager.getInstance().markUserAction("submitCreateStoryAsync"),this.createStoryDisabled=!0;var l=e.UrlHelper.getInstance().getLegacyCreateStoryUrl();Cookie.setPageRequestInfo(l);var u={type:"POST",dataType:"json",timeout:12e4,data:{returnPerformanceDetails:n,noRedirects:!0,worldOverride:o,styleOverride:i}},c=$.ajax(l,u);return Task.fromPromise(c).then(function(n){var o="",i=n.performanceMetrics;i&&(o+="?performanceMetrics="+i),t.Utilities.assignWindowLocation(e.UrlHelper.getInstance().viewUrl(n.id)+o),s.resolve(!0)},function(){a.createStoryDisabled=!1,a.showCreateSwayFailDialog(),s.resolve(!1)}),s},n.prototype.submitCreateAndJoinStory=function(t,n,o){var i=this;StoryPerformance.PerformanceManager.getInstance().markUserAction("submitCreateAndJoinStory"),UX.LoadingBarrier.show();var r=new DeferredTask,a=e.SinglePageAppHelper.buildCreateAndJoinRequest(n,o);return $.ajax(e.UrlHelper.getInstance().createAndJoinUrl(),{type:"POST",dataType:"json",data:JSON.stringify(a),processData:!1,contentType:!1}).then(function(a){e.SinglePageAppHelper.processCreateAndJoinResponse(a,function(){return i.submitCreateStoryAsync(t,n,o,!0)}),r.resolve(!0)},function(t,e,n){UX.LoadingBarrier.hide(),i.createStoryDisabled=!1,i.showCreateSwayFailDialog(),r.resolve(!1)}),r},n.prototype.submitJoinStory=function(n,o){var i=this;StoryPerformance.PerformanceManager.getInstance().markUserAction("submitJoinStory"),UX.LoadingBarrier.show();var r=new e.AjaxJoiner,a=$.Deferred();e.Environment.getInstance().retrieveOfflineState(n).then(function(s){var l=e.SinglePageAppHelper.buildJoinStoryRequest(void 0,void 0,!0);s&&(StoryLog.StructuredTraceTag(596459991,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Offline state is being uploaded",{offlineClientVersion:s.offlineClientVersion}),l.offlineState=s),r.join(n,l,a),a.then(function(t){s&&t&&(t.joined||t.offlineStateConflict)&&(StoryLog.StructuredTraceTag(596459992,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Offline state was uploaded successfully",{}),e.Environment.getInstance().deleteOfflineState(n)),e.SinglePageAppHelper.processJoinResponse(n,t,o,function(){return i.loadStory(n,!0,!0,!1,!0)})},function(r,a,l){var u={status:r.status,textStatus:a,errorThrown:l};StoryLog.StructuredTraceTag(596477025,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Call to JoinStory has failed.",u),UX.LoadingBarrier.hide(),s&&400==r.status&&(StoryLog.StructuredTraceTag(596459993,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Offline state was rejected",{}),e.Environment.getInstance().deleteOfflineState(n)),t.Identity.isPasswordRequiredError(r)?t.View.ViewElements.PasswordEntryDialog.createAndShow(n,function(){t.View.Common.DialogManager.closeCurrentDialog(),i.submitJoinStory(n,o)},function(){return t.View.Common.DialogManager.closeCurrentDialog()}):i.showOpenSwayErrorDialog(r,function(){return i.submitJoinStory(n,o)})})},function(t){var e={failureReasons:t};StoryLog.StructuredTraceTag(596459994,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Could not retrieve offline state from client.",e)})},n.prototype.submitGetStory=function(n,o,i){var r=this;StoryPerformance.PerformanceManager.getInstance().markUserAction("submitGetStory"),o=o||t.Utilities.query.fetch(e.UrlHelper.URLParamAccessible).toLowerCase()===e.UrlHelper.URLParamValueTrue,UX.LoadingBarrier.show();var a=e.Environment.getInstance().getWindowSize(),s=$.ajax({type:"POST",timeout:CommonSettings.LoadTimeoutMilliseconds,url:e.UrlHelper.getInstance().getStoryUrl(n,CommonSettings.LowWatermarkServiceVersion),data:e.SinglePageAppHelper.buildGetStoryRequestData(a.w,a.h,o),cache:!1,dataType:"json"});swayConsumptionFirstModel={xhr:s,width:a.w,height:a.h,data:void 0},s.then(function(t){return FirstModel.signalSuccessEvent(t)},function(t,e,n){return FirstModel.signalFailureEvent(t,e,n,"Call to GetStory has failed.")}),$.ajax({type:"POST",timeout:CommonSettings.LoadTimeoutMilliseconds,url:e.UrlHelper.getInstance().getStorySettingsUrl(n),data:{accessible:o,firstRun:t.Utilities.query.fetch(e.UrlHelper.URLParamFirstRun).toLowerCase()===e.UrlHelper.URLParamValueTrue}}).then(function(t){return e.SinglePageAppHelper.processGetSettingsResponse(n,t,i,function(){return r.loadStory(n,!1,!0,!1,!0)})},function(e,o,a){var s={status:e.status,textStatus:o,errorThrown:a};StoryLog.StructuredTraceTag(596477026,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Call to GetStory has failed.",s),UX.LoadingBarrier.hide(),t.Identity.isPasswordRequiredError(e)?t.View.ViewElements.PasswordEntryDialog.createAndShow(n,function(){t.View.Common.DialogManager.closeCurrentDialog(),r.submitGetStory(n,!1,i)},function(){return t.View.Common.DialogManager.closeCurrentDialog()}):r.showOpenSwayErrorDialog(e,function(){return r.submitGetStory(n,!1,i)})})},n.prototype.showOpenSwayErrorDialog=function(e,n){var o;o=!e||404!==e.status&&401!==e.status?{title:Resources.OpenSwayRetryDialogTitle,description:Resources.OpenSwayRetryDialogTitle,messages:[Resources.OpenSwayRetryDialogBody],dialogLogMessage:"Open Sway failed",dialogType:t.View.ViewElements.DialogType.Error,buttonsArgs:[{caption:{value:Resources.ButtonRetry},isDefault:!0,dismissOnAction:!0,onAction:n},{caption:{value:Resources.ButtonCancel},dismissOnAction:!0,isNeutralButton:!0}]}:{title:Resources.DeletedDialogTitle,description:Resources.DeletedDialogTitle,messages:[Resources.NativeDeletedDialogBody],dialogLogMessage:"Open Sway failed",dialogType:t.View.ViewElements.DialogType.Error,buttonsArgs:[{caption:{value:Resources.ButtonOK},isDefault:!0,dismissOnAction:!0,onAction:function(){return t.Common.AppBarAction.getInstance().GoToMyStories()}}]},t.View.Common.DialogManager.createAndShow(o)},n.prototype.showCreateSwayFailDialog=function(){var e={title:Resources.CreateSwayFailedTitle,description:Resources.CreateSwayFailedTitle,messages:[Resources.CreateSwayFailedText],dialogLogMessage:"Create Sway failed",dialogType:t.View.ViewElements.DialogType.Error,buttonsArgs:[{caption:{value:Resources.ButtonOK},isDefault:!0,dismissOnAction:!0}]};t.View.Common.DialogManager.createAndShow(e)},n.prototype.submitCreateStoryFromOffice=function(){BRSDialog.showIfAuthoringDisabled()||this.createStoryDisabled||document.getElementById("officeFileInput").click()},n.prototype.submitImportStoryRequest=function(){BRSDialog.showIfAuthoringDisabled()||$("#createNewFileToUpload").click()},n}();e.UserStories=n}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){var e=function(){function t(t){this.commonSettings=t,this.requestedFligths={}}return t.getInstance=function(){return t.instance||(t.instance=new t(CommonSettings)),t.instance},t.setInstance=function(e){t.instance=e},t.prototype.isInternalUser=function(){var t=this.commonSettings&&this.commonSettings.FlightSettings?this.commonSettings.FlightSettings:null;return t&&t.isInternal},t.prototype.isUserOnFlight=function(t){var e=!1,n="",o=this.commonSettings&&this.commonSettings.FlightSettings?this.commonSettings.FlightSettings:null;if(o&&(n=o.flightName))for(var i=n.split(";"),r=i.length,a=0;a<r;a++)if(i[a]==t){e=!0;break}return t in this.requestedFligths||(ActionLogger.RecordClientAction(new ClientAction.UserFlightAssignmentData(t,n,e)),this.requestedFligths[t]=!0),e},t.prototype.isEligibleForFirstClassEmbedCardExperiment=function(){return this.isUserOnFlight(FlightList.FirstClassEmbedCard1)&&!this.isUserOnFlight(FlightList.StoryAutomationFlight)&&this.commonSettings.FirstClassEmbedCardExperimentEnabled},t.prototype.getDisplayName=function(t){return this.commonSettings.DisplayName},t.prototype.getUserName=function(t){return this.commonSettings.DisplayName},t.prototype.getUserPicture=function(t){return""},t.prototype.getUserEmail=function(t){return this.commonSettings.EmailAddress},t.prototype.getUserProvider=function(e){return CommonSettings.IsAADUser?t.pvrAad:t.pvrLive},t.pvrLive="WindowsLiveId",t.pvrAad="OrgId",t}();t.UserState=e}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){function n(){return new o(CommonSettings)}e.environmentFactory=n;var o=function(){function n(n,o){void 0===o&&(o=!0);var i=this;this.resizeHandlers=[],this.beforeNavigationHandlers=[];var r=this.getWindowSizeFromDOM();this.windowWidth=TDB.watchableTag(596477057,this,r.w),this.windowHeight=TDB.watchableTag(596477058,this,r.h),this.availableBandwidth=0,this.commonSettings=n,this.clientOnline=TDB.watchableTag(596477059,this,o),this.clientOnlineChanged=new e.EventSource(null),this.loadHandler=t.Utilities.deferredEventHandler(function(){return i.handleLoad()}),addEventListener("load",this.loadHandler,!1),t.Utilities.onResize(this.handleResize,this),this.clientOnlineEventRegistrations=[]}return n.getInstance=function(){return n.instance||(n.instance=e.environmentFactory()),n.instance},n.setInstance=function(t){n.instance=t},n.clearInstance=function(){n.instance.removeLoadHandler(),n.instance.disposeAllIsClientOnlineRegistrations(),n.instance=void 0},n.prototype.getWindowSize=function(t){return{w:this.windowWidth.getWatchedValue(t),h:this.windowHeight.getWatchedValue(t)}},n.prototype.getWindowWidth=function(){return this.windowWidth},n.prototype.getWindowHeight=function(){return this.windowHeight},n.prototype.onResize=function(t,e,n){this.resizeHandlers.push({before:t,after:e,context:n})},n.prototype.removeLoadHandler=function(){removeEventListener("load",this.loadHandler)},n.prototype.removeResizeHandlerByContext=function(t){ArrayExtensions.removeFirstWhere(this.resizeHandlers,function(e){return e.context===t})},n.prototype.handleLoad=function(){this.setWindowSize(this.getWindowSizeFromDOM())},n.prototype.handleResize=function(){var t=this.getWindowSize(),e=this.getWindowSizeFromDOM(),n=this.resizeHandlers.map(function(n){return n.before.call(n.context,t,e)});this.setWindowSize(e),this.resizeHandlers.forEach(function(o,i){o.after.call(o.context,t,e,n[i])})},n.prototype.setWindowSize=function(t){var e=this;TDB.applyUpdate(function(){e.windowWidth.setValue(t.w),e.windowHeight.setValue(t.h)})},n.prototype.getWindowSizeFromDOM=function(){var e=document.documentElement,n=t.Utilities.browser.isMobile&&t.Utilities.browser.isChrome?e.offsetHeight:e.clientHeight;return{w:e.clientWidth,h:n}},n.prototype.getAvailableBandwidth=function(){return this.availableBandwidth},n.prototype.setAvailableBandwidth=function(t){this.availableBandwidth=t},n.prototype.shouldShowAuthoringEntrypoints=function(){var t=this.windowWidth.getValue()>=600,e="Mobile"!=this.commonSettings.ClientDevice;return t&&e},n.prototype.isProductionEnvironment=function(){return!(this.commonSettings.EnvironmentName==n.IntName||this.commonSettings.EnvironmentName==n.DevFabricName||this.commonSettings.EnvironmentName==n.SingleBox||this.commonSettings.EnvironmentName==n.ScaledBox||this.commonSettings.EnvironmentName==n.WeeklyName)},n.prototype.supportsSandbox=function(){return!0},n.prototype.hasNativeHyperlinkTooltips=function(){return!0},n.prototype.areInternalFeaturesEnabled=function(){return this.commonSettings&&this.commonSettings.FlightSettings&&this.commonSettings.FlightSettings.areInternalFeaturesEnabled},n.prototype.shouldDisplayInternalFeaturesButton=function(){return this.areInternalFeaturesEnabled()},n.prototype.shouldDisplayDeveloperCdnButton=function(){return!this.isProductionEnvironment()&&null!==Cookie.getDeveloperCdnCookie()},n.prototype.shouldDisplayConsumptionAppBar=function(t){return!t},n.prototype.getClientOnlineWatcher=function(){return this.clientOnline},n.prototype.getClientOnline=function(){return{watchable:this.getClientOnlineWatcher()}},n.prototype.isClientOnline=function(t){return this.clientOnline.getWatchedValue(t)},n.prototype.subscribeToIsClientOnline=function(t,e,n){this.clientOnlineEventRegistrations.addunique(this.clientOnlineChanged.addHandler(t,e,n))},n.prototype.disposeAllIsClientOnlineRegistrations=function(){this.clientOnlineEventRegistrations.forEach(function(t){return t.dispose()})},n.prototype.waitUntilClientIsOnline=function(){var t=new Disposable(null),e=$.Deferred();return this.clientOnlineChanged.addHandler(t,this,function(n){n&&(t.dispose(),e.resolve())}),e.promise()},n.prototype.addBeforeNavigationHandler=function(t){this.beforeNavigationHandlers.push(t)},n.prototype.runBeforeNavigationHandlers=function(t,e){for(var n=!1,o=0,i=this.beforeNavigationHandlers;o<i.length;o++){var r=i[o];if(n=n||r(t,e))break}return n},n.prototype.shouldShowAboutDialogButton=function(){return!1},n.prototype.canOpenNewTab=function(){return!0},n.prototype.supportsPrinting=function(){return!0},n.prototype.retrieveOfflineState=function(t){var e=$.Deferred();return e.resolve(null),e.promise()},n.prototype.deleteOfflineState=function(t){},n.prototype.setNativeFullScreen=function(t){},n.prototype.allowAuthRenewalForIdleUsers=function(){return!1},n.DevFabricName="DevFabric",n.IntName="Int",n.SingleBox="SingleBox_Cloud",n.ScaledBox="ScaledPr_Cloud",n.WeeklyName="Weekly",n}();e.Environment=o}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){t[t.NotSet=0]="NotSet",t[t.Mobile=1]="Mobile",t[t.Tablet=2]="Tablet",t[t.Laptop=3]="Laptop",t[t.Desktop=4]="Desktop"}(t.DeviceType||(t.DeviceType={}))}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){t.officeAppSwitcherButtonId="OfficeAppSwitcherButton",t.swayButtonId="SwayButton",t.swayButtonRightClick="SwayButtonRigthClick",t.internalFeaturesEnabledAppBarButtonId="InternalFeaturesEnabledAppBarButton",t.internalFeaturesEnabledOverflowMenuButtonId="InternalFeaturesEnabledOverflowMenuButton",t.togglePremiumFeaturesOverflowMenuButtonId="TogglePremiumFeaturesOverflowMenuButton",t.signInButtonId="SignInButton",t.tutorialVideosButtonId="TutorialVideosButton",t.playButtonId="PlayButton",t.getStartedTopButtonId="GetStartedButtonTop",t.getStartedTopButtonWrapperId="GetStartedButtonTopWrapper",t.getStartedBottomButtonId="GetStartedButtonBottom",t.getStartedBottomButtonWrapperId="GetStartedButtonBottomWrapper",t.mySwaysHeaderButtonId="MySwaysHeaderButton",t.createNewButtonAppBarId="CreateNewButtonAppBar",t.createNewButtonOverflowMenuId="CreateNewButtonOverflowMenu",t.addFeedbackButtonId="FeedbackButton",t.helpButtonId="HelpButton",t.userButtonID="UserButton",t.signOutButtonId="SignOutButton",t.overflowButtonId="OverflowButtonId",t.carouselPreviousButtonId="CarouselPreviousButton",t.carouselNextButtonId="CarouselNextButton",t.howToVideosPreviousButtonId="HowToVideosPreviousButton",t.howToVideosPreviousButtonWrapperId="HowToVideosPreviousButtonWrapper",t.howToVideosNextButtonId="HowToVideosNextButton",t.howToVideosNextButtonWrapperId="HowToVideosNextButtonWrapper",t.followFacebookId="FollowUsOnFacebookButton",t.followTwitterId="FollowUsOnTwitterButton",t.followBlogkId="FollowUsOnBlogButton",t.disableInternalFeaturesId="DisableInternalFeaturesButton",t.mySwayOverflowId="MySwaysOverflowButton",t.chevronId="ChevronButton",t.platformiOSButtonId="PlatformiOS",t.platformiPadButtonId="PlatformiPad",t.platformiPhoneButtonId="PlatformiPhone",t.platformWebButtonId="PlatformWeb",t.platformWindowsButtonId="PlatformWindows",t.educationPlatformiOSButtonId="EducationPlatformiOS",t.educationPlatformiPadButtonId="EducationPlatformiPad",t.educationPlatformiPhoneButtonId="EducationPlatformiPhone",t.educationPlatformWebButtonId="EducationPlatformWeb",t.educationPlatformWindowsButtonId="EducationPlatformWindows",t.MiddlePartHorisontalIcon_Reports="Reports",t.MiddlePartHorisontalIcon_Presentations="Presentations",t.MiddlePartHorisontalIcon_Newsletters="Newsletters",t.MiddlePartHorisontalIcon_PersonalStories="PersonalStories",t.MiddlePartHorisontalIcon_Communications="Communications",t.recycleBinOverflowButtonId="recycleBinOverflowButtonId",t.panelCardsOverflowButtonId="PanelOverflowButtonCards",t.panelDesignOverflowButtonId="PanelOverflowButtonDesign",t.panelContentOverflowButtonId="PanelOverflowButtonContent",t.panelNavigationOverflowButtonId="PanelOverflowButtonNavigation",t.appBarAuthorsButtonId="AppBarAuthorsButton",t.appBarAuthorsOverflowButtonId="AppBarAuthorsOverflowButton",t.appBarShareButtonId="AppBarShareButton",t.appBarShareOverflowButtonId="AppBarShareOverflowButton",t.tutorialVideosOverflowButtonId="TutorialVideosOverflowButton",t.appBarOpenInNewTabButtonId="OpenInNewTabButton",t.appBarSwaySettingsPane="SwaySettingsPane",t.homepageO365UpsellId="HomepageO365Upsell",t.EducationPage_getStartedTopButtonId="EducationGetStartedButtonTop",t.EducationPage_getStartedTopButtonWrapperId="EducationGetStartedButtonTopWrapper",t.EducationPage_getStartedIntroductionButtonId="EducationGetStartedButtonIntroduction",t.EducationPage_getStartedPlanSwayButtonId="EducationGetStartedButtonPlanSway",t.EducationPage_getStartedPlaySwayO365ButtonId="EducationGetStartedButtonPlanSwayO365",t.EducationPage_getStartedBottomButtonId="EducationGetStartedButtonBottom",t.EducationPage_getStartedBottomButtonWrapperId="EducationGetStartedButtonBottomWrapper"}(t.TelemetryConstants||(t.TelemetryConstants={}))}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(e){var n=function(){function e(){}return e.prototype.storeLogArgs=function(t){e.buffer.enqueue(t)},e.prototype.flushArgs=function(){var t=e.buffer.toArray();return e.buffer.clear(),t},e.buffer=new t.CircularBuffer(100,!0),e}();e.PersistentBufferLogger=n}(t.Logging||(t.Logging={}))}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(){function t(){}return t.prototype.log=function(t){0===t.state?StoryLog.StructuredTraceTag(596477e3,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Resource loader succeeded",t):t.attempts<t.maximumAttempts?StoryLog.StructuredTraceTag(596477001,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Resource loader will try again",t):StoryLog.StructuredTraceTag(596477002,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"Resource loader failed",t)},t}();t.PreloadLogger=e}(t.Logging||(t.Logging={}))}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){function n(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(t.Utilities.browser.isIE)if(void 0!==StoryLog&&void 0!==StoryLog.Trace&&StoryLog.initialized){if(0!==o.length){for(var r=0,a=o;r<a.length;r++){var s=a[r];i(s)}o.length=0}i(e)}else o.push(e)}var o=[],i=function(t){StoryLog.TraceTag(596476999,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,JSON.stringify(t))};e.logIfIe=n}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){var n,o=t.View.ViewElements;!function(t){t[t.OnlineAuthors=0]="OnlineAuthors",t[t.MadeSways=1]="MadeSways"}(n=e.PopularityMetric||(e.PopularityMetric={}));var i=function(){function e(e,o){switch(this._metric=e,this._placement=o,this._metric){case n.OnlineAuthors:this.parseDataFromSettings(CommonSettings.PopularityMetricsOnlineAuthorsData);break;case n.MadeSways:this.parseDataFromSettings(CommonSettings.PopularityMetricsMadeSwaysData);break;default:throw t.RethrowLogger.createError("Unknown metric selected!")}}return e.prototype.parseDataFromSettings=function(t){this._metricDataPerHourInWeek=[];for(var e=0;e<7;++e)for(var n=t[e].split(","),o=0;o<24;++o){var i=parseInt(n[o]);this._metricDataPerHourInWeek.push(i)}},e.prototype.approximateCurrentCount=function(t,n,o,i,r){var a=this._metricDataPerHourInWeek[24*o+i],s=o<6||i<23?this._metricDataPerHourInWeek[24*o+i+1]:this._metricDataPerHourInWeek[0],l=a+Math.floor(r*(s-a)/60);return n&&(l+=Math.floor(Math.random()*e._deltaRangePercentage*l)*(Math.random()<.5?-1:1)),t*l},e.prototype.getMetricNumberForDate=function(e){var o=e.getUTCDay(),i=o>0?o-1:6,r=e.getUTCHours(),a=e.getUTCMinutes();switch(this._metric){case n.OnlineAuthors:return this.approximateCurrentCount(CommonSettings.PopularityMetricsOnlineAuthorsScale,!0,i,r,a);case n.MadeSways:return this.approximateCurrentCount(CommonSettings.PopularityMetricsMadeSwaysScale,!1,i,r,a);default:throw t.RethrowLogger.createError("Unknown metric selected!")}},e.prototype.getMetricNumber=function(){var t=new Date;return this.getMetricNumberForDate(t)},e.prototype.aboveTheThreshold=function(){var e=this.getMetricNumber();switch(this._metric){case n.OnlineAuthors:return e>=CommonSettings.PopularityMetricsOnlineAuthorsThreshold;case n.MadeSways:return e>=CommonSettings.PopularityMetricsMadeSwaysThreshold;default:throw t.RethrowLogger.createError("Unknown metric selected!")}},e.prototype.getMetricMessage=function(){switch(this._metric){case n.OnlineAuthors:return Resources.PopularityMetricsExperimentOnlineAuthorsText;case n.MadeSways:return Resources.PopularityMetricsExperimentMadeSwaysText;default:throw t.RethrowLogger.createError("Unknown metric selected!")}},e.prototype.getMetricMessagePrefix=function(){var t=this.getMetricMessage().split("{0}");return t.length>1?t[0]:""},e.prototype.getMetricMessageText=function(){var t=this.getMetricMessage().split("{0}");return t.length>1?t[1]:t[0]},e.prototype.popularityMetricIconFontIconName=function(t){return FontIcons.PopularityMetricIcon},e.prototype.popularityMetricIconFontIconWrapperClass=function(t){return"PopularityMetricIcon"+this._placement},e.prototype.getMetricIcon=function(){return new TDB.ChildArgs(o.FontIconVE,{fontIconName:{compute:new TDB.ComputedOptionArgs(this,this.popularityMetricIconFontIconName)},fontIconSizeClass:FontIcons.PopularityMetricIconSize,fontIconWrapperClass:{compute:new TDB.ComputedOptionArgs(this,this.popularityMetricIconFontIconWrapperClass)}})},e._deltaRangePercentage=.005,e}();e.PopularityMetricsGenerator=i}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var StoryBrandingMode;!function(t){t[t.Default=0]="Default",t[t.DocsJournal=1]="DocsJournal",t[t.DocsAbout=2]="DocsAbout"}(StoryBrandingMode||(StoryBrandingMode={}));var StoryJoinResult;!function(t){t[t.CanJoin=0]="CanJoin",t[t.TooManyAuthors=1]="TooManyAuthors",t[t.IncompatibleWithOtherAuthor=2]="IncompatibleWithOtherAuthor",t[t.IncompatibleWithOwnClient=3]="IncompatibleWithOwnClient",t[t.NotSupported=4]="NotSupported"}(StoryJoinResult||(StoryJoinResult={}));var StoryApp;!function(t){!function(t){var e=function(){function t(t,e,n){t&&t.addResource(this),this.delay=e,this._owner=t,this._cbArgs=n,this.handle=void 0}return t.prototype.set=function(t){var e=this;this.clear(),this.handle=platform.setTimeout(function(){e.handle=void 0,t()},this.delay)},t.prototype.start=function(){var t=this;this.handle||(this.handle=platform.setTimeout(function(){t.finish()},this.delay)),this._cbArgs.onStart&&this._cbArgs.onStart.call(this._owner)},t.prototype.finish=function(){this.handle&&(this.handle=void 0,this._cbArgs.onFinish&&this._cbArgs.onFinish.call(this._owner))},t.prototype.cancel=function(){this._cbArgs.onCancel&&this._cbArgs.onCancel.call(this._owner),this.clear()},t.prototype.restart=function(){this.cancel(),this.start()},t.prototype.clear=function(){this.handle&&(clearTimeout(this.handle),this.handle=void 0)},t.prototype.started=function(){return!!this.handle},t.prototype.getDelay=function(){return this.delay},t.prototype.dispose=function(){this.clear()},t}();t.Timeout=e;var n=function(){function e(t,e){this.delay=e,this.handle=null,t&&t.addResource(this)}return e.prototype.getDelay=function(){return this.delay},e.prototype.started=function(){return!!this.handle},e.prototype.set=function(e){var n=this;this.clear(),this.handle=t.scheduler.schedule(this.delay,function(){n.handle=null,e()})},e.prototype.clear=function(){this.handle&&(this.handle.dispose(),this.handle=null)},e.prototype.dispose=function(){this.clear()},e}();t.ScheduledTimeout=n;var o=function(){function t(){this.agenda={}}return t.prototype.schedule=function(t,e){var n="dt"+t,o=this.agenda[n];return o||(o=this.agenda[n]=new i(t,this.callback.bind(this))),o.schedule(e),{dispose:function(){return o.unschedule(e)}}},t.prototype.callback=function(t){for(var e=t.callbacks,n=0,o=(e=e.splice(0,e.length)).length;n<o;++n)e[n]();delete this.agenda["dt"+t.timeout.getDelay()]},t}();t.Scheduler=o;var i=function(){function t(t,n){var o=this;this.callbacks=[],this.timeout=new e(null,t),this.handler=function(){return n(o)}}return t.prototype.schedule=function(t){this.callbacks.push(t),this.timeout.started()||this.timeout.set(this.handler)},t.prototype.unschedule=function(t){ArrayExtensions.removeFirst(this.callbacks,t),this.callbacks.length||this.timeout.clear()},t}();t.scheduler=new o}(t.Utilities||(t.Utilities={}))}(StoryApp||(StoryApp={}));var UserType;!function(t){t[t.Unknown=0]="Unknown",t[t.AAD_Unknown=1]="AAD_Unknown",t[t.AAD_EDU=2]="AAD_EDU",t[t.AAD_BUS=3]="AAD_BUS",t[t.MSA=4]="MSA"}(UserType||(UserType={}));var VisualLinkMode;!function(t){t[t.Disabled=0]="Disabled",t[t.PublicStoriesOnly=1]="PublicStoriesOnly",t[t.Enabled=2]="Enabled"}(VisualLinkMode||(VisualLinkMode={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(){function t(){}return t.prototype.getSetSize=function(){},t.prototype.getPositionInSet=function(){},t.prototype.isSelected=function(t){return!1},t.prototype.setSelected=function(t){},t.prototype.getTitleForDisplay=function(){return this.getTitle()||Resources.UntitledStoryTitle},t}();t.AbstractStoryTileBaseModel=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=function(e){function n(t,n){var o=e.call(this,t)||this;return o.args=n,o.errorMessageVisible=TDB.watchableTag(596476952,o,!1),o.spinnerVisible=TDB.watchableTag(596476953,o,!1),o}return __extends(n,e),n.prototype.getPasswordText=function(){return this.passwordTextBox.getText()},n.prototype.ifShowErrorMessageArgs=function(){return this.errorMessageVisible},n.prototype.setErrorMessageVisible=function(t){var e=this;TDB.applyUpdate(function(){e.errorMessageVisible.setValue(t)})},n.prototype.handleTextBoxEnter=function(t){return t.keyCode===KeyCodeType.EnterKey&&this.passwordTextBox.getText()&&void 0!==this.args.onEnterClicked?(this.args.onEnterClicked(),TDB.EventPropagation.PreventDefault):TDB.EventPropagation.Bubble},n.prototype.loadingSpinnerAttrArgs=function(){var e={};return e.src=t.Common.UrlHelper.getInstance().getLoadingSpinnerUrl(),e},n.prototype.ifShowLoadingSpinnerArgs=function(){return this.spinnerVisible},n.prototype.setLoadingSpinnerVisibility=function(t){var e=this;TDB.applyUpdate(function(){e.spinnerVisible.setValue(t)})},n.prototype.errorMessageTextArgs=function(t){return Resources.SharingPasswordEntryDialogError},n.prototype.narratorMessageTextArgs=function(t){return this.errorMessageVisible.getWatchedValue(t)?Resources.SharingPasswordEntryDialogError:""},n}(TDB.FocusableViewElement);e.CommonPasswordDialogContentVEBase=n}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(){function t(t,e){this.linkText=t,this.action=e}return t.prototype.getText=function(){return this.linkText},t.prototype.getAction=function(){var t=this;return function(e){return t.action(),TDB.EventPropagation.Bypass}},t}();t.LinkWithAction=e;var n=function(t){function e(e,n){var o=t.call(this,e)||this;return o.args=n,o}return __extends(e,t),e.prototype.messageArgs=function(){for(var t=[],e=0;e<this.args.links.length;e++)t.push({url:"javascript:void(0)",message:this.args.links[e].getText(),context:this,class:this.args.linkStyle?this.args.linkStyle:"NeutralHyperlinks",target:"_self",onClickHandler:this.args.links[e].getAction()});return ResourceManager.resolveWithChildArgs(this.args.message,t,"")},e}(TDB.FocusableViewElement);t.TextWithHyperlinkContentVEBase=n}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){!function(t){t[t.Initial=0]="Initial",t[t.Searching=1]="Searching",t[t.Ready=2]="Ready"}(t.EntityPickerModelState||(t.EntityPickerModelState={}));var e=function(){function t(t,e,n){this.state=t,this.suggestedEntities=e,this.noSuggestions=n}return t}();t.EntityPickerModel=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(e,n){var o=t.call(this,e)||this;return o.args=n,o.entities=TDB.watchableTag(596476941,o,[]),o}return __extends(e,t),e.prototype.entitiesArgs=function(t){var e=this;return this.entities.getWatchedValue(t).map(function(t){return e.args.createEntityArgs(t)})},e.prototype.addEntity=function(t){var e=this;TDB.applyUpdate(function(){e.entities.getValue().push(t),e.entities.notify()})},e.prototype.removeEntity=function(t){var e=this;TDB.applyUpdate(function(){e.entities.getValue().removefirst(t),e.entities.notify()})},e.prototype.getActivatableChildren=function(){for(var t=[],e=0;e<this.entityList.length;e++){var n=this.entityList[e];if(n instanceof TDB.ControlBase&&n.canActivate()){var o=n.getFocusableChildren();if(o)for(var i=0;i<o.length;i++)t.push(o[i]);t.push(this.entityList[e])}}return t},e.prototype.getItems=function(t){return this.entities.getWatchedValue(t)},e.prototype.clearList=function(){var t=this;TDB.applyUpdate(function(){t.entities.setValue([])})},e}(TDB.FocusableViewElement);t.EntityListVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(e){function n(t,n){var o=e.call(this,t)||this;return o.args=n,o.model=n.model,o.lastToggledModel=TDB.watchableTag(596455493,o,void 0),o}return __extends(n,e),n.prototype.entityPickerWrapperClassNameArgs=function(t){return this.args.cssName},n.prototype.entitySuggestionsReaderTextArgs=function(e){var n=this.model.getWatchedValue(e),o="";return n.state===t.EntityPickerModelState.Ready&&(o=n.noSuggestions?Resources.PeoplePickerNoSuggestedPeople:this.getReaderTextPrefix(e)),o},n.prototype.getReaderTextPrefix=function(t){return this.model.getWatchedValue(t)===this.lastToggledModel.getWatchedValue(t)?"":Resources.SharingInvitePeopleResultsUpdateMessage},n.prototype.getSelectedEntityReaderValue=function(t){for(var e=this.model.getWatchedValue(t).suggestedEntities,n=0;n<e.length;n++)if(e[n].selected.getWatchedValue(t))return e[n].readerValue;return""},n.prototype.updateModel=function(e,n,o){var i=this;TDB.applyUpdate(function(){i.model.setValue(new t.EntityPickerModel(e,n,o))})},n.prototype.suggestedResultsArgs=function(){var e={model:this.model,createSuggestedEntity:this.args.createSuggestedEntity};return new TDB.ChildArgs(t.PeoplePickerSuggestedResultsVE,e)},n.prototype.selectedResultsArgs=function(){var e={model:this.model,createSelectedEntity:this.args.createSelectedEntity,onInput:this.args.onInput};return new TDB.ChildArgs(t.PeoplePickerSelectedResultsVE,e)},n.prototype.getSuggestedList=function(){return this.suggestedResults},n.prototype.getSelectedList=function(){return this.selectedResults},n.prototype.noSuggestionsArgs=function(e){var n=this.model.getWatchedValue(e);return n.noSuggestions&&this.getSelectedList().isEntityPickerInputFocused(e)&&this.getSelectedList().entityPickerInput.getText().length>0&&n.state!==t.EntityPickerModelState.Searching},n.prototype.suggestionsVisibleArgs=function(t){var e=this.model.getWatchedValue(t);return!e.noSuggestions&&e.suggestedEntities.length>0},n.prototype.noSuggestionsTextTextArgs=function(t){return Resources.PeoplePickerNoSuggestedPeople},n.prototype.noSuggestionsTextAttrArgs=function(t){var e={};return e[Aria.Attributes.Label]=Resources.PeoplePickerNoSuggestedPeople,e},n}(TDB.FocusableViewElement);t.EntityPickerVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=function(n){function o(t,o){var i=n.call(this,t)||this;return i.initiatedPlay=!1,i.initiatedPause=!1,i.playerReady=!1,i.playerLoadingErrorOccurred=!1,i.model=o,i.notificationBar=o.notificationBar||e.NotificationBarViewModel.getNotificationBar(i),i}return __extends(o,n),o.prototype.playVideo=function(){this.playerLoadingErrorOccurred&&this.loadPlayer(),this.initiatedPlay=!0,this.playerReady?this.doPlayVideo():this.initiatedPause=!1},o.prototype.pauseVideo=function(){this.initiatedPause=!0,this.playerReady?this.doPauseVideo():this.initiatedPlay=!1},o.prototype.canControlPlayback=function(){return!0},o.prototype.loadPlayer=function(t){var e=this;this.playerLoadingErrorOccurred=!1,this.doLoadPlayer(this.model.resourceFactory).then(function(){return e.onPlayerReady()},function(){return e.onPlayerError(t)})},o.prototype.onPlayerReady=function(){if(this.initiatedPlay&&this.initiatedPause)throw t.RethrowLogger.createError("Both initiatedPause and initiatedPlay are true; this indicates a bug");this.initiatedPlay&&this.doPlayVideo(),this.initiatedPause&&this.doPauseVideo(),this.playerReady=!0,this.model.onReady&&this.model.onReady()},o.prototype.onPlayerPlaying=function(){this.initiatedPlay?this.initiatedPlay=!1:this.model.onPlaying&&this.model.onPlaying()},o.prototype.onPlayerError=function(t){this.playerLoadingErrorOccurred=!0,!t&&this.notificationBar&&this.notificationBar.addNotification({messages:[{text:Resources.UploadVideoNoStreamingUrlErrorNotification}],notificationSource:e.NotificationSource.AzureVideoPlayerUpload,notificationType:e.NotificationType.Info}),this.model.onLoadingError&&this.model.onLoadingError()},o.prototype.onPlayerPaused=function(){this.initiatedPause?this.initiatedPause=!1:this.model.onPaused&&this.model.onPaused()},o}(TDB.ViewElement);e.ControllableVideoPlayerVE=n}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){!function(t){t[t.TimedOut=0]="TimedOut",t[t.BrowserLoadingError=1]="BrowserLoadingError"}(e.IframeLoadingFailureCategory||(e.IframeLoadingFailureCategory={}));var n=function(e){function n(t,n){var o=e.call(this,t)||this;return o.args=n,o.sandboxed=TDB.watchableOption(o,o.args.sandboxed,!0),o.height=TDB.watchableTag(596476932,o,void 0),o}return __extends(n,e),n.prototype.getIframeMessageBinding=function(){return this.iframeMessageBinding||this.iframe1MessageBinding},n.prototype.iframeAttr1Args=function(e){return{sandbox:t.Common.Environment.getInstance().supportsSandbox()&&this.isSandboxed(e)?"allow-scripts allow-same-origin allow-forms allow-popups":void 0}},n.prototype.iframeAttr2Args=function(t){return{src:this.getContentUrl(t),allowfullscreen:"",class:this.args.cssClassName,height:this.height.getWatchedValue(t)}},n.prototype.iframeStyleArgs=function(t){return{}},n.prototype.supportsScrollingArgs=function(){return!0},n.prototype.wrapperStyleArgs=function(t){return{}},n.prototype.getContentUrl=function(t){return this.args.contentUrl},n.prototype.isSandboxed=function(t){return this.sandboxed.getWatchedValue(t)},n.prototype.iframeEventsInitArgs=function(){var t=this,e={};return this.args.onload&&(e.load=function(e){return t.args.onload.call(t.args.context,e)}),this.args.onerror&&(e.error=function(e){return t.args.onerror.call(t.args.context,e)}),e},n.prototype.setHeight=function(t){var e=this;TDB.applyUpdate(function(){e.height.setValue(t.toString())})},n.prototype.iframeMessageInitArgs=function(){return{fn:this.args.iframeMessageHandler,context:this.args.context}},n}(TDB.FocusableViewElement);e.IframeVEBase=n}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=function(n){function o(t,e){return n.call(this,t,e)||this}return __extends(o,n),o.prototype.passwordTextBoxArgs=function(){var n={context:this,description:Resources.PasswordEntryTextboxDescription,placeholder:{value:Resources.SharingPasswordEntryDialogPlacholder},cssClass:"EmailAddressInputNew",inputType:"password",autocomplete:!1,selectTextOnFocus:!0,textWatchable:this.passwordTextBoxText,tabIndex:e.PasswordEntryDialogTabOrder.EntryTextbox,handleKeyDown:this.handleTextBoxEnter,maxLength:t.Common.PasswordHelper.MaxPasswordLength};return new TDB.ChildArgs(e.TextBoxVE,n)},o.prototype.errorMessageTextArgs=function(t){return Resources.SharingPasswordEntryDialogError},o}(e.CommonPasswordDialogContentVEBase);e.PasswordEntryDialogContentVEBase=n}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(e,n){var o=t.call(this,e)||this;return o.args=n,o.applyClass=TDB.watchableTag(596476961,o,!1),platform.setImmediate(function(){TDB.applyUpdate(function(){o.applyClass.setValue(!0)})}),o}return __extends(e,t),e.prototype.imageAttrArgs=function(t){return{alt:this.args.alt,role:this.args.role,src:this.args.src}},e.prototype.imageClassNameArgs=function(t){return this.applyClass.getWatchedValue(t)?this.args.className:""},e.prototype.onImageLoaded=function(t){return this.args.context&&this.args.loadHandler&&this.args.loadHandler.call(this.args.context,t),!1},e.prototype.imageEventsInitArgs=function(){return{load:this.onImageLoaded}},e}(TDB.ViewElement);t.BasicImageVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(e,n){var o=t.call(this,e)||this;return o.model=n,o}return __extends(e,t),e.prototype.divClassNameArgs=function(t){return this.model.className||""},e.prototype.divStyleArgs=function(t){return this.model.style},e}(TDB.FocusableViewElement);t.DivVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){!function(t){t[t.Debug=0]="Debug",t[t.Limits=1]="Limits",t[t.NetworkStatus=2]="NetworkStatus",t[t.InteractionEngineLowEndMode=3]="InteractionEngineLowEndMode",t[t.StoryPageSetupAuthoringDisabled=4]="StoryPageSetupAuthoringDisabled",t[t.AzureVideoPlayerUpload=5]="AzureVideoPlayerUpload",t[t.AzureAudioPlayerUpload=6]="AzureAudioPlayerUpload",t[t.LandingPageCookieNotification=7]="LandingPageCookieNotification",t[t.MyStoriesPageMobileNotification=8]="MyStoriesPageMobileNotification",t[t.DocumentIngestionPdf=9]="DocumentIngestionPdf",t[t.PageRootUnsupportedBrowser=10]="PageRootUnsupportedBrowser",t[t.InitializeSnapshot=11]="InitializeSnapshot",t[t.AddContentUpload=12]="AddContentUpload",t[t.ShareAudience=13]="ShareAudience",t[t.NativeIdentity=14]="NativeIdentity",t[t.NativeContentUploader=15]="NativeContentUploader",t[t.FontLoadError=16]="FontLoadError",t[t.ContactMe=17]="ContactMe",t[t.Recording=18]="Recording",t[t.StoryExport=19]="StoryExport",t[t.OpenInIOSApp=20]="OpenInIOSApp",t[t.PremiumContentRestriction=21]="PremiumContentRestriction"}(t.NotificationSource||(t.NotificationSource={}));!function(t){t[t.Info=0]="Info",t[t.Warning=1]="Warning",t[t.Error=2]="Error"}(t.NotificationType||(t.NotificationType={}))}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=t.Common,o=function(o){function i(t){var e=o.call(this,t)||this;return e.waitingResponse=TDB.watchableTag(596476893,e,!1),e.choices=TDB.watchableTag(596476894,e,[]),e.errorMessage=TDB.watchableTag(596476895,e,""),e}return __extends(i,o),i.prototype.titleTextBoxArgs=function(){var t=this,n={placeholder:{value:Resources.CreateOutlineTextboxPlaceholder},selectTextOnFocus:!0,cssClass:"outlineTextbox",maxLength:200,handleKeyDown:function(e){return e.keyCode===KeyCodeType.EnterKey?(t.createOutline(),TDB.EventPropagation.PreventDefault):TDB.EventPropagation.Bubble},description:Resources.CreateOutlineTextBoxDescription};return new TDB.ChildArgs(e.TextBoxVE,n)},i.prototype.getTitleTextBoxText=function(t){return this.topicTextBox.getText()},i.prototype.createOutline=function(){var t=this.topicTextBox.getText();t&&t.length>0&&this.sendCreateOutlineRequest(t)},i.prototype.sendCreateOutlineRequest=function(e,o){var r=this;if(!this.waitingResponse.getValue()){TDB.applyUpdate(function(){r.waitingResponse.setValue(!0),r.errorMessage.setValue("")});var a,s;!o&&CommonSettings.AuthoringFromLandingPageContextEnabled?(a=n.UrlHelper.getInstance().getGetOutlineAndJoinStoryForTopicUrl(),s=t.Common.SinglePageAppHelper.buildCreateAndJoinRequest()):a=n.UrlHelper.getInstance().getGetOutlineForTopicUrl();var l={description:"Method to start create outline process.",data:{topic:e,request:s?JSON.stringify(s):void 0},dataType:"json",timeout:i.getOutlineTimeout,cache:!1,type:"POST"};Task.fromPromise($.ajax(a,l)).then(function(t){r.parent.visible.getValue()&&r.handleMakeOutlineResponse(t,e)},function(){TDB.applyUpdate(function(){r.errorMessage.setValue(Resources.CreateOutlineDialogErrorMessage),r.choices.setValue([]),r.waitingResponse.setValue(!1)})})}},i.prototype.handleMakeOutlineResponse=function(e,n){var o=this;switch(TDB.applyUpdate(function(){o.waitingResponse.setValue(!1),o.choices.setValue([])}),e.ResponseType){case MakeOutlineResponseType.Hit:null!=e.CreateAndJoinResponse?t.Common.SinglePageAppHelper.processCreateAndJoinResponse(e.CreateAndJoinResponse,function(){return o.sendCreateOutlineRequest(n,!0)}):(t.View.Common.DialogManager.getInstance().closeCurrentDialog(),this.redirectToStory(e.SwayId));break;case MakeOutlineResponseType.Disambiguation:var i=[];TDB.applyUpdate(function(){o.panel.subTitleText.setValue(Resources.CreateOutlineDisambiguationCaption)});for(var r=0;r<e.Disambiguation.length;r++)i.push(e.Disambiguation[r]);TDB.applyUpdate(function(){o.choices.setValue(i)});break;case MakeOutlineResponseType.Error:var a=e.ErrorType===MakeOutlineErrorType.NoResults?Resources.CreateOutlineDialogNoResultsMessage:Resources.CreateOutlineDialogErrorMessage;TDB.applyUpdate(function(){o.errorMessage.setValue(a)});break;default:StoryLog.StructuredTraceTag(596476896,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.error,"Unexpected Make outline response type encountered",{responseType:e.ResponseType.toString()})}},i.prototype.redirectToStory=function(e){t.Common.UserStories.getInstance().loadStory(e,!0)},i.prototype.ifDisambiguationArgs=function(t){return this.choices.getWatchedValue(t).length>0},i.prototype.disambiguationPanelArgs=function(){return new TDB.ChildArgs(e.OutlineDialogDisambiguationPanelVE,this)},i.prototype.animationAttrArgs=function(e){return{src:t.Common.UrlHelper.getInstance().getLoadingSpinnerUrl()}},i.prototype.animationVisibleArgs=function(t){return this.waitingResponse.getWatchedValue(t)},i.prototype.ifErrorMessageArgs=function(t){return this.errorMessage.getWatchedValue(t).length>0},i.prototype.errorMessageTextArgs=function(t){return this.errorMessage.getWatchedValue(t)},i.prototype.poweredByTextArgs=function(){return Resources.PoweredByWikipedia},i.prototype.getInitialActiveChild=function(){return this.topicTextBox},i.getOutlineTimeout=6e4,i}(TDB.FocusableViewElement);e.OutlineDialogContentVEBase=o}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=function(n){function o(t,e){var o=n.call(this,t,e)||this;return o.buttonArgs=e,o.visible=TDB.watchableOption(o,e.visible,!0),o.context=e.context?e.context:o,o.cssClass=TDB.watchableOption(o,e.cssClass,""),o.ulsCategory=null!=e.ulsCategory?e.ulsCategory:Diag.ULSCat.msoulscat_Story_InteractionModel,o.attrWatchableOption=TDB.watchableOption(o,e.attributes),o.shortcutHelpText="",o.description=TDB.watchableOption(o,e.description),o.tooltip=TDB.watchableOption(o,e.tooltip),e.shortcutIdentifiers&&(o.shortcutIdentifiers=e.shortcutIdentifiers.map(function(t){return TDB.ShortcutIdentifier.createShortcutIdentifier(t)}),o.shortcutHelpText=o.getShortcutHelpText(e.shortcutIdentifiers),o.registerShortcut(o.shortcutIdentifiers,o,o.buttonArgs.shortcutProcessor),o.showShortcutHelp=o.getShortcutHelpVisibility()),o}return __extends(o,n),o.prototype.ifShowShortcutArgs=function(t){return this.shortcutHelpText&&this.showShortcutHelp&&this.showShortcutHelp.getWatchedValue(t)===e.ControlElementHelpState.Shortcut},o.prototype.shortcutLabelTextArgs=function(t){return this.shortcutHelpText},o.prototype.wrapperScrollIntoViewInitArgs=function(){return 0},o.prototype.ifButtonWrapperArgs=function(t){return this.isVisible(t)},o.prototype.isVisible=function(t){return this.visible.getWatchedValue(t)},o.prototype.getButtonClass=function(t){return this.getRawButtonClass(t)+" "+o.baseCssClass},o.prototype.getRawButtonClass=function(t){return this.cssClass.getWatchedValue(t)},o.prototype.keyDown=function(t){var e=TDB.EventPropagation.Bubble;switch(t.keyCode){case KeyCodeType.EnterKey:case KeyCodeType.SpaceKey:e=this.buttonArgs.nativeKeyboardHandling?TDB.EventPropagation.Bypass:this.actionKeyDown(t)}return e},o.prototype.keyUp=function(e){return t.Utilities.browser.isFirefox&&e.keyCode==KeyCodeType.SpaceKey?TDB.EventPropagation.PreventDefault:n.prototype.keyUp.call(this,e)},o.prototype.actionKeyDown=function(t){return this.action(t),TDB.EventPropagation.PreventDefault},o.prototype.mouseDown=function(t){return TDB.EventPropagation.Bypass},o.prototype.mouseUp=function(e){return t.Utilities.browser.isSafari&&this.setFocus(),TDB.EventPropagation.Bypass},o.prototype.getButtonId=function(){return this.buttonArgs.buttonId},o.prototype.mouseClicked=function(t){return this.isEnabled()?this.action(t):TDB.EventPropagation.Bypass},o.prototype.handleShortcutKey=function(t){return this.isVisible()?this.action(t):TDB.EventPropagation.Bubble},o.prototype.shortcutCallback=function(){this.buttonArgs.shortcutCallback&&this.buttonArgs.shortcutCallback()},o.prototype.contextMenu=function(t){return t.preventDefault&&(t.stopPropagation(),t.preventDefault()),ActionLogger.RecordClientAction(new ClientAction.ButtonRightClickAction(this.buttonArgs.buttonId,this.ulsCategory,this.additionalLogInfo())),!1},o.prototype.action=function(t){return this.logButtonClick(),this.onAction(t)},o.prototype.onAction=function(t){return this.buttonArgs.click&&this.context?this.buttonArgs.click.call(this.context,t):TDB.EventPropagation.Bypass},o.prototype.getButtonAttributes=function(t,e){var n=this.attrWatchableOption.getWatchedValue(t)||{};return n[Aria.Attributes.Role]=this.buttonArgs.role||Aria.Roles.Button,n[Aria.Attributes.Label]=this.description.getWatchedValue(t),n[Aria.Attributes.Haspopup]=this.buttonArgs.hasPopup?Aria.BooleanState.True:void 0,n[Aria.Attributes.Describedby]=this.buttonArgs.describedby,n[Aria.Attributes.Labelledby]=this.buttonArgs.labeledby,n[Aria.Attributes.Title]=this.tooltip.getWatchedValue(t),e&&Obj.extend(n,e),n},o.prototype.wrapperPropsArgs=function(t){return{disabled:!this.isEnabled(t)}},o.prototype.wrapperStyleArgs=function(t){return this.buttonArgs.style},o.prototype.toString=function(){var t=this.text,e=this.attrWatchableOption.getValue();return n.prototype.toString.call(this)+" Visible="+this.isVisible()+" Enabled="+this.isEnabled()+" Text='"+(t?t.toString():"<none>")+"' Title='"+(e&&e.title?e.title:"<none>")+"'"},o.prototype.dispose=function(){n.prototype.dispose.call(this),this.shortcutIdentifiers&&(this.unregisterShortcut(this.shortcutIdentifiers,this,this.buttonArgs.shortcutProcessor),this.shortcutIdentifiers=null,this.buttonArgs.shortcutProcessor=null)},o.prototype.getShortcutHelpVisibility=function(){var t=this.findParent(e.PageRootVE);if(t)return t.controlElementHelpState},o.prototype.getShortcutHelpText=function(t){if(t&&t.length>0){var e=t[0];return e.indexOf("Key")>0&&(e=e.substring(0,e.indexOf("Key"))),e}},o.prototype.logButtonClick=function(){ActionLogger.RecordClientAction(new ClientAction.ButtonClickAction(this.buttonArgs.buttonId,this.ulsCategory,this.additionalLogInfo()))},o.prototype.additionalLogInfo=function(){return this.buttonArgs.actionTelemetryProvider?this.buttonArgs.actionTelemetryProvider():null},o.baseCssClass="ButtonVE",o}(TDB.Control);e.ButtonVE=n}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=function(e){function n(n,o){var i=e.call(this,n)||this;return i._glyphClassWatchableOption=TDB.watchableOption(i,o.glyphClass,""),i._clipClassWatchableOption=TDB.watchableOption(i,o.clipClass,""),i._wrapperClassWatchableOption=TDB.watchableOption(i,o.wrapperClass,""),i._glyphVisibleWatchableOption=TDB.watchableOption(i,o.glyphVisible,!0),i.glyphUrl=o.glyphUrl?o.glyphUrl:t.Common.UrlHelper.getInstance().getStoryGlyphIconsUrl(),i}return __extends(n,e),n.prototype.ifWrapperArgs=function(t){return this._glyphVisibleWatchableOption.getWatchedValue(t)},n.prototype.wrapperClassNameArgs=function(t){return this._wrapperClassWatchableOption.getWatchedValue(t)},n.prototype.clipAttrArgs=function(t){return{class:this._clipClassWatchableOption.getWatchedValue(t)}},n.prototype.glyphAttrArgs=function(t){return{class:this._glyphClassWatchableOption.getWatchedValue(t),src:this.glyphUrl,alt:"",role:Aria.Roles.Presentation}},n}(TDB.ViewElement);e.GlyphVEBase=n}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=function(n){function o(e,o){var i=n.call(this,e,o)||this;return i.fontIconSizeClass=o.fontIconSizeClass||"",i.textClass=o.textClass||"",i.textPlacementRight=o.textPlacementRight,i.textPlacementLeft=o.textPlacementLeft,i.glyphWrapperClass=o.glyphWrapperClass,i.glyphOnlyCssClass=o.glyphOnlyCssClass,i.glyphButtonWrapperClassName=o.glyphButtonWrapperClassName,i.shouldUseGlyphIconText=o.useGlyphIconText&&(new t.Common.GlyphIconSupportVerifier).localeSupportsGlyphIconText(CommonSettings.UserLocaleString),i.glyphIconTextCssClass=o.glyphIconTextClass,i.fontIconNameWatchableOption=TDB.watchableOption(i,o.fontIconName,""),i.fontIconWrapperClassWatchableOption=TDB.watchableOption(i,o.fontIconWrapperClass,""),i.textWatchableOption=TDB.watchableOption(i,o.text,""),i.clipClassWatchableOption=TDB.watchableOption(i,o.clipClass,""),i.glyphClassWatchableOption=TDB.watchableOption(i,o.glyphClass,""),i.collapsed=TDB.watchableOption(i,o.collapsed,!1),i}return __extends(o,n),o.prototype.getRawButtonClass=function(t){var e=n.prototype.getRawButtonClass.call(this,t);return this.glyphOnlyCssClass&&this.collapsed.getWatchedValue(t)&&(e=(e?e+" ":"")+this.glyphOnlyCssClass),e},o.prototype.fontIconPresentArgs=function(t){return!!this.fontIconNameWatchableOption.getWatchedValue(t)},o.prototype.glyphVEGlyphClass=function(t){return this.glyphClassWatchableOption.getWatchedValue(t)},o.prototype.glyphVEClipClass=function(t){return this.clipClassWatchableOption.getWatchedValue(t)},o.prototype.fontIconVEFontIconName=function(t){return this.fontIconNameWatchableOption.getWatchedValue(t)},o.prototype.fontIconVEFontIconSizeClass=function(t){return this.fontIconSizeClass},o.prototype.fontIconVEFontIconWrapperClass=function(t){return this.fontIconWrapperClassWatchableOption.getWatchedValue(t)},o.prototype.wrapperClassNameArgs=function(t){return this.getButtonClass(t)},o.prototype.wrapperAttrArgs=function(t){return this.getButtonAttributes(t,{id:this.buttonArgs.telemetryId?this.buttonArgs.telemetryId:void 0})},o.prototype.glyphWrapperStyleArgs=function(t){return this.textPlacementRight?{float:CommonSettings.SiteUiRtl?o.right:o.left}:this.textPlacementLeft?{float:CommonSettings.SiteUiRtl?o.left:o.right}:{}},o.prototype.glyphWrapperClassNameArgs=function(t){var e=this.glyphButtonWrapperClassName?this.glyphButtonWrapperClassName:"flexCenterWrapper";return this.includeLabelTextArgs(t)?e:null},o.prototype.glyphVEArgs=function(){return this.shouldUseGlyphIconText?null:new TDB.ChildArgs(e.GlyphVE,{clipClass:{compute:new TDB.ComputedOptionArgs(this,this.glyphVEClipClass)},glyphClass:{compute:new TDB.ComputedOptionArgs(this,this.glyphVEGlyphClass)},wrapperClass:{value:this.glyphWrapperClass}})},o.prototype.fontIconVEArgs=function(){return this.shouldUseGlyphIconText?null:new TDB.ChildArgs(e.FontIconVE,{fontIconName:{compute:new TDB.ComputedOptionArgs(this,this.fontIconVEFontIconName)},fontIconSizeClass:this.fontIconSizeClass,fontIconWrapperClass:{compute:new TDB.ComputedOptionArgs(this,this.fontIconVEFontIconWrapperClass)}})},o.prototype.textClassNameArgs=function(t){return this.textClass},o.prototype.textTextArgs=function(t){return this.textWatchableOption.getWatchedValue(t)},o.prototype.glyphTextTextArgs=function(t){var e=this.textTextArgs(t);return this.shouldUseGlyphIconText&&e?e[0]:""},o.prototype.textStyleArgs=function(t){return this.textPlacementRight?{float:CommonSettings.SiteUiRtl?o.right:o.left}:this.textPlacementLeft?{float:CommonSettings.SiteUiRtl?o.left:o.right}:{}},o.prototype.glyphTextClassNameArgs=function(t){return this.glyphIconTextCssClass},o.prototype.ifGlyphTextArgs=function(){return this.shouldUseGlyphIconText},o.prototype.includeLabelTextArgs=function(t){return!!this.textTextArgs(t)&&!this.collapsed.getWatchedValue(t)},o.prototype.toString=function(){var t=this.getGlyphButtonDescription();return n.prototype.toString.call(this)+" Description='"+(t||"<none>")+"'"},o.prototype.getGlyphButtonDescription=function(t){return this.description.getWatchedValue(t)},o.prototype.useGlyphIconText=function(){return this.shouldUseGlyphIconText},o.right="right",o.left="left",o}(e.ButtonVE);e.GlyphButtonVEBase=n}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(e,n){var o=t.call(this,e,n)||this;return o.inFocus=TDB.watchableTag(596449289,o,!1),o.inFocusPrevious=null,o.parentHovered=n.parentHovered,o.mouseDownStarted=!1,o}return __extends(e,t),e.prototype.wrapperClassNameArgs=function(t){var e=this,n=this.getButtonClass(t);if(this.inFocus){var o=!this.inFocus.getWatchedValue(t)&&this.parentHovered.getWatchedValue(t)?" videoButtonClippedFocused":" videoButtonClipped";!this.inFocus.getWatchedValue(t)&&this.inFocusPrevious&&(o=" videoButtonClipped",TDB.applyUpdate(function(){e.parentHovered.setValue(!1)},TDB.Justification.SynchronousBrowserEvent)),this.mouseDownStarted&&(o=" videoButtonClippedFocused"),n+=o}return this.inFocusPrevious=this.inFocus.getWatchedValue(t),n},e.prototype.activate=function(){return this.scrollToParent(),t.prototype.activate.call(this)},e.prototype.scrollToParent=function(){this.focusableBinding.scrollToParent()},e.prototype.mouseDown=function(e){return this.mouseDownStarted=!0,t.prototype.mouseDown.call(this,e)},e.prototype.mouseUp=function(e){return this.mouseDownStarted=!1,t.prototype.mouseUp.call(this,e)},e.prototype.onGainingFocus=function(){var t=this;TDB.applyUpdate(function(){t.inFocus.setValue(!0)})},e.prototype.onLosingFocus=function(){var t=this;TDB.applyUpdate(function(){t.inFocus.setValue(!1)})},e}(t.GlyphButtonVEBase);t.VideoGlyphButtonVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=function(e){function n(t,n){var o=e.call(this,t,n)||this;return o.isChecked=n.checkedWatchable||TDB.watchableTag(596476954,o,!!n.checked),o.text=TDB.watchableOption(o,n.text),o}return __extends(n,e),n.prototype.setChecked=function(e){var n=TDB.asRW(this.isChecked);if(!n)throw t.RethrowLogger.createError("Cannot set checked if it has been overriden with a read-only watchable.");n.setValue(e)},n.prototype.getChecked=function(t){return this.isChecked.getWatchedValue(t)},n.prototype.getButtonClass=function(t){return this.getRawButtonClass(t)},n.prototype.getLabel=function(t){return this.text.getValue()},n.prototype.mouseClicked=function(t){return 1!==t.which?TDB.EventPropagation.Bubble:e.prototype.mouseClicked.call(this,t)},n.prototype.onAction=function(t){var e=this,n=TDB.asRW(this.isChecked);return n&&this.shouldToggleOnEvent(t)&&TDB.applyUpdate(function(){n.setValue(!e.isChecked.getValue())}),this.context&&this.buttonArgs.click&&this.isEnabled()?this.buttonArgs.click.call(this.context,t):TDB.EventPropagation.Bypass},n.prototype.shouldToggleOnEvent=function(t){return!(t.target instanceof HTMLInputElement)||"checkbox"!==t.target.type.toLowerCase()},n.prototype.getCheckboxWrapperAttributes=function(t,n){var o=e.prototype.getButtonAttributes.call(this,t);return o[Aria.Attributes.Checked]=n?Aria.CheckboxState.True:Aria.CheckboxState.False,o[Aria.Attributes.Disabled]=this.isEnabled(t)?void 0:Aria.BooleanState.True,o},n}(e.ButtonVE);e.CheckboxVE=n}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(n){var o=function(o){function i(e,n){var i=o.call(this,e,n)||this;return n.calculateChecked?i.isChecked=TDB.watcherTag(596476829,n.context,i,n.calculateChecked):(i._isChecked=n.checkedWatchable||TDB.watchableTag(596476830,i,n.checked),i.isChecked=i._isChecked),i.textElementClass=n.textClass,i._textElementTextWatchable=TDB.watchableOption(i,n.textElementText),i._fontIconTemplateArgs=TDB.watchableOption(i,n.fontIconArgs),i._calloutArgs=TDB.watchableOption(i,n.calloutArgs),i.useGlyphIconText=n.useGlyphIconText&&(new t.Common.GlyphIconSupportVerifier).localeSupportsGlyphIconText(CommonSettings.UserLocaleString),i.glyphIconTextCssClass=n.glyphIconTextClass,i.superScriptTextWatchable=TDB.watchableOption(i,n.superScriptText),i.superScriptClassWatchable=TDB.watchableOption(i,n.superScriptClassName),i.collapsed=TDB.watchableOption(i,n.collapsed,!1),i.glyphOnlyCssClass=n.glyphOnlyCssClass,i}return __extends(i,o),i.prototype.setChecked=function(e){if(this.isChecked!==this._isChecked)throw t.RethrowLogger.createError("Cannot set checked if it has been overridden.");this._isChecked.setValue(e)},i.prototype.onAction=function(t){var e=this;return this._isChecked&&TDB.applyUpdate(function(){e._isChecked.setValue(!e._isChecked.getValue())}),this.context&&this.buttonArgs.click&&this.isEnabled()?this.buttonArgs.click.call(this.buttonArgs.context,t):TDB.EventPropagation.Bypass},i.prototype.wrapperAttrArgs=function(t){var e=this.getButtonAttributes(t);return this.buttonArgs.role!==Aria.Roles.Button&&this.buttonArgs.role?e[Aria.Attributes.Checked]=Aria.BooleanState.fromBoolean(this.isChecked.getWatchedValue(t)):e[Aria.Attributes.Pressed]=Aria.BooleanState.fromBoolean(this.isChecked.getWatchedValue(t)),e[Aria.Attributes.Id]=this.buttonArgs.domId,e},i.prototype.wrapperClassNameArgs=function(t){return this.getButtonClass(t)},i.prototype.fontIconArgs=function(t){return this._fontIconTemplateArgs.getWatchedValue(t)&&!this.useGlyphIconText?new TDB.ChildArgs(n.FontIconVE,this._fontIconTemplateArgs.getWatchedValue(t)):void 0},i.prototype.textElementClassNameArgs=function(t){return this.textElementClass},i.prototype.textElementTextArgs=function(t){return this._textElementTextWatchable.getWatchedValue(t)},i.prototype.displayTextArgs=function(t){return!!this._textElementTextWatchable.getWatchedValue(t)&&!this.collapsed.getWatchedValue(t)},i.prototype.calloutArgs=function(t){if(this._calloutArgs&&this._calloutArgs.getWatchedValue(t))return e.Common.FRE.getCalloutManager().isActiveCallout(t,this._calloutArgs.getWatchedValue(t).calloutID)?new TDB.ChildArgs(n.FRECalloutVE,this._calloutArgs.getWatchedValue(t)):void 0},i.prototype.hasSuperScriptArgs=function(t){return!!this.superScriptTextWatchable.getWatchedValue(t)},i.prototype.superScriptClassNameArgs=function(t){return this.superScriptClassWatchable.getWatchedValue(t)},i.prototype.getRawButtonClass=function(t){var e=o.prototype.getRawButtonClass.call(this,t);return this.glyphOnlyCssClass&&this.collapsed.getWatchedValue(t)&&(e=(e?e+" ":"")+this.glyphOnlyCssClass),e},i.prototype.superScriptTextArgs=function(t){return this.superScriptTextWatchable.getWatchedValue(t)},i.prototype.glyphTextTextArgs=function(t){var e=this.textElementTextArgs(t);return this.useGlyphIconText&&e?e[0]:""},i.prototype.glyphTextClassNameArgs=function(t){return this.glyphIconTextCssClass},i.prototype.ifGlyphTextArgs=function(){return this.useGlyphIconText},i}(n.ButtonVE);n.ToggleButtonVEBase=o}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n;!function(t){t[t.Horizontal=1]="Horizontal",t[t.Vertical=2]="Vertical",t[t.All=3]="All"}(n=e.MovingDirection||(e.MovingDirection={}));var o=function(e){function o(t,n){var o=e.call(this,t)||this;return o.movableArgs=n,o.speed=o.movableArgs.defaultSpeed,o.movementTimer=void 0,o.accelerationTimer=void 0,o.position={x:o.movableArgs.x,y:o.movableArgs.y},o.logAcceleration=1.5,o}return __extends(o,e),o.prototype.moveTo=function(t){this.movableArgs.update?this.movableArgs.update.call(this.movableArgs.context,t):this.updatePosition(t),this.movementTimer&&this.movementTimer.restart(),this.accelerationTimer&&!this.accelerationTimer.started()&&this.accelerationTimer.start()},o.prototype.accelerate=function(){this.speed*=this.logAcceleration,this.accelerationTimer.restart()},o.prototype.initTimer=function(){this.movementTimer||(this.movementTimer=new t.Utilities.Timeout(this,this.movableArgs.movementTime,{onFinish:this.stopMoving})),this.movableArgs.accelerateTime&&!this.accelerationTimer&&(this.accelerationTimer=new t.Utilities.Timeout(this,this.movableArgs.accelerateTime,{onFinish:this.accelerate}))},o.prototype.startMoving=function(){this.initTimer(),this.movableArgs.start?this.movableArgs.start.call(this.movableArgs.context):this.start()},o.prototype.stopMoving=function(){this.resetSpeed(),this.movableArgs.stop?this.movableArgs.stop.call(this.movableArgs.context):this.stop()},o.prototype.start=function(){},o.prototype.stop=function(){},o.prototype.updatePosition=function(t){},o.prototype.resetSpeed=function(){this.accelerationTimer&&(this.accelerationTimer.cancel(),this.speed=this.movableArgs.defaultSpeed)},o.prototype.cancelMovement=function(){this.movementTimer&&this.movementTimer.cancel(),this.accelerationTimer&&this.accelerationTimer.cancel()},o.prototype.getMovingDirection=function(t){var e=this.movableArgs.direction&n.Horizontal?1:0,o=this.movableArgs.direction&n.Vertical?1:0;switch(t.keyCode){case KeyCodeType.UpArrowKey:e=0,o*=-1;break;case KeyCodeType.DownArrowKey:e=0,o*=1;break;case KeyCodeType.LeftArrowKey:e*=-1,o=0;break;case KeyCodeType.RightArrowKey:e*=1,o=0}return{x:e,y:o}},o.prototype.ensurePositionBoundary=function(t){return t},o.prototype.directionKeyDown=function(t){var e=this.position.x,n=this.position.y;this.startMoving();var o=this.getMovingDirection(t);return e+=o.x*this.speed,n+=o.y*this.speed,this.moveTo(this.ensurePositionBoundary({x:e,y:n})),TDB.EventPropagation.PreventDefault},o.prototype.keyDown=function(t){var n=TDB.EventPropagation.Bubble;switch(t.keyCode){case KeyCodeType.UpArrowKey:case KeyCodeType.DownArrowKey:case KeyCodeType.LeftArrowKey:case KeyCodeType.RightArrowKey:t.shiftKey||t.altKey||(n=this.directionKeyDown(t))}return n===TDB.EventPropagation.Bubble?e.prototype.keyDown.call(this,t):n},o.prototype.keyUp=function(t){return this.resetSpeed(),TDB.EventPropagation.Bubble},o}(TDB.Control);e.MovableElement=o}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(e,n){var o=t.call(this,e,{features:TDB.ControlSetFeatures.TabDisabled|TDB.ControlSetFeatures.TabInto|TDB.ControlSetFeatures.HorizontalList,tabIndex:n.tabIndex})||this;return o._visible=TDB.watchableOption(o,n.visible,!0),o._collapsed=TDB.watchableOption(o,n.collapsed,!1),o}return __extends(e,t),e.prototype.getVisible=function(t){return this._visible.getWatchedValue(t)},e.prototype.getCollapsed=function(t){return this._collapsed.getWatchedValue(t)},e.prototype.canEnter=function(){return this.getActivatableChildren().length>0},e}(TDB.ControlSet);t.CustomMenuControl=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(e,n){var o=t.call(this,e)||this;return o.args=n,o.value=TDB.watchableTag(596476949,o,n.initialValue?n.initialValue:""),o.errorMessage=TDB.watchableTag(596476950,o,n.errorMessage?n.errorMessage:""),o.isLoadingSpinnerVisible=TDB.watchableTag(596476951,o,!1),o}return __extends(e,t),e.prototype.getText=function(){var t=this.textInputValueBinding;return t?t.getValue():""},e.prototype.setText=function(t){var e=this;TDB.applyUpdate(function(){e.value.setValue(t)})},e.prototype.setErrorMessage=function(t){var e=this;TDB.applyUpdate(function(){e.errorMessage.setValue(t)})},e.prototype.setLoadingSpinnerVisibility=function(t){var e=this;TDB.applyUpdate(function(){e.isLoadingSpinnerVisible.setValue(t)})},e.prototype.wrapperClassNameArgs=function(t){return this.args.wrapperCss},e.prototype.descriptionTextArgs=function(t){return this.args.description},e.prototype.errorMessageTextArgs=function(t){return this.errorMessage.getWatchedValue(t)},e.prototype.errorMessageClassNameArgs=function(t){return this.args.errorMessageCss},e.prototype.textInputAttrArgs=function(t){var e={};return e.placeholder=this.args.placeholder,e[Aria.Attributes.Label]=this.args.label,e[Aria.Attributes.Title]=this.args.textInputTooltip,e},e.prototype.textInputClassNameArgs=function(t){return this.args.textInputCss},e.prototype.textInputValueInitArgs=function(){return{context:this.value,getValue:this.value.getWatchedValue,setValue:this.value.setValue}},e.prototype.loadingSpinnerVisibleArgs=function(t){return t.watchValue(this.isLoadingSpinnerVisible)},e.prototype.loadingSpinnerAttrArgs=function(){var t={};return t.src=CommonSettings.ContentBaseUrl+"LoadingBlackSpinner.gif",t[Aria.Attributes.Valuetext]=Resources.NativeOpenDialogOpening,t},e.prototype.keyPress=function(t){return t.keyCode==KeyCodeType.EnterKey&&this.args.onEnter?(this.args.onEnter.call(this.args.context),TDB.EventPropagation.PreventDefault):TDB.EventPropagation.Bubble},e.prototype.mouseClicked=function(t){return TDB.EventPropagation.Bypass},e}(TDB.Control);t.DialogTextInputVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){t.RegionOrderIndex={NotSpecified:0,AppBar:1,CardDeckControls:2,Preview:3,EditTemplateButton:4,PreviewPeek:5};var e=function(e){function n(t,n,o){var i=e.call(this,t,{features:n|TDB.ControlSetFeatures.PreserveFocusContext})||this;return i.activatable=o,i.isCurrentListViewItem=TDB.watchableTag(596476876,i,!1),i}return __extends(n,e),n.prototype.onEntering=function(){this.activateItem(!0)},n.prototype.onActivatedItem=function(){this.activate()},n.prototype.onDeactivatedItem=function(){this.deactivate()},n.prototype.activateItem=function(t){var e=this.getListView();return e&&e.activateListItem(this,t),this.isActivated()},n.prototype.canActivateItem=function(){return this.canActivate()},n.prototype.canEnter=function(){return this.activatable?this.activatable.getValue():e.prototype.canEnter.call(this)},n.prototype.setItemActiveState=function(t){var e=this;TDB.applyUpdate(function(){return e.isCurrentListViewItem.setValue(t)})},n.prototype.isActiveItem=function(t){return this.isCurrentListViewItem.getWatchedValue(t)},n.prototype.setSelectedState=function(t){if(this.isSelectable()){var e=this.getListView();e&&e.notifySelectionStateChanged(this,t)}},n.prototype.isSelectable=function(t){return!1},n.prototype.isSelected=function(t){return!1},n.prototype.getListView=function(){for(var e=this.parent;e;){if(e instanceof t.PageRootVEBase)return e;e=e.parent}return null},n.prototype.containsRegions=function(){return!1},n.prototype.getOrder=function(){return t.RegionOrderIndex.NotSpecified},n.prototype.toString=function(){return e.prototype.toString.call(this)+" Order="+this.getOrder()},n}(TDB.ControlSet);t.RegionViewElement=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=function(e){function n(t,n){var o=e.call(this,t,n|TDB.ControlSetFeatures.ExitOnEscape)||this;return o.originallyFocused=void 0,o}return __extends(n,e),n.prototype.onEntering=function(){var e=t.Utilities.getDocumentActiveElement();this.originallyFocused=e instanceof HTMLElement?e:void 0},n.prototype.dismiss=function(){this.originallyFocused&&this.originallyFocused.focus()},n}(e.RegionViewElement);e.RegionPopupVE=n}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=function(n){function o(o,i){var r=n.call(this,o,TDB.ControlSetFeatures.Isolated)||this;return r.fadeDone=TDB.watchableTag(596453211,r,!1),r.screenReaderText=TDB.watchableTag(596453212,r,void 0),r.headerText=TDB.watchableOption(r,i.headerText),r.bodyText=i.bodyText?i.bodyText:"",r.readerText=i.readerText?ResourceManager.ResolveString(i.readerText,[Resources.FirstRunCalloutReaderPrefix]):"",r.beakPosition=TDB.watchableTag(596453213,r,i.beakPosition),r.delay=void 0!=i.delay?i.delay:e.BasicCalloutVEBase.DefaultDelay,r.calloutSetupContext=i.context,r.calloutSetup=i.calloutSetup,r.inAnimation=t.Utilities.browser.isChrome53?"none":i.inAnimation,r.outAnimation=i.outAnimation,r.calloutBoxClassName="segoeUI calloutView "+(i.calloutBoxClassName?i.calloutBoxClassName:""),r.calloutWrapperClassName="defaultCalloutWrapper "+(i.calloutWrapperClassName?i.calloutWrapperClassName:""),r.calloutTapClassName=i.calloutTapClassName?i.calloutTapClassName:"",r.bubbleKeyEvents=i.bubbleKeyEvents?i.bubbleKeyEvents:[],r.updateCloseButtonPosition=i.updateCloseButtonPosition||!1,r.isLayoutRtl=i.isLayoutRtl||!1,r.hideCloseButton=i.hideCloseButton||!1,r.linkText=i.linkText,r.linkUrl=i.linkUrl,r.linkInSameTab=!!i.linkInSameTab,r}return __extends(o,n),o.prototype.isVisible=function(t){return!0},o.prototype.canActivate=function(){return this.isVisible()&&("none"===this.inAnimation||this.fadeDone.getValue())&&this.isInViewport()},o.prototype.isCalloutTapVisible=function(t){return this.isVisible(t)&&this.calloutTapClassName.length>0},o.prototype.showCalloutArgs=function(t){return this.isVisible(t)},o.prototype.calloutWrapperClassNameArgs=function(t){return this.calloutWrapperClassName},o.prototype.calloutTapWrapperClassNameArgs=function(t){return this.calloutTapClassName},o.prototype.calloutTapWrapperVisibleArgs=function(t){return this.isCalloutTapVisible(t)},o.prototype.calloutTapWrapperCalloutFadeInitArgs=function(){return this.calloutBoxCalloutFadeInitArgs()},o.prototype.calloutTapWrapperCalloutFadeArgs=function(t){return{visible:this.isCalloutTapVisible(t),inAnimation:this.inAnimation,outAnimation:this.outAnimation}},o.prototype.calloutTapAnimationInnerClassNameArgs=function(e){return t.Utilities.browser.isIEOrEdge||t.Utilities.browser.isChrome53?"TapInner":"TapAnimationInner"},o.prototype.calloutTapAnimationOuterClassNameArgs=function(e){return t.Utilities.browser.isIEOrEdge||t.Utilities.browser.isChrome53?"TapOuter":"TapAnimationOuter"},o.prototype.calloutBoxCalloutFadeInitArgs=function(){var n;switch(this.beakPosition.getValue()){case e.BeakPosition.Left:n=CommonBindings.View.Bindings.CalloutFade.Direction.Left;break;case e.BeakPosition.Right:n=CommonBindings.View.Bindings.CalloutFade.Direction.Right;break;case e.BeakPosition.BottomLeft:case e.BeakPosition.BottomRight:n=CommonBindings.View.Bindings.CalloutFade.Direction.Down;break;default:n=CommonBindings.View.Bindings.CalloutFade.Direction.Up}return{context:this,delay:this.delay+"s",direction:n,animationEndAction:this.calloutFadeEndAction,disabled:t.Utilities.browser.isChrome53}},o.prototype.calloutBoxCalloutFadeArgs=function(t){return{visible:this.isVisible(t),inAnimation:this.inAnimation,outAnimation:this.outAnimation}},o.prototype.calloutBeakClassNameArgs=function(t){return this.calloutBeakClassNameHelper(t,"calloutBeak calloutBeak-")},o.prototype.calloutBeakBorderClassNameArgs=function(t){return this.calloutBeakClassNameHelper(t,"calloutBeakBorder calloutBeakBorder-")},o.prototype.calloutBeakClassNameHelper=function(t,n){var o=n;switch(t.watchValue(this.beakPosition)){case e.BeakPosition.Left:o+="left";break;case e.BeakPosition.TopLeft:o+="topLeft";break;case e.BeakPosition.TopRight:o+="topRight";break;case e.BeakPosition.Right:o+="right";break;case e.BeakPosition.BottomLeft:o+="bottomLeft";break;case e.BeakPosition.BottomRight:o+="bottomRight";break;default:return""}return o},o.prototype.calloutBoxClassNameArgs=function(t){return this.calloutBoxClassName},o.prototype.calloutHeaderTextArgs=function(t){return this.headerText.getWatchedValue(t)},o.prototype.calloutHeaderStyleArgs=function(){return 0===this.bodyText.length?{fontSize:"15px"}:{fontSize:"18px",marginBottom:"8px"}},o.prototype.calloutBodyTextArgs=function(){return this.bodyText},o.prototype.closeButtonArgs=function(){if(!this.hideCloseButton){var t={buttonId:ClientAction.ButtonId.Callout_CloseButton,click:this.closeButtonClicked,context:this,cssClass:{value:this.getCloseButtonCss()},description:{value:Resources.CalloutCloseButton},fontIconName:{value:FontIcons.CloseCalloutIcon},fontIconSizeClass:FontIcons.CloseCalloutButtonIconSize,fontIconWrapperClass:{value:"calloutCloseButtonWrapperFont"}};return new TDB.ChildArgs(e.GlyphButtonVE,t)}},o.prototype.closeButtonClicked=function(t){return this.escape(),TDB.EventPropagation.Bypass},o.prototype.dismissCallout=function(t){},o.prototype.escape=function(){this.dismissCallout(!1)},o.prototype.handleShortcutKey=function(t){return ArrayExtensions.contains(this.bubbleKeyEvents,t.keyCode)||t.keyCode===KeyCodeType.F6Key&&t.ctrlKey&&!t.altKey?TDB.EventPropagation.Bubble:TDB.EventPropagation.PreventDefault},o.prototype.getDelay=function(){return this.delay},o.prototype.mouseClicked=function(t){return TDB.EventPropagation.PreventDefault},o.prototype.mouseOver=function(t){return t.stopPropagation(),t.preventDefault(),!1},o.prototype.mouseDown=function(t){return TDB.EventPropagation.PreventDefault},o.prototype.calloutTapClicked=function(t){var e=t.srcElement||t.target;$(e).parent().hide();var n=document.elementFromPoint(t.clientX,t.clientY);$(e).parent().show();var o=TDB.ViewElement.dataFor(n);return!(!o||!o.handleMouseEvent)&&o.handleMouseEvent(t,TDB.ViewElementMouseEventType.MouseClickEvent)===TDB.EventPropagation.Bubble},o.prototype.calloutBoxEventsInitArgs=function(){return{mouseover:this.mouseOver}},o.prototype.calloutTapWrapperEventsInitArgs=function(){return{click:this.calloutTapClicked}},o.prototype.calloutBoxAttrArgs=function(t){var e={};return e.title=void 0,e["aria-label"]=Resources.FirstRunCalloutReaderPrefix,e[Aria.Attributes.Role]=Aria.Roles.Dialog,e},o.prototype.calloutStatusTextArgs=function(t){return this.isVisible(t)?this.screenReaderText.getWatchedValue(t):void 0},o.prototype.setup=function(){this.calloutSetupContext&&this.calloutSetup&&this.calloutSetup.call(this.calloutSetupContext)},o.prototype.calloutFadeEndAction=function(){var t=this;TDB.applyUpdate(function(){t.screenReaderText.setValue(t.readerText),t.fadeDone.setValue(!0)},TDB.Justification.CalloutUpdate)},o.prototype.firstChanceMouseEvent=function(t,e,n){return TDB.EventPropagation.Bubble},o.prototype.onChildActiveStateChanged=function(t,e){},o.prototype.calloutTextAttrArgs=function(t){var e={};return e.dir=CommonSettings.SiteUiRtl?"rtl":"ltr",e},o.prototype.wrapperClassNameArgs=function(t){return this.updateCloseButtonPosition?CommonSettings.SiteUiRtl===this.isLayoutRtl?"calloutCloseButtonWrapperRight":"calloutCloseButtonWrapperLeft":CommonSettings.SiteUiRtl?"calloutCloseButtonWrapperLeft":"calloutCloseButtonWrapperRight"},o.prototype.isInViewport=function(){var t=this.getControlPosition();return t&&t.top>0&&t.top<=window.innerHeight&&t.left>0&&t.left<=window.innerWidth},o.prototype.getCloseButtonCss=function(){return this.updateCloseButtonPosition?CommonSettings.SiteUiRtl===this.isLayoutRtl?"calloutCloseButtonRight":"calloutCloseButtonLeft":CommonSettings.SiteUiRtl?"calloutCloseButtonLeft":"calloutCloseButtonRight"},o.prototype.linkArgs=function(){if(this.linkUrl&&this.linkText){var t={url:this.linkUrl,message:this.linkText,target:this.linkInSameTab?"_self":"_blank",context:this,class:"calloutLink"};return new TDB.ChildArgs(e.ClickableLinkVE,t)}},o.DefaultDelay=.8,o}(e.RegionPopupVE);e.BasicCallout=n}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){!function(t){t[t.None=0]="None",t[t.TopLeft=1]="TopLeft",t[t.TopRight=2]="TopRight",t[t.Left=3]="Left",t[t.Right=4]="Right",t[t.BottomLeft=5]="BottomLeft",t[t.BottomRight=6]="BottomRight"}(t.BeakPosition||(t.BeakPosition={}));var e=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e}(t.BasicCallout);t.BasicCalloutVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){!function(t){function e(e,n){var o=s[t.FirstRunType[n]];if(!o)return TDB.raiseRecoverableError("No dispatcher available for type: "+n,TDB.LogLevel.error),a[r[r.None]];var i=o[r[e]];return null===i||void 0===i?(TDB.raiseRecoverableError("Requested delay for unknown callout: "+e+", for type: "+n,TDB.LogLevel.error),a[r[r.None]]):i}function n(){return i||(i=CommonSettings.ContextualFirstRunEnabled?new t.FRECalloutManager:new t.NullFRECalloutManager),i}function o(){i=void 0}var i,r;!function(t){t[t.None=0]="None",t[t.SwayTitle=1]="SwayTitle",t[t.TitleJack=2]="TitleJack",t[t.PreviewHeader=3]="PreviewHeader",t[t.PlayButton=4]="PlayButton",t[t.ReturnToAuthoring=5]="ReturnToAuthoring",t[t.UndoButton=6]="UndoButton",t[t.VerticalNavigation=7]="VerticalNavigation",t[t.PanoramaNavigation=8]="PanoramaNavigation",t[t.ExpoNavigation=9]="ExpoNavigation",t[t.PhotoStack=10]="PhotoStack",t[t.DetailView=11]="DetailView",t[t.Storyline=12]="Storyline",t[t.EmptySwayPreview=13]="EmptySwayPreview",t[t.AddContentSearchBox=14]="AddContentSearchBox",t[t.AddContentSourcesDropdown=15]="AddContentSourcesDropdown",t[t.PublishButton=16]="PublishButton",t[t.RemixButton=17]="RemixButton",t[t.EditTemplate=18]="EditTemplate",t[t.OverflowButton=19]="OverflowButton",t[t.FirstHint=20]="FirstHint",t[t.AutoPlayConsumptionSettingsButton=21]="AutoPlayConsumptionSettingsButton",t[t.AutoPlaySettingsButton=22]="AutoPlaySettingsButton",t[t.ShareSway=23]="ShareSway",t[t.ShareSwayAADRecipients=24]="ShareSwayAADRecipients",t[t.StylesButton=25]="StylesButton",t[t.DesignButton=26]="DesignButton",t[t.CustomColorEntry=27]="CustomColorEntry",t[t.IngestedDocumentSurvey=28]="IngestedDocumentSurvey",t[t.DigitalPrintWelcome=29]="DigitalPrintWelcome",t[t.DigitalPrintAuthoring=30]="DigitalPrintAuthoring",t[t.DigitalPrintShare=31]="DigitalPrintShare",t[t.DigitalPrintPlay=32]="DigitalPrintPlay",t[t.DigitalPrintStoryline=33]="DigitalPrintStoryline",t[t.PullQuote=34]="PullQuote"}(r=t.CalloutID||(t.CalloutID={}));var a={None:1,SwayTitle:.5,TitleJack:.5,PreviewHeader:0,PlayButton:2,ReturnToAuthoring:2,UndoButton:5,VerticalNavigation:2.5,PanoramaNavigation:2.5,ExpoNavigation:2.5,PhotoStack:0,DetailView:0,Storyline:1.5,EmptySwayPreview:1.5,AddContentSearchBox:2,AddContentSourcesDropdown:2,PublishButton:2.5,RemixButton:2,EditTemplate:2,OverflowButton:2,FirstHint:.5,AutoPlayConsumptionSettingsButton:2,AutoPlaySettingsButton:2,ShareSway:0,StylesButton:0,DesignButton:0,CustomColorEntry:0,IngestedDocumentSurvey:0,DigitalPrintWelcome:2,DigitalPrintAuthoring:2,DigitalPrintShare:2,DigitalPrintPlay:0,DigitalPrintStoryline:0,ShareSwayAADRecipients:2,PullQuote:0},s={Default:a,FRENonEmpty:{None:1,SwayTitle:0,TitleJack:3,PreviewHeader:0,PlayButton:2,ReturnToAuthoring:7,UndoButton:5,VerticalNavigation:2.5,PanoramaNavigation:2.5,ExpoNavigation:2.5,PhotoStack:0,DetailView:0,Storyline:1.5,EmptySwayPreview:1.5,AddContentSearchBox:2,AddContentSourcesDropdown:5,PublishButton:2.5,RemixButton:2,EditTemplate:2,OverflowButton:2,FirstHint:.5,AutoPlayConsumptionSettingsButton:2,AutoPlaySettingsButton:2,ShareSway:0,StylesButton:0,DesignButton:0,CustomColorEntry:0,IngestedDocumentSurvey:0,DigitalPrintWelcome:2,DigitalPrintAuthoring:2,DigitalPrintShare:2,DigitalPrintPlay:0,DigitalPrintStoryline:0,ShareSwayAADRecipients:2,PullQuote:0}};t.getDelayForCallout=e,t.getCalloutManager=n,t.deleteCalloutManager=o}(t.FRE||(t.FRE={}))}(t.Common||(t.Common={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){!function(t){var e=function(){function e(){this.currentCalloutID=TDB.watchableTag(596464327,this,t.CalloutID.None),this.callouts={}}return e.prototype.addCallout=function(t,e){this.callouts[t]=e},e.prototype.getCallout=function(t){return this.callouts[t]},e.prototype.getCurrentCalloutID=function(t){return this.currentCalloutID.getWatchedValue(t)},e.prototype.getCurrentCalloutStartTime=function(){return this.currentCalloutStartTime},e.prototype.isActiveCallout=function(t,e){return this.getCurrentCalloutID(t)===e},e.prototype.getCurrentTriggerContext=function(){return this.currentTriggerContext},e.prototype.updateCallout=function(t,e){var n=this;TDB.applyUpdate(function(){n.currentTriggerContext=e,n.currentCalloutID.setValue(t)},TDB.Justification.CalloutUpdate),this.currentCalloutStartTime=platform.now()},e.prototype.clearCallouts=function(){var e=this,n=this.getCallout(this.currentCalloutID.getValue());n&&n.dismissCallout(!0),TDB.applyUpdate(function(){e.currentCalloutID.setValue(t.CalloutID.None)},TDB.Justification.CalloutUpdate)},e.prototype.setup=function(){},e}();t.FRECalloutManager=e}(t.FRE||(t.FRE={}))}(t.Common||(t.Common={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=t.View.Common.FRE,o=function(t){function o(e,n){var o=t.call(this,e,n)||this;return o.calloutArguments=TDB.watchableOption(o,n.calloutArgs),o.wrapperClassName=n.wrapperClassName||"",o}return __extends(o,t),o.prototype.calloutGlyphButtonWrapperClassNameArgs=function(t){return this.wrapperClassName},o.prototype.calloutArgs=function(t){var o=this.calloutArguments.getWatchedValue(t),i=n.getCalloutManager();if(o&&i.isActiveCallout(t,o.calloutID))return new TDB.ChildArgs(e.FRECalloutVE,o)},o}(e.GlyphButtonVEBase);e.CalloutGlyphButtonVEBase=o}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=function(e){function n(n,o){var i=e.call(this,n)||this;if(!o)throw t.RethrowLogger.createError("FREPage3VE args missing.");if(i.isSmallScreen=TDB.watchableOption(i,o.isSmallScreen,!1),i.animationsPaused=TDB.watchableOption(i,o.animationsPaused,!1),i.timerInterval=o.timerIntervalMs?o.timerIntervalMs:1e3,i.imagesIndex=TDB.watchableTag(596476800,i,0),o.imagesLargeLtr&&o.imagesSmallLtr?(o.imagesLargeLtr.length!==o.imagesSmallLtr.length&&TDB.raiseRecoverableError("Number of images for large and small screens (LTR setup) should be the same.",TDB.LogLevel.error),i.imagesLargeLtr=o.imagesLargeLtr,i.imagesSmallLtr=o.imagesSmallLtr):(i.imagesLargeLtr=[],i.imagesSmallLtr=[]),o.imagesLargeRtl&&o.imagesSmallRtl?(o.imagesLargeRtl.length!==o.imagesSmallRtl.length&&TDB.raiseRecoverableError("Number of images for large and small screens (RTL setup) should be the same.",TDB.LogLevel.error),i.imagesLargeRtl=o.imagesLargeRtl,i.imagesSmallRtl=o.imagesSmallRtl):(i.imagesLargeRtl=[],i.imagesSmallRtl=[]),o.subtitleCssLarge&&o.subtitleCssSmall){if(o.subtitleCssLarge.length!==o.subtitleCssSmall.length)throw t.RethrowLogger.createError("Number of styles for large and small screens should be the same.");i.subtitleCssLarge=o.subtitleCssLarge,i.subtitleCssSmall=o.subtitleCssSmall}else i.subtitleCssLarge=[],i.subtitleCssSmall=[];return i.timer=platform.setInterval(function(){var t=i.imagesIndex.getValue()+1;t=t<i.imagesLargeLtr.length?t:0,i.animationsPaused.getValue()||TDB.applyUpdate(function(){i.imagesIndex.setValue(t)})},i.timerInterval),i}return __extends(n,e),n.prototype.dispose=function(t){this.timer&&clearInterval(this.timer),e.prototype.dispose.call(this,t)},n.prototype.titleTextArgs=function(t){return Resources.FREDialogPage3Title},n.prototype.titleClassNameArgs=function(t){return this.isSmallScreen.getWatchedValue(t)?"frePage3TitleSmall":"frePage3TitleLarge"},n.prototype.accessibilityMessageTextArgs=function(t){return Resources.FREDialogPage3Narration},n.prototype.imageWrapperClassNameArgs=function(t){return this.isSmallScreen.getWatchedValue(t)?"frePage3ImageWrapperSmall":"frePage3ImageWrapperLarge"},n.prototype.actionTextArgs=function(){return Resources.SwayThis},n.prototype.actionClassNameArgs=function(t){return this.isSmallScreen.getWatchedValue(t)?"frePage3ActionSmall":"frePage3ActionLarge"},n.prototype.imageAttrArgs=function(t){var e=this.imagesIndex.getWatchedValue(t),n=Resources.FREDialogPage3ImageAlt,o=this.isSmallScreen.getWatchedValue(t)?this.imagesSmallLtr:this.imagesLargeLtr,i=this.isSmallScreen.getWatchedValue(t)?this.imagesSmallRtl:this.imagesLargeRtl;return{src:CommonSettings.SiteUiRtl?i[e]:o[e],alt:n}},n.prototype.subtitleTextArgs=function(){return Resources.FREDialogPage3Subtitle},n.prototype.subtitleClassNameArgs=function(t){var e=this.imagesIndex.getWatchedValue(t);return(this.isSmallScreen.getWatchedValue(t)?this.subtitleCssSmall:this.subtitleCssLarge)[e]},n}(TDB.FocusableViewElement);e.FREPage3VEBase=n}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=function(e){function n(n,o){var i=e.call(this,n)||this;if(!o)throw t.RethrowLogger.createError("FREPage2VE args missing.");if(i._isSmallScreen=TDB.watchableOption(i,o.isSmallScreen,!1),i._animationsPaused=TDB.watchableOption(i,o.animationsPaused,!1),i._timerIntervalMs=o.timerIntervalMs?o.timerIntervalMs:1e3,o.imagesLarge&&o.imagesSmall){if(o.imagesLarge.length!==o.imagesSmall.length)throw t.RethrowLogger.createError("Number of images for large and small screens should be the same.");i._imagesLarge=o.imagesLarge,i._imagesSmall=o.imagesSmall}else i._imagesLarge=[],i._imagesSmall=[];return i._numberOfStates=i._imagesLarge.length,i._imagesIndex=TDB.watchableTag(596476801,i,i._numberOfStates),i._timer=platform.setInterval(function(){var t=i._imagesIndex.getValue()-1;t=t<0?i._numberOfStates:t,i._animationsPaused.getValue()||TDB.applyUpdate(function(){i._imagesIndex.setValue(t)})},i._timerIntervalMs),i}return __extends(n,e),n.prototype.dispose=function(t){this.stopTimer(),e.prototype.dispose.call(this,t)},n.prototype.stopTimer=function(){this._timer&&clearInterval(this._timer),this._timer=void 0},n.prototype.titleTextArgs=function(t){return Resources.FREDialogPage2TitleV2},n.prototype.titleClassNameArgs=function(t){return this._isSmallScreen.getWatchedValue(t)?"frePage2TitleSmall":"frePage2TitleLarge"},n.prototype.accessibilityMessageTextArgs=function(t){return Resources.FREDialogPage2Narration},n.prototype.imageWrapperClassNameArgs=function(t){return this._isSmallScreen.getWatchedValue(t)?"frePage2ImageWrapperSmall":"frePage2ImageWrapperLarge"},n.prototype.actionTextArgs=function(){return Resources.AuthoringPanelContent},n.prototype.actionClassNameArgs=function(t){return this._isSmallScreen.getWatchedValue(t)?"frePage2ActionSmall":"frePage2ActionLarge"},n.prototype.actionStyleArgs=function(t){return{display:this._imagesIndex.getWatchedValue(t)<this._imagesLarge.length?"none":""}},n.prototype.backgroundImageAttrArgs=function(t){var e=Resources.FREDialogPage2ImageAlt,n=this._isSmallScreen.getWatchedValue(t)?Icons.FREDialogPage2ImageSmall_Menu:Icons.FREDialogPage2ImageLarge_Menu,o=this._isSmallScreen.getWatchedValue(t)?Icons.FREDialogPage2ImageSmall_Menu_Rtl:Icons.FREDialogPage2ImageLarge_Menu_Rtl;return{src:CommonSettings.SiteUiRtl?o:n,alt:e}},n.prototype.backgroundImageClassNameArgs=function(t){return this._isSmallScreen.getWatchedValue(t)?"frePage2ImageSmall":"frePage2ImageLarge"},n.prototype.sourceImageAttrArgs=function(t){var e=this._imagesIndex.getWatchedValue(t),n="";return e<this._imagesLarge.length&&(n=(this._isSmallScreen.getWatchedValue(t)?this._imagesSmall:this._imagesLarge)[e]),{src:n}},n.prototype.sourceImageClassNameArgs=function(t){return this._isSmallScreen.getWatchedValue(t)?"frePage2SourceImageSmall":"frePage2SourceImageLarge"},n.prototype.sourceImageStyleArgs=function(t){var e=this._imagesIndex.getWatchedValue(t),n=0,o="none";return e<this._imagesLarge.length&&(n=(n=e*(this._isSmallScreen.getWatchedValue(t)?19:33)-(this._isSmallScreen.getWatchedValue(t)?14:10))>0?n:0,o=""),{top:n.toString()+"px",display:o}},n}(TDB.FocusableViewElement);e.FREPage2VEBase=n}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=function(e){function n(n,o){var i=e.call(this,n)||this;if(!o)throw t.RethrowLogger.createError("FREPage1VE args missing.");return i._isSmallScreen=TDB.watchableOption(i,o.isSmallScreen,!1),i}return __extends(n,e),n.prototype.dispose=function(t){e.prototype.dispose.call(this,t)},n.prototype.titleTextArgs=function(){return Resources.FREDialogPage1Title},n.prototype.accessibilityMessageTextArgs=function(t){return Resources.FREDialogPage1Narration},n.prototype.titleClassNameArgs=function(t){return this._isSmallScreen.getWatchedValue(t)?"frePage1TitleSmall":"frePage1TitleLarge"},n.prototype.subtitleWrapperClassNameArgs=function(t){return this._isSmallScreen.getWatchedValue(t)?"frePage1SubtitleWrapperSmallCentered":"frePage1SubtitleWrapperLargeCentered"},n.prototype.subtitleTextArgs=function(t){switch(CommonSettings.CurrentUserType){case UserType.AAD_BUS:return Resources.FREDialogPage1SubitleBus;case UserType.AAD_EDU:return Resources.FREDialogPage1SubitleEdu;case UserType.MSA:return Resources.FREDialogPage1SubitleMsa;default:return StoryLog.TraceTag(596456135,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"Unexpected user type."),Resources.FREDialogPage1SubitleBus}},n.prototype.subtitleClassNameArgs=function(t){return this._isSmallScreen.getWatchedValue(t)?"frePage1SubtitleSmallInline":"frePage1SubtitleLargeInline"},n.prototype.imageAttrArgs=function(t){var e=CommonSettings.UserLocaleString,n=Resources.FREDialogPage1ImageAlt;return e in FREDialogPage1ImageLarge||(e="en-us"),{src:this._isSmallScreen.getWatchedValue(t)?FREDialogPage1ImageSmall[e]:FREDialogPage1ImageLarge[e],alt:n}},n.prototype.imageClassNameArgs=function(t){return this._isSmallScreen.getWatchedValue(t)?"frePage1ImageSmall":"frePage1ImageLarge"},n}(TDB.FocusableViewElement);e.FREPage1VEBase=n}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=function(n){function o(e,o){var i=this;if(!o)throw t.RethrowLogger.createError("FRECarouselVE args missing.");if(i=n.call(this,e)||this,!o.carouselContentFactory)throw t.RethrowLogger.createError("Carousel content factory not specified");return i._carouselContentFactory=o.carouselContentFactory,i._numberOfCarouselVEs=o.numberOfCarouselVEs?o.numberOfCarouselVEs:0,i.content=TDB.watchableTag(596476803,i,null),i._elementIndex=TDB.watchableTag(596476804,i,1),i._animationsPaused=TDB.watchableTag(596476805,i,!1),i._isSmallScreen=TDB.watchableOption(i,o.isSmallScreen,!1),i._indexButtonDescriptions=o.indexButtonDescriptions,i.moveToStart(TDB.Justification.Initialization),i}return __extends(o,n),o.prototype.setElement=function(t,e,n){var i=this;TDB.applyUpdate(function(){i._elementIndex.setValue(e);var t=i._carouselContentFactory.createDialogContent(e,i._animationsPaused);i.content.setValue(t)},n),platform.setTimeout(function(){i.disposed||(e<i._numberOfCarouselVEs-1?i.nextButton.setFocus():i._dismissButtonVE.getControl().setFocus())},o.c_buttonFocusSwitchDelay)},o.prototype.setPausedState=function(t){var e=this;TDB.applyUpdate(function(){e._animationsPaused.setValue(t)}),t?this.playButton&&this.playButton.setFocus():this.pauseButton&&this.pauseButton.setFocus()},o.prototype.getElementIndex=function(t){return this._elementIndex.getWatchedValue(t)},o.prototype.changeElement=function(t,e){var n=this.getElementIndex(),o=this._numberOfCarouselVEs-1;n===t||t<0||o<t||(n=n>o?o:n,this.setElement(n,t,e))},o.prototype.hasDismissButton=function(){return!!this._dismissButtonVE},o.prototype.clickDismissButton=function(){var e=this;t.View.Common.DialogManager.getInstance().closeCurrentDialog(function(){return e.freDismissed()})},o.prototype.indexButtonsArgs=function(){for(var t=this,n=[],o=this._numberOfCarouselVEs,i=this,r=0;r<o;r++)!function(o){var r=o,a=i._indexButtonDescriptions&&i._indexButtonDescriptions[o]?i._indexButtonDescriptions[o]:Resources.FREDialogIndexButtonDescription,s={buttonId:ClientAction.ButtonId.FREDialogCarouselIndex,telemetryId:"FREIndexButton"+(1+o),textElementText:{value:""},description:{value:a},tooltip:{value:a},click:i.indexButtonClicked.bind(i,o),context:i,cssClass:{value:"freCarouselIndexButton"},calculateChecked:function(e){return t._elementIndex.getWatchedValue(e)===r},tabIndex:-1};n.push(new TDB.ChildArgs(e.ToggleButtonVE,s))}(r);return n},o.prototype.indexButtonClicked=function(t){var e=t+1;return StoryLog.TraceTag(596476806,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"FRE multi-page dialog carousel index button ["+e+"] pressed."),this.moveToIndex(t),!1},o.prototype.moveToIndex=function(t){this.changeElement(t)},o.prototype.moveToStart=function(t){this.changeElement(0,t)},o.prototype.pauseClicked=function(t){return StoryLog.TraceTag(596476807,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"FRE multi-page dialog carousel pause button pressed."),this.setPausedState(!0),TDB.EventPropagation.Bypass},o.prototype.playClicked=function(t){return StoryLog.TraceTag(596476808,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"FRE multi-page dialog carousel play button pressed."),this.setPausedState(!1),TDB.EventPropagation.Bypass},o.prototype.previousClicked=function(t){return StoryLog.TraceTag(596476809,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"FRE multi-page dialog carousel previous button pressed."),this.movePrevious(),TDB.EventPropagation.Bypass},o.prototype.movePrevious=function(){var t=this.getElementIndex()-1;this.changeElement(t)},o.prototype.nextButtonArgs=function(){var t={buttonId:ClientAction.ButtonId.FREDialogCarouselNext,telemetryId:"FRENextButton",click:this.nextClicked,context:this,description:{value:Resources.FREDialogNextButtonDescription},fontIconName:{value:FontIcons.FRECarouselNextIcon},fontIconSizeClass:FontIcons.FRECarouselNextIconSize,cssClass:{value:"freCarouselNavButton"},tooltip:{value:Resources.FREDialogNextButtonCaption}};return new TDB.ChildArgs(e.GlyphButtonVE,t)},o.prototype.nextClicked=function(t){return StoryLog.TraceTag(596476810,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"FRE multi-page dialog carousel next button pressed."),this.moveNext(),TDB.EventPropagation.Bypass},o.prototype.moveNext=function(){var t=this.getElementIndex()+1;this.changeElement(t)},o.prototype.hasNextButton=function(){return!!this.nextButton},o.prototype.clickNextButton=function(){this.nextButton.mouseClicked(void 0)},o.prototype.carouselContentWrapperClassNameArgs=function(t){return this._isSmallScreen.getWatchedValue(t)?"freCarouselContentWrapperSmall":"freCarouselContentWrapperLarge"},o.prototype.contentArgs=function(){return this.content},o.prototype.carouselFooterWrapperClassNameArgs=function(t){return this._isSmallScreen.getWatchedValue(t)?"freCarouselFooterWrapperSmall":"freCarouselFooterWrapperLarge"},o.prototype.dismissButtonWrapperClassNameArgs=function(t){return this._isSmallScreen.getWatchedValue(t)?"freCarouselDismissButtonWrapperSmall":"freCarouselDismissButtonWrapperLarge"},o.prototype.dismissButtonWrapperVisibleArgs=function(t){return!(this._elementIndex.getWatchedValue(t)<this._numberOfCarouselVEs-1)},o.prototype.dismissButtonArgs=function(){var n={dialogManager:t.View.Common.DialogManager.getInstance(),displayArgs:{caption:{value:Resources.NewUserDialogButton},isDefault:!0,dismissOnAction:!0,onAction:this.freDismissed,customTextButton:{telemetryId:"FREDismiss",buttonId:ClientAction.ButtonId.DialogButton,text:{value:Resources.FRESplashPageButton},textClass:"freCarouselDismissButtonText",cssClass:{value:"freCarouselDismissButton"}}}};return new TDB.ChildArgs(e.DialogButtonVE,n)},o.prototype.freDismissed=function(){StoryLog.TraceTag(596476811,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,'FRE multi-page dialog "GetStarted" button pressed.')},o.prototype.pauseButtonArgs=function(){var t={buttonId:ClientAction.ButtonId.FREDialogCarouselPause,telemetryId:"FREPauseButton",click:this.pauseClicked,context:this,description:{value:Resources.FREDialogPauseButtonDescription},tooltip:{value:Resources.FREDialogPauseButtonDescription},fontIconName:{value:FontIcons.FRECarouselPauseIcon},fontIconSizeClass:FontIcons.FRECarouselPauseIconSize,cssClass:{value:"freCarouselAnimButton"}};return new TDB.ChildArgs(e.GlyphButtonVE,t)},o.prototype.pauseWrapperClassNameArgs=function(t){return"freCarouselNavButtonWrapper"},o.prototype.pauseWrapperVisibleArgs=function(t){return!this._animationsPaused.getWatchedValue(t)},o.prototype.playButtonArgs=function(){var t={buttonId:ClientAction.ButtonId.FREDialogCarouselPlay,telemetryId:"FREPlayButton",click:this.playClicked,context:this,description:{value:Resources.FREDialogPlayButtonDescription},tooltip:{value:Resources.FREDialogPlayButtonDescription},fontIconName:{value:FontIcons.FRECarouselPlayIcon},fontIconSizeClass:FontIcons.FRECarouselPlayIconSize,cssClass:{value:"freCarouselAnimButtonPlay"}};return new TDB.ChildArgs(e.GlyphButtonVE,t)},o.prototype.playWrapperClassNameArgs=function(t){return"freCarouselNavButtonWrapper"},o.prototype.playWrapperVisibleArgs=function(t){return this._animationsPaused.getWatchedValue(t)},o.prototype.previousButtonArgs=function(){var t={buttonId:ClientAction.ButtonId.FREDialogCarouselPrevious,telemetryId:"FREPreviousButton",click:this.previousClicked,context:this,description:{value:Resources.FREDialogPreviousButtonDescription},fontIconName:{value:FontIcons.FRECarouselPreviousIcon},fontIconSizeClass:FontIcons.FRECarouselPreviousIconSize,cssClass:{value:"freCarouselNavButton"},tooltip:{value:Resources.FREDialogPreviousButtonCaption}};return new TDB.ChildArgs(e.GlyphButtonVE,t)},o.prototype.previousWrapperClassNameArgs=function(t){return"freCarouselPreviousButtonWrapper"},o.prototype.previousWrapperVisibleArgs=function(t){return 0!==this._elementIndex.getWatchedValue(t)},o.prototype.nextWrapperClassNameArgs=function(t){return"freCarouselNextButtonWrapper"},o.prototype.nextWrapperVisibleArgs=function(t){return this._elementIndex.getWatchedValue(t)!==this._numberOfCarouselVEs-1},o.c_buttonFocusSwitchDelay=50,o}(TDB.FocusableViewElement);e.FRECarouselVEBase=n}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(e){function n(t,n){var o=e.call(this,t)||this;return o.args=n,o}return __extends(n,e),n.prototype.calloutTextAttrArgs=function(){var t={};return t.dir=CommonSettings.SiteUiRtl?"rtl":"ltr",t},n.prototype.calloutHeaderTextArgs=function(){return this.args.headerText},n.prototype.calloutBodyTextArgs=function(){return this.args.bodyText},n.prototype.calloutTextClassNameArgs=function(){return this.args.textWrapperClass},n.prototype.calloutGlyphArgs=function(){var e={fontIconName:{value:this.args.glyphClass},fontIconSizeClass:this.args.glyphClassSize,fontIconWrapperClass:{value:this.args.glyphWrapperClass}};return new TDB.ChildArgs(t.FontIconVE,e)},n}(TDB.FocusableViewElement);t.GlyphTextCalloutBodyVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(e){function n(t,n){var o=e.call(this,t)||this;return o.buttonArguments=TDB.watchableOption(o,n.buttonArgs),o.calloutArguments=TDB.watchableOption(o,n.calloutArgs),o}return __extends(n,e),n.prototype.buttonArgs=function(e){var n=this,o=this.buttonArguments.getWatchedValue(e),i=o.click;return o.click=function(t){return n.onButtonClicked(o.context,i,t)},new TDB.ChildArgs(t.GlyphButtonVE,o)},n.prototype.onButtonClicked=function(t,e,n){return this.callout&&this.callout.show(),e.call(t,n)},n.prototype.calloutArgs=function(e){var n=this.calloutArguments.getWatchedValue(e);if(n)return new TDB.ChildArgs(t.TransientCalloutVE,n)},n}(TDB.FocusableViewElement);t.TransientCalloutGlyphButtonVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var ActionLogger;!function(t){function e(t,e){f.getInstance().setContext(t,e)}function n(){f.getInstance().operationStarted()}function o(){f.getInstance().operationEnded(!0)}function i(){f.getInstance().flush()}function r(t){return f.getInstance().getCounterValue(t)}function a(t,e){void 0===e&&(e=null),f.getInstance().decrementCounter(t),null!==e&&f.getInstance().setContext(t,e)}function s(t,e){void 0===e&&(e=null),f.getInstance().incrementCounter(t),null!==e&&f.getInstance().setContext(t,e)}function l(t,e,n){void 0===e&&(e=0),void 0===n&&(n=null),f.getInstance().createCounter(t,e,n)}function u(t,e,n){void 0===n&&(n=null),f.getInstance().createMeasure(t,e,n)}function c(t,e){f.getInstance().observeValues(t,e)}function d(t){f.getInstance().resetCounter(t)}function p(t){f.getInstance().recordAction(t)}function g(t){f.getInstance().recordRenderTiming(t)}function h(t){f.getInstance().actionStarted(t)}function m(t){f.getInstance().registerActionCallback(t)}function y(t){f.getInstance().unregisterActionCallback(t)}var f=function(){function t(){this.actions=[],this.actionsTypeName=[],this.aggregations={},this.renderTimes=[],this.actionInProgress=null,this.syncActionsStarted=0,this.syncActionsEnded=0,this.markTimingNonAtomic=!1,this.actionCallbacks=[],this.resetRecord()}return t.prototype.getStartTime=function(){return this.operationStart},t.prototype.decrementCounter=function(t){var e=this.getAggregationById(t);if(!e)throw StoryApp.RethrowLogger.createError("ActionLogger.decrementCounter() called for uninitialized counter:"+t);e.decrement()},t.prototype.getCounterValue=function(t){var e=this.getAggregationById(t);return e?e.getValue():(StoryLog.TraceTag(596477409,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"ActionLogger.getCounterValue() called for uninitialized counter:"+t),-1)},t.prototype.incrementCounter=function(t){var e=this.getAggregationById(t);e?e.increment():(this.createCounter(t),this.incrementCounter(t))},t.prototype.createCounter=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=null);var o=this.getAggregationById(t);if(o&&!CommonSettings.AuthoringFromLandingPageContextEnabled)throw StoryApp.RethrowLogger.createError("ActionLogger.createCounter() called for existing counter: "+t);o&&this.logAction(o),this.aggregations[t]=new ClientAction.CounterData(t,e,n)},t.prototype.createMeasure=function(t,e,n){void 0===n&&(n=null);var o=this.getAggregationById(t);if(o&&!CommonSettings.AuthoringFromLandingPageContextEnabled)throw StoryApp.RethrowLogger.createError("ActionLogger.createMeasure() called for existing measure: "+t);o&&this.logAction(o),this.aggregations[t]=new ClientAction.StatisticalData(t,e,n)},t.prototype.resetCounter=function(t){var e=this.getAggregationById(t);if(!e)throw StoryApp.RethrowLogger.createError("ActionLogger.resetCounter() called for uninitialized counter.");this.logAction(e),e.reset()},t.prototype.observeValues=function(t,e){var n=this.getAggregationById(t);n?n.observe(e):this.aggregations[t]=new ClientAction.StatisticalData(t,e)},t.prototype.setContext=function(t,e){var n=this.getAggregationById(t);if(!n)throw StoryApp.RethrowLogger.createError("ActionLogger.setContext() called for uninitialized id: "+t);n.setContext(e)},t.prototype.actionStarted=function(t){this.actionCallbacks.forEach(function(e){return e(t,!0)}),t.isSyncAction()&&(0!=this.syncActionsStarted&&(this.markTimingNonAtomic=!0),this.actionInProgress=t,this.syncActionsStarted++)},t.prototype.recordAction=function(t){this.actionCallbacks.forEach(function(e){return e(t,!1)}),t.isSyncAction()?(this.syncActionsEnded++,t==this.actionInProgress?this.actionInProgress=null:this.markTimingNonAtomic=!0,this.syncActionsStarted==this.syncActionsEnded&&1==this.syncActionsEnded||(this.markTimingNonAtomic=!0),t.setOperationStartTime(this.operationStart),this.actions.push(t),this.actionsTypeName.push(null!=t.getActionType()?ClientAction.ActionType[t.getActionType()]:"")):this.logAction(t)},t.prototype.recordRenderTiming=function(t){this.syncActionsStarted>0&&this.renderTimes.push(t)},t.prototype.operationStarted=function(){this.operationStart&&(this.operationStart=new Date),1==this.syncActionsStarted&&0==this.syncActionsEnded||(this.markTimingNonAtomic=!0)},t.prototype.operationEnded=function(t){if(t)for(var e=this.actions.length,n=0;n<e;n++)this.actions[n]?this.logAction(this.actions[n]):StoryLog.TraceTag(596477410,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.error,"ActionLogger : operationEnded : Action initiated in this sync is null : Unable to log action : Action length = {0} : SyncActionsStarted = {1} : SyncActionsEnded = {2} : ActionInProgress = {3} : ActionTypeNames = {4}",[this.actions&&this.actions.length,this.syncActionsStarted,this.syncActionsEnded,!!this.actionInProgress,this.actionsTypeName]);this.resetRecord()},t.prototype.flush=function(){for(var t in this.aggregations)this.logAction(this.aggregations[t]);this.operationStarted&&this.operationEnded(!0)},t.prototype.logAction=function(t){t?(t.isSyncAction()&&(t.setElapsedTime((new Date).getTime()-t.getActionStartTime().getTime()),t.setRenderTimes(this.renderTimes.slice(0)),this.isAtomicChange()&&t.markAsAtomicOperation()),StoryLog.TraceTag(t.getUlsTagId(),t.getUlsCategory(),t.getUlsTraceLevel(),t.stringify())):StoryLog.TraceTag(596477411,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.error,"ActionLogger : logAction : actionData is null : Unable to log action : Action length = {0}",[this.actions&&this.actions.length])},t.prototype.getAggregationById=function(t){return this.aggregations[t]?this.aggregations[t]:null},t.prototype.isAtomicChange=function(){return!this.markTimingNonAtomic&&1==this.syncActionsStarted&&1==this.syncActionsEnded},t.prototype.registerActionCallback=function(t){this.actionCallbacks.push(t)},t.prototype.unregisterActionCallback=function(t){return ArrayExtensions.removeFirst(this.actionCallbacks,t)},t.prototype.resetRecord=function(){this.actionInProgress=null,this.operationStart=null,this.actions=[],this.markTimingNonAtomic=!1,this.syncActionsEnded=0,this.syncActionsStarted=0,this.renderTimes=[]},t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t}();t.SetContext=e,t.StartOperationLogging=n,t.EndOperationLogging=o,t.Flush=i,t.GetClientCounterValue=r,t.DecrementClientCounter=a,t.IncrementClientCounter=s,t.CreateClientCounter=l,t.CreateClientMeasure=u,t.ObserveClientMeasure=c,t.ResetClientCounter=d,t.RecordClientAction=p,t.RecordRenderTiming=g,t.BeginSyncAction=h,t.RegisterActionCallback=m,t.UnregisterActionCallback=y}(ActionLogger||(ActionLogger={}));var ClientAction;!function(t){function e(t){var e=0;if(t&&0!=t.length)for(var n=0;n<t.length;n++)e=(e<<5)-e+t.charCodeAt(n),e|=0;return e}function n(t){return a[t]}var o=StoryApp.Common,i=StoryApp.View.Common.FRE;t.getHashCode=e;var r;!function(t){t[t.AddContent=0]="AddContent",t[t.AddContent_AddBingImageContent=1]="AddContent_AddBingImageContent",t[t.AddContent_AddPicHitImageContent=2]="AddContent_AddPicHitImageContent",t[t.AddContent_AddOneNoteImageContent=3]="AddContent_AddOneNoteImageContent",t[t.AddContent_AddSuggestedImageContent=4]="AddContent_AddSuggestedImageContent",t[t.AddContent_CreateNewImageUnit=5]="AddContent_CreateNewImageUnit",t[t.AddContent_SuggestedContent=6]="AddContent_SuggestedContent",t[t.AddContent_AddContentPieceFromBasicContentPage=7]="AddContent_AddContentPieceFromBasicContentPage",t[t.AddContent_SearchSuggestionActivated=8]="AddContent_SearchSuggestionActivated",t[t.Aggregation=9]="Aggregation",t[t.ButtonClicked=10]="ButtonClicked",t[t.ButtonCreated=11]="ButtonCreated",t[t.CalloutExited=12]="CalloutExited",t[t.CardDeck_Deserialize=13]="CardDeck_Deserialize",t[t.CardDeck_Serialize=14]="CardDeck_Serialize",t[t.CardDeck_Copy=15]="CardDeck_Copy",t[t.CardDeck_CopyPressed=16]="CardDeck_CopyPressed",t[t.CardDeck_Cut=17]="CardDeck_Cut",t[t.CardDeck_CutPressed=18]="CardDeck_CutPressed",t[t.CardDeck_MoveCard_DragDrop=19]="CardDeck_MoveCard_DragDrop",t[t.CardDeck_MoveCard_Keyboard=20]="CardDeck_MoveCard_Keyboard",t[t.CardDeck_Paste=21]="CardDeck_Paste",t[t.ClearAddContentSelection=22]="ClearAddContentSelection",t[t.CreateNew=23]="CreateNew",t[t.ChangeStyle=24]="ChangeStyle",t[t.ChangeWorld=25]="ChangeWorld",t[t.ChangeColor=26]="ChangeColor",t[t.ChangeColorImageOption=27]="ChangeColorImageOption",t[t.ChangeColorPalette=28]="ChangeColorPalette",t[t.ContactMeCancelDialog=29]="ContactMeCancelDialog",t[t.ContactMeDismissNotification=30]="ContactMeDismissNotification",t[t.CreateNewTile=31]="CreateNewTile",t[t.CreateOutlineTile=32]="CreateOutlineTile",t[t.CreateOutlineDialog=33]="CreateOutlineDialog",t[t.MyStoriesChangeSortType=34]="MyStoriesChangeSortType",t[t.MyStoriesViewAuthors=35]="MyStoriesViewAuthors",t[t.ContentAdded=36]="ContentAdded",t[t.Design_Override_ChangeFontSet=37]="Design_Override_ChangeFontSet",t[t.DeleteStory=38]="DeleteStory",t[t.ObliterateStory=39]="ObliterateStory",t[t.DeleteStories=40]="DeleteStories",t[t.DetailViewEnter=41]="DetailViewEnter",t[t.DetailViewExit=42]="DetailViewExit",t[t.DetailViewNext=43]="DetailViewNext",t[t.DetailViewPrevious=44]="DetailViewPrevious",t[t.DoubleClickInsertionExperiment_AddContentPane=45]="DoubleClickInsertionExperiment_AddContentPane",t[t.DoubleClickInsertionControl_AddContentPane=46]="DoubleClickInsertionControl_AddContentPane",t[t.RestoreStories=47]="RestoreStories",t[t.RemoveEditor=48]="RemoveEditor",t[t.RemoveViewedStory=49]="RemoveViewedStory",t[t.DeleteImageContent=50]="DeleteImageContent",t[t.FileUpload=51]="FileUpload",t[t.FileUpload_Pause=52]="FileUpload_Pause",t[t.FileUpload_Resume=53]="FileUpload_Resume",t[t.FileUpload_Retry=54]="FileUpload_Retry",t[t.FileUpload_Cancel=55]="FileUpload_Cancel",t[t.FirstRunExperience_CorrectCompletionAction=56]="FirstRunExperience_CorrectCompletionAction",t[t.FirstRunExperience_CalloutPhasedOut=57]="FirstRunExperience_CalloutPhasedOut",t[t.FirstRunExperience_UserNavigatedAwayFromContentThatHasCallout=58]="FirstRunExperience_UserNavigatedAwayFromContentThatHasCallout",t[t.FirstRunExperience_UserCompletedActionBeforeCalloutWasShown=59]="FirstRunExperience_UserCompletedActionBeforeCalloutWasShown",t[t.FirstRunExperience_CalloutDismissedInFavorOfNewCallout=60]="FirstRunExperience_CalloutDismissedInFavorOfNewCallout",t[t.InvalidFileUpload=61]="InvalidFileUpload",t[t.GetRecycleBinSways=62]="GetRecycleBinSways",t[t.GetSuggestedContent=63]="GetSuggestedContent",t[t.InitialAddContent=64]="InitialAddContent",t[t.PasteToTextBox=65]="PasteToTextBox",t[t.CloseStory=66]="CloseStory",t[t.OpenStoryline=67]="OpenStoryline",t[t.CloseStoryline=68]="CloseStoryline",t[t.MaximizeStoryline=69]="MaximizeStoryline",t[t.PlayModeEntered=70]="PlayModeEntered",t[t.OpenAddContent=71]="OpenAddContent",t[t.CloseAddContent=72]="CloseAddContent",t[t.OpenAccessibilityCheckerPane=73]="OpenAccessibilityCheckerPane",t[t.CloseAccessibilityCheckerPane=74]="CloseAccessibilityCheckerPane",t[t.OpenStylePane=75]="OpenStylePane",t[t.CloseStylePane=76]="CloseStylePane",t[t.OpenNavigationPane=77]="OpenNavigationPane",t[t.CloseNavigationPane=78]="CloseNavigationPane",t[t.OpenMoodMenu=79]="OpenMoodMenu",t[t.CloseMoodMenu=80]="CloseMoodMenu",t[t.OpenLayoutMenu=81]="OpenLayoutMenu",t[t.CloseLayoutMenu=82]="CloseLayoutMenu",t[t.OpenColorPane=83]="OpenColorPane",t[t.CloseColorPane=84]="CloseColorPane",t[t.OpenTransformMenu=85]="OpenTransformMenu",t[t.CloseTransformMenu=86]="CloseTransformMenu",t[t.ShareStory=87]="ShareStory",t[t.StatisticalMeasure=88]="StatisticalMeasure",t[t.PageLoad=89]="PageLoad",t[t.RenderModelLoad=90]="RenderModelLoad",t[t.OpenStoryTile=91]="OpenStoryTile",t[t.Edit_Canvas_SelectAction=92]="Edit_Canvas_SelectAction",t[t.Edit_Canvas_DeselectAction=93]="Edit_Canvas_DeselectAction",t[t.Edit_Canvas_OOUI_DeleteAction=94]="Edit_Canvas_OOUI_DeleteAction",t[t.Edit_Canvas_OOUI_EmphAction=95]="Edit_Canvas_OOUI_EmphAction",t[t.Edit_Canvas_OOUI_XformAction=96]="Edit_Canvas_OOUI_XformAction",t[t.Edit_Canvas_OOUI_EditAction=97]="Edit_Canvas_OOUI_EditAction",t[t.Edit_Canvas_OOUI_ChangeEmphAction=98]="Edit_Canvas_OOUI_ChangeEmphAction",t[t.Edit_Canvas_OOUI_EditImageAction=99]="Edit_Canvas_OOUI_EditImageAction",t[t.DeleteContent=100]="DeleteContent",t[t.ScrollDown=101]="ScrollDown",t[t.Edit_AddXFormUI_Opened=102]="Edit_AddXFormUI_Opened",t[t.Edit_AddXFormUI_SelectTransform=103]="Edit_AddXFormUI_SelectTransform",t[t.Edit_ChangeTransformUI_Opened=104]="Edit_ChangeTransformUI_Opened",t[t.Edit_ChangeTransformUI_Closed=105]="Edit_ChangeTransformUI_Closed",t[t.Edit_ChangeTransformUI_SelectTransform=106]="Edit_ChangeTransformUI_SelectTransform",t[t.DialogShown=107]="DialogShown",t[t.Edit_AddContentUI_Open=108]="Edit_AddContentUI_Open",t[t.Edit_AddContentUI_Close=109]="Edit_AddContentUI_Close",t[t.Edit_AddContentUI_SwitchSource=110]="Edit_AddContentUI_SwitchSource",t[t.Edit_AddContentUI_AddButtonClick=111]="Edit_AddContentUI_AddButtonClick",t[t.Edit_AddContentUI_ConnectButtonClicked=112]="Edit_AddContentUI_ConnectButtonClicked",t[t.Edit_AddContentUI_Search=113]="Edit_AddContentUI_Search",t[t.Edit_AddContentUI_SearchSameQuery=114]="Edit_AddContentUI_SearchSameQuery",t[t.Edit_AddContentUI_SelectContent=115]="Edit_AddContentUI_SelectContent",t[t.Edit_AddContentUI_DeselectContent=116]="Edit_AddContentUI_DeselectContent",t[t.Edit_AddContentUI_ClearSelection=117]="Edit_AddContentUI_ClearSelection",t[t.Edit_AddContentUI_SelectSuggestedContentTag=118]="Edit_AddContentUI_SelectSuggestedContentTag",t[t.Edit_AddContentUI_DeselectSuggestedContentTag=119]="Edit_AddContentUI_DeselectSuggestedContentTag",t[t.Edit_AddContentUI_OpenSuggestedContentDrawer=120]="Edit_AddContentUI_OpenSuggestedContentDrawer",t[t.Edit_AddContentUI_OpenFolder=121]="Edit_AddContentUI_OpenFolder",t[t.Edit_AddContentUI_ChangeTab=122]="Edit_AddContentUI_ChangeTab",t[t.Edit_AddContentUI_NavBack=123]="Edit_AddContentUI_NavBack",t[t.Edit_AddContentUI_Drag=124]="Edit_AddContentUI_Drag",t[t.Edit_AddContentUI_AttributionClose=125]="Edit_AddContentUI_AttributionClose",t[t.Edit_AddContentUI_CreativeCommonsNotificationClose=126]="Edit_AddContentUI_CreativeCommonsNotificationClose",t[t.Edit_AddContentUI_UploadFileCountExceed=127]="Edit_AddContentUI_UploadFileCountExceed",t[t.Edit_AddContentUI_UploadFileInfo=128]="Edit_AddContentUI_UploadFileInfo",t[t.Edit_AddContentUI_UploadLocalVideo=129]="Edit_AddContentUI_UploadLocalVideo",t[t.Edit_AddContentUI_UploadViaMyDevice=130]="Edit_AddContentUI_UploadViaMyDevice",t[t.Edit_AddContentUI_UploadInvalidFiles=131]="Edit_AddContentUI_UploadInvalidFiles",t[t.Edit_AddContentUI_UploadNotificationOpen=132]="Edit_AddContentUI_UploadNotificationOpen",t[t.Edit_AddContentUI_UploadFileSuccess=133]="Edit_AddContentUI_UploadFileSuccess",t[t.Edit_AddContentUI_UploadFileError=134]="Edit_AddContentUI_UploadFileError",t[t.Edit_AddContentUI_IngestFileOneDriveSuccess=135]="Edit_AddContentUI_IngestFileOneDriveSuccess",t[t.Edit_AddContentUI_IngestFileOneDriveError=136]="Edit_AddContentUI_IngestFileOneDriveError",t[t.Site_YoutubePlayerStatusChange=137]="Site_YoutubePlayerStatusChange",t[t.SuggestedContent_CreateImageModel=138]="SuggestedContent_CreateImageModel",t[t.SuggestedContent_SelectContent=139]="SuggestedContent_SelectContent",t[t.SuggestedContent_SelectCluster=140]="SuggestedContent_SelectCluster",t[t.SuggestedContent_ShowMoreSearchTags=141]="SuggestedContent_ShowMoreSearchTags",t[t.SuggestedContent_UserTypedQuerySearch=142]="SuggestedContent_UserTypedQuerySearch",t[t.StorylinePasteContext=143]="StorylinePasteContext",t[t.StorylinePasteInfo=144]="StorylinePasteInfo",t[t.Storyline_Delete=145]="Storyline_Delete",t[t.Storyline_Embed_AutoConvertedToNative=146]="Storyline_Embed_AutoConvertedToNative",t[t.Storyline_Embed_ConvertedToNativeGiphy=147]="Storyline_Embed_ConvertedToNativeGiphy",t[t.Storyline_Embed_ConvertedToNativeOther=148]="Storyline_Embed_ConvertedToNativeOther",t[t.Storyline_Embed_ConvertedToNativeTweet=149]="Storyline_Embed_ConvertedToNativeTweet",t[t.Storyline_Embed_ConvertedToNativeYouTube=150]="Storyline_Embed_ConvertedToNativeYouTube",t[t.Storyline_Explode=151]="Storyline_Explode",t[t.Storyline_Group_Clicked=152]="Storyline_Group_Clicked",t[t.Storyline_GroupType_Clicked=153]="Storyline_GroupType_Clicked",t[t.Storyline_Media_ConvertedToEmbed=154]="Storyline_Media_ConvertedToEmbed",t[t.Storyline_Placeholder_Intent_CaptionThenContent=155]="Storyline_Placeholder_Intent_CaptionThenContent",t[t.Storyline_OpenTransform=156]="Storyline_OpenTransform",t[t.Storyline_OpenEmphasisDropdown=157]="Storyline_OpenEmphasisDropdown",t[t.Storyline_ChangeEmphAction=158]="Storyline_ChangeEmphAction",t[t.Storyline_SetGalleryStyle=159]="Storyline_SetGalleryStyle",t[t.Storyline_PlaceholderClicked=160]="Storyline_PlaceholderClicked",t[t.Storyline_CollapseClicked=161]="Storyline_CollapseClicked",t[t.Storyline_CardClicked=162]="Storyline_CardClicked",t[t.Storyline_EmptySocketClicked=163]="Storyline_EmptySocketClicked",t[t.Storyline_SelectionToggled=164]="Storyline_SelectionToggled",t[t.Storyline_JackOpened=165]="Storyline_JackOpened",t[t.Storyline_JackTextClicked=166]="Storyline_JackTextClicked",t[t.Storyline_JackHeaderClicked=167]="Storyline_JackHeaderClicked",t[t.Storyline_JackMediaClicked=168]="Storyline_JackMediaClicked",t[t.Storyline_JackEmbedClicked=169]="Storyline_JackEmbedClicked",t[t.Storyline_JackTransformClicked=170]="Storyline_JackTransformClicked",t[t.Storyline_JackLocalClicked=171]="Storyline_JackLocalClicked",t[t.Storyline_JackCardClicked=172]="Storyline_JackCardClicked",t[t.SuggestedClusterDrawerVisibilityChange=173]="SuggestedClusterDrawerVisibilityChange",t[t.Storyline_PasteExceptionRTE=174]="Storyline_PasteExceptionRTE",t[t.Storyline_Text_Header=175]="Storyline_Text_Header",t[t.Storyline_Text_Link=176]="Storyline_Text_Link",t[t.Storyline_Text_RemoveLink=177]="Storyline_Text_RemoveLink",t[t.Storyline_Text_Emphasize=178]="Storyline_Text_Emphasize",t[t.Storyline_Text_Special=179]="Storyline_Text_Special",t[t.Storyline_Text_Bullets=180]="Storyline_Text_Bullets",t[t.Storyline_Text_Bullets_Auto=181]="Storyline_Text_Bullets_Auto",t[t.Storyline_Text_Numbers=182]="Storyline_Text_Numbers",t[t.Storyline_Text_Numbers_Auto=183]="Storyline_Text_Numbers_Auto",t[t.Storyline_Text_LeftToRight=184]="Storyline_Text_LeftToRight",t[t.Storyline_Text_RightToLeft=185]="Storyline_Text_RightToLeft",t[t.Storyline_Text_RemoveListItems=186]="Storyline_Text_RemoveListItems",t[t.Storyline_Text_Focus_Clicked=187]="Storyline_Text_Focus_Clicked",t[t.Storyline_Text_Focus_Visible=188]="Storyline_Text_Focus_Visible",t[t.Storyline_StyleHints_ClickedOpen=189]="Storyline_StyleHints_ClickedOpen",t[t.Storyline_AddSocket=190]="Storyline_AddSocket",t[t.Storyline_ConvertTextToHeading=191]="Storyline_ConvertTextToHeading",t[t.Storyline_AddHeadingBackground=192]="Storyline_AddHeadingBackground",t[t.YouTubeVideoStateChange=193]="YouTubeVideoStateChange",t[t.Edit_Undo_Keyboard_Undo=194]="Edit_Undo_Keyboard_Undo",t[t.Edit_Undo_Keyboard_Redo=195]="Edit_Undo_Keyboard_Redo",t[t.CreateFromDoc=196]="CreateFromDoc",t[t.Edit_CardGallery_Open=197]="Edit_CardGallery_Open",t[t.Edit_CardGallery_Close=198]="Edit_CardGallery_Close",t[t.Edit_AuthoringTab_Toggle=199]="Edit_AuthoringTab_Toggle",t[t.Edit_CardGallery_AddCard=200]="Edit_CardGallery_AddCard",t[t.Edit_CardGallery_DragCard=201]="Edit_CardGallery_DragCard",t[t.Add_Embed=202]="Add_Embed",t[t.ChangeStoryAudience=203]="ChangeStoryAudience",t[t.Edit_AuthoringPane_LightDismiss=204]="Edit_AuthoringPane_LightDismiss",t[t.Edit_Canvas_OOUI_CopyLinkAction=205]="Edit_Canvas_OOUI_CopyLinkAction",t[t.AuthorsManager_IPLocation=206]="AuthorsManager_IPLocation",t[t.Storyline_PlaceholderFilled=207]="Storyline_PlaceholderFilled",t[t.ButtonRightClicked=208]="ButtonRightClicked",t[t.Edit_EditImage_Open=209]="Edit_EditImage_Open",t[t.Edit_EditImage_Close=210]="Edit_EditImage_Close",t[t.FocusPane_FocusPointAdd=211]="FocusPane_FocusPointAdd",t[t.FocusPane_FocusPointAdd_Keyboard=212]="FocusPane_FocusPointAdd_Keyboard",t[t.FocusPane_FocusPointDelete=213]="FocusPane_FocusPointDelete",t[t.FocusPane_FocusPointDelete_Keyboard=214]="FocusPane_FocusPointDelete_Keyboard",t[t.FocusPane_FocusPointDragDrop=215]="FocusPane_FocusPointDragDrop",t[t.FocusPane_FocusPointEdit_Keyboard=216]="FocusPane_FocusPointEdit_Keyboard",t[t.FocusPane_FocusPointsReset=217]="FocusPane_FocusPointsReset",t[t.FocusPane_KeepEntireImageChecked=218]="FocusPane_KeepEntireImageChecked",t[t.Add_Document_OneDrive_ImportButtonClick=219]="Add_Document_OneDrive_ImportButtonClick",t[t.Add_Document_OneDrive_EmbedButtonClick=220]="Add_Document_OneDrive_EmbedButtonClick",t[t.Add_Document_OneDrive_IngestSuccess=221]="Add_Document_OneDrive_IngestSuccess",t[t.Add_Document_OneDrive_IngestError=222]="Add_Document_OneDrive_IngestError",t[t.Add_Document_OneDrive_EmbedSuccess=223]="Add_Document_OneDrive_EmbedSuccess",t[t.Add_Document_OneDrive_EmbedError=224]="Add_Document_OneDrive_EmbedError",t[t.Add_Document_Upload_ImportButtonClick=225]="Add_Document_Upload_ImportButtonClick",t[t.Add_Document_Upload_EmbedButtonClick=226]="Add_Document_Upload_EmbedButtonClick",t[t.Add_Document_Upload_IngestSuccess=227]="Add_Document_Upload_IngestSuccess",t[t.Add_Document_Upload_IngestError=228]="Add_Document_Upload_IngestError",t[t.Add_Document_Upload_EmbedSuccess=229]="Add_Document_Upload_EmbedSuccess",t[t.Add_Document_Upload_EmbedError=230]="Add_Document_Upload_EmbedError",t[t.Edit_Emphasis_KeyboardShortcut=231]="Edit_Emphasis_KeyboardShortcut",t[t.Edit_Special_KeyboardShortcut=232]="Edit_Special_KeyboardShortcut",t[t.ViewEmbedCode=233]="ViewEmbedCode",t[t.Client_UserRequestedFlight=234]="Client_UserRequestedFlight",t[t.FileDraggedAndDropped=235]="FileDraggedAndDropped",t[t.TextDraggedAndDropped=236]="TextDraggedAndDropped",t[t.SlidebarChangedPosition=237]="SlidebarChangedPosition",t[t.Storyline_DragAndDrop_CreatedGroup=238]="Storyline_DragAndDrop_CreatedGroup",t[t.Storyline_StrictSizingAction=239]="Storyline_StrictSizingAction",t[t.Edit_AddContentUI_UploadLocalAudio=240]="Edit_AddContentUI_UploadLocalAudio",t[t.Edit_AddContentUI_ChangeSource=241]="Edit_AddContentUI_ChangeSource",t[t.SuggestedClusterClick=242]="SuggestedClusterClick",t[t.Preview_ZoomEnter=243]="Preview_ZoomEnter",t[t.Edit_AddContentUI_TryButtonClick=244]="Edit_AddContentUI_TryButtonClick",t[t.Edit_AddContentUI_BuyButtonClick=245]="Edit_AddContentUI_BuyButtonClick",t[t.Storyline_Purchase=246]="Storyline_Purchase",t[t.Edit_Canvas_OOUI_PurchaseAction=247]="Edit_Canvas_OOUI_PurchaseAction",t[t.RemixCalloutTriggerHappened=248]="RemixCalloutTriggerHappened",t[t.Edit_HideEndOfSwayToggled=249]="Edit_HideEndOfSwayToggled",t[t.Dialog_ConnectButtonClicked=250]="Dialog_ConnectButtonClicked",t[t.ToCView_Opened=251]="ToCView_Opened",t[t.ToCView_Navigated=252]="ToCView_Navigated",t[t.Print_Triggered=253]="Print_Triggered",t[t.Edit_SwaySettingsPane_Open=254]="Edit_SwaySettingsPane_Open",t[t.Edit_SwaySettingsPane_Close=255]="Edit_SwaySettingsPane_Close",t[t.ActionNegatedByDelete=256]="ActionNegatedByDelete",t[t.RemixClicked=257]="RemixClicked",t[t.ChangeLayoutClicked=258]="ChangeLayoutClicked",t[t.ConsumptionAnimationToggled=259]="ConsumptionAnimationToggled",t[t.DesignPane_AddCustomColor=260]="DesignPane_AddCustomColor",t[t.DocumentIngestionHeading_Deleted=261]="DocumentIngestionHeading_Deleted",t[t.DocumentIngestionHeading_Modified=262]="DocumentIngestionHeading_Modified"}(r=t.ActionType||(t.ActionType={}));var a;!function(t){t[t.AccessibilityCheckerPane_BackToSummaryButton=0]="AccessibilityCheckerPane_BackToSummaryButton",t[t.AccessibilityCheckerPane_CloseButton=1]="AccessibilityCheckerPane_CloseButton",t[t.AccessibilityCheckerPane_DecorativeImageCheckbox=2]="AccessibilityCheckerPane_DecorativeImageCheckbox",t[t.AccessibilityCheckerPane_DefaultAltTextIssueButton=3]="AccessibilityCheckerPane_DefaultAltTextIssueButton",t[t.AccessibilityCheckerPane_DoneButton=4]="AccessibilityCheckerPane_DoneButton",t[t.AccessibilityCheckerPane_ImageAltTextTextArea=5]="AccessibilityCheckerPane_ImageAltTextTextArea",t[t.AccessibilityCheckerPane_ImprovementResultButton=6]="AccessibilityCheckerPane_ImprovementResultButton",t[t.AccessibilityCheckerPane_InaccessibleChartIssueButton=7]="AccessibilityCheckerPane_InaccessibleChartIssueButton",t[t.AccessibilityCheckerPane_IssueResultButton=8]="AccessibilityCheckerPane_IssueResultButton",t[t.AccessibilityCheckerPane_MissingAltTextIssueButton=9]="AccessibilityCheckerPane_MissingAltTextIssueButton",t[t.AccessibilityCheckerPane_NextIssueButton=10]="AccessibilityCheckerPane_NextIssueButton",t[t.AccessibilityCheckerPane_PreviousIssueButton=11]="AccessibilityCheckerPane_PreviousIssueButton",t[t.AccessibilityCheckerPane_ReviewAllAltTextIssueButton=12]="AccessibilityCheckerPane_ReviewAllAltTextIssueButton",t[t.AccessibilityCheckerPane_ReviewAllHyperlinkIssueButton=13]="AccessibilityCheckerPane_ReviewAllHyperlinkIssueButton",t[t.AccessibilityCheckerPane_ReviewEmbedIssueButton=14]="AccessibilityCheckerPane_ReviewEmbedIssueButton",t[t.AccessibilityCheckerPane_UnclearHyperlinkIssueButton=15]="AccessibilityCheckerPane_UnclearHyperlinkIssueButton",t[t.SwaySettingsPane_CloseButton=16]="SwaySettingsPane_CloseButton",t[t.SwaySettingsPane_LanguageOption=17]="SwaySettingsPane_LanguageOption",t[t.SwaySettingsPane_LanguageDropdown=18]="SwaySettingsPane_LanguageDropdown",t[t.SwaySettingsPane_TextDirectionCheckbox=19]="SwaySettingsPane_TextDirectionCheckbox",t[t.SwaySettingsPane_RtlLayoutCheckbox=20]="SwaySettingsPane_RtlLayoutCheckbox",t[t.SwaySettingsPane_AutoPlayToggleSwitch=21]="SwaySettingsPane_AutoPlayToggleSwitch",t[t.SwaySettingsPane_AutoPlayLoopCheckbox=22]="SwaySettingsPane_AutoPlayLoopCheckbox",t[t.Add_Document_ImportButtonClick=23]="Add_Document_ImportButtonClick",t[t.Add_Document_EmbedButtonClick=24]="Add_Document_EmbedButtonClick",t[t.AddContent_Add=25]="AddContent_Add",t[t.AddContent_AddedOverlay=26]="AddContent_AddedOverlay",t[t.AddContent_AttributionClose=27]="AddContent_AttributionClose",t[t.AddContent_AttributionShowAll=28]="AddContent_AttributionShowAll",t[t.AddContent_AttributionLink=29]="AddContent_AttributionLink",t[t.AddContent_AttributionOwnerLink=30]="AddContent_AttributionOwnerLink",t[t.AddContent_AttributionLicenseLink=31]="AddContent_AttributionLicenseLink",t[t.AddContent_Report=32]="AddContent_Report",t[t.AddContent_Buy=33]="AddContent_Buy",t[t.AddContent_ClearSelection=34]="AddContent_ClearSelection",t[t.AddContent_Close=35]="AddContent_Close",t[t.AddContent_CloseLicense=36]="AddContent_CloseLicense",t[t.AddContent_ConnectAccount=37]="AddContent_ConnectAccount",t[t.AddContent_ContentPieces=38]="AddContent_ContentPieces",t[t.AddContent_ContentSource_TextTab=39]="AddContent_ContentSource_TextTab",t[t.AddContent_CreativeCommonsClose=40]="AddContent_CreativeCommonsClose",t[t.AddContent_EmbedAdd=41]="AddContent_EmbedAdd",t[t.AddContent_EmbedText=42]="AddContent_EmbedText",t[t.AddContent_Open=43]="AddContent_Open",t[t.AddContent_PurchasedOverlay=44]="AddContent_PurchasedOverlay",t[t.AddContent_RefreshAccount=45]="AddContent_RefreshAccount",t[t.AddContent_Search=46]="AddContent_Search",t[t.AddContent_ClearSearch=47]="AddContent_ClearSearch",t[t.AddContent_SelectSearch=48]="AddContent_SelectSearch",t[t.AddContent_SearchDropdown=49]="AddContent_SearchDropdown",t[t.AddContent_SourceSelector=50]="AddContent_SourceSelector",t[t.AddContent_SuggestedContentFilter_All=51]="AddContent_SuggestedContentFilter_All",t[t.AddContent_SuggestedContentFilter_Images=52]="AddContent_SuggestedContentFilter_Images",t[t.AddContent_SuggestedContentFilter_Videos=53]="AddContent_SuggestedContentFilter_Videos",t[t.AddContent_Survey=54]="AddContent_Survey",t[t.AddContent_Try=55]="AddContent_Try",t[t.AlternateBranding_PoweredBy=56]="AlternateBranding_PoweredBy",t[t.AppBar_About=57]="AppBar_About",t[t.AppBar_AccessibilityView=58]="AppBar_AccessibilityView",t[t.AppBar_AccessibilityViewExit=59]="AppBar_AccessibilityViewExit",t[t.AppBar_AccessibilityChecker=60]="AppBar_AccessibilityChecker",t[t.AppBar_Authors=61]="AppBar_Authors",t[t.AppBar_ConsumptionSettings=62]="AppBar_ConsumptionSettings",t[t.AppBar_ConsumptionWorldId_VerticalWorld=63]="AppBar_ConsumptionWorldId_VerticalWorld",t[t.AppBar_ConsumptionWorldId_PanoramaWorld=64]="AppBar_ConsumptionWorldId_PanoramaWorld",t[t.AppBar_ConsumptionWorldId_ExpoWorld=65]="AppBar_ConsumptionWorldId_ExpoWorld",t[t.AppBar_CreateNew=66]="AppBar_CreateNew",t[t.AppBar_CreateNewFromFacebook=67]="AppBar_CreateNewFromFacebook",t[t.AppBar_CreateNewFromOfficeDocs=68]="AppBar_CreateNewFromOfficeDocs",t[t.AppBar_Download=69]="AppBar_Download",t[t.AppBar_Duplicate=70]="AppBar_Duplicate",t[t.AppBar_SaveAsTemplate=71]="AppBar_SaveAsTemplate",t[t.AppBar_Export=72]="AppBar_Export",t[t.AppBar_Print=73]="AppBar_Print",t[t.AppBar_Find=74]="AppBar_Find",t[t.AppBar_OpenUrl=75]="AppBar_OpenUrl",t[t.AppBar_SwaySettingsPane=76]="AppBar_SwaySettingsPane",t[t.AppBar_Edit=77]="AppBar_Edit",t[t.AppBar_EditTemplate=78]="AppBar_EditTemplate",t[t.AppBar_Feedback=79]="AppBar_Feedback",t[t.AppBar_Fullscreen=80]="AppBar_Fullscreen",t[t.AppBar_Home=81]="AppBar_Home",t[t.AppBar_Home_Inactive=82]="AppBar_Home_Inactive",t[t.AppBar_HomeConsumption=83]="AppBar_HomeConsumption",t[t.AppBar_InternalFeatures=84]="AppBar_InternalFeatures",t[t.AppBar_PremiumFeatures=85]="AppBar_PremiumFeatures",t[t.AppBar_DeveloperCdn=86]="AppBar_DeveloperCdn",t[t.AppBar_MyStories=87]="AppBar_MyStories",t[t.AppBar_Overflow=88]="AppBar_Overflow",t[t.AppBar_Play=89]="AppBar_Play",t[t.AppBar_Preview=90]="AppBar_Preview",t[t.AppBar_Profile=91]="AppBar_Profile",t[t.AppBar_Publish=92]="AppBar_Publish",t[t.AppBar_Redo=93]="AppBar_Redo",t[t.AppBar_Remix=94]="AppBar_Remix",t[t.AppBar_SignIn=95]="AppBar_SignIn",t[t.AppBar_SignOut=96]="AppBar_SignOut",t[t.AppBar_Style=97]="AppBar_Style",t[t.AppBar_TutorialVideos=98]="AppBar_TutorialVideos",t[t.AppBar_Undo=99]="AppBar_Undo",t[t.AppBar_RefreshStories=100]="AppBar_RefreshStories",t[t.AppBar_OpenInNewTab=101]="AppBar_OpenInNewTab",t[t.AppSwitcher=102]="AppSwitcher",t[t.Audio_Play=103]="Audio_Play",t[t.Audio_Pause=104]="Audio_Pause",t[t.Audio_TextField=105]="Audio_TextField",t[t.AuthorDropDown_AddAuthor=106]="AuthorDropDown_AddAuthor",t[t.AuthDialog_EnterSignIn=107]="AuthDialog_EnterSignIn",t[t.AuthDialog_SignIn=108]="AuthDialog_SignIn",t[t.AuthDialog_SignInMSA=109]="AuthDialog_SignInMSA",t[t.AuthDialog_SignInAAD=110]="AuthDialog_SignInAAD",t[t.AuthDialog_Cancel=111]="AuthDialog_Cancel",t[t.AuthDialog_SignUpOffer=112]="AuthDialog_SignUpOffer",t[t.AuthDialog_SignUpError=113]="AuthDialog_SignUpError",t[t.Autoplay_ConsumptionLoop=114]="Autoplay_ConsumptionLoop",t[t.Autoplay_Pause=115]="Autoplay_Pause",t[t.Autoplay_Resume=116]="Autoplay_Resume",t[t.Autoplay_Settings=117]="Autoplay_Settings",t[t.Autoplay_Start=118]="Autoplay_Start",t[t.Autoplay_Stop=119]="Autoplay_Stop",t[t.BlockingProgress_Cancel=120]="BlockingProgress_Cancel",t[t.Breadcrumb=121]="Breadcrumb",t[t.Callout_CloseButton=122]="Callout_CloseButton",t[t.Callout_OpenSurvey=123]="Callout_OpenSurvey",t[t.Callout_PostponeSurvey=124]="Callout_PostponeSurvey",t[t.CanvasPeek=125]="CanvasPeek",t[t.Card=126]="Card",t[t.Card_Chart_PreviewEdit=127]="Card_Chart_PreviewEdit",t[t.Card_Placeholder=128]="Card_Placeholder",t[t.CardAction_CollapseOrExpand=129]="CardAction_CollapseOrExpand",t[t.CardAction_CollapseOrExpandLabelWithIcon=130]="CardAction_CollapseOrExpandLabelWithIcon",t[t.CardAction_ExpandCardDetail=131]="CardAction_ExpandCardDetail",t[t.CardAction_CollapseCardDetail=132]="CardAction_CollapseCardDetail",t[t.CardAction_Decorative=133]="CardAction_Decorative",t[t.CardAction_Delete=134]="CardAction_Delete",t[t.CardAction_EmphasisMore=135]="CardAction_EmphasisMore",t[t.CardAction_EmphasisNone=136]="CardAction_EmphasisNone",t[t.CardAction_EmphasisOverflow=137]="CardAction_EmphasisOverflow",t[t.CardAction_EmphasisVery=138]="CardAction_EmphasisVery",t[t.CardAction_EmphasisMoreOverflow=139]="CardAction_EmphasisMoreOverflow",t[t.CardAction_EmphasisNoneOverflow=140]="CardAction_EmphasisNoneOverflow",t[t.CardAction_EmphasisVeryOverflow=141]="CardAction_EmphasisVeryOverflow",t[t.CardAction_StrictSizing=142]="CardAction_StrictSizing",t[t.CardAction_StyleHints=143]="CardAction_StyleHints",t[t.CardAction_Group=144]="CardAction_Group",t[t.CardAction_GroupType=145]="CardAction_GroupType",t[t.CardAction_Overflow=146]="CardAction_Overflow",t[t.CardAction_Purchase=147]="CardAction_Purchase",t[t.CardAction_Select=148]="CardAction_Select",t[t.CardAction_UnGroup=149]="CardAction_UnGroup",t[t.CardDeck=150]="CardDeck",t[t.CardDeck_CopiedOverlay=151]="CardDeck_CopiedOverlay",t[t.CardOption_Audio=152]="CardOption_Audio",t[t.CardOption_Chart=153]="CardOption_Chart",t[t.CardOption_Code=154]="CardOption_Code",t[t.CardOption_Comparison=155]="CardOption_Comparison",t[t.CardOption_Document=156]="CardOption_Document",t[t.CardOption_ImportingOrEmbedding=157]="CardOption_ImportingOrEmbedding",t[t.CardOption_Embed=158]="CardOption_Embed",t[t.CardOption_PowerBi=159]="CardOption_PowerBi",t[t.CardOption_SharePoint=160]="CardOption_SharePoint",t[t.CardOption_Sway=161]="CardOption_Sway",t[t.CardOption_Sketchfab=162]="CardOption_Sketchfab",t[t.CardOption_Vimeo=163]="CardOption_Vimeo",t[t.CardOption_Twitter=164]="CardOption_Twitter",t[t.CardOption_Grid=165]="CardOption_Grid",t[t.CardOption_Group=166]="CardOption_Group",t[t.CardOption_Header=167]="CardOption_Header",t[t.CardOption_Subheader=168]="CardOption_Subheader",t[t.CardOption_Picture=169]="CardOption_Picture",t[t.CardOption_Slideshow=170]="CardOption_Slideshow",t[t.CardOption_Stack=171]="CardOption_Stack",t[t.CardOption_Table=172]="CardOption_Table",t[t.CardOption_Text=173]="CardOption_Text",t[t.CardOption_Tweet=174]="CardOption_Tweet",t[t.CardOption_Video=175]="CardOption_Video",t[t.CardToolbar_Bullets=176]="CardToolbar_Bullets",t[t.CardToolbar_Demote=177]="CardToolbar_Demote",t[t.CardToolbar_Emphasis=178]="CardToolbar_Emphasis",t[t.CardToolbar_Special=179]="CardToolbar_Special",t[t.CardToolbar_Heading=180]="CardToolbar_Heading",t[t.CardToolbar_LeftToRight=181]="CardToolbar_LeftToRight",t[t.CardToolbar_Link=182]="CardToolbar_Link",t[t.CardToolbar_Link_RemoveLink=183]="CardToolbar_Link_RemoveLink",t[t.CardToolbar_Numbers=184]="CardToolbar_Numbers",t[t.CardToolbar_Overflow=185]="CardToolbar_Overflow",t[t.CardToolbar_Promote=186]="CardToolbar_Promote",t[t.CardToolbar_RightToLeft=187]="CardToolbar_RightToLeft",t[t.CardToolbar_Focus=188]="CardToolbar_Focus",t[t.CardToolbar_AudioRecord=189]="CardToolbar_AudioRecord",t[t.Checkbox=190]="Checkbox",t[t.Chevron=191]="Chevron",t[t.ColorPane_ColorImageDefaultOption=192]="ColorPane_ColorImageDefaultOption",t[t.ColorPane_ColorImageOption=193]="ColorPane_ColorImageOption",t[t.ColorPane_ColorPaletteOption=194]="ColorPane_ColorPaletteOption",t[t.ColorPane_CustomColorOption=195]="ColorPane_CustomColorOption",t[t.ColorPane_DeleteCustomColorOption=196]="ColorPane_DeleteCustomColorOption",t[t.ColorPane_NewCustomColorOption=197]="ColorPane_NewCustomColorOption",t[t.ColorPane_AddNewCustomColor=198]="ColorPane_AddNewCustomColor",t[t.ConsumptionAnimationToggleSwitch=199]="ConsumptionAnimationToggleSwitch",t[t.ContactMe_OpenSurvey=200]="ContactMe_OpenSurvey",t[t.ContentSearch_Open=201]="ContentSearch_Open",t[t.ContentSearch_Close=202]="ContentSearch_Close",t[t.ContentSearch_Next=203]="ContentSearch_Next",t[t.ContentSearch_Previous=204]="ContentSearch_Previous",t[t.ContentSearch_Search=205]="ContentSearch_Search",t[t.ContentSearch_Options=206]="ContentSearch_Options",t[t.ContentSearch_Options_WholeWord=207]="ContentSearch_Options_WholeWord",t[t.ContentSearch_Options_MatchCase=208]="ContentSearch_Options_MatchCase",t[t.CreateOutline_DismissAll=209]="CreateOutline_DismissAll",t[t.CreateOutline_DisambiguationOption=210]="CreateOutline_DisambiguationOption",t[t.CreateOutline_CreateButton=211]="CreateOutline_CreateButton",t[t.CreateOutline_CancelButton=212]="CreateOutline_CancelButton",t[t.Dashboard_GetViewUrl=213]="Dashboard_GetViewUrl",t[t.Dashboard_ClickViewUrl=214]="Dashboard_ClickViewUrl",t[t.Dashboard_SendMail=215]="Dashboard_SendMail",t[t.Dashboard_StartRecycleBinCleanupJob=216]="Dashboard_StartRecycleBinCleanupJob",t[t.Dashboard_CheckIfSwaysExist=217]="Dashboard_CheckIfSwaysExist",t[t.Dashboard_BlockSway=218]="Dashboard_BlockSway",t[t.Dashboard_UnblockSway=219]="Dashboard_UnblockSway",t[t.Dashboard_BatchAnalysis=220]="Dashboard_BatchAnalysis",t[t.Dashboard_BatchAnalysisSelectInput=221]="Dashboard_BatchAnalysisSelectInput",t[t.Dashboard_BatchAnalysisPause=222]="Dashboard_BatchAnalysisPause",t[t.Dashboard_BatchAnalysisResume=223]="Dashboard_BatchAnalysisResume",t[t.Dashboard_BatchAnalysisStop=224]="Dashboard_BatchAnalysisStop",t[t.Dashboard_BatchAnalysisDelete=225]="Dashboard_BatchAnalysisDelete",t[t.Dashboard_BatchAnalysisDownloadResults=226]="Dashboard_BatchAnalysisDownloadResults",t[t.Dashboard_DeleteUser=227]="Dashboard_DeleteUser",t[t.Dashboard_Replicate=228]="Dashboard_Replicate",t[t.Delete=229]="Delete",t[t.DesignPane_CarouselNext=230]="DesignPane_CarouselNext",t[t.CarouselPrevious=231]="CarouselPrevious",t[t.CarouselNext=232]="CarouselNext",t[t.DesignPane_CarouselPrevious=233]="DesignPane_CarouselPrevious",t[t.DesignPane_LayoutCarouselNext=234]="DesignPane_LayoutCarouselNext",t[t.DesignPane_LayoutCarouselPrevious=235]="DesignPane_LayoutCarouselPrevious",t[t.DesignPane_CloseButton=236]="DesignPane_CloseButton",t[t.DesignPane_ColorDefaultOption=237]="DesignPane_ColorDefaultOption",t[t.DesignPane_ColorOption=238]="DesignPane_ColorOption",t[t.DesignPane_ColorPalette=239]="DesignPane_ColorPalette",t[t.DesignPane_CustomizeBackButton=240]="DesignPane_CustomizeBackButton",t[t.DesignPane_CustomizeButton=241]="DesignPane_CustomizeButton",t[t.DesignPane_FontSetChooser_Dropdown=242]="DesignPane_FontSetChooser_Dropdown",t[t.DesignPane_FontSetOption=243]="DesignPane_FontSetOption",t[t.DesignPane_Open=244]="DesignPane_Open",t[t.DesignPane_StructureTab=245]="DesignPane_StructureTab",t[t.DesignPane_StyleOption=246]="DesignPane_StyleOption",t[t.DesignPane_StyleTab=247]="DesignPane_StyleTab",t[t.DialogButton=248]="DialogButton",t[t.DialogCheckbox=249]="DialogCheckbox",t[t.DialogLightDismiss=250]="DialogLightDismiss",t[t.DialogEscDismiss=251]="DialogEscDismiss",t[t.DualAuthDialog_AAD=252]="DualAuthDialog_AAD",t[t.DualAuthDialog_MSA=253]="DualAuthDialog_MSA",t[t.Edit_Canvas_OOUI_CopyLinkButton=254]="Edit_Canvas_OOUI_CopyLinkButton",t[t.EditImagePane_Close=255]="EditImagePane_Close",t[t.EditImagePane_Reset=256]="EditImagePane_Reset",t[t.EducationPage_GetStartedTop=257]="EducationPage_GetStartedTop",t[t.EducationPage_GetStartedIntroduction=258]="EducationPage_GetStartedIntroduction",t[t.EducationPage_GetStartedPlanSway=259]="EducationPage_GetStartedPlanSway",t[t.EducationPage_GetStartedPlanSwayO365=260]="EducationPage_GetStartedPlanSwayO365",t[t.EducationPage_GetStartedBottom=261]="EducationPage_GetStartedBottom",t[t.EducationPage_Platform_Web=262]="EducationPage_Platform_Web",t[t.EducationPage_Platform_Windows=263]="EducationPage_Platform_Windows",t[t.Embed_ConvertToNativeCard=264]="Embed_ConvertToNativeCard",t[t.Embed_DismissErrorMessage=265]="Embed_DismissErrorMessage",t[t.Embed_LearnMore=266]="Embed_LearnMore",t[t.Embed_LoadNowPlaceholder=267]="Embed_LoadNowPlaceholder",t[t.Embed_MicrosoftForms=268]="Embed_MicrosoftForms",t[t.Embed_PowerBi=269]="Embed_PowerBi",t[t.Embed_SharePoint=270]="Embed_SharePoint",t[t.Embed_Sketchfab=271]="Embed_Sketchfab",t[t.Embed_SoundCloud=272]="Embed_SoundCloud",t[t.Embed_Sway=273]="Embed_Sway",t[t.Embed_TextField=274]="Embed_TextField",t[t.Embed_Twitter=275]="Embed_Twitter",t[t.Embed_ViewPlaceholder=276]="Embed_ViewPlaceholder",t[t.Embed_Vimeo=277]="Embed_Vimeo",t[t.EndOfStory_Create=278]="EndOfStory_Create",t[t.EndOfStory_Create_SignedIn=279]="EndOfStory_Create_SignedIn",t[t.EndOfStory_Create_SignedOut=280]="EndOfStory_Create_SignedOut",t[t.EndOfStory_ShareFacebook=281]="EndOfStory_ShareFacebook",t[t.EndOfStory_ShareFacebook_ShareThis=282]="EndOfStory_ShareFacebook_ShareThis",t[t.EndOfStory_ShareLink=283]="EndOfStory_ShareLink",t[t.EndOfStory_ShareLinkedIn=284]="EndOfStory_ShareLinkedIn",t[t.EndOfStory_ShareTwitter=285]="EndOfStory_ShareTwitter",t[t.EndOfStory_ShareTwitter_ShareThis=286]="EndOfStory_ShareTwitter_ShareThis",t[t.FeaturedSway_Next=287]="FeaturedSway_Next",t[t.FeaturedSway_Previous=288]="FeaturedSway_Previous",t[t.FileUpload=289]="FileUpload",t[t.FocusPane_Checkbox=290]="FocusPane_Checkbox",t[t.FollowLink_Blog=291]="FollowLink_Blog",t[t.FollowLink_Facebook=292]="FollowLink_Facebook",t[t.FollowLink_Twitter=293]="FollowLink_Twitter",t[t.FREDialogCarouselIndex=294]="FREDialogCarouselIndex",t[t.FREDialogCarouselPause=295]="FREDialogCarouselPause",t[t.FREDialogCarouselPlay=296]="FREDialogCarouselPlay",t[t.FREDialogCarouselPrevious=297]="FREDialogCarouselPrevious",t[t.FREDialogCarouselNext=298]="FREDialogCarouselNext",t[t.GetSuggestedContent=299]="GetSuggestedContent",t[t.GetStartedBottom=300]="GetStartedBottom",t[t.GetStartedTop=301]="GetStartedTop",t[t.Heading_TextField_Title=302]="Heading_TextField_Title",t[t.Heading_TextField_H1=303]="Heading_TextField_H1",t[t.Heading_TextField_H2=304]="Heading_TextField_H2",t[t.RateThisDesign=305]="RateThisDesign",t[t.HelpUsImproveSurvey_Dismiss=306]="HelpUsImproveSurvey_Dismiss",t[t.HelpUsImproveSurvey_FeedbackTextArea=307]="HelpUsImproveSurvey_FeedbackTextArea",t[t.HelpUsImproveSurvey_Submit=308]="HelpUsImproveSurvey_Submit",t[t.Jack_AddMoreContent=309]="Jack_AddMoreContent",t[t.Home_CarouselNext=310]="Home_CarouselNext",t[t.Home_CarouselPrevious=311]="Home_CarouselPrevious",t[t.Home_Platform_iOS=312]="Home_Platform_iOS",t[t.Home_Platform_iPad=313]="Home_Platform_iPad",t[t.Home_Platform_iPhone=314]="Home_Platform_iPhone",t[t.Home_Platform_Web=315]="Home_Platform_Web",t[t.Home_Platform_Windows=316]="Home_Platform_Windows",t[t.Home_TestimonailNext=317]="Home_TestimonailNext",t[t.Home_TestimonailPrevious=318]="Home_TestimonailPrevious",t[t.HowToVideoSwayInTwoMinutes=319]="HowToVideoSwayInTwoMinutes",t[t.HowToVideoMakeTutorial=320]="HowToVideoMakeTutorial",t[t.HowToVideoBuildPresentation=321]="HowToVideoBuildPresentation",t[t.HowToVideoCreateNewsletter=322]="HowToVideoCreateNewsletter",t[t.HowToVideoShareVacation=323]="HowToVideoShareVacation",t[t.Image_TextField=324]="Image_TextField",t[t.Jack_AllCards=325]="Jack_AllCards",t[t.Jack_Upload=326]="Jack_Upload",t[t.Jack_Camera=327]="Jack_Camera",t[t.Jack_Record=328]="Jack_Record",t[t.Map_Next=329]="Map_Next",t[t.Map_Previous=330]="Map_Previous",t[t.Media_TextField=331]="Media_TextField",t[t.MoodPane_MoodOption=332]="MoodPane_MoodOption",t[t.MyStories_Title=333]="MyStories_Title",t[t.MyStories_Title_AllSways=334]="MyStories_Title_AllSways",t[t.MyStories_Title_MySways=335]="MyStories_Title_MySways",t[t.MyStories_Title_SharedwithMeSways=336]="MyStories_Title_SharedwithMeSways",t[t.MyStories_MySwaysPageV2_CarouselNext=337]="MyStories_MySwaysPageV2_CarouselNext",t[t.MyStories_MySwaysPageV2_CarouselPrevious=338]="MyStories_MySwaysPageV2_CarouselPrevious",t[t.MyStories_MySwaysPageV2_Office365LearnMore=339]="MyStories_MySwaysPageV2_Office365LearnMore",t[t.MyStories_MySwaysPageV2_Office365Refresh=340]="MyStories_MySwaysPageV2_Office365Refresh",t[t.MyStories_MySwaysPageV2_TitleTab_AllSways=341]="MyStories_MySwaysPageV2_TitleTab_AllSways",t[t.MyStories_MySwaysPageV2_TitleTab_Analytics=342]="MyStories_MySwaysPageV2_TitleTab_Analytics",t[t.MyStories_MySwaysPageV2_TitleTab_MySways=343]="MyStories_MySwaysPageV2_TitleTab_MySways",t[t.MyStories_MySwaysPageV2_TitleTab_SharedSways=344]="MyStories_MySwaysPageV2_TitleTab_SharedSways",t[t.MyStories_MySwaysPageV2_TitleTab_ViewedSways=345]="MyStories_MySwaysPageV2_TitleTab_ViewedSways",t[t.MyStories_MySwaysPageV2_TitleTab_RecycledSways=346]="MyStories_MySwaysPageV2_TitleTab_RecycledSways",t[t.MyStories_MySwaysPageV2_SeeMore=347]="MyStories_MySwaysPageV2_SeeMore",t[t.MyStories_MySwaysPageV2_SeeMoreFeaturedSways=348]="MyStories_MySwaysPageV2_SeeMoreFeaturedSways",t[t.MyStories_MySwaysPageV2_SeeLess=349]="MyStories_MySwaysPageV2_SeeLess",t[t.MyStories_MySwaysPageV2_FeaturedCarouselNext=350]="MyStories_MySwaysPageV2_FeaturedCarouselNext",t[t.MyStories_MySwaysPageV2_FeaturedCarouselPrevious=351]="MyStories_MySwaysPageV2_FeaturedCarouselPrevious",t[t.MyStories_MySwaysPageV2_TemplateCarouselNext=352]="MyStories_MySwaysPageV2_TemplateCarouselNext",t[t.MyStories_MySwaysPageV2_TemplateCarouselPrevious=353]="MyStories_MySwaysPageV2_TemplateCarouselPrevious",t[t.MyStories_MySwaysPageV2_SortCriteria_Dropdown=354]="MyStories_MySwaysPageV2_SortCriteria_Dropdown",t[t.MyStories_MySwaysPageV2_SortCriteria_DropdownOption=355]="MyStories_MySwaysPageV2_SortCriteria_DropdownOption",t[t.MyStories_MySwaysPageV2_SortingType_Dropdown=356]="MyStories_MySwaysPageV2_SortingType_Dropdown",t[t.MyStories_MySwaysPageV2_SortingType_DropdownOption=357]="MyStories_MySwaysPageV2_SortingType_DropdownOption",t[t.MyStories_MySwaysPageV2_RefreshPage=358]="MyStories_MySwaysPageV2_RefreshPage",t[t.NavigationPane_CloseButton=359]="NavigationPane_CloseButton",t[t.NavigationPane_Open=360]="NavigationPane_Open",t[t.NavigationPane_LayoutOption=361]="NavigationPane_LayoutOption",t[t.NavigationPane_LayoutOption_DepthWorld=362]="NavigationPane_LayoutOption_DepthWorld",t[t.NavigationPane_LayoutOption_ExpolWorld=363]="NavigationPane_LayoutOption_ExpolWorld",t[t.NavigationPane_LayoutOption_NutWorld=364]="NavigationPane_LayoutOption_NutWorld",t[t.NavigationPane_LayoutOption_PanoramaWorld=365]="NavigationPane_LayoutOption_PanoramaWorld",t[t.NavigationPane_LayoutOption_TileWorld=366]="NavigationPane_LayoutOption_TileWorld",t[t.NavigationPane_LayoutOption_VerticalWorld=367]="NavigationPane_LayoutOption_VerticalWorld",t[t.NavigationPane_LayoutOption_RtlLayoutCheckbox=368]="NavigationPane_LayoutOption_RtlLayoutCheckbox",t[t.Notification_Dismiss=369]="Notification_Dismiss",t[t.Notification_SeeMore=370]="Notification_SeeMore",t[t.OOUI_Caption_TextField=371]="OOUI_Caption_TextField",t[t.OOUI_Delete=372]="OOUI_Delete",t[t.OOUI_Edit=373]="OOUI_Edit",t[t.OOUI_Emphasis=374]="OOUI_Emphasis",t[t.OOUI_Focus=375]="OOUI_Focus",t[t.OOUI_MoreEmphasis=376]="OOUI_MoreEmphasis",t[t.OOUI_NoneEmphasis=377]="OOUI_NoneEmphasis",t[t.OOUI_Purchase=378]="OOUI_Purchase",t[t.OOUI_Text_TextField=379]="OOUI_Text_TextField",t[t.OOUI_Title_TextField=380]="OOUI_Title_TextField",t[t.OOUI_Transform=381]="OOUI_Transform",t[t.OOUI_VeryEmphasis=382]="OOUI_VeryEmphasis",t[t.OptionsPane_EmphasizeButtons=383]="OptionsPane_EmphasizeButtons",t[t.OptionsPane_GalleryStyleHints=384]="OptionsPane_GalleryStyleHints",t[t.PersonalStoryConnectToFacebook=385]="PersonalStoryConnectToFacebook",t[t.PreviewPeek_Play=386]="PreviewPeek_Play",t[t.RecordingDialog_Close=387]="RecordingDialog_Close",t[t.RecordingDialog_StopRecording=388]="RecordingDialog_StopRecording",t[t.RecordingDialog_PauseRecording=389]="RecordingDialog_PauseRecording",t[t.RecordingDialog_AddToSway=390]="RecordingDialog_AddToSway",t[t.RecordingDialog_ReRecord=391]="RecordingDialog_ReRecord",t[t.RecordingDialog_Delete=392]="RecordingDialog_Delete",t[t.RecycleBin_EntryPoint=393]="RecycleBin_EntryPoint",t[t.RecycleBin_DeleteSelected=394]="RecycleBin_DeleteSelected",t[t.RecycleBin_RestoreSelected=395]="RecycleBin_RestoreSelected",t[t.RecycleBin_DeleteAll=396]="RecycleBin_DeleteAll",t[t.RecycleBin_RestoreAll=397]="RecycleBin_RestoreAll",t[t.RecycleBin_ClearSelection=398]="RecycleBin_ClearSelection",t[t.RecycleBin_BackToMySways=399]="RecycleBin_BackToMySways",t[t.RecycleBin_MoveToRBDialog_RecycleBin=400]="RecycleBin_MoveToRBDialog_RecycleBin",t[t.RecycleBin_MoveToRBDialog_Undo=401]="RecycleBin_MoveToRBDialog_Undo",t[t.RecycleBin_DeleteDialog_Close=402]="RecycleBin_DeleteDialog_Close",t[t.RecycleBin_DeleteDialog_Delete=403]="RecycleBin_DeleteDialog_Delete",t[t.RecycleBin_StoryTileSelectionCheckbox=404]="RecycleBin_StoryTileSelectionCheckbox",t[t.RecycleBin_Overflow=405]="RecycleBin_Overflow",t[t.Remix_Confirm=406]="Remix_Confirm",t[t.Remix_NlDesign=407]="Remix_NlDesign",t[t.ReportDialog_Checkbox=408]="ReportDialog_Checkbox",t[t.ReportDialog_Submit=409]="ReportDialog_Submit",t[t.ReportDialog_Cancel=410]="ReportDialog_Cancel",t[t.ReportDialog_Close=411]="ReportDialog_Close",t[t.RequestInvite=412]="RequestInvite",t[t.RichCheckbox=413]="RichCheckbox",t[t.RichCheckbox_BasicContentPage=414]="RichCheckbox_BasicContentPage",t[t.RichCheckbox_HelpUsImproveSurveyCopySway=415]="RichCheckbox_HelpUsImproveSurveyCopySway",t[t.RichCheckbox_HelpUsImproveSurveyContentUser=416]="RichCheckbox_HelpUsImproveSurveyContentUser",t[t.RichCheckbox_SuggestedContent=417]="RichCheckbox_SuggestedContent",t[t.RichCheckbox_FocusPane=418]="RichCheckbox_FocusPane",t[t.RichCheckbox_StrictSizing=419]="RichCheckbox_StrictSizing",t[t.ShareDropdown_AddSuggestedPerson=420]="ShareDropdown_AddSuggestedPerson",t[t.ShareDropdown_CastPublish=421]="ShareDropdown_CastPublish",t[t.ShareDropdown_CastView=422]="ShareDropdown_CastView",t[t.ShareDropdown_CastUnpublish=423]="ShareDropdown_CastUnpublish",t[t.ShareDropdown_CloseGrantedAccessDialog=424]="ShareDropdown_CloseGrantedAccessDialog",t[t.ShareDropdown_CoauthorImage=425]="ShareDropdown_CoauthorImage",t[t.ShareDropdown_CopyShareLinkButton=426]="ShareDropdown_CopyShareLinkButton",t[t.ShareDropdown_CopyShareLinkDialogButton=427]="ShareDropdown_CopyShareLinkDialogButton",t[t.ShareDropdown_EmbedCodeButton=428]="ShareDropdown_EmbedCodeButton",t[t.ShareDropdown_GetGroupMembersButton=429]="ShareDropdown_GetGroupMembersButton",t[t.ShareDropdown_InviteButton=430]="ShareDropdown_InviteButton",t[t.ShareDropdown_MoreOptionsButton=431]="ShareDropdown_MoreOptionsButton",t[t.ShareDropdown_MoreOptionsCheckbox=432]="ShareDropdown_MoreOptionsCheckbox",t[t.ShareDropdown_VisualLinkAuthoringDialogCopyButton=433]="ShareDropdown_VisualLinkAuthoringDialogCopyButton",t[t.ShareDropdown_VisualLinkConsumptionDialogCopyButton=434]="ShareDropdown_VisualLinkConsumptionDialogCopyButton",t[t.ShareDropdown_VisualLinkDialogCloseButton=435]="ShareDropdown_VisualLinkDialogCloseButton",t[t.ShareDropdown_CopiedVisualLink=436]="ShareDropdown_CopiedVisualLink",t[t.ShareDropdown_MoreOptionsCheckbox_BlockShareButton=437]="ShareDropdown_MoreOptionsCheckbox_BlockShareButton",t[t.ShareDropdown_MoreOptionsCheckbox_DuplicateStory=438]="ShareDropdown_MoreOptionsCheckbox_DuplicateStory",t[t.ShareDropdown_MoreOptionsCheckbox_PrintStory=439]="ShareDropdown_MoreOptionsCheckbox_PrintStory",t[t.ShareDropdown_MoreOptionsCheckbox_ExportStory=440]="ShareDropdown_MoreOptionsCheckbox_ExportStory",t[t.ShareDropdown_MoreOptionsCheckbox_ConsumptionWorldSwitch=441]="ShareDropdown_MoreOptionsCheckbox_ConsumptionWorldSwitch",t[t.ShareDropdown_MoreOptionsCheckbox_HideEndOfSway=442]="ShareDropdown_MoreOptionsCheckbox_HideEndOfSway",t[t.ShareDropdown_MoreOptionsRevokeLink=443]="ShareDropdown_MoreOptionsRevokeLink",t[t.ShareDropdown_MoreOptionsSetPassword=444]="ShareDropdown_MoreOptionsSetPassword",t[t.ShareDropdown_MoreOptionsRemovePassword=445]="ShareDropdown_MoreOptionsRemovePassword",t[t.ShareDropdown_RemoveSelectedPerson=446]="ShareDropdown_RemoveSelectedPerson",t[t.ShareDropdown_SocialDocsDotCom=447]="ShareDropdown_SocialDocsDotCom",t[t.ShareDropdown_SocialVisualLink=448]="ShareDropdown_SocialVisualLink",t[t.ShareDropdown_SocialFacebook=449]="ShareDropdown_SocialFacebook",t[t.ShareDropdown_SocialGooglePlus=450]="ShareDropdown_SocialGooglePlus",t[t.ShareDropdown_SocialLinkedIn=451]="ShareDropdown_SocialLinkedIn",t[t.ShareDropdown_SocialOverflow=452]="ShareDropdown_SocialOverflow",t[t.ShareDropdown_SocialShareThis=453]="ShareDropdown_SocialShareThis",t[t.ShareDropdown_SocialTwitter=454]="ShareDropdown_SocialTwitter",t[t.ShareDropdown_SocialYammer=455]="ShareDropdown_SocialYammer",t[t.ShareDropdown_ToggleSwitch=456]="ShareDropdown_ToggleSwitch",t[t.ShareFlyout_EditLink=457]="ShareFlyout_EditLink",t[t.ShareFlyout_Email=458]="ShareFlyout_Email",t[t.ShareFlyout_Embed=459]="ShareFlyout_Embed",t[t.ShareFlyout_VisualLink=460]="ShareFlyout_VisualLink",t[t.ShareFlyout_Facebook=461]="ShareFlyout_Facebook",t[t.ShareFlyout_Facebook_ShareThis=462]="ShareFlyout_Facebook_ShareThis",t[t.ShareFlyout_LinkedIn=463]="ShareFlyout_LinkedIn",t[t.ShareFlyout_Link=464]="ShareFlyout_Link",t[t.ShareFlyout_RevokeShareLinks=465]="ShareFlyout_RevokeShareLinks",t[t.ShareFlyout_ShareThis=466]="ShareFlyout_ShareThis",t[t.ShareFlyout_Twitter=467]="ShareFlyout_Twitter",t[t.ShareFlyout_Twitter_ShareThis=468]="ShareFlyout_Twitter_ShareThis",t[t.ShareLink_AlternateUrl=469]="ShareLink_AlternateUrl",t[t.ShareThis_Facebook=470]="ShareThis_Facebook",t[t.ShareThis_FacebookLike=471]="ShareThis_FacebookLike",t[t.ShareThis_GooglePlus=472]="ShareThis_GooglePlus",t[t.ShareThis_Linkedin=473]="ShareThis_Linkedin",t[t.ShareThis_NullId=474]="ShareThis_NullId",t[t.ShareThis_Pinterest=475]="ShareThis_Pinterest",t[t.ShareThis_ShareThis=476]="ShareThis_ShareThis",t[t.ShareThis_Twitter=477]="ShareThis_Twitter",t[t.ShareThis_Yammer=478]="ShareThis_Yammer",t[t.ShowAllResults=479]="ShowAllResults",t[t.Slideshow_Thumbnails_Next=480]="Slideshow_Thumbnails_Next",t[t.Slideshow_Thumbnails_Previous=481]="Slideshow_Thumbnails_Previous",t[t.SocialFlyout_CopyText=482]="SocialFlyout_CopyText",t[t.SocialFlyout_GetEmbedCode=483]="SocialFlyout_GetEmbedCode",t[t.Socket_TestSocket=484]="Socket_TestSocket",t[t.Socket_AltTextSocket=485]="Socket_AltTextSocket",t[t.Socket_AuthorSocket=486]="Socket_AuthorSocket",t[t.Socket_BackgroundSocket=487]="Socket_BackgroundSocket",t[t.Socket_LogoSocket=488]="Socket_LogoSocket",t[t.Socket_CaptionSocket=489]="Socket_CaptionSocket",t[t.Socket_HeadingSocket=490]="Socket_HeadingSocket",t[t.Socket_ImageSocket=491]="Socket_ImageSocket",t[t.Socket_SubtitleSocket=492]="Socket_SubtitleSocket",t[t.Socket_TitleSocket=493]="Socket_TitleSocket",t[t.Socket_VideoSocket=494]="Socket_VideoSocket",t[t.Socket_ClosedCaptionSocket=495]="Socket_ClosedCaptionSocket",t[t.Socket_AudioThumbnailSocket=496]="Socket_AudioThumbnailSocket",t[t.ClosedCaptionSocket_LanguageDropdown=497]="ClosedCaptionSocket_LanguageDropdown",t[t.ClosedCaptionSocket_LanguageOption=498]="ClosedCaptionSocket_LanguageOption",t[t.StatusMessageClose=499]="StatusMessageClose",t[t.StoryTile_AddAuthor=500]="StoryTile_AddAuthor",t[t.StoryTile_ShareEditLink=501]="StoryTile_ShareEditLink",t[t.StoryTile_ShareLink=502]="StoryTile_ShareLink",t[t.Story_AppBar_Embed=503]="Story_AppBar_Embed",t[t.Story_AppBar_Facebook=504]="Story_AppBar_Facebook",t[t.Story_AppBar_Home=505]="Story_AppBar_Home",t[t.Story_AppBar_Link=506]="Story_AppBar_Link",t[t.Story_AppBar_SocialFlyout=507]="Story_AppBar_SocialFlyout",t[t.Story_AppBar_Twitter=508]="Story_AppBar_Twitter",t[t.Story_Tile=509]="Story_Tile",t[t.StorylinePeek=510]="StorylinePeek",t[t.Storyline_OpenCloseIcon=511]="Storyline_OpenCloseIcon",t[t.Storyline_SidebarText=512]="Storyline_SidebarText",t[t.Storyline_ShrinkStoryline=513]="Storyline_ShrinkStoryline",t[t.StructurePane_StructureOption=514]="StructurePane_StructureOption",t[t.StyleHintsPane_Close=515]="StyleHintsPane_Close",t[t.SubTileMenu_ConfirmDelete=516]="SubTileMenu_ConfirmDelete",t[t.SuggestedClustersDrawer=517]="SuggestedClustersDrawer",t[t.SuggestedContentCluster=518]="SuggestedContentCluster",t[t.UserContentCluster=519]="UserContentCluster",t[t.SuggestedSource=520]="SuggestedSource",t[t.SuggestedSource_AddSource=521]="SuggestedSource_AddSource",t[t.SuggestedSource_Bing=522]="SuggestedSource_Bing",t[t.SuggestedSource_Facebook=523]="SuggestedSource_Facebook",t[t.SuggestedSource_Flickr=524]="SuggestedSource_Flickr",t[t.SuggestedSource_SkyDrive=525]="SuggestedSource_SkyDrive",t[t.SuggestedSource_OneNote=526]="SuggestedSource_OneNote",t[t.SuggestedSource_PicHit=527]="SuggestedSource_PicHit",t[t.SuggestedSource_SuggestedContent=528]="SuggestedSource_SuggestedContent",t[t.SuggestedSource_Twitter=529]="SuggestedSource_Twitter",t[t.SuggestedSource_Upload=530]="SuggestedSource_Upload",t[t.SuggestedSource_YouTube=531]="SuggestedSource_YouTube",t[t.Survey_Cancel=532]="Survey_Cancel",t[t.Survey_Submit=533]="Survey_Submit",t[t.SwayBar_Preview=534]="SwayBar_Preview",t[t.SwayBar_Storyline=535]="SwayBar_Storyline",t[t.Swsp_ConvertToViewer=536]="Swsp_ConvertToViewer",t[t.Swsp_ConvertToEditor=537]="Swsp_ConvertToEditor",t[t.Swsp_RemoveViewer=538]="Swsp_RemoveViewer",t[t.Swsp_RemoveEditor=539]="Swsp_RemoveEditor",t[t.Text_TextField=540]="Text_TextField",t[t.TileMenu_Delete=541]="TileMenu_Delete",t[t.TileMenu_Download=542]="TileMenu_Download",t[t.TileMenu_Duplicate=543]="TileMenu_Duplicate",t[t.TileMenu_Play=544]="TileMenu_Play",t[t.TileMenu_Share=545]="TileMenu_Share",t[t.Tile_AddAuthor=546]="Tile_AddAuthor",t[t.Tile_Sync=547]="Tile_Sync",t[t.Tile_CreateNew=548]="Tile_CreateNew",t[t.Tile_CreateNewFromDoc=549]="Tile_CreateNewFromDoc",t[t.Tile_CreateNewFromUpload=550]="Tile_CreateNewFromUpload",t[t.Tile_CreateOutline=551]="Tile_CreateOutline",t[t.Tile_CreateFacebookPersonalStory=552]="Tile_CreateFacebookPersonalStory",t[t.Tile_OpenTemplate=553]="Tile_OpenTemplate",t[t.Tile_Ellipses=554]="Tile_Ellipses",t[t.Tile_ViewCount=555]="Tile_ViewCount",t[t.Tile_UploadExistingStory=556]="Tile_UploadExistingStory",t[t.ToCView_Thumbnail=557]="ToCView_Thumbnail",t[t.ToCView_Open=558]="ToCView_Open",t[t.ToCView_Close=559]="ToCView_Close",t[t.ToCView_PaddleLeft=560]="ToCView_PaddleLeft",t[t.ToCView_PaddleRight=561]="ToCView_PaddleRight",t[t.ToCView_PullDownIcon=562]="ToCView_PullDownIcon",t[t.TopMenu_Authors=563]="TopMenu_Authors",t[t.TopMenu_Fullscreen=564]="TopMenu_Fullscreen",t[t.TopMenu_Popout=565]="TopMenu_Popout",t[t.TopMenu_Share=566]="TopMenu_Share",t[t.TransformChooser_Close=567]="TransformChooser_Close",t[t.TransformAuto=568]="TransformAuto",t[t.TransformComparison=569]="TransformComparison",t[t.TransformGallery=570]="TransformGallery",t[t.TransformGalleryContinuous=571]="TransformGalleryContinuous",t[t.TransformGalleryHorizontalThumbs=572]="TransformGalleryHorizontalThumbs",t[t.TransformStack=573]="TransformStack",t[t.TransformUniformGrid=574]="TransformUniformGrid",t[t.Upload_Cancel=575]="Upload_Cancel",t[t.Upload_Pause=576]="Upload_Pause",t[t.Upload_Resume=577]="Upload_Resume",t[t.Upload_Retry=578]="Upload_Retry",t[t.UnitTestMockButton=579]="UnitTestMockButton",t[t.Video_Play=580]="Video_Play",t[t.Video_TextField=581]="Video_TextField",t[t.PasswordEntryDialogCancel=582]="PasswordEntryDialogCancel",t[t.PasswordEntryDialogSubmit=583]="PasswordEntryDialogSubmit",t[t.PasswordManagementDialogCancel=584]="PasswordManagementDialogCancel",t[t.PasswordManagementDialogSet=585]="PasswordManagementDialogSet",t[t.PasswordManagementDialogAudience=586]="PasswordManagementDialogAudience",t[t.PasswordAudienceFlyout=587]="PasswordAudienceFlyout",t[t.AppBar_Help=588]="AppBar_Help",t[t.HelpDialog_ReportAViolation=589]="HelpDialog_ReportAViolation",t[t.HelpDialog_AnswersForum=590]="HelpDialog_AnswersForum",t[t.HelpDialog_OfficeDotCom=591]="HelpDialog_OfficeDotCom",t[t.HelpDialog_About=592]="HelpDialog_About",t[t.SendReport=593]="SendReport",t[t.ContentInfringementLink=594]="ContentInfringementLink",t[t.AadViolationUrl=595]="AadViolationUrl",t[t.ScheduleJobs=596]="ScheduleJobs",t[t.ScheduleWatcher=597]="ScheduleWatcher",t[t.UniversalHeaderSignIn=598]="UniversalHeaderSignIn",t[t.UniversalHeaderBuyOffice365=599]="UniversalHeaderBuyOffice365",t[t.ExportStoryForPrintingDialog_PDF=600]="ExportStoryForPrintingDialog_PDF",t[t.PlayPromoPillarVideo=601]="PlayPromoPillarVideo",t[t.PausePromoPillarVideo=602]="PausePromoPillarVideo",t[t.HomepageO365UpsellLink=603]="HomepageO365UpsellLink"}(a=t.ButtonId||(t.ButtonId={})),t.getButtonId=n;var s;!function(t){t[t.AnimationLevelSlidebar=0]="AnimationLevelSlidebar",t[t.FontScaleSlidebar=1]="FontScaleSlidebar",t[t.SettingsPlaneAutoPlayTimingSlidebar=2]="SettingsPlaneAutoPlayTimingSlidebar"}(s=t.SlidebarId||(t.SlidebarId={}));!function(t){t[t.Arbitrary=0]="Arbitrary",t[t.ConsumptionClick=1]="ConsumptionClick",t[t.ConsumptionScrollbarClick=2]="ConsumptionScrollbarClick",t[t.ConsumptionKeyboard=3]="ConsumptionKeyboard",t[t.ConsumptionMouseDown=4]="ConsumptionMouseDown",t[t.ConsumptionMouseWheel=5]="ConsumptionMouseWheel",t[t.ConsumptionTouch=6]="ConsumptionTouch",t[t.ConsumptionRenderModels=7]="ConsumptionRenderModels",t[t.ConsumptionRenderModelSwaps=8]="ConsumptionRenderModelSwaps",t[t.ConsumptionSnapPointsStuckDetected=9]="ConsumptionSnapPointsStuckDetected",t[t.HomePageClick=10]="HomePageClick",t[t.HomePageScrollbarClick=11]="HomePageScrollbarClick",t[t.HomePageMouseDown=12]="HomePageMouseDown",t[t.HomePageMouseWheel=13]="HomePageMouseWheel",t[t.HomePageKeyboard=14]="HomePageKeyboard",t[t.HomePageTouch=15]="HomePageTouch",t[t.NewVisualDesignHomePageClick=16]="NewVisualDesignHomePageClick",t[t.NewVisualDesignHomePageScrollbarClick=17]="NewVisualDesignHomePageScrollbarClick",t[t.NewVisualDesignHomePageMouseDown=18]="NewVisualDesignHomePageMouseDown",t[t.NewVisualDesignHomePageMouseWheel=19]="NewVisualDesignHomePageMouseWheel",t[t.NewVisualDesignHomePageKeyboard=20]="NewVisualDesignHomePageKeyboard",t[t.NewVisualDesignHomePageTouch=21]="NewVisualDesignHomePageTouch",t[t.Dashboard_BlockSway=22]="Dashboard_BlockSway",t[t.Dashboard_UnblockSway=23]="Dashboard_UnblockSway"}(t.AggregationCounter||(t.AggregationCounter={}));!function(t){t[t.Arbitrary=0]="Arbitrary",t[t.ConsumptionScrollChange=1]="ConsumptionScrollChange",t[t.InitialConsumption=2]="InitialConsumption",t[t.ConsumptionChange=3]="ConsumptionChange",t[t.HomePageScrollChange=4]="HomePageScrollChange",t[t.NewVisualDesignHomePageScrollChange=5]="NewVisualDesignHomePageScrollChange",t[t.OutputTextAdjustment=6]="OutputTextAdjustment",t[t.Performance=7]="Performance",t[t.CardDeckVirtualization=8]="CardDeckVirtualization"}(t.StatisticalMeasure||(t.StatisticalMeasure={}));var l;!function(t){t[t.Email=0]="Email",t[t.Embed=1]="Embed",t[t.Facebook=2]="Facebook",t[t.Link=3]="Link",t[t.LinkedIn=4]="LinkedIn",t[t.Twitter=5]="Twitter",t[t.Edit=6]="Edit",t[t.DocsDotCom=7]="DocsDotCom"}(l=t.ShareTargetId||(t.ShareTargetId={}));!function(t){t[t.Bing=0]="Bing",t[t.Embed=1]="Embed",t[t.Facebook=2]="Facebook",t[t.MyDevice=3]="MyDevice",t[t.OneDrive=4]="OneDrive",t[t.OneNote=5]="OneNote",t[t.StockPhotos=6]="StockPhotos",t[t.SuggestedContent=7]="SuggestedContent",t[t.Twitter=8]="Twitter",t[t.Unknown=9]="Unknown",t[t.Youtube=10]="Youtube"}(t.AddContentSource||(t.AddContentSource={}));var u;!function(t){t[t.initial=0]="initial",t[t.undo=1]="undo",t[t.redo=2]="redo"}(u=t.UndoState||(t.UndoState={}));var c=function(){function t(){this.OperationStartTime=new Date,this.TELEM_DATACOLUMNS={},this.UndoState=u[u.initial],this.ShouldLogActivityName=!0,StoryLog.SetupUlsLogData(this)}return t.prototype.clone=function(){var e=new t;for(var n in this)this.hasOwnProperty(n)&&(e[n]=this[n]);return e.OperationStartTime&&(e.OperationStartTime=new Date(e.OperationStartTime.getTime())),e.ActionStartTime&&(e.ActionStartTime=new Date(e.ActionStartTime.getTime())),e.RenderTimes&&(e.RenderTimes=e.RenderTimes.slice()),e.TELEM_DATACOLUMNS&&(e.TELEM_DATACOLUMNS=JSON.parse(JSON.stringify(e.TELEM_DATACOLUMNS))),e},t.prototype.createHashId=function(){var t=e(this.ActionStartTime.toString())^e(this.StoryId)^e(this.UserLogId)^e(this.TELEM_ACTIVITY_ACTIONNAME);this.ActionId=t},t.prototype.getActionStartTime=function(){return this.ActionStartTime},t.prototype.getOperationStartTime=function(){return this.OperationStartTime},t.prototype.setAnonUserId=function(t){this.AnonUserId=t},t.prototype.setIsBrowserSupported=function(t){this.UnsupportedBrowser=!t},t.prototype.setCustomReportingKey=function(t){this.TELEM_ACTIVITY_ACTIONNAME=t},t.prototype.setDescription=function(t){this.Description=t},t.prototype.setElapsedTime=function(t){this.ElapsedTime=t},t.prototype.setPageType=function(t){t===o.NavigationContextType.Story?this.PageType=o.NavigationContext.IsConsumption?"StoryConsumption":o.NavigationContext.IsAuthoringPlay?"AuthoringPlay":"StoryAuthoring":this.PageType=o.NavigationContextType[t]},t.prototype.setEditOccured=function(){this.EditOccured=!0},t.prototype.setIsAtomic=function(t){this.IsAtomic=t},t.prototype.setActionStartTime=function(t){this.ActionStartTime=t},t.prototype.setOperationStartTime=function(t){this.OperationStartTime=t},t.prototype.setRenderTimes=function(t){this.RenderTimes=t},t.prototype.setReportingKey=function(t){this.TELEM_ACTIVITY_ACTIONNAME=r[t]},t.prototype.setStoryId=function(t){this.StoryId=t},t.prototype.setUserId=function(t){this.UserLogId=t},t.prototype.setTelemetryData=function(t){this.TELEM_DATACOLUMNS=t},t.prototype.getLogData=function(){var t=this.clone();return delete t.OperationStartTime,delete t.ActionId,""+t.UnsupportedBrowser=="false"&&delete t.UnsupportedBrowser,!1===t.IsAtomic&&delete t.IsAtomic,null!==t.AnonUserId&&""!==t.AnonUserId&&void 0!==t.AnonUserId&&"null"!==t.AnonUserId||delete t.AnonUserId,null!==t.UserLogId&&""!==t.UserLogId&&void 0!=t.UserLogId&&"null"!==t.UserLogId||delete t.UserLogId,0===Object.keys(t.TELEM_DATACOLUMNS).length&&delete t.TELEM_DATACOLUMNS,!1===t.ShouldLogActivityName&&delete t.TELEM_ACTIVITY_ACTIONNAME,null!==t.STATISTICAL_MEASURE_NAME&&""!==t.STATISTICAL_MEASURE_NAME&&void 0!==t.STATISTICAL_MEASURE_NAME&&"null"!==t.STATISTICAL_MEASURE_NAME||delete t.STATISTICAL_MEASURE_NAME,null!==t.AGGREGATION_COUNTER_NAME&&""!==t.AGGREGATION_COUNTER_NAME&&void 0!==t.AGGREGATION_COUNTER_NAME&&"null"!==t.AGGREGATION_COUNTER_NAME||delete t.AGGREGATION_COUNTER_NAME,delete t.ShouldLogActivityName,t},t}();t.UlsLogData=c;var d=function(){function t(t){this._category=Diag.ULSCat.msoulscat_Story_RequestManager,this._traceLevel=Diag.ULSTraceLevel.info,this._ulsTag=0,this._logData=new c,this._telemetryData={},this._type=t,this._logData.setReportingKey(t),this._logData.setAnonUserId(CommonSettings.AnonUserId||"null"),this._logData.setIsAtomic(!1),this._logData.setUserId(CommonSettings.LogString||"null"),this._logData.setPageType(o.NavigationContext.CurrentType),this._logData.setIsBrowserSupported(0==CommonSettings.UnsupportedBrowser),this.resetActionStartTime()}return t.prototype.clone=function(){var t=Object.create(Object.getPrototypeOf(this));return t._category=this._category,t._traceLevel=this._traceLevel,t._type=this._type,t._ulsTag=this._ulsTag,t._telemetryData=JSON.parse(JSON.stringify(this._telemetryData)),t._logData=this._logData.clone(),t},t.prototype.stringify=function(){this._logData.setTelemetryData(this.getTelemetryDataColumns());var t=JSON.stringify(this._logData.getLogData());return this._logData.setTelemetryData(null),t},t.prototype.getActionStartTime=function(){return this._logData.getActionStartTime()},t.prototype.resetActionStartTime=function(){this._logData.setActionStartTime(new Date),this._logData.createHashId()},t.prototype.getActionType=function(){return this._type},t.prototype.getDataColumnCount=function(){return Object.keys(this._telemetryData).length},t.prototype.getTelemetryDataColumns=function(){var t={};for(var e in this._telemetryData)t[e]=this._telemetryData[e];return t},t.prototype.getUlsTraceLevel=function(){return this._traceLevel},t.prototype.setUlsTraceLevel=function(t){this._traceLevel=t},t.prototype.getUlsCategory=function(){return this._category},t.prototype.setUlsCategory=function(t){this._category=t},t.prototype.isSyncAction=function(){return!1},t.prototype.setEditOccured=function(){this._logData.setEditOccured()},t.prototype.getOperationStartTime=function(){return this._logData.getOperationStartTime()},t.prototype.setCustomReportingKey=function(t){this._logData.setCustomReportingKey(t)},t.prototype.setElapsedTime=function(t){this._logData.setElapsedTime(t)},t.prototype.setRenderTimes=function(t){this._logData.setRenderTimes(t)},t.prototype.markAsAtomicOperation=function(){this._logData.setIsAtomic(!0)},t.prototype.setOperationStartTime=function(t){this._logData.setOperationStartTime(t)},t.prototype.setStoryId=function(t){this._logData.setStoryId(t)},t.prototype.setTelemetryData=function(t){this._telemetryData=t},t.prototype.updateDataColumn=function(t,e){this._telemetryData[t]=e},t.prototype.setContext=function(t){for(var e in t)this._telemetryData[e]=t[e]},t.prototype.getUlsTagId=function(){return this._ulsTag},t.prototype.setActionName=function(t){this._logData.TELEM_ACTIVITY_ACTIONNAME=t},t.prototype.setUlsData=function(t,e,n){this.setUlsDataTag(596477218,t,e,n)},t.prototype.setUlsDataTag=function(t,e,n,o){this._ulsTag=t,this.setUlsCategory(e),this.setUlsTraceLevel(n),this._logData.Description=o},t.prototype.setLogReportingKey=function(t){this._logData.setCustomReportingKey(t)},t.prototype.setUndoState=function(t){this._logData.UndoState=u[t]},t.prototype.setShouldLogActivityName=function(t){this._logData.ShouldLogActivityName=t},t.prototype.setStatisticalMeasureName=function(t){this._logData.STATISTICAL_MEASURE_NAME=t},t.prototype.setAggregationCounterName=function(t){this._logData.AGGREGATION_COUNTER_NAME=t},t}();t.ActionData=d;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.isSyncAction=function(){return!0},e}(d);t.ModelChangeActionData=p;var g=function(t){function e(e,n){var o=t.call(this,e)||this;return o.setUlsDataTag(596477219,n,Diag.ULSTraceLevel.info,"The user performed the action:"+r[e]),o}return __extends(e,t),e}(d);t.SimpleClientActionData=g;var h=function(t){function e(e,n,o,i,a){void 0===a&&(a=null);var s=t.call(this,r.PageLoad)||this,l=capturePerformanceMetric("PageLoad"),u="";return n&&(u=StoryApp.Utilities.extractHostnameFromUrl(n)),s.setUlsDataTag(596477248,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"The user loaded a page."),s.setTelemetryData({PageLoadType:e,Referrer:u,WorldId:o,StyleId:i,DocumentReadyToPageRoot:l,PageName:a,DocumentHasFocus:document.hasFocus()}),StoryLog.FlushClientData(),s}return __extends(e,t),e}(d);t.PageLoadActionData=h;var m=function(t){function e(e,n,o,i){var a=t.call(this,r.Add_Embed)||this;return a.setUlsDataTag(596477249,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"The user added an embed."),a.setTelemetryData({Domain:e,Height:n,Width:o,Allowed:i.toString()}),a}return __extends(e,t),e}(d);t.EmbedActionData=m;var y=function(t){function e(e,n){var o=t.call(this,r.ChangeStoryAudience)||this;return o.setUlsDataTag(596477250,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"The user changed the audience for a story."),o.setTelemetryData({NewAudience:StoryAudience[e],OldAudience:StoryAudience[n]}),o}return __extends(e,t),e}(d);t.ChangeStoryAudienceData=y;var f=function(t){function e(e,n,o,i){var a=t.call(this,r.SuggestedContent_CreateImageModel)||this;return a.setUlsDataTag(596477251,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"Created image unit."),a.setTelemetryData({ImageUnitId:e,ProviderType:n,ImageHeight:o,ImageWidth:i}),a}return __extends(e,t),e}(p);t.CreateImageModelActionData=f;var S=function(t){function e(e,n,o,i,a,s,l,u,c,d,p,g,h){var m=t.call(this,r.AddContent_AddSuggestedImageContent)||this;return m.setUlsDataTag(596477252,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"Adding Suggested content piece"),m.setTelemetryData({NumberOfContentPieces:e,IndexOfInsertedContentPiece:n,NumberOfActiveClusters:o,TotalNumberOfClusters:i,QueryIDs:a,ClustersCount:s,ClusterClasses:l,ClusterSubTypes:u,ClusterIndex:c,License:d,ClusterVisualizationImage:p,ContentSource:g,ContentType:h}),m}return __extends(e,t),e}(p);t.AddSuggestedContentPiece=S;var C=function(t){function e(e,n,o,i,a,s,l){var u=t.call(this,r.AddContent_AddContentPieceFromBasicContentPage)||this;return u.setUlsDataTag(596477253,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"Adding a content piece from BasicContentPage"),u.setTelemetryData({NumberOfContentPieces:e,IndexOfInsertedContentPiece:n,TabId:o,ContentSource:i,ContentType:a,TotalClusters:s,ClusterIndex:l}),u}return __extends(e,t),e}(p);t.AddBasicContentPiece=C;var v=function(t){function e(e){var n=t.call(this,r.AddContent_SearchSuggestionActivated)||this;return n.setUlsDataTag(596477254,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"Selecting a search suggestion form the search suggestions dropdown."),n.setTelemetryData({SuggestionIndex:e}),n}return __extends(e,t),e}(d);t.SelectSearchSuggestion=v;var _=function(t){function e(e,n,o,i,a,s){var l=t.call(this,r.ContentAdded)||this;return l.setUlsDataTag(596477255,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"Content added"),l.setTelemetryData({ContentSource:e,ContentType:n,SelectedSource:o||"",SelectedTabIndex:i||0===i?i:-1,SelectedTabId:a||"",FromPredefinedClusters:s||""}),l}return __extends(e,t),e}(p);t.ContentAddedData=_;var w=function(t){function e(e){var n=t.call(this,r.AddContent_AddBingImageContent)||this;return n.setUlsDataTag(596477256,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"Adding Bing Image"),n.setTelemetryData({License:e}),n}return __extends(e,t),e}(p);t.AddBingImageData=w;var T=function(t){function e(e,n,o,i){var a=t.call(this,r.AddContent_AddPicHitImageContent)||this;return a.setUlsDataTag(596477257,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"Adding PicHit Image"),a.setTelemetryData({Index:e,TabId:n,CategoryInfo:o,IsAuthenticated:i}),a}return __extends(e,t),e}(p);t.AddPicHitImageData=T;var A=function(t){function e(e){var n=t.call(this,r.AddContent_AddOneNoteImageContent)||this;return n.setUlsDataTag(596477258,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"Adding OneNote Image"),n.setTelemetryData({ForeignKey:e}),n}return __extends(e,t),e}(p);t.AddOneNoteImageData=A;var D=function(t){function e(e,n,o,i,a,s,l,u,c,d,p){var g=t.call(this,r.SuggestedContent_SelectCluster)||this;return g.setUlsDataTag(596477259,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"Cluster Clicked"),g.setTelemetryData({ClusterID:e,ClusterIndex:n,ClusterClass:o,ClusterSubType:i,ClusterQueryIDs:a,OldClusterSelection:s,NewClusterSelection:l,ActiveClustersCount:u,TotalClustersCount:c,AllClustersTypeInfoEncoded:d,SelectedSource:p}),g}return __extends(e,t),e}(d);t.SelectSuggestedContentClusterData=D;var B=function(t){function e(e,n){var o=t.call(this,r.DeleteImageContent)||this;return o.setUlsDataTag(596477260,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"Deleting image."),o.setTelemetryData({ImageId:e,ImageUsedForColor:n}),o}return __extends(e,t),e}(p);t.DeleteImageActionData=B;var I=function(t){function e(e){var n=t.call(this,r.Aggregation)||this;if(n.setUlsDataTag(596477261,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Aggregation data."),null===e)throw StoryApp.RethrowLogger.createError("Key parameter is null, all aggregations must have a key to uniquely identify them.");return n.setCustomReportingKey(e),n}return __extends(e,t),e}(d);t.AggregationData=I;var b=function(t){function e(e,n,o){void 0===n&&(n=0),void 0===o&&(o=null);var i=t.call(this,e)||this;i.counter=0,i.setShouldLogActivityName(!1),i.setAggregationCounterName(e),i.setUlsDataTag(596477262,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Long running client counter:"+e),i.counter=n,i.update();var r=CommonSettings.FlightSettings?CommonSettings.FlightSettings.flightName:"N/A";return i.updateDataColumn("Flight",r),null!==o&&i.setContext(o),i}return __extends(e,t),e.prototype.decrement=function(){if(!(this.counter>0))throw StoryApp.RethrowLogger.createError("decrement() call would result in an invalid state (below 0) for self counter.");this.counter--,this.update()},e.prototype.getValue=function(){return this.counter},e.prototype.increment=function(){this.counter++,this.update()},e.prototype.reset=function(){this.counter=0,this.update()},e.prototype.update=function(){this.updateDataColumn("Count",this.counter.toString())},e}(I);t.CounterData=b;var E=function(){function t(t){this.counter=0,this.product=1,this.runningSdev=0,t?this.observeNewValue(t):this.initializeToNaN()}return t.prototype.observeNewValue=function(t){if(isNaN(t))StoryLog.TraceTag(596477263,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"Observation of a NaN value attempted for a aggregate measure or counter. Value is:"+t);else if(null!==t){isNaN(this.counter)?(this.initializeValuesToZero(),this.min=t,this.max=t):(t<this.min&&(this.min=t),t>this.max&&(this.max=t)),this.counter++,this.sum=this.sum+t,this.reciprocalSum=this.reciprocalSum+1/t;var e=this.mean;this.mean=this.sum/this.counter,this.product=this.product*t,this.geometricMean=Math.pow(this.product,1/this.counter),this.harmonicMean=this.counter/this.reciprocalSum,this.runningSdev=this.runningSdev+(t-e)*(t-this.mean),this.sdev=Math.sqrt(this.runningSdev/this.counter)}else StoryLog.TraceTag(596477264,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"Observation of a null value attempted for a aggregate measure or counter.")},t.prototype.initializeToNaN=function(){var t=parseInt("Not a number");this.counter=t,this.geometricMean=t,this.harmonicMean=t,this.max=t,this.mean=t,this.min=t,this.reciprocalSum=t,this.sdev=t,this.sum=t},t.prototype.initializeValuesToZero=function(){this.counter=0,this.geometricMean=0,this.harmonicMean=0,this.max=0,this.mean=0,this.min=0,this.reciprocalSum=0,this.sdev=0,this.sum=0},t.prototype.getStatisticalLogData=function(t){var e={},n=this;for(var o in n)n.hasOwnProperty(o)&&!isNaN(n[o])&&(e[o]=parseFloat(n[o].toFixed(t)));return e},t}();t.SingleVariableStasticsData=E;var x=function(t){function e(e,n,o){void 0===o&&(o=null);var i=t.call(this,e)||this;i.data={},i.setShouldLogActivityName(!1),i.setStatisticalMeasureName(e),i.setUlsDataTag(596477265,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Long running client aggregation measure:"+e);for(var r in n)i.data[r]=new E(n[r]);return i.update(),o&&i.setContext(o),i}return __extends(e,t),e.prototype.observe=function(t){for(var e in this.data)void 0!==this.data[e]?this.data[e].observeNewValue(t[e]):this.setUlsDataTag(596477266,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"Observe value for key "+e+" is undefined");this.update()},e.prototype.update=function(){for(var t in this.data)void 0!==this.data[t]?this.updateDataColumn(t,JSON.stringify(this.data[t].getStatisticalLogData(4))):this.setUlsDataTag(596477267,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"Data for key "+t+" is undefined")},e}(I);t.StatisticalData=x;var P=function(t){function e(e,n,o){var i=t.call(this,r.ButtonClicked)||this;return i.setUlsDataTag(596477268,n,Diag.ULSTraceLevel.info,"Button click"),i.setTelemetryData({Target:a[e]}),o&&i.setContext(o),i}return __extends(e,t),e}(d);t.ButtonClickAction=P;var R=function(t){function e(e,n,o){var i=t.call(this,r.ButtonRightClicked)||this;return i.setUlsDataTag(596477269,n,Diag.ULSTraceLevel.info,"Button right click"),i.setTelemetryData({Target:a[e]}),o&&i.setContext(o),i}return __extends(e,t),e}(d);t.ButtonRightClickAction=R;var L=function(t){function e(e,n,o){var i=t.call(this,r.ButtonCreated)||this;return i.setUlsDataTag(596477270,n,Diag.ULSTraceLevel.info,"Button created"),i.setTelemetryData({Target:a[e]}),o&&i.setContext(o),i}return __extends(e,t),e}(d);t.ButtonCreatedAction=L;var V=function(t){function e(){var e=t.call(this,r.CreateNew)||this;return e.setUlsDataTag(596477271,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.info,"The user created a new story."),e}return __extends(e,t),e}(d);t.CreateNewActionData=V;var U=function(t){function e(){var e=t.call(this,r.DeleteStory)||this;return e.setUlsDataTag(596477272,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"The user deleted a story."),e}return __extends(e,t),e}(d);t.DeleteStoryActionData=U;var k=function(t){function e(e){var n=t.call(this,r.DeleteStories)||this;return n.setUlsDataTag(596477273,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,e),n}return __extends(e,t),e}(d);t.DeleteStoriesActionData=k;var F=function(t){function e(e){var n=t.call(this,r.GetRecycleBinSways)||this;return n.setUlsDataTag(596477274,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,e),n}return __extends(e,t),e}(d);t.GetRecycleBinSwaysActionData=F;var M=function(t){function e(e){var n=t.call(this,r.RestoreStories)||this;return n.setUlsDataTag(596477275,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,e),n}return __extends(e,t),e}(d);t.RestoreStoriesActionData=M;var O=function(t){function e(){var e=t.call(this,r.RemoveEditor)||this;return e.setUlsDataTag(596477276,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"The user removed themselves from a story."),e}return __extends(e,t),e}(d);t.RemoveEditorActionData=O;var N=function(t){function e(){var e=t.call(this,r.RemoveViewedStory)||this;return e.setUlsDataTag(596477277,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"User has sent the request to remove viewed story."),e}return __extends(e,t),e}(d);t.RemoveViewedStoryActionData=N;var W=function(t){function e(e,n){var o=t.call(this,r.FileUpload)||this;return o.setUlsDataTag(596477278,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.info,"The user has uploaded some files."),o.setTelemetryData({Count:e.length,UploadSource:n,TotalSize:o.getTotalFileSize(e)}),o}return __extends(e,t),e.prototype.getTotalFileSize=function(t){for(var e=0,n=0,o=t;n<o.length;n++)e+=o[n];return e},e}(d);t.FileUploadData=W;var H=function(t){function e(e,n,o){var i=t.call(this,e)||this;return i.setUlsDataTag(596477279,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"User changed upload progress"),i.setTelemetryData({ModelID:n,Progress:o}),i}return __extends(e,t),e}(d);t.FileUploadProgressData=H;var z=function(t){function e(e,n,o){var i=t.call(this,r.InvalidFileUpload)||this;return i.setUlsDataTag(596477280,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.info,"The user uploaded a invalid file"),i.setTelemetryData({FileExists:e,FileBlobExists:n,FileTypeExists:o}),i}return __extends(e,t),e}(d);t.InvalidFileUploadData=z;var G=function(t){function e(){var e=t.call(this,r.GetSuggestedContent)||this;return e.setUlsDataTag(596477281,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"The user asked for suggested content."),e}return __extends(e,t),e}(d);t.GetSuggestedContentActionData=G;var q=function(t){function e(e,n){var o=t.call(this,r.OpenStoryTile)||this;return o.setUlsDataTag(596477282,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"The user opens a story tile."),o.setTelemetryData({TileType:n}),o}return __extends(e,t),e}(d);t.OpenStoryTileData=q;var j=function(t){function e(e){var n=t.call(this,r.RemixClicked)||this;return n.setUlsDataTag(596465029,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"The user clicked the Remix! button."),n.setTelemetryData({StoryElementCount:e}),n}return __extends(e,t),e}(d);t.RemixAction=j;var K=function(t){function e(e){var n=t.call(this,r.ChangeLayoutClicked)||this;return n.setUlsDataTag(596465030,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"The user clicked one of the layout buttons."),n.setTelemetryData({StoryElementCount:e}),n}return __extends(e,t),e}(d);t.ChangeLayoutAction=K;var J=function(t){function e(e,n,o,i,a){void 0===a&&(a=!1);var s=t.call(this,r.ChangeWorld)||this;return s.setUlsDataTag(596477283,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.info,"The user changed to a new world."),s.setTelemetryData({CurrentWorldId:e,CurrentStyleId:o,NewWorldId:n,WorldForcedStyleChange:a,NewStyleId:i}),s}return __extends(e,t),e}(p);t.WorldChangeData=J;var Q=function(t){function e(e,n,o,i,a){void 0===i&&(i=""),void 0===a&&(a=!1);var s=t.call(this,r.ChangeStyle)||this;return s.setUlsDataTag(596477312,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.info,"The user changed to a new style."),s.setTelemetryData({CurrentWorldId:e,CurrentStyleId:n,NewWorldId:i,NewStyleId:o,WorldForcedStyleChange:a}),s}return __extends(e,t),e}(p);t.StyleChangeData=Q;var Y=function(t){function e(e,n,o,i){var a=t.call(this,r.Design_Override_ChangeFontSet)||this;return a.setUlsDataTag(596477313,Diag.ULSCat.msoulscat_Story_Style,Diag.ULSTraceLevel.info,"The user changed the font set override."),a.setTelemetryData({CurrentFontSetId:n,NewFontSetId:e,CurrentStyleId:o,CurrentWorldId:i}),a}return __extends(e,t),e}(p);t.FontSetChangeData=Y;var X=function(t){function e(e,n,o){var i=t.call(this,r.SlidebarChangedPosition)||this;return i.setUlsDataTag(596477314,n,Diag.ULSTraceLevel.info,"Slidebar change"),i.setTelemetryData({Target:s[e]}),o&&i.setContext(o),i}return __extends(e,t),e}(d);t.SlidebarSlideAction=X;var Z=function(t){function e(e,n){void 0===n&&(n="");var o=t.call(this,r.ChangeColor)||this;return o.setUlsDataTag(596477315,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.info,"The user changed to a new color override."),o.setTelemetryData({CurrentColorPalette:n,NewColorPalette:e}),o}return __extends(e,t),e}(p);t.ColorChangeData=Z;var tt=function(t){function e(e,n,o,i,a,s,l,u){var c=t.call(this,r.ChangeColorPalette)||this;return c.setUlsDataTag(596477316,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.info,"The user elected a new palette from the list of options."),c.setTelemetryData({"Palette Position":e,"Number of Palettes for Image":n,World:o,Style:i,"Selected Palette":a,"Previous Palette":s,"Image Id":l,BonusPaletteSelected:u}),c}return __extends(e,t),e}(d);t.ColorPaletteChangeData=tt;var et=function(t){function e(e,n){var o=t.call(this,r.DesignPane_AddCustomColor)||this;return o.setUlsDataTag(596464465,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.info,"The user added a custom color."),o.setTelemetryData({"Raw Color":e,"Sanitized Color":n}),o}return __extends(e,t),e}(p);t.AddCustomColorData=et;var nt=function(t){function e(e,n){var o=t.call(this,r.ShareStory)||this;return o.setUlsDataTag(596477317,Diag.ULSCat.msoulscat_Story_Feedback,Diag.ULSTraceLevel.info,"The user shared a story."),o.setTelemetryData({TargetId:l[e],HasCurrentLocationUrl:(!!n).toString(),"Supports browser clipboard":(!(!window.clipboardData||!window.clipboardData.setData)).toString()}),o}return __extends(e,t),e}(d);t.ShareStoryData=nt;var ot=function(t){function e(e,n,o,i,r){var a=t.call(this,e)||this;return a.setTelemetryData({SwayContentLength:o,Position:i,ContentType:r}),a}return __extends(e,t),e}(d);t.ContextualUIData=ot;var it=function(t){function e(e,n,o,i,r){var a=t.call(this,e)||this;return a.setUlsDataTag(596477318,Diag.ULSCat.msoulscat_Story_Feedback,Diag.ULSTraceLevel.info,"The user shared a story from a content element."),a.setTelemetryData({HasCurrentLocationUrl:n.toString(),SupportsBrowserClipboard:(!(!window.clipboardData||!window.clipboardData.setData)).toString(),SwayContentLength:o,Position:i,ContentType:r}),a}return __extends(e,t),e}(d);t.ShareStoryDataFromContextualUI=it;var rt=function(t){function e(e,n,o,i,r,a){var s=t.call(this,n)||this;return s.setUlsDataTag(596477319,e,Diag.ULSTraceLevel.info,o),s.setTelemetryData({From:i,To:r,ModelIds:JSON.stringify(a)}),s}return __extends(e,t),e}(d);t.EmphasisLevelData=rt;var at=function(t){function e(e,n,o,i,r,a){var s=t.call(this,n)||this;return s.setUlsDataTag(596477320,e,Diag.ULSTraceLevel.info,o),s.setTelemetryData({From:i,To:r,ModelIds:JSON.stringify(a)}),s}return __extends(e,t),e}(d);t.StrictSizingData=at;var st=function(t){function e(e,n,o,i,r,a){var s=t.call(this,n)||this;return s.setUlsDataTag(596477321,e,Diag.ULSTraceLevel.info,o),s.setTelemetryData({From:i,To:r,ModelIds:JSON.stringify(a)}),s}return __extends(e,t),e}(d);t.GalleryStyleData=st;var lt=function(e){function n(n,o,i,r,a){var s=e.call(this,n)||this;return s.setUlsDataTag(596477322,Diag.ULSCat.msoulscat_Story_ContextualUI,Diag.ULSTraceLevel.info,o),s.setTelemetryData({SwayContentLength:i,ViewContext:r}),a&&n==t.ActionType.Edit_ChangeTransformUI_Opened&&s.updateDataColumn("ContentTypes",JSON.stringify(a)),s}return __extends(n,e),n}(d);t.TransformUIOpenData=lt;var ut=function(t){function e(e,n,o,i,r,a){var s=t.call(this,e)||this;return s.setUlsDataTag(596477323,Diag.ULSCat.msoulscat_Story_ContextualUI,Diag.ULSTraceLevel.info,n),s.setTelemetryData({SwayContentLength:o,TransformType:i,ViewContext:r,contentTypesTransformed:a}),s}return __extends(e,t),e}(d);t.TransformActionData=ut;var ct=function(t){function e(e,n,o,i,a){void 0===i&&(i="Undefined");var s=t.call(this,r.DialogShown)||this;return s.setUlsDataTag(596477324,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"The user was shown a dialog."),s.setTelemetryData({Title:e,Message:n,DialogType:StoryApp.View.ViewElements.DialogType[o],DialogLogMessage:i}),a&&s.setContext(a),s}return __extends(e,t),e}(d);t.DialogShownData=ct;var dt=function(t){function e(e,n,o,i,r){var a=t.call(this,e)||this;return a.setUlsDataTag(596477325,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"The user did something in the add content pane."),a.setTelemetryData({SwayLength:n,CurrentSource:o,SourceCardType:void 0===i?"":i,IsAADUser:void 0===r?"":r}),a}return __extends(e,t),e}(d);t.AddContentUIPaneData=dt;var pt=function(t){function e(e,n,o,i,r){var a=t.call(this,e)||this;return a.setUlsDataTag(596477326,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"The user switched their add content source."),a.setTelemetryData({SwayLength:n,FromSource:o,ToSource:i,FirstRun:r}),a}return __extends(e,t),e}(d);t.AddContentUINavigation=pt;var gt=function(t){function e(e,n,o,i,r){var a=t.call(this,e)||this;return a.setUlsDataTag(596477327,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"The user  used to add button to add content."),a.setTelemetryData({SwayLength:n,FromSource:o}),a.updateDataColumn("SelectionLength",(i||"").toString()),a}return __extends(e,t),e}(d);t.AddContentUISelection=gt;var ht=function(t){function e(e,n,o){var i=t.call(this,r.Edit_AddContentUI_ChangeTab)||this;return i.setUlsDataTag(596477328,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"The user opened a changed the content source tab."),i.setTelemetryData({SwayLength:e,CurrentSource:n,TabName:o.Id}),i}return __extends(e,t),e}(d);t.AddContentUIChangeSourceTab=ht;var mt=function(t){function e(e,n){var o=t.call(this,r.Edit_AddContentUI_ChangeSource)||this;return o.setUlsDataTag(596477329,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"AddContent Source Selected"),o.setTelemetryData({NewSource:e,OldSource:n?n.providerType:"null"}),o}return __extends(e,t),e}(d);t.AddContentUISwitchContentSource=mt;var yt=function(t){function e(e,n){var o=t.call(this,r.Edit_AddContentUI_ConnectButtonClicked)||this;return o.setUlsDataTag(596477330,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"Connect Button Clicked"),o.setTelemetryData({SelectedSource:e,SelectedTabId:n}),o}return __extends(e,t),e}(d);t.AddContentConnectButtonClicked=yt;var ft=function(t){function e(e){var n=t.call(this,r.Dialog_ConnectButtonClicked)||this;return n.setUlsDataTag(596477331,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Connect Button Clicked"),n.setTelemetryData({SelectedSource:e}),n}return __extends(e,t),e}(d);t.DialogConnectButtonClicked=ft;var St=function(t){function e(e,n,o,i){var r=t.call(this,e)||this;return r.setUlsDataTag(596477332,Diag.ULSCat.msoulscat_Story_DocumentImport,Diag.ULSTraceLevel.info,i),r.setTelemetryData({ProviderType:n,Extension:o}),r}return __extends(e,t),e}(d);t.ImportedOrEmbeddedDocumentUI=St;var Ct=function(t){function e(e,n,o){var i=t.call(this,e)||this;return i.setUlsDataTag(596477333,Diag.ULSCat.msoulscat_Story_DocumentImport,Diag.ULSTraceLevel.info,o),i.setTelemetryData({EmbedLink:n}),i}return __extends(e,t),e}(d);t.EmbedCardUI=Ct;var vt=function(t){function e(e){var n=t.call(this,r.FileDraggedAndDropped)||this;return n.setUlsDataTag(596477334,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"User dragged and dropped files from file system."),n.setTelemetryData({FileCount:e}),n}return __extends(e,t),e}(d);t.FileDraggedAndDropped=vt;var _t=function(t){function e(e){var n=t.call(this,r.TextDraggedAndDropped)||this;return n.setUlsDataTag(596477335,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"User dragged and dropped text."),n.setTelemetryData({Length:e}),n}return __extends(e,t),e}(d);t.TextDraggedAndDropped=_t;var wt=function(t){function e(e,n,o){var i=t.call(this,r.ScrollDown)||this;return i.setShouldLogActivityName(!1),i.setUlsDataTag(596477336,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"User scrolled to the bottom of suggestions. Decomposing next batch of suggestions."),i.setTelemetryData({AvailableSuggestionsCount:e,ActiveClustersCount:n,NoMoreSuggestionsAvailable:o}),i}return __extends(e,t),e}(d);t.ScrollDownAction=wt;var Tt=function(t){function e(e,n){var o=t.call(this,r.StorylinePasteContext)||this;return o.setUlsDataTag(596477337,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,"The user pasted into a view element."),o.setTelemetryData({Context:e}),o.updateDataColumn("ElementName",n||""),o}return __extends(e,t),e}(d);t.StorylinePasteContext=Tt;var At=function(t){function e(e){var n=t.call(this,r.ActionNegatedByDelete)||this;return n.setUlsDataTag(596477338,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,"The user deleted cards that were modified by the last action on the undo stack."),n.setTelemetryData({Action:r[e]}),n}return __extends(e,t),e}(d);t.ActionNegatedByDelete=At;var Dt=function(t){function e(e,n,o){var i=t.call(this,r.StorylinePasteInfo)||this;return i.setUlsDataTag(596477339,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,"The user pasted content into their Storyline."),i.setTelemetryData({Length:e,NumHeadings:n,NumImages:o}),i}return __extends(e,t),e}(d);t.StorylinePasteInfo=Dt;var Bt=function(t){function e(e,n,o,i,r,a){void 0===r&&(r=!0);var s=t.call(this,e)||this;s.setShouldLogActivityName(r),s.setUlsDataTag(596477340,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,n);var l={ModelIds:JSON.stringify(o),CardTypes:JSON.stringify(i),CardCount:o.length};return a&&(l=$.extend({},l,a)),s.setTelemetryData(l),s}return __extends(e,t),e}(d);t.StorylineActionData=Bt;var It=function(t){function e(e,n,o,i){var a=t.call(this,r.Storyline_PlaceholderClicked)||this;return a.setUlsDataTag(596460832,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,e),a.setTelemetryData({ModelIds:JSON.stringify(n),CardTypes:JSON.stringify(o),CardCount:n.length,CardModes:JSON.stringify(i)}),a}return __extends(e,t),e}(d);t.StorylinePlaceholderClickedData=It;var bt=function(t){function e(e,n,o,i){void 0===i&&(i=null);var r=t.call(this,e)||this;return r.setUlsDataTag(596477341,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,n),i?r.setTelemetryData({CardType:o,CardId:i}):r.setTelemetryData({CardType:o}),r}return __extends(e,t),e}(d);t.StorylineActionDataWithMultipleObjects=bt;var Et=function(e){function n(n,o,i,r){var a=e.call(this,t.ActionType.AddContent,n,o)||this;return a.updateDataColumn("AddedUnderId",i),a.updateDataColumn("AddedUnderType",r),a}return __extends(n,e),n}(bt);t.AddActionData=Et;var xt=function(e){function n(n,o,i){var r=e.call(this,t.ActionType.Storyline_PlaceholderFilled,n,o)||this;return r.updateDataColumn("ParentType",i),r}return __extends(n,e),n}(bt);t.StorylinePlaceholderFilled=xt;var Pt=function(t){function e(e,n,o,i){var a=t.call(this,r.Storyline_JackCardClicked)||this;return a.setUlsDataTag(596477342,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,e),a.setTelemetryData({CardType:n,ModelId:o,JacksParentsType:i}),a}return __extends(e,t),e}(d);t.StorylineJackAddCard=Pt;var Rt=function(t){function e(e,n,o,i){var a=t.call(this,r.Storyline_JackCardClicked)||this;return a.setUlsDataTag(596457537,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,e),a.setTelemetryData({PrevTab:n,NewTab:o,JackParentType:i}),a}return __extends(e,t),e}(d);t.StorylineJackChangeTab=Rt;var Lt=function(t){function e(e){var n=t.call(this,r.Storyline_PasteExceptionRTE)||this;return n.setShouldLogActivityName(!1),n.setUlsDataTag(596477343,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,"Exception thrown by our Rich Text Editor"),n.setTelemetryData({Exception:JSON.stringify(e)}),n}return __extends(e,t),e}(d);t.StorylinePasteException=Lt;var Vt=function(t){function e(e,n,o,i,r,a,s){var l=t.call(this,e)||this;if(l.setUlsDataTag(596477344,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,n),l.setTelemetryData({StartParagraph:o,EndParagraph:i,SelectionLength:r,OnCanvas:a}),s)for(var u in s)l.updateDataColumn(u,s[u]);return l}return __extends(e,t),e}(d);t.StorylineTextActionData=Vt;var Ut=function(t){function e(e,n,o,i){var r=t.call(this,e)||this;return r.setUlsDataTag(596477345,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,n),r.setTelemetryData({FocusedElement:o,FocusedParentElement:i}),r}return __extends(e,t),e}(d);t.UndoActionData=Ut;var kt=function(t){function e(e,n){var o=t.call(this,r.Site_YoutubePlayerStatusChange)||this;return o.setUlsDataTag(596477346,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Youtube video status change"),o.setTelemetryData({VideoId:e,NewStatus:n}),o}return __extends(e,t),e}(d);t.YouTubeVideoStateChange=kt;var Ft=function(t){function e(e,n,o,i,a){var s=t.call(this,r.SuggestedContent_ShowMoreSearchTags)||this;return s.setUlsDataTag(596477347,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"User wants to see more search tags"),s.setTelemetryData({indexOfSelectedCluster:e,numberOfVisibleClusters:n,numberOfContentPieces:o,license:i,sourcePane:a}),s}return __extends(e,t),e}(d);t.SuggestedContentDrawerButtonClicked=Ft;var Mt=function(e){function n(n,o,i){var r=e.call(this,t.ActionType.Edit_AuthoringTab_Toggle)||this;return r.setUlsDataTag(596477376,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,n),r.setTelemetryData({PaneType:o,ActionResult:i}),r}return __extends(n,e),n}(d);t.AuthoringTabToggleData=Mt;var Ot=function(t){function e(e,n,o){var i=t.call(this,e)||this;return i.setUlsDataTag(596477377,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,n),i.setTelemetryData({CardType:o}),i}return __extends(e,t),e}(d);t.CardGalleryAddCardData=Ot;var Nt=function(t){function e(e,n){var o=t.call(this,r.SuggestedContent_UserTypedQuerySearch)||this;return o.setUlsDataTag(596477378,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"User searched with user typed query"),o.setTelemetryData({SelectedSource:e,FromPreviousSource:n.toString()}),o}return __extends(e,t),e}(d);t.UserTypeQuerySearchData=Nt;var Wt=function(e){function n(n){var o=e.call(this,t.ActionType.Edit_AuthoringPane_LightDismiss)||this;return o.setUlsDataTag(596477379,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,"An authoring pane was just light dismissed."),o.setTelemetryData({PaneType:n}),o}return __extends(n,e),n}(d);t.AuthoringPaneLightDismissData=Wt;var Ht=function(t){function e(e,n,o,i){var a=t.call(this,r.AuthorsManager_IPLocation)||this;return a.setShouldLogActivityName(!1),a.setUlsDataTag(596477380,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,"Author IP Broadcasted"),a.setTelemetryData({modelId:e,editorsInModel:n,paragraphIds:JSON.stringify(o),editorsInParagraph:i}),a}return __extends(e,t),e}(d);t.IPPositionActionData=Ht;var zt=function(e){function n(n){var o=e.call(this,t.ActionType.MyStoriesChangeSortType)||this;return o.setUlsDataTag(596477381,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"The user changed the sorting type on MyStories"),o.setTelemetryData({type:n}),o}return __extends(n,e),n}(d);t.MyStoriesChangeSortTypeActionData=zt;var Gt=function(t){function e(e,n){var o=t.call(this,e)||this;return o.setUlsDataTag(596477382,Diag.ULSCat.msoulscat_Story_DocumentImport,Diag.ULSTraceLevel.info,"The user clicked on keep entire image checkbox."),o.setTelemetryData({KeepEntireImageChecked:n.toString()}),o}return __extends(e,t),e}(d);t.FocusPaneUIKeepEntireImageAction=Gt;var qt=function(t){function e(e,n){var o=t.call(this,e)||this;return o.setUlsDataTag(596477383,Diag.ULSCat.msoulscat_Story_DocumentImport,Diag.ULSTraceLevel.info,"The user made a focus point action."),o.setTelemetryData({NumberOfFocusPoints:n.toString()}),o}return __extends(e,t),e}(d);t.FocusPaneUIFocusPointAction=qt;var jt=function(t){function e(e,n,o){var i=t.call(this,r.Client_UserRequestedFlight)||this;return i.setShouldLogActivityName(!1),i.setUlsDataTag(596477384,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Client code is determining whether a user is on a given flight."),i.setTelemetryData({RequestedFlight:e,AvailableFlights:n,OnTreatmentFlight:o.toString()}),i}return __extends(e,t),e}(d);t.UserFlightAssignmentData=jt;var Kt=function(t){function e(e,n,i,a,s,l){var u=t.call(this,r.RenderModelLoad)||this,c=o.Environment.getInstance().getWindowSize();return u.setShouldLogActivityName(!1),u.setUlsDataTag(596477385,Diag.ULSCat.msoulscat_Story_Preview,Diag.ULSTraceLevel.info,"New RenderModel was loaded."),u.setTelemetryData({ElapsedTime:e,ContainerElementCount:n,NonContainerElementCount:i,ClientDevice:CommonSettings.ClientDevice,Width:c.w,Height:c.h,IsNativeClient:s,IsEmbedded:a,UserAgent:navigator.userAgent,IsComplete:l}),u}return __extends(e,t),e}(d);t.RenderModelLoadData=Kt;var Jt=function(t){function e(e){var n=t.call(this,r.CardDeck_Copy)||this;return n.setUlsDataTag(596477386,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,"User copied cards from the storyline."),n.setTelemetryData({ModelTypes:JSON.stringify(e)}),n}return __extends(e,t),e}(d);t.CardDeckCopyAction=Jt;var $t=function(t){function e(e){var n=t.call(this,r.CardDeck_Cut)||this;return n.setUlsDataTag(596477387,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,"User cut cards from the storyline."),n.setTelemetryData({ModelTypes:JSON.stringify(e)}),n}return __extends(e,t),e}(d);t.CardDeckCutAction=$t;var Qt=function(t){function e(e,n){var o=t.call(this,r.CardDeck_Paste)||this;return o.setUlsDataTag(596477388,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,"Cards were pasted into the storyline."),o.setTelemetryData({isSameSway:e,isSameAuthor:null,ModelTypes:JSON.stringify(n)}),o}return __extends(e,t),e}(d);t.CardDeckPasteAction=Qt;var Yt=function(t){function e(e){var n=t.call(this,r.CardDeck_Deserialize)||this;return n.setUlsDataTag(596477389,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.verbose,"Cards were deserialized into the storyline."),n.setTelemetryData({ModelTypes:JSON.stringify(e)}),n}return __extends(e,t),e}(d);t.CardDeckDeserializeAction=Yt;var Xt=function(t){function e(e){var n=t.call(this,r.CardDeck_Serialize)||this;return n.setUlsDataTag(596477390,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.verbose,"Cards were serialized from the storyline."),n.setTelemetryData({ModelTypes:JSON.stringify(e)}),n}return __extends(e,t),e}(d);t.CardDeckSerializeAction=Xt;var Zt=function(t){function e(e){var n=t.call(this,r.CardDeck_CopyPressed)||this;return n.setUlsDataTag(596477391,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,"User tried to copy cards from the storyline."),n.setTelemetryData({ModelTypes:JSON.stringify(e)}),n}return __extends(e,t),e}(d);t.CardDeckCopyPressedAction=Zt;var te=function(t){function e(e){var n=t.call(this,r.CardDeck_CutPressed)||this;return n.setUlsDataTag(596477392,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,"User tried to cut cards from the storyline."),n.setTelemetryData({ModelTypes:JSON.stringify(e)}),n}return __extends(e,t),e}(d);t.CardDeckCutPressedAction=te;var ee=function(t){function e(e,n){var o=t.call(this,r.CardDeck_MoveCard_DragDrop)||this;o.setUlsDataTag(596477393,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,"User moved cards in the storyline via drag and drop.");var i={CardMovedAfter:e};return n&&(i=$.extend({},i,n)),o.setTelemetryData(i),o}return __extends(e,t),e}(d);t.CardDeckMoveCardDragDropAction=ee;var ne=function(t){function e(e,n,o){var i=t.call(this,r.CardDeck_MoveCard_Keyboard)||this;i.setUlsDataTag(596477394,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,"User moved cards in the storyline via keyboard reordering.");var a={CardsMoved:e,CardMovedAfter:n};return o&&(a=$.extend({},a,o)),i.setTelemetryData(a),i}return __extends(e,t),e}(d);t.CardDeckMoveCardKeyboardAction=ne;var oe=function(t){function e(e,n,o,a){var s=t.call(this,e)||this;return s.setUlsDataTag(596477395,Diag.ULSCat.msoulscat_Story_ContextualUI,Diag.ULSTraceLevel.info,"First Run callout dismissed"),s.setTelemetryData({CalloutID:i.CalloutID[o],DismissalAction:i.FirstRunActionType[n],ActionType:r[e],ElapsedTime:a}),s}return __extends(e,t),e}(d);t.FirstRunExperienceData=oe;var ie=function(t){function e(e,n){var o=t.call(this,e)||this;return o.setUlsDataTag(596477396,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,"Card menu action taken"),o.setTelemetryData({OnCanvas:n}),o}return __extends(e,t),e}(d);t.CardMenuAction=ie;var re=function(t){function e(e,n){var o=t.call(this,e)||this;return o.setUlsDataTag(596477397,Diag.ULSCat.msoulscat_Story_Preview,Diag.ULSTraceLevel.info,"Detail view action"),n&&o.setContext(n),o}return __extends(e,t),e}(d);t.DetailViewAction=re;var ae=function(t){function e(e){var n=t.call(this,r.SuggestedClusterClick)||this;return n.setUlsDataTag(596477398,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"User clicked on suggested content cluster"),n.setTelemetryData({ClusterId:e}),n}return __extends(e,t),e}(d);t.SuggestedContentClusterClickAction=ae;var se=function(t){function e(e,n,o){var i=t.call(this,r.Preview_ZoomEnter)||this;return i.setUlsDataTag(596477399,Diag.ULSCat.msoulscat_Story_Preview,Diag.ULSTraceLevel.info,"User entered zoomed in state on an element in preview."),i.setTelemetryData({ModelId:e,InDetailView:n,EventType:o}),i}return __extends(e,t),e}(d);t.PreviewZoomEnter=se;var le=function(t){function e(e){var n=t.call(this,r.Edit_HideEndOfSwayToggled)||this;return n.setUlsDataTag(596477400,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"User changed value of HideEndOfSway checkbox"),n.setTelemetryData({HideEndOfSway:e}),n}return __extends(e,t),e}(d);t.HideEndOfSwayToggled=le;var ue=function(t){function e(e,n){var o=t.call(this,r.ToCView_Opened)||this;return o.setUlsDataTag(596477401,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"User opened ToC view"),o.setTelemetryData({IsAuthor:e,IsEditMode:n}),o}return __extends(e,t),e}(d);t.ToCViewOpened=ue;var ce=function(t){function e(e,n,o){var i=t.call(this,r.ToCView_Navigated)||this;return i.setUlsDataTag(596477402,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"User navigated the sway with ToC view"),i.setTelemetryData({TargetChapter:e,IsAuthor:n,IsEditMode:o}),i}return __extends(e,t),e}(d);t.ToCViewNavigated=ce;var de=function(t){function e(){var e=t.call(this,r.Print_Triggered)||this;return e.setUlsDataTag(596477403,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"User triggered printing"),e}return __extends(e,t),e}(d);t.PrintTriggered=de;var pe=function(e){function n(n){var o=e.call(this,r.Storyline_AddSocket)||this;return o.setUlsDataTag(596477404,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,"User added card into socket"),o.setTelemetryData({ButtonId:t.ButtonId[n]}),o}return __extends(n,e),n}(d);t.AddSocket=pe;var ge=function(e){function n(n,o){var i=e.call(this,r.ConsumptionAnimationToggled)||this;return i.setUlsDataTag(596477406,Diag.ULSCat.msoulscat_Story_Preview,Diag.ULSTraceLevel.info,"User is toggling consumpton animations"),i.setTelemetryData({ButtonId:t.ButtonId[n],AreAnimtionsEnabled:o}),i}return __extends(n,e),n}(d);t.ConsumptionAnimationsToggle=ge;var he=function(t){function e(e,n,o){var i=t.call(this,e)||this;return i.setUlsDataTag(596477407,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,n),i.setTelemetryData({TextCardDepth:o}),i}return __extends(e,t),e}(d);t.ConvertTextToHeadingActionData=he;var me=function(t){function e(e){var n=t.call(this,r.DocumentIngestionHeading_Deleted)||this;return n.setUlsDataTag(596121494,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,"User removed heading card"),n.setTelemetryData({ModelId:e}),n}return __extends(e,t),e}(d);t.DeleteIngestedHeadingCard=me;var ye=function(t){function e(e){var n=t.call(this,r.DocumentIngestionHeading_Modified)||this;return n.setUlsDataTag(596121495,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.info,"User changed the text of a heading card"),n.setTelemetryData({ModelId:e}),n}return __extends(e,t),e}(d);t.ModifyIngestedHeadingCard=ye}(ClientAction||(ClientAction={}));var StoryApp;!function(t){!function(e){var n=ClientAction.StatisticalMeasure,o=function(){function e(){}return e.prototype.initialize=function(n){var o=this,i=1e3*CommonSettings.PerformanceTelemetryInterval;if(i){if(this.handle)throw t.RethrowLogger.createError("Cannot initialize PagePerformanceObserver twice.");ActionLogger.CreateClientMeasure(e.measure,{totalElements:0,totalImages:0,allIFrames:0,dynamicElements:0,dynamicImages:0,dynamicIFrames:0,cssRules:0,computedTime:0},{scenario:n});var r=this.getPotentiallyUnsafeStyleValue(function(){return document.styleSheets&&document.styleSheets[0]});this.handle=platform.setInterval(function(){return o.observe(r)},i)}},e.prototype.dispose=function(){this.handle&&clearInterval(this.handle)},e.prototype.observe=function(t){var n=platform.now(),o=this.getPotentiallyUnsafeStyleValue(function(){return t&&t.cssRules&&t.cssRules.length})||0,i=document.querySelectorAll(e.allSelector).length,r=document.querySelectorAll(e.imgSelector).length,a=document.querySelectorAll(e.iframeSelector).length,s=0,l=0,u=0;this.mainElement||(this.mainElement=document.querySelector("div[role='main']")),this.mainElement&&(s=this.mainElement.querySelectorAll(e.allSelector).length,l=this.mainElement.querySelectorAll(e.imgSelector).length,u=this.mainElement.querySelectorAll(e.iframeSelector).length),ActionLogger.ObserveClientMeasure(e.measure,{allIFrames:a,cssRules:o,dynamicElements:s,dynamicIFrames:u,dynamicImages:l,totalElements:i,totalImages:r,computedTime:platform.now()-n})},e.prototype.getPotentiallyUnsafeStyleValue=function(t){try{return t()}catch(t){if("SecurityError"!==t.name)throw t}},e.measure=n[n.Performance],e.allSelector="*",e.imgSelector="img",e.iframeSelector="iframe",e}();e.PagePerformanceObserver=o}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(e,n){var o=t.call(this,e)||this;return o._cssClass=n.cssClass||"",o}return __extends(e,t),e.prototype.layerClassNameArgs=function(t){return"FontIconLayer "+this._cssClass},e}(TDB.ViewElement);t.FontIconLayerVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(e){function n(t,n){var o=e.call(this,t)||this;return o._fontIconName=TDB.watchableOption(o,n.fontIconName),o._cssClass=TDB.watchableOption(o,n.fontIconWrapperClass,""),o._fontIconSizeClass=n.fontIconSizeClass||"",o._fontIconVisible=TDB.watchableOption(o,n.fontIconVisible,!0),o.fontIconBackgroundColorClass=n.fontIconBackgroundColorClass||"",o}return __extends(n,e),n.prototype.ifWrapperArgs=function(t){return this._fontIconVisible.getWatchedValue(t)},n.prototype.getVisible=function(t){return this.ifWrapperArgs(t)},n.prototype.wrapperClassNameArgs=function(t){return t.watchValue(this._cssClass)},n.prototype.layersContainerClassNameArgs=function(t){return"FontIconLayersContainer "+this._fontIconSizeClass+" "+this.fontIconBackgroundColorClass},n.prototype.layersArgs=function(e){var n=this.getFontIconsFontLoadState().getWatchedValue(e);if(n==FontLoadTest.FontLoadState.FailedAndTesting||n==FontLoadTest.FontLoadState.Failed)return StoryLog.TraceTag(596476933,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"Showing fallback font icon"),[new TDB.ChildArgs(t.FontIconLayerVE,{cssClass:"MissingFontIcon"})];var o=this._fontIconName.getWatchedValue(e),i=[],r=FontIconsMapping[o];if(null==r)return StoryLog.TraceTag(596476934,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.error,"Missing icon. Icon name: "+o),[];for(var a=r.length,s=0;s<a;s++)i.push(new TDB.ChildArgs(t.FontIconLayerVE,{cssClass:r[s]}));return i},n.prototype.getFontIconsFontLoadState=function(){var e=this.findParent(t.PageRootVE,!0);return FontLoadTest.registerCustomFont("SwayIcons,SwayIcons Bold,SwayIcons Semibold,SwayIcons Semilight,SwayIcons Thin","",3,30,e)},n}(TDB.ViewElement);t.FontIconVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(e,n){var o=t.call(this,e)||this;return o._user=n.user,o._message=n.message,o}return __extends(e,t),e.prototype.messageTextArgs=function(t){return this._message},e.prototype.imageAttrArgs=function(t){var e=Icons.Doughboy72Icon;return this._user.thumbnailUrl?e=this._user.thumbnailUrl:this._user.thumbnailUrlSmall&&(e=this._user.thumbnailUrlSmall),{src:e}},e.prototype.nameTextArgs=function(t){return this._user.displayName},e.prototype.domainTextArgs=function(t){return this._user.domain},e}(TDB.FocusableViewElement);t.EditStoryDialogVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(e,n){var o=t.call(this,e)||this;return o.message=TDB.watchableOption(o,n.message),o.visible=TDB.watchableOption(o,n.visible),o.containerClassName=n.containerClassName,o}return __extends(e,t),e.prototype.ifLoadingMessageArgs=function(t){return t.watchValue(this.visible)},e.prototype.loadingMessageContainerClassNameArgs=function(t){return this.containerClassName||"LoadingMessage"},e.prototype.textTextArgs=function(t){return t.watchValue(this.message)},e.prototype.textClassNameArgs=function(t){return"AddContentLoadingText"},e.prototype.getVisible=function(t){return this.visible.getWatchedValue(t)},e.prototype.animationAttrArgs=function(t){return{src:CommonSettings.ContentBaseUrl+"Loading.2X2X8.gif",role:Aria.Roles.Presentation}},e}(TDB.ViewElement);t.LoadingMessageVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n;!function(t){t[t.Loading=0]="Loading",t[t.Success=1]="Success",t[t.Failed=2]="Failed"}(n=e.VisualLinkLoadingState||(e.VisualLinkLoadingState={}));var o=function(){function e(t){this.args=t,this.title=TDB.watchableTag(596476822,this,void 0),this.titleDirection=TDB.watchableTag(596476823,this,void 0),this.descriptionDirection=TDB.watchableTag(596476824,this,void 0),this.description=TDB.watchableTag(596476825,this,void 0),this.thumbnailImageId=TDB.watchableTag(596476826,this,void 0),this.thumbnailId="visualLink_"+IdGenerator.generateId(36),this.loadingState=TDB.watchableTag(596476827,this,n.Loading),this.copiedOverlayVisible=TDB.watchableTag(596476828,this,!1)}return e.prototype.fetchThumbnailInfo=function(t){var e=this;this.clearModel(),this.args.sharingManager.getThumbnail(this.args.lookupId,function(n){e.updateModel(n),t&&t()},function(o,i,r){TDB.applyUpdate(function(){e.loadingState.setValue(n.Failed)}),t&&t()})},e.prototype.clearModel=function(){var t=this;TDB.applyUpdate(function(){t.title.setValue(void 0),t.titleDirection.setValue(void 0),t.description.setValue(void 0),t.descriptionDirection.setValue(void 0),t.thumbnailImageId.setValue(void 0),t.loadingState.setValue(n.Loading),t.copiedOverlayVisible.setValue(!1),t.publicThumbnailCreated=!1})},e.prototype.updateModel=function(t){var e=this;TDB.applyUpdate(function(){e.title.setValue(t.title),e.titleDirection.setValue(t.titleDirection),e.description.setValue(t.description),e.descriptionDirection.setValue(t.descriptionDirection),e.thumbnailImageId.setValue(t.thumbnail),e.loadingState.setValue(n.Success)})},e.prototype.copyToClipboard=function(){var n=this.getThumbnaillUrl(void 0,!1,!0),o=document.createElement("div");o.classList.add("visualLinkTemporaryHolder"),o.setAttribute(Aria.Attributes.Hidden,Aria.BooleanState.True),o.innerHTML=document.getElementById(this.thumbnailId).innerHTML,$(o).find(".visualLinkImage").attr({src:n,width:e.thumbnailWidthPx,height:e.thumbnailHeightPx}),$("body").append(o);var i=document.createRange();i.selectNode(o);var r=window.getSelection();r.removeAllRanges(),r.addRange(i),t.Utilities.execDocumentCommand("copy"),r.removeAllRanges(),$(o).remove(),this.triggerCopiedOverlay(),!n||this.publicThumbnailCreated||this.isModelEmpty(void 0)||(this.args.sharingManager.createPublicThumbnail(this.args.lookupId,this.getThumbnailImageId(void 0),void 0,void 0),this.publicThumbnailCreated=!0)},e.prototype.getSpinnerUrl=function(){return this.args.urlHelper.getLoadingSpinnerUrl()},e.prototype.getTitle=function(t){if(this.isLoaded(t))return this.isModelEmpty(t)?Resources.EmptySwayVisualLinkTitle:this.title.getWatchedValue(t)},e.prototype.getTitleDirection=function(t){return this.titleDirection.getWatchedValue(t)},e.prototype.getDescription=function(t){if(this.isLoaded(t)){var n=this.description.getWatchedValue(t);return e.truncateDescription(n,e.maxDescriptionLength,e.truncatedDescriptionSuffix)}},e.prototype.getDescriptionDirection=function(t){return this.descriptionDirection.getWatchedValue(t)},e.truncateDescription=function(t,e,n){if(!t)return t;var o=e-n.length;return t.length>o?t.substring(0,o)+n:t},e.prototype.getPreviewThumbnailUrl=function(t){return this.getThumbnaillUrl(t,!0,this.args.useCDN)},e.prototype.getThumbnaillUrl=function(t,n,o){if(this.isLoaded(t)){var i=this.getThumbnailImageId(t);return i?this.args.urlHelper.getThumbnailImageUrl(this.args.lookupId,i,e.thumbnailWidthPx,e.thumbnailHeightPx,n,o):this.args.urlHelper.getUnversionedContentUrl("email_image_large.png")}},e.prototype.getUrl=function(){return this.args.urlHelper.trackedShareLinkUrl(this.args.lookupId,t.Common.SharingReferrers.Email,this.args.urlParameterButtonLocation)},e.prototype.getLoadingState=function(t){return this.loadingState.getWatchedValue(t)},e.prototype.isLoading=function(t){return t.watchValue(this.loadingState)===n.Loading},e.prototype.isLoaded=function(t){return this.loadingState.getWatchedValue(t)===n.Success},e.prototype.isModelEmpty=function(t){return!this.getThumbnailImageId(t)&&!this.title.getWatchedValue(t)&&!this.description.getWatchedValue(t)},e.prototype.getThumbnailImageId=function(t){if(this.args.sharingManager.isPublicSharingAllowed(t)&&!this.args.sharingManager.hasPassword(t))return this.thumbnailImageId.getWatchedValue(t)},e.prototype.triggerCopiedOverlay=function(){var t=this;this.overlayTimeoutId&&clearTimeout(this.overlayTimeoutId),TDB.applyUpdate(function(){return t.copiedOverlayVisible.setValue(!0)}),this.overlayTimeoutId=platform.setTimeout(function(){TDB.applyUpdate(function(){return t.copiedOverlayVisible.setValue(!1)})},3e3)},e.prototype.isCopiedOverlayVisible=function(t){return this.copiedOverlayVisible.getWatchedValue(t)},e.truncatedDescriptionSuffix="",e.maxDescriptionLength=190,e.thumbnailWidthPx=600,e.thumbnailHeightPx=180,e}();e.VisualLinkViewModel=o}(e.ViewModel||(e.ViewModel={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=t.View.ViewElements,o=t.View.ViewModel,i=function(e){function i(t,n){var o=e.call(this,t)||this;return o.viewModel=n.viewModel,o}return __extends(i,e),i.prototype.ifVisualLinkSpinnerArgs=function(t){return this.viewModel.isLoading(t)},i.prototype.visualLinkSpinnerAttrArgs=function(){return{src:this.viewModel.getSpinnerUrl()}},i.prototype.ifVisualLinkErrorArgs=function(t){return this.viewModel.getLoadingState(t)===o.VisualLinkLoadingState.Failed},i.prototype.errorMessageTextArgs=function(){return Resources.VisualLinkErrorMessageText},i.prototype.ifVisualLinkContentArgs=function(t){return this.viewModel.getLoadingState(t)===o.VisualLinkLoadingState.Success},i.prototype.ifVisualLinkImageRowArgs=function(t){return!!this.viewModel.getPreviewThumbnailUrl(t)},i.prototype.visualLinkAttrArgs=function(){return{id:this.viewModel.thumbnailId}},i.prototype.thumbnailLinkAttrArgs=function(){return{href:this.viewModel.getUrl()}},i.prototype.thumbnailImgAttrArgs=function(t){return{src:this.viewModel.getPreviewThumbnailUrl(t)}},i.prototype.ifVisualLinkTitleRowArgs=function(t){return!!this.titleTextArgs(t)},i.prototype.titleLinkAttrArgs=function(){return{href:this.viewModel.getUrl()}},i.prototype.titleTextArgs=function(t){return this.viewModel.getTitle(t)},i.prototype.titleAttrArgs=function(t){return{dir:i.directionToAttribute(this.viewModel.getTitleDirection(t))}},i.prototype.ifVisualLinkDescriptionRowArgs=function(t){return!!this.descriptionTextArgs(t)},i.prototype.descriptionCellCssArgs=function(e){return{rtlContent:this.viewModel.getDescriptionDirection(e)===t.Common.TitleTextDirection.RightToLeft}},i.prototype.descriptionTextArgs=function(t){return this.viewModel.getDescription(t)},i.prototype.descriptionAttrArgs=function(t){return{dir:i.directionToAttribute(this.viewModel.getDescriptionDirection(t))}},i.prototype.goToSwayButtonContentTextArgs=function(t){return Resources.GoToStoryVisualLinkButtonText},i.prototype.goToSwayButtonAttrArgs=function(){return{href:this.viewModel.getUrl()}},i.directionToAttribute=function(e){return e===t.Common.TitleTextDirection.RightToLeft?"rtl":"ltr"},i.prototype.visualLinkOverlayCssArgs=function(t){return{GreenImageOverlay:this.viewModel.isCopiedOverlayVisible(t)}},i.prototype.visualLinkOverlayIconArgs=function(t){if(this.viewModel.isCopiedOverlayVisible(t)){var e={buttonId:ClientAction.ButtonId.ShareDropdown_CopiedVisualLink,clipClass:{value:Glyphs.VisualLinkCheckmarkWhiteClip},cssClass:{value:"GreenImageOverlayIcon segoeUISemilight"},description:{value:Resources.Copied},glyphClass:{value:Glyphs.VisualLinkCheckmarkWhiteGlyph},textClass:"GreenImageOverlayIconText",text:{value:Resources.Copied},domFocusable:{value:!1}};return new TDB.ChildArgs(n.GlyphButtonVE,e)}},i.prototype.visualLinkTableAttrArgs=function(t){var e={};return e[Aria.Attributes.Role]=Aria.Roles.Group,e[Aria.Attributes.Label]=this.viewModel.getTitle(t),e},i}(TDB.FocusableViewElement);e.VisualLinkVEBase=i}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=CommonBindings.View.Bindings.DynamicMenu,n=function(){function t(t){this.args=t,this._stateWidths={},this._stateWidths[e.MenuItemState.Overflow]=0,this.state=TDB.watchableTag(596476930,this,e.MenuItemState.Full),this.stateMap=t.stateMap||this.getDefaultStateMap()}return t.prototype.getViewElement=function(){return this.viewElement},t.prototype.getPrimaryArgs=function(){var t=this,e=this.args.primaryArgs;return this.extendPrimaryArgs(e),new TDB.ChildArgs(this.args.primaryType,e,function(e){t.viewElement=e})},t.prototype.getOverflowVisibility=function(){return{compute:new TDB.ComputedOptionArgs(this,this.overflowItemVisible)}},t.prototype.needToRecalcWidth=function(t){return void 0==this._stateWidths[t]},t.prototype.logFailure=function(){var t=this.args.primaryArgs,e={};for(var n in t){var o=t[n];switch(typeof o){case"number":case"string":e[n]=o;break;case"object":!o||"string"!=typeof o.value&&"number"!=typeof o.value||(e[n]=o.value)}}TDB.raiseRecoverableError("MenuItem doesn't have built VE. Args: "+JSON.stringify(e))},t.prototype.getItemWidth=function(){var t=this.state.getValue();if(this.needToRecalcWidth(t)){if(!this.viewElement)return this.logFailure(),0;var e=$(this.viewElement.findFirstNode(function(t){return!t.attributes.getNamedItem("class")||"ToggleButtonCheckbox"!==t.attributes.getNamedItem("class").nodeValue})).outerWidth(!0);void 0!==this.args.widthBuffer&&(e+=this.args.widthBuffer),this._stateWidths[t]=e}return this._stateWidths[t]},t.prototype.getWidthForState=function(t){return this._stateWidths[t]},t.prototype.menuItemVisible=function(t){return!(this.state.getWatchedValue(t)===e.MenuItemState.Overflow)&&this.getViewElementVisible(t)},t.prototype.menuItemGlyphOnly=function(t){return this.state.getWatchedValue(t)===e.MenuItemState.GlyphOnly},t.prototype.overflowItemVisible=function(t){return!(this.state.getWatchedValue(t)!==e.MenuItemState.Overflow)&&this.getViewElementVisible(t)},t.prototype.getViewElementVisible=function(t){return TDB.getOptionValue(this.args.viewElementVisible,t,!0)},t.createGlyphButtonStateMap=function(){var t;return t={},t[e.MenuResizeStep.Step3]=e.MenuItemState.Full,t[e.MenuResizeStep.Step4]=e.MenuItemState.GlyphOnly,t[e.MenuResizeStep.LastStep]=e.MenuItemState.Overflow,t},t.createStaticElementStateMap=function(){return{}},t.createGenericButtonStateMap=function(){var t;return t={},t[e.MenuResizeStep.NextToLastStep]=e.MenuItemState.Full,t[e.MenuResizeStep.LastStep]=e.MenuItemState.Overflow,t},t.createAlwaysVisibleButtonStateMap=function(){var t;return t={},t[e.MenuResizeStep.NextToLastStep-1]=e.MenuItemState.Full,t[e.MenuResizeStep.NextToLastStep]=e.MenuItemState.GlyphOnly,t},t.createLowPriorityStateMap=function(){var t;return t={},t[e.MenuResizeStep.Step1]=e.MenuItemState.Full,t[e.MenuResizeStep.Step2]=e.MenuItemState.Overflow,t},t.createStaggeredGlyphButtonStateMap=function(){var t;return t={},t[e.MenuResizeStep.Step2]=e.MenuItemState.Full,t[e.MenuResizeStep.NextToLastStep]=e.MenuItemState.GlyphOnly,t[e.MenuResizeStep.LastStep]=e.MenuItemState.Overflow,t},t}();t.MenuItem=n;var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getDefaultStateMap=function(){return n.createStaticElementStateMap()},e.prototype.extendPrimaryArgs=function(t){},e}(n);t.StaticMenuItem=o;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getDefaultStateMap=function(){return n.createGenericButtonStateMap()},e.prototype.extendPrimaryArgs=function(t){t.visible={compute:new TDB.ComputedOptionArgs(this,this.menuItemVisible)}},e}(n);t.HideableMenuItem=i;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getDefaultStateMap=function(){return n.createGlyphButtonStateMap()},e.prototype.extendPrimaryArgs=function(t){t.collapsed={compute:new TDB.ComputedOptionArgs(this,this.menuItemGlyphOnly)},t.visible={compute:new TDB.ComputedOptionArgs(this,this.menuItemVisible)}},e}(n);t.CollapsibleMenuItem=r;var a=function(){function t(t){this.menuItems=t}return t.prototype.getMenuItems=function(t){return this.menuItems},t.prototype.getOverflowButtonWidth=function(){return 0},t.prototype.getOverflowButtonVisible=function(){return!1},t.prototype.predictOverflowButtonVisible=function(t){return!1},t}();t.BasicMenuChunk=a}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(e,n){return t.call(this,e,{features:TDB.ControlSetFeatures.NoWrappingNavigation|TDB.ControlSetFeatures.TabDisabled|TDB.ControlSetFeatures.TabInto|TDB.ControlSetFeatures.PreserveFocusContext|TDB.ControlSetFeatures.HorizontalList|TDB.ControlSetFeatures.VerticalList|n})||this}return __extends(e,t),e.prototype.canActivate=function(){return this.getActivatableChildren().length>0},e.prototype.filterActivatable=function(t){for(var e=[],n=0;n<t.length;n++)t[n].canActivate()&&t[n].isFocusable()&&e.push(t[n]);return e},e.prototype.onNavigateList=function(e,n,o){if(Math.abs(n)>1||Math.abs(o)>1||n>0&&o>0)return TDB.EventPropagation.PreventDefault;if(0===o||e===TDB.OffsetOrigin.Initial){var i=CommonSettings.SiteUiRtl?-n:n;t.prototype.updateActiveChild.call(this,e,i)}else{var r=this.getActivatableChildren();if(r&&r.length>0){var a=this.getStartingIndex(r,e,0),s=1===o?this.elementIndexUnderCurrent(r,a):this.elementIndexAboveCurrent(r,a);this.updateActiveChild(e,s-a,r)}}return TDB.EventPropagation.PreventDefault},e.prototype.elementIndexUnderCurrent=function(t,e){for(var n=t[e].getControlPosition().bottom,o=-1,i=e+1;i<t.length;i++)if(t[i].getControlPosition().top>n){o=i;break}if(-1!==o){for(var r=t[e]?t[e].getControlPosition().left:0,a=t[o].getControlPosition().bottom,s=-1,i=o;i<t.length&&!(t[i].getControlPosition().top>a);i++)if(t[i].getControlPosition().right>r){s=i;break}return s=-1!==s?s:i-1}return e},e.prototype.elementIndexAboveCurrent=function(t,e){for(var n=t[e]&&t[e].getControlPosition().top,o=-1,i=e-1;i>=0;i--)if(t[i].getControlPosition().bottom<n){o=i;break}if(-1===o)return e;for(var r=t[o].getControlPosition().top,a=-1,s=t[e]&&t[e].getControlPosition().left,i=o;i>=0&&!(t[i].getControlPosition().bottom<r);i--)if(t[i].getControlPosition().left<=s){a=i;break}return a=-1!==a?a:i+1},e}(TDB.ControlSet);t.GridViewPanelVE=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=CommonBindings.View.Bindings.DynamicMenu,n=function(n){function o(t,e){var o=n.call(this,t)||this;return o._args=e,o}return __extends(o,n),o.prototype.getExtraChildren=function(){return[]},o.prototype.getCachedChildren=function(){return this._menuItems||(this._menuItems=this.getChildren()),this._menuItems},o.prototype.getCachedExtraChildren=function(){return this._extraMenuItems||(this._extraMenuItems=this.getExtraChildren()),this._extraMenuItems},o.prototype.getDynamicMenuVisible=function(t){return!0},o.prototype.menuWrapperDynamicMenuChunksArgs=function(t){return{visible:this.getDynamicMenuVisible(t),menuChunks:[this],widthBuffer:0}},o.prototype.menuElementsArgs=function(){return this.getCachedChildren().map(function(t){return t.menuItem.getPrimaryArgs()}).concat([this.createOverflowButton()])},o.prototype.overflowMenuArgs=function(){var e=this,n=this._args;return new TDB.ChildArgs(t.OverflowMenuVE,{menuItems:this.getCachedChildren().concat(this.getCachedExtraChildren()).map(function(t){return t.overflowArgs}),userState:n.userState,currentStory:n.currentStory,visible:TDB.watchableTag(596476942,this,!1),cssClass:n.overflowMenuCssClass,resourceFactory:n.resourceFactory,getControllingElement:function(){return e.overflowButton}},function(t){return e.overflowMenu=t})},o.prototype.getMenuItems=function(t){return this.getCachedChildren().concat(this.getCachedExtraChildren()).map(function(t){return t.menuItem})},o.prototype.getOverflowButtonWidth=function(){return e.Binding.overflowMenuWidth},o.prototype.getOverflowButtonVisible=function(){return this.calcOverflowButtonVisible()},o.prototype.predictOverflowButtonVisible=function(t){for(var n=this.getMenuItems(),o=0,i=0,r=n.length;i<r;i++)n[i].state.getValue()==e.MenuItemState.Overflow&&o++;return o+t>0},o.prototype.createOverflowButton=function(){var e=this;return new TDB.ChildArgs(t.GlyphButtonVE,{context:this,click:this.toggleOverflowMenu,fontIconName:{value:FontIcons.AppBarOverflowButtonIcon},fontIconSizeClass:FontIcons.AppBarOverflowButtonIconSize,textPlacementRight:!0,description:{value:Resources.OverflowButtonShortDescription},hasPopup:!0,buttonId:this._args.overflowButtonId,cssClass:{value:this._args.overflowButtonCssClass},telemetryId:this._args.overflowButtonTelemetryId,visible:{compute:new TDB.ComputedOptionArgs(this,this.calcOverflowButtonVisible)}},function(t){return e.overflowButton=t})},o.prototype.calcOverflowButtonVisible=function(t){for(var n=this.getMenuItems(t),o=0;o<n.length;o++)if(n[o].state.getWatchedValue(t)==e.MenuItemState.Overflow)return!0;return!1},o.prototype.toggleOverflowMenu=function(t){return this.overflowMenu.toggle(),TDB.EventPropagation.Bypass},o}(t.GridViewPanelVE);t.DynamicMenuVEBase=n}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(e){function n(t){var n=e.call(this,t)||this;return n.parent=t,n.hoveredRating=TDB.watchableTag(596476935,t,0),n.totalRating=TDB.watchableTag(596476936,n.ratingStars,3),n}return __extends(n,e),n.prototype.ratingStarsArgs=function(){for(var e=[],n=0;n<t.FeedbackSurveyStarsSliderVE.highestRating;n++){var o={rating:n+1,starNeutralFontClass:"StarNeutral",starHoveredFontClass:"StarHovered",starSelectedFontClass:"StarSelected",fontIconSizeClass:FontIcons.StarIconSize,fontIconName:{value:FontIcons.StarIcon},parent:this},i=new TDB.ChildArgs(t.FeedbackSurveyStarVE,o);e.push(i)}return e},n.prototype.getRatingStars=function(){return this.ratingStars},n.prototype.wrapperAttrArgs=function(e){var n={};n[Aria.Attributes.Role]=Aria.Roles.Slider,n[Aria.Attributes.Label]=Resources.HelpUsImproveSurveyRatingStarsReader,n[Aria.Attributes.Valuemin]=t.FeedbackSurveyStarsSliderVE.lowestRating.toString(),n[Aria.Attributes.Valuemax]=t.FeedbackSurveyStarsSliderVE.highestRating.toString();var o=this.totalRating.getWatchedValue(e),i=o>1?ResourceManager.ResolveString(Resources.HelpUsImproveSurveyStarPluralReader,[o]):ResourceManager.ResolveString(Resources.HelpUsImproveSurveyStarReader,[o]);return n[Aria.Attributes.Valuenow]=o.toString(),n[Aria.Attributes.Valuetext]=i,n},n.prototype.keyDown=function(t){var n=this.totalRating.getValue();if(t.keyCode===KeyCodeType.RightArrowKey||t.keyCode===KeyCodeType.LeftArrowKey){var o=t.keyCode===KeyCodeType.RightArrowKey?1:-1;return CommonSettings.SiteUiRtl&&(o*=-1),this.setTotalRating(n+o),TDB.EventPropagation.PreventDefault}return e.prototype.keyDown.call(this,t)},n.prototype.setHoveredRating=function(t){var e=this;TDB.applyUpdate(function(){e.hoveredRating.setValue(t)})},n.prototype.setTotalRating=function(e){var n=this;TDB.applyUpdate(function(){n.totalRating.setValue(Math.max(t.FeedbackSurveyStarsSliderVE.lowestRating,Math.min(e,t.FeedbackSurveyStarsSliderVE.highestRating)))})},n.lowestRating=1,n.highestRating=5,n}(TDB.Control);t.FeedbackSurveyStarsSliderVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(e){function n(t,n){var o=e.call(this,t,n)||this;return o._rating=n.rating,o.parent=n.parent,o._starNeutralFontClass=n.starNeutralFontClass,o._starHoveredFontClass=n.starHoveredFontClass,o._starSelectedFontClass=n.starSelectedFontClass,o}return __extends(n,e),n.prototype.wrapperClassNameArgs=function(e){var n=this.parent.totalRating.getWatchedValue(e),o=n>=t.FeedbackSurveyStarsSliderVE.lowestRating,i=this.parent.hoveredRating.getWatchedValue(e),r=i>=t.FeedbackSurveyStarsSliderVE.lowestRating;return r&&this._rating<=i?this._starHoveredFontClass:o&&!r&&this._rating<=n?this._starSelectedFontClass:this._starNeutralFontClass},n.prototype.wrapperEventsInitArgs=function(){return{mouseover:this.mouseOver,mouseout:this.mouseOut}},n.prototype.mouseOver=function(t){return this.parent.setHoveredRating(this._rating),!0},n.prototype.mouseOut=function(e){return this.parent.setHoveredRating(t.FeedbackSurveyStarsSliderVE.lowestRating-1),!0},n.prototype.mouseClicked=function(t){return this.parent.setTotalRating(this._rating),TDB.EventPropagation.Bypass},n}(t.FontIconVEBase);t.FeedbackSurveyStarVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(e,n){var o=t.call(this,e)||this;return o.args=n,o.underlyingArgs=n.contentArgs,o.visible=TDB.watchableOption(o,n.visible,!0),o}return __extends(e,t),e.prototype.ifMenuItemWrapperArgs=function(t){return this.visible.getWatchedValue(t)},e.prototype.contentArgs=function(){return new TDB.ChildArgs(this.args.contentType,this.args.contentArgs)},e}(TDB.FocusableViewElement);t.MenuItemVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e;!function(t){t[t.DIV=0]="DIV",t[t.LI=1]="LI"}(e=t.ListItemHTMLTag||(t.ListItemHTMLTag={}));var n=function(t){function n(e,n){var o=t.call(this,e)||this;return o.args=n,o}return __extends(n,t),n.prototype.HTMLTagArgs=function(){return this.args.htmlTag},n.prototype.wrapperAttrArgs=function(){var t={};return this.args.htmlTag===e.DIV&&(t[Aria.Attributes.Role]=this.args.role||Aria.Roles.Listitem),t},n.prototype.wrapperClassNameArgs=function(){return this.args.className},n.prototype.contentArgs=function(){return new TDB.ChildArgs(this.args.contentType,this.args.contentArgs)},n}(TDB.FocusableViewElement);t.ListItemVEBase=n}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){!function(t){t[t.DIV=0]="DIV",t[t.UL=1]="UL",t[t.OL=2]="OL"}(t.ListHTMLTag||(t.ListHTMLTag={}));var e=function(e){function n(t,n){var o=e.call(this,t)||this;return o.args=n,o}return __extends(n,e),n.prototype.HTMLTagArgs=function(){return this.args.htmlTag},n.prototype.listAttrArgs=function(){var t={};return t[Aria.Attributes.Label]=this.args.description,t[Aria.Attributes.Role]=this.args.role||Aria.Roles.List,t},n.prototype.listClassNameArgs=function(){return this.args.className},n.prototype.listItemsArgs=function(){return this.args.itemArgs.map(function(e){return new TDB.ChildArgs(t.ListItemVE,e)})},n}(TDB.FocusableViewElement);t.ListVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(e,n){var o=t.call(this,e,TDB.ControlSetFeatures.Isolated)||this;return o.model=n,o}return __extends(e,t),e.prototype.canActivate=function(){return!!this.model.getNotification()},e.prototype.getActivatableChildren=function(){var t=this.notification;return t?[t]:[]},e.prototype.notificationBarAttrArgs=function(t){var e={};return e[Aria.Attributes.Label]=Resources.NotificationBar,e[Aria.Attributes.Hidden]=0===this.model.getNotifications(t).length?Aria.BooleanState.True:Aria.BooleanState.False,e},e.prototype.notificationArgs=function(t){var e=this.model.getNotification(t);return e?e.getChildArgs():void 0},e.prototype.accessibilityNotificationTextTextArgs=function(t){var e=this.model.getNotification(t);if(e)return e.getText(t),Resources.NewNotificationAlert},e.prototype.onExiting=function(){var t=this.notification;t&&t.exit()},e}(t.RegionViewElement);t.NotificationBarVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(){function e(){this.notifications=TDB.watchable(this,[])}return e.getNotificationBar=function(e){var n=e?e.findParent(t.PageRootVE,!0):void 0;if(n)return n.notificationBar},e.prototype.removeNotification=function(e){var n=this,o=this.notifications.getValue(),i=o.indexOf(e);i>=0&&(e.getType()!=t.NotificationType.Warning||!e.isDismissed)&&o.splice(i,1),TDB.applyUpdate(function(){n.notifications.notify()}),this.getNotification()&&this.ve&&this.ve.exit()},e.prototype.setCurrentNotification=function(t,e){var n=this;if(this.getNotification()!==t)if(this.getNotification()){var o=this.notifications.getValue(),i=o.indexOf(t);i>=0&&o.splice(i,1);var r=this.getNotification();e?Task.unwrap(r.hide().then(function(){n.prependNotification(t),t.show()})):this.appendNotification(t)}else this.prependNotification(t),t.show()},e.prototype.prependNotification=function(t){var e=this,n=this.notifications.getValue();ArrayExtensions.contains(n,t)||(n.unshift(t),TDB.applyUpdate(function(){return e.notifications.notify()},TDB.Justification.SynchronousBrowserEvent))},e.prototype.appendNotification=function(t){var e=this,n=this.notifications.getValue();ArrayExtensions.addUnique(n,t)&&TDB.applyUpdate(function(){return e.notifications.notify()})},e.prototype.getNotification=function(t){var e=this.getNotifications(t);return ArrayExtensions.firstOrDefault(e,function(t){return!t.isDismissed})},e.prototype.getNotifications=function(t){return this.notifications.getWatchedValue(t)},e.prototype.createNotification=function(e){return new t.NotificationViewModel(this,e)},e.prototype.addNotification=function(e,n,o){void 0===n&&(n=!0),void 0===o&&(o=!1);var i=this.getNotificationFromSource(e.notificationSource,e.notificationType);return e.notificationType==t.NotificationType.Warning&&(this.removeNotifications(e.notificationSource,function(e){return e.getType()==t.NotificationType.Error}),i&&i.isDismissed)?null:(i&&(o||i.getType()==t.NotificationType.Error)?i.setArgs(e):i=this.createNotification(e),this.setCurrentNotification(i,n),i)},e.prototype.getNotificationFromSource=function(t,e){var n=this.notifications.getValue();return ArrayExtensions.firstOrDefault(n,function(n){return n.getSource()==t&&n.getType()==e})},e.prototype.removeNotifications=function(t,e){for(var n=[],o=0,i=this.notifications.getValue();o<i.length;o++){var r=i[o];if(r.getSource()==t){if(e&&!e(r))continue;n.push(r)}}for(var a=0,s=n;a<s.length;a++){var l=s[a];this.removeNotification(l)}var u=this.getNotification();u&&u.show()},e.prototype.getViewElementArgs=function(){var e=this;return new TDB.ChildArgs(t.NotificationBarVE,this,function(t){e.ve=t})},e}();t.NotificationBarViewModel=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=function(n){function o(t,e){var o=n.call(this,t,{features:TDB.ControlSetFeatures.Isolated|TDB.ControlSetFeatures.PreserveFocusContext})||this;return o.model=e,o}return __extends(o,n),o.prototype.onExiting=function(){this.model.setCollapsed(!0),this.notificationContentOverflowBinding&&this.notificationContentOverflowBinding.adjustLayout()},o.prototype.getActivatableChildren=function(){return this.showSeeMoreArgs()?[this.seeMoreButton]:n.prototype.getActivatableChildren.call(this)},o.prototype.notificationContentClassNameArgs=function(t){return this.model.getCollapsed(t)?"NotificationBarTextCollapsed":"NotificationBarText"},o.prototype.seeMoreClick=function(t){return this.model.setCollapsed(!1),this.enter(),TDB.EventPropagation.Bypass},o.prototype.seeMoreButtonArgs=function(t){if(this.showSeeMoreArgs(t)){var n={buttonId:ClientAction.ButtonId.Notification_SeeMore,click:this.seeMoreClick,context:this,description:{value:Resources.SeeMoreButtonDescription},fontIconName:{value:FontIcons.DropdownChevronIcon},fontIconSizeClass:FontIcons.DropdownChevronIconSize,cssClass:{value:"NotificationSeeMoreButton"}};return new TDB.ChildArgs(e.GlyphButtonVE,n)}},o.prototype.showSeeMoreArgs=function(t){return this.model.isOverflow.getWatchedValue(t)&&this.model.getCollapsed(t)},o.prototype.notificationContentOverflowInitArgs=function(){return this.model.isOverflow},o.prototype.notificationContentOverflowArgs=function(t){return 3*o.notificationHorizontalPadding+this.getExpandedButtonsWidth(t)},o.prototype.wrapperAttrArgs=function(t){var e={};return e[Aria.Attributes.Label]=Resources.NotificationItem,e},o.prototype.wrapperSlideVisibleInitArgs=function(){return!1},o.prototype.wrapperClassNameArgs=function(t){return this.model.getArgs(t).cssClass||"Notification"},o.prototype.getExpandedButtonsWidth=function(t){var n=this.model.getArgs(t),i=0;return n.isPinned||n.notificationType===e.NotificationType.Error||(i+=o.buttonWidth),n&&n.buttons&&(i+=n.buttons.length*(o.buttonWidth+o.buttonSpacing)),i},o.prototype.notificationPaddingStyleArgs=function(e){var n=this.showSeeMoreArgs(e)||this.model.getArgs(e).isPinned?o.seeMoreButtonWidth:this.getExpandedButtonsWidth(e);return{minWidth:t.Utilities.toPxStr(n),padding:"0 "+t.Utilities.toPxStr(o.notificationHorizontalPadding)}},o.prototype.onSlideComplete=function(t,e){this.model.isAnimationInProgress()&&(this.notificationContentOverflowBinding&&this.notificationContentOverflowBinding.adjustLayout(),this.model.queueAnimationCompletion())},o.prototype.wrapperSlideVisibleArgs=function(t){return{visible:this.model.isVisible(t),done:this.onSlideComplete}},o.prototype.rightButtonsArgs=function(t){var n=!this.showSeeMoreArgs(t),o=this.model.getArgs(t),i=[];if(n&&o.buttons&&(i=o.buttons.map(function(t){var n={buttonId:t.buttonId,click:t.onClick,text:t.text,context:t.context,cssClass:{value:"NotificationActionButton"}};return new TDB.ChildArgs(e.TextButtonVE,n)})),n&&!o.isPinned&&o.notificationType!==e.NotificationType.Error){var r={buttonId:ClientAction.ButtonId.Notification_Dismiss,click:this.dismissClick,text:{value:Resources.DismissButtonDescription},description:{value:Resources.DismissButtonScreenReaderDescription},tooltip:{value:Resources.DismissButtonScreenReaderDescription},context:this,cssClass:{value:"NotificationDismissButton"}};i.push(new TDB.ChildArgs(e.TextButtonVE,r))}return i},o.prototype.notificationMessageArgs=function(t){return this.model.getArgs(t).messages.map(function(t){return t.url?new TDB.ChildArgs(e.ClickableLinkVE,{message:t.text,url:t.url,class:t.cssClass,tabIndex:0}):new TDB.ChildArgs(e.SpanMessageVE,{message:t.text,messageCss:t.cssClass})})},o.prototype.dismissClick=function(t){return this.model.dismiss(),TDB.EventPropagation.Bypass},o.prototype.mouseClicked=function(t){var e=this.model.getArgs();return this.enter(),e.onClick&&e.onClick.call(this,t)?TDB.EventPropagation.Bubble:TDB.EventPropagation.Bypass},o.buttonWidth=96,o.buttonSpacing=10,o.notificationHorizontalPadding=16,o.seeMoreButtonWidth=48,o}(TDB.ControlSet);e.NotificationVEBase=n}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(){function e(t,e){this.parent=t,this.args=TDB.watchableTag(596455939,this,e),this.isNotificationVisible=TDB.watchableTag(596455940,this,!1),this.isOverflow=TDB.watchableTag(596455941,this,!1),this.isCollapsed=TDB.watchableTag(596455942,this,!0),void 0===e.showInConsumptionView&&(e.showInConsumptionView=!0)}return e.prototype.getChildArgs=function(){var e=this;return new TDB.ChildArgs(t.NotificationVE,this,function(t){e.ve=t})},e.prototype.getArgs=function(t){return this.args.getWatchedValue(t)},e.prototype.setCollapsed=function(t){var e=this;TDB.applyUpdate(function(){e.isCollapsed.setValue(t)})},e.prototype.getCollapsed=function(t){return this.isCollapsed.getWatchedValue(t)},e.prototype.setVisible=function(t){var e=this;return this.animationCompleted&&this.animationCompleted.resolve(),this.animationCompleted=new DeferredTask,TDB.applyUpdate(function(){e.isNotificationVisible.setValue(t),e.animationCompleted.resolve()},TDB.Justification.SynchronousBrowserEvent),this.animationCompleted},e.prototype.show=function(){return this.setVisible(!0)},e.prototype.hide=function(){return this.setVisible(!1)},e.prototype.getText=function(t){var e=this.args.getWatchedValue(t),n="";if(e.messages)for(var o=0;o<e.messages.length;o++)n+=e.messages[o].text;return n},e.prototype.isAnimationInProgress=function(){return!!this.animationCompleted},e.prototype.queueAnimationCompletion=function(){var t=this;platform.setImmediate(function(){t.animationCompleted&&(t.animationCompleted.resolve(),t.animationCompleted=void 0)})},e.prototype.isVisible=function(t){return this.isNotificationVisible.getWatchedValue(t)},e.prototype.setArgs=function(t){var e=this,n=this.ve,o=n&&n.isEntered();TDB.applyUpdate(function(){return e.args.setValue(t)}),o&&n.enter()},e.prototype.dismiss=function(){var t=this;this.isDismissed=!0,this.parent.removeNotifications(this.getSource(),function(e){return e===t});var e=this.args.getValue().onDismissed;e&&e.call(this.args.getValue().dismissContext)},e.prototype.showInConsumptionView=function(t){return!!t.watchValue(this.args).showInConsumptionView},e.prototype.getSource=function(){return this.args.getValue().notificationSource},e.prototype.getType=function(){return this.args.getValue().notificationType},e}();t.NotificationViewModel=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(n){var o,i=t.Common.PagePerformanceObserver;!function(t){t[t.None=0]="None",t[t.Shortcut=1]="Shortcut",t[t.AccessKey=2]="AccessKey"}(o=n.ControlElementHelpState||(n.ControlElementHelpState={}));!function(t){t[t.StorySiteHome=0]="StorySiteHome",t[t.MyStories=1]="MyStories",t[t.ReportAViolation=2]="ReportAViolation",t[t.ReportComplete=3]="ReportComplete",t[t.SetupPage=4]="SetupPage",t[t.MobileFeatured=5]="MobileFeatured",t[t.OpenStory_View=6]="OpenStory_View",t[t.OpenStory_Edit=7]="OpenStory_Edit",t[t.PasswordEntry=8]="PasswordEntry",t[t.SharingUi=9]="SharingUi"}(n.PageRootScenario||(n.PageRootScenario={})),n.focusNotificationEventName={SetFocus:"SetFocus",SetFocusStartRegion:"SetFocusStartRegion",SetFocusEndRegion:"SetFocusEndRegion",FocusExitedStartRegion:"FocusExitedStartRegion",FocusExitedEndRegion:"FocusExitedEndRegion"};var r=function(r){function a(e,n){var a=r.call(this,e,{features:TDB.ControlSetFeatures.PreserveFocusContext})||this;a._hoveredLinkUrl=TDB.watchableTag(596476879,a,""),a.performanceObserver=new i;var s=t.Utilities.query.fetch(t.Common.UrlHelper.URLParamAnimationsDisabled);return a.animationDisabled=TDB.watchableTag(596476880,a,s===t.Common.UrlHelper.URLParamValueTrue),a.pageId=n.pageId,a.register(n),a.setupNotificationBar(),a._pageView=n.createView(a),n.initializeView&&n.initializeView(),a.controlElementHelpState=TDB.watchableTag(596476881,a,o.None),a}return __extends(a,r),a.prototype.register=function(t){this._domEventRegister=n.DomEventRegister.setRoot(this,t.creationPolicy,CookieConsent.setUserConsentForCookies)},a.prototype.enableLinkHover=function(){var t=this;if(!this._mouseEnterHandler){var e=this._mouseEnterHandler=function(e){t.mouseOver(e)};document.addEventListener("mouseenter",e,!0)}if(!this._mouseLeaveHandler){var n=this._mouseLeaveHandler=function(e){t.mouseOut(e)};document.addEventListener("mouseleave",n,!0)}},a.prototype.dispose=function(t){this.performanceObserver&&(this.performanceObserver.dispose(),this.performanceObserver=void 0);var e=this._mouseEnterHandler;e&&(document.removeEventListener("mouseenter",e,!0),this._mouseEnterHandler=null),(e=this._mouseLeaveHandler)&&(document.removeEventListener("mouseleave",e,!0),this._mouseLeaveHandler=null),r.prototype.dispose.call(this,t)},a.createAndAttach=function(o){var i=null;return StoryPerformance.PerformanceManager.getInstance().measurePerformance("createAndAttachPageRootVE",function(){StoryPerformance.PerformanceManager.getInstance().measurePerformance("createAndAttach:BuildViewModel",function(){i=new n.PageRootVE(null,o)}),StoryPerformance.PerformanceManager.getInstance().measurePerformance("createAndAttach:BuildDOM",function(){i.createRoot(o.parentElement,o.pageId)}),e.Common.DialogManager.getInstance().setReady(),o.scenario&&i.performanceObserver.initialize(o.scenario),t.Identity.getActions().tryRenewAuthToken(),t.Common.Environment.getInstance().hasNativeHyperlinkTooltips()||i.enableLinkHover()}),TDB.ControlSet.contentFlowDirection=CommonSettings.SiteUiRtl?TDB.ContentFlowDirection.RightToLeft:TDB.ContentFlowDirection.LeftToRight,i},a.prototype.onFocusedElementRemoval=function(t){var e=this;this.lastActivationChain=void 0,platform.setImmediate(function(){e.enter()||a.clearDomFocus()})},a.clearDomFocus=function(){try{var e=document.body,n=t.Utilities.getDocumentActiveElement();void 0!=e&&e!==n&&("function"==typeof e.setActive?e.setActive():n&&"function"==typeof n.blur&&n.blur());var o=window?window.getSelection():void 0;void 0!=o&&"function"==typeof o.removeAllRanges&&o.removeAllRanges()}catch(t){StoryLog.TraceTag(596476882,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Failed to clear DOM focus: "+t)}},a.prototype.mouseOver=function(t){var e=this;try{var n=t.target;n.tagName&&"A"===n.tagName.toUpperCase()&&"ms-local-stream:"!==n.protocol&&TDB.applyUpdate(function(){e._hoveredLinkUrl.setValue(n.href)},TDB.Justification.SynchronousBrowserEvent)}catch(t){StoryLog.StructuredTraceTag(596453144,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"Exception adding fake link tooltip for Windows Client",{exception:t})}},a.prototype.mouseOut=function(t){var e=this,n=t.target;n.tagName&&"A"===n.tagName.toUpperCase()&&TDB.applyUpdate(function(){e._hoveredLinkUrl.setValue("")},TDB.Justification.SynchronousBrowserEvent)},a.prototype.showLinkArgs=function(t){return!!t.watchValue(this._hoveredLinkUrl)},a.prototype.linkTextArgs=function(t){return t.watchValue(this._hoveredLinkUrl)},a.prototype.notifySelectionStateChanged=function(t,e){},a.prototype.getActiveListItem=function(){return this.activeChild},a.prototype.activateListItem=function(t,e){var n=this.getActiveListItem();t&&t!==n&&t.canActivateItem()&&(this.setActiveListItem(t),e||t.onActivatedItem(),t.setItemActiveState(!0),n&&(n.setItemActiveState(!1),n.onDeactivatedItem()))},a.prototype.setActiveListItem=function(t){this.activeChild=t},a.prototype.onChildActiveStateChanged=function(t,e){if(e&&(this.lastActivationChain=t,t)){var o=ArrayExtensions.firstOrDefault(t,function(t){return t instanceof n.RegionViewElement});o&&o.activateItem(!0)}},a.prototype.setupNotificationBar=function(){this.notificationBar=new n.NotificationBarViewModel},a.prototype.pageViewArgs=function(){return this._pageView},a.prototype.dialogArgs=function(t){var e=this.getCurrentDialog(t);return e&&e.getViewArgs()},a.prototype.registerEventHandler=function(t){this._domEventRegister.registerEventHandler(t)},a.prototype.unregisterEventHandler=function(t){this._domEventRegister.unregisterEventHandler(t)},a.prototype.dialogWrapperFadeVisibleInitArgs=function(){return{}},a.prototype.dialogWrapperFadeVisibleArgs=function(t){return!!this.getCurrentDialog(t)},a.prototype.onActivateChild=function(t){var e=t;return e.enter(),e.activateItem(!0),!0},a.prototype.getActivatableChildren=function(){var t=function(t){return t instanceof n.RegionViewElement?t:null},e=this.traverseFocusable(function(e){var n=t(e);return n&&n.canActivateItem()?n:null},function(e){var n=t(e);return!n||n.containsRegions()||n.canActivateItem()});return ArrayExtensions.bubbleSort(e,function(t,o){var i=t.getOrder(),r=o.getOrder();if(i!==n.RegionOrderIndex.NotSpecified&&i===r){var a="Specific region order index should be unique in Ctrl+F6 loop.";a+=JSON.stringify(e.map(function(t){return t.toString()})),TDB.raiseRecoverableError(a)}return i=i===n.RegionOrderIndex.NotSpecified?Number.MAX_VALUE:i,r=r===n.RegionOrderIndex.NotSpecified?Number.MAX_VALUE:r,i-r})},a.prototype.getCurrentDialog=function(t){return e.Common.DialogManager.getCurrentDialog(t)},a.prototype.handleShortcutKey=function(t){var e=this.getShortcutElements(TDB.ShortcutIdentifier.createShortcutIdentifierFromEvent(t));return e.length>0?this.executeShortcutElements(e,t):TDB.EventPropagation.Bubble},a.prototype.handleNavigationKey=function(t){return t.keyCode===KeyCodeType.F6Key&&t.ctrlKey&&!t.altKey?(this.onNavigateList(TDB.OffsetOrigin.Current,t.shiftKey?-1:1,0),TDB.EventPropagation.PreventDefault):TDB.EventPropagation.Bubble},a.prototype.keyDown=function(t){var e=r.prototype.keyDown.call(this,t);return e!==TDB.EventPropagation.Bubble?e:t.keyCode!==KeyCodeType.F1Key||!t.altKey||t.ctrlKey||t.shiftKey?TDB.EventPropagation.Bubble:(this.changeShowShortcutHelpState(),TDB.EventPropagation.Bypass)},a.prototype.pickActiveChild=function(t,e,n){r.prototype.pickActiveChild.call(this,t,e,n),this.notifyRegionChange(t,n)},a.prototype.notifyRegionChange=function(e,o){var i=window.StoryPageSettings;if(i&&StoryViewMode&&i.Mode===StoryViewMode.Embedded&&t.Common.UrlHelper.getInstance().supportsNotifications(document.referrer)&&window.parent!==window){var r=this.getActiveChildIndex();r===e.length-1&&o<0?this.postMessageToParent(n.focusNotificationEventName.FocusExitedStartRegion):0===r&&o>0&&this.postMessageToParent(n.focusNotificationEventName.FocusExitedEndRegion)}},a.prototype.postMessageToParent=function(t){window.parent.postMessage(t,"*")},a.prototype.setFocusFromNotification=function(t){t.data===n.focusNotificationEventName.SetFocus?window.focus():t.data===n.focusNotificationEventName.SetFocusStartRegion?this.updateActiveChild(TDB.OffsetOrigin.Begin,0):t.data===n.focusNotificationEventName.SetFocusEndRegion&&this.updateActiveChild(TDB.OffsetOrigin.End,0)},a.prototype.changeShowShortcutHelpState=function(){var e=this,n=this.controlElementHelpState.getValue(),i=o.None;switch(n){case o.None:t.Common.Environment.getInstance().areInternalFeaturesEnabled()&&(i=o.Shortcut);break;default:i=o.None}TDB.applyUpdate(function(){e.controlElementHelpState.setValue(i)})},a.prototype.disableAnimation=function(){var t=this;TDB.applyUpdate(function(){t.animationDisabled.setValue(!0)})},a}(TDB.ControlSet);n.PageRootVEBase=r}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=function(){function e(e){if(this.args=e,e.points){if(e.points.length<2)throw t.RethrowLogger.createError("Slidebar needs at least two points");if(e.points.some(function(t){return void 0==t.value}))throw t.RethrowLogger.createError("All supplied point values must be valid");if(e.continuousMode)throw t.RethrowLogger.createError("Slider is continous but has points provided")}if(!e.position)throw t.RethrowLogger.createError("Invalid slidebar position watchable supplied");this._isDragging=TDB.watchableTag(596476871,this,!1),this._isVisible=TDB.watchableTag(596476872,this,!0);var n=e.continuousMode?1:this.getSnapPointFromOutputValue(e.position.getValue());this._positionRatio=TDB.watchableTag(596476873,this,n)}return e.prototype.setVisibility=function(t){this._isVisible.setValue(t)},e.prototype.isVisible=function(t){return this._isVisible.getWatchedValue(t)},e.prototype.isDragging=function(t){return this._isDragging.getWatchedValue(t)},e.prototype.setDragging=function(t){this._isDragging.setValue(t)},e.prototype.setInternalSlidebarRatio=function(t){this._positionRatio.setValue(t)},e.prototype.getSlidebarRatio=function(t){return this._isDragging.getWatchedValue(t)||this.args&&this.args.continuousMode?this._positionRatio.getWatchedValue(t):this.getExternalSlidebarRatio(t)},e.prototype.getExternalSlidebarRatio=function(t){var e=this.args.position.getWatchedValue(t);return this.getRatioFromOutputValue(e)},e.prototype.getSnapPointIndexFromRatio=function(t){return Math.round(Math.max(0,Math.min(1,t))*(this.args.points.length-1))},e.prototype.getRatioFromSnapPoint=function(t){return t/(this.args.points.length-1)},e.prototype.getOutputValueFromSnapPoint=function(t){return this.args.points[t].value},e.prototype.getSnapPointFromOutputValue=function(t){var e=ArrayExtensions.indexOfFirst(this.args.points,function(e){return e.value===t});return e>=0?e:0},e.prototype.setSliderToNearestSnapPoint=function(t){var e=this.getSnapPointIndexFromRatio(t),n=this.getRatioFromSnapPoint(e);return this.setInternalSlidebarRatio(n),e},e.prototype.setSnapPoint=function(t){var e=this;if(0<=t&&this.args.points&&t<this.args.points.length){var n=this.getRatioFromSnapPoint(t);return TDB.applyUpdate(function(){return e.setInternalSlidebarRatio(n)}),!0}return!1},e.prototype.slideAttrBaseArgs=function(t){var e={};if(e[Aria.Attributes.Role]=Aria.Roles.Slider,!this.args)return e;if(this.args&&this.args.continuousMode){var n=this._positionRatio.getWatchedValue(t);e[Aria.Attributes.Valuemin]="0",e[Aria.Attributes.Valuemax]="100",e[Aria.Attributes.Valuenow]=Math.round(100*n).toString(),e[Aria.Attributes.Valuetext]=Math.round(100*n).toString()+"%"}else{var o=this.args.position.getWatchedValue(t),i=this.args.points[this.getSnapPointFromOutputValue(o)];e[Aria.Attributes.Valuemin]=this.args.points[0].value.toString(),e[Aria.Attributes.Valuemax]=this.args.points[this.args.points.length-1].value.toString(),e[Aria.Attributes.Valuenow]=i.value.toString(),e[Aria.Attributes.Valuetext]=i.text}return e},e.prototype.getRatioFromOutputValue=function(t){var e=this.getSnapPointFromOutputValue(t);return this.getRatioFromSnapPoint(e)},e}();e.SlidebarViewModel=n}(e.ViewModel||(e.ViewModel={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=t.View.ViewElements,o=function(e){function o(n,i){var r=e.call(this,n,{domFocusable:i.domFocusable,enabled:i.enabled})||this;return r.args=i,r.lineTopOffset=0,r.defaultSlidebarWrapperClass="SlidebarWrapper",r.titleId="Slidebar"+ ++o.nextId,r._viewModel=new t.View.ViewModel.SlidebarViewModel({position:i.position,points:i.points,continuousMode:i.continuousMode}),r}return __extends(o,e),o.prototype.slideDraggableInitArgs=function(){var t=this;return{containment:"parent",cursor:"pointer",helper:function(){return $(this)},revert:null,start:function(e,n,o){t.setFocus()},stop:function(e,n,o){TDB.applyUpdate(function(){t._viewModel.setDragging(!1),t.setSlider(t.getDraggablePositionRatio(n))}),t.setFocus()},drag:function(e,n,o){TDB.applyUpdate(function(){t._viewModel.setDragging(!0),t._viewModel.setInternalSlidebarRatio(t.getDraggablePositionRatio(n))})}}},o.prototype.getDraggablePositionRatio=function(t){if(this.args&&this.args.vertical)return this.getPositionRatio(t.position.top);var e=this.shouldReverseControls()?this.slideLimiterPositionBinding.getPosition().width-t.position.left-this.getHandleWidth():t.position.left;return this.getPositionRatio(e)},o.prototype.getHandleWidth=function(){return this.args&&this.args.handleWidth?this.args.handleWidth:o._HANDLE_WIDTH},o.prototype.slideDraggableOptionsArgs=function(t){return{disabled:!this.isEnabled(t)}},o.prototype.slideTouchToMouseArgs=function(t){return{enabled:!0}},o.prototype.slideStyleArgs=function(t){var e=this._viewModel.getSlidebarRatio(t),n=this.args&&this.args.vertical;n&&(e=1-e);var o="calc((100% - "+this.getHandleWidth()+"px) * "+e.toFixed(3)+")";return n?{top:o}:this.shouldReverseControls()?{right:o,left:"auto"}:{left:o,right:"auto"}},o.prototype.slidebarWrapperCssArgs=function(t){var e={},n=this.isEnabled(t);return this.args.cssOverride&&(e[this.args.cssOverride]=n),this.args.disabledCssOverride&&(e[this.args.disabledCssOverride]=!n),this.args.cssOverride||this.args.disabledCssOverride||(e[this.defaultSlidebarWrapperClass]=!0),e},o.prototype.slidebarWrapperEventsInitArgs=function(){return{click:this.slidebarClicked}},o.prototype.slidebarClicked=function(t){var e=this;if(!this.isEnabled())return!1;var n,o=this.slideLimiterPositionBinding.getPosition();return n=this.args&&this.args.vertical?t.pageY-o.top-this.lineTopOffset:this.shouldReverseControls()?o.right-t.pageX:t.pageX-o.left,n-=this.getHandleWidth()/2,TDB.applyUpdate(function(){return e.setSlider(e.getPositionRatio(Math.max(0,n)))}),this.setFocus(),!1},o.prototype.slidebarPointsArgs=function(){if(this.args&&this.args.continuousMode)return[];var t=ArrayExtensions.count(this.args.points,function(t){return!t.hidden});t<1&&(t=1);var e=(100/t).toFixed(1)+"%";return this.args.points.map(function(t){return new TDB.ChildArgs(n.SpanMessageVE,{messageCss:"SlidebarPoint",message:t.text||"",width:t.hidden?"0":e})})},o.prototype.slideTicksArgs=function(){if(!this.showTicksArgs())return[];for(var t=[],e=this.args.points.length,o=0;o<e;o++)t.push(new TDB.ChildArgs(n.DivVE,{className:"SlidebarTick"}));return t},o.prototype.showTicksArgs=function(){return this.args&&this.args.showTicks},o.prototype.ifSlidebarWrapperArgs=function(t){return this._viewModel.isVisible(t)},o.prototype.show=function(){var t=this;TDB.applyUpdate(function(){return t._viewModel.setVisibility(!0)},TDB.Justification.InitialConversion)},o.prototype.hide=function(){var t=this;TDB.applyUpdate(function(){return t._viewModel.setVisibility(!1)},TDB.Justification.InitialConversion)},o.prototype.slidebarFullLineStyleArgs=function(t){var e=100*this._viewModel.getSlidebarRatio(t);return this.args&&this.args.vertical?{height:e+"%"}:this.args&&this.args.reverse?{width:e+"%",left:"auto",right:"0px"}:{width:e+"%",left:"0px",right:"auto"}},o.prototype.keyDown=function(t){var e=this,n=0;switch(t.keyCode){case KeyCodeType.LeftArrowKey:n=-1;break;case KeyCodeType.RightArrowKey:n=1}if(this.args.vertical)switch(t.keyCode){case KeyCodeType.DownArrowKey:n=-1;break;case KeyCodeType.UpArrowKey:n=1}else this.shouldReverseControls()&&(n=-n);var o=!(t.shiftKey||t.altKey||t.ctrlKey||t.metaKey);if(!this._viewModel.isDragging()&&o&&n){var i=this._viewModel.getSlidebarRatio();if(this.args&&this.args.continuousMode){var r=this.calculateNewRatio(i,n);r!=i&&TDB.applyUpdate(function(){return e.setSlider(r)})}else{var a=this._viewModel.getSnapPointIndexFromRatio(i)+n;this._viewModel.setSnapPoint(a)&&this.triggerSliderChangeCallback(a)}return TDB.EventPropagation.PreventDefault}return TDB.EventPropagation.Bubble},o.prototype.shouldReverseControls=function(){return CommonSettings.SiteUiRtl||this.args.reverse},o.prototype.slidebarTitleTextArgs=function(){return this.args&&this.args.titleText||void 0},o.prototype.slidebarTitleAttrArgs=function(){var t={};return this.titleId&&(t.id=this.titleId),t},o.prototype.slidebarWrapperAttrArgs=function(t){var e=this._viewModel.slideAttrBaseArgs(t);if(this.args){e[Aria.Attributes.Label]=this.args.description,e[Aria.Attributes.Labelledby]=this.slidebarTitleTextArgs()?this.titleId:void 0,e[Aria.Attributes.Describedby]=this.args.describedById;var n=this.isEnabled(t);e[ControlAttributes.Attributes.Disabled]=n?ControlAttributes.DisabledState.Enabled:ControlAttributes.DisabledState.Disabled,e[Aria.Attributes.Disabled]=n?void 0:Aria.BooleanState.True}return e},o.prototype.slideAttrArgs=function(t){var e={};return e[Aria.Attributes.Grabbed]=this._viewModel.isDragging(t)?Aria.BooleanState.True:Aria.BooleanState.False,e[Aria.Attributes.Role]=Aria.Roles.Presentation,e},o.prototype.showTooltipArgs=function(){return this.args.showTooltip},o.prototype.slideTooltipTextArgs=function(t){var e=this._viewModel.getSnapPointIndexFromRatio(this._viewModel.getSlidebarRatio(t));return this.args.points[e].value.toString()},o.prototype.slideTooltipStyleArgs=function(t){return{visibility:this._viewModel.isDragging(t)?"visible":void 0}},o.prototype.setSlider=function(t){this.args&&this.args.continuousMode?(t=Math.max(Math.min(t,1),0),this._viewModel.setInternalSlidebarRatio(t),this.triggerSliderChangeCallback(t)):this.setSliderToNearestSnapPoint(t)},o.prototype.setSliderToNearestSnapPoint=function(t){var e=this._viewModel.setSliderToNearestSnapPoint(t);this.triggerSliderChangeCallback(e)},o.prototype.triggerSliderChangeCallback=function(t){if(this.args.onSliderChange){var e=this.args&&this.args.continuousMode?t:this._viewModel.getOutputValueFromSnapPoint(t);this.args.onSliderChange.call(this.parent,e)}},o.prototype.getPositionRatio=function(t){var e;return this.args&&this.args.vertical?(e=this.slideLimiterPositionBinding.getPosition().height-2*this.lineTopOffset-this.getHandleWidth(),1-t/e):(e=this.slideLimiterPositionBinding.getPosition().width-this.getHandleWidth(),t/e)},o.prototype.calculateNewRatio=function(t,e){return Math.min(Math.max(0,t+.05*e),1)},o._HANDLE_WIDTH=30,o.nextId=0,o}(TDB.Control);e.SlidebarVEBase=o}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(e,n){var o=t.call(this,e)||this;return o.model=n,o}return __extends(e,t),e.prototype.spanMessageTextArgs=function(t){return this.model.message},e.prototype.spanMessageClassNameArgs=function(t){return this.model.messageCss||""},e.prototype.spanMessageStyleArgs=function(t){var e="0"===this.model.width;return{fontSize:e?"0":"",visibility:e?"hidden":"",width:this.model.width||""}},e}(TDB.FocusableViewElement);t.SpanMessageVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(e,n){var o=t.call(this,e,{tabIndex:n.tabIndex})||this;return o._args=n,o}return __extends(e,t),e.prototype.clickableLinkTextArgs=function(t){return this._args.message},e.prototype.clickableLinkAttrArgs=function(t){return{href:this._args.url,title:this._args.title||this._args.message,class:this._args.class,"aria-label":this._args.message,target:this._args.target||"_blank"}},e.prototype.mouseClicked=function(t){return this._args.onClickHandler&&this._args.context&&this._args.onClickHandler.call(this._args.context,t),TDB.EventPropagation.Bypass},e.prototype.keyPress=function(t){if(t.keyCode===KeyCodeType.EnterKey){if(this._args.onClickHandler&&this._args.context)return this._args.onClickHandler.call(this._args.context,t)}else if(t.keyCode===KeyCodeType.SpaceKey)return TDB.EventPropagation.PreventDefault;return TDB.EventPropagation.Bubble},e}(TDB.Control);t.ClickableLinkVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(e,n){var o=t.call(this,e)||this;return o.linkMessages=n,o}return __extends(e,t),e.prototype.messageContentArgs=function(){return ResourceManager.convertToChildArgs(this.linkMessages)},e}(TDB.FocusableViewElement);t.DynamicMessageVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=function(e){function n(t,n){var o=e.call(this,t,{features:TDB.ControlSetFeatures.Isolated|TDB.ControlSetFeatures.ExitOnEscape|n.features})||this;return o.visible=n.visible?n.visible:TDB.watchableTag(596476878,o,!1),o.role=n.role?n.role:Aria.Roles.Group,o.description=n.description,o.shouldExternalEventBeHandled=!0,o.getControllingElementInternal=n.getControllingElement,o}return __extends(n,e),n.prototype.getControllingElement=function(){var t=this.getControllingElementInternal;return t?t():void 0},n.prototype.isVisible=function(t){return this.visible.getWatchedValue(t)},n.prototype.setVisible=function(t){var e=this;TDB.applyUpdate(function(){return e.visible.setValue(t)},TDB.Justification.FocusManagement)},n.prototype.suspend=function(){this.setVisible(!1)},n.prototype.resume=function(){this.setVisible(!0),this.activeChild&&this.onActivateChild(this.activeChild)},n.prototype.toggle=function(){var t=this.isVisible(),e=this.isEntered();t&&e?this.hide():this.show()},n.prototype.hideIfNotHidden=function(){var t=this.isVisible(),e=this.isEntered();t&&e&&this.hide()},n.prototype.show=function(){this.enter()},n.prototype.hide=function(){this.exit()},n.prototype.hideWithoutRestoringFocus=function(){this.originallyFocusedSet=void 0,this.exit()},n.prototype.onEntering=function(){this.saveFocus(),this.setVisible(!0)},n.prototype.onExiting=function(){this.setVisible(!1),this.restoreFocus()},n.prototype.firstChanceMouseEvent=function(t,n,o){for(;o&&o!==this&&o!==this.getControllingElement();)o=o.parent;return!o&&this.isEntered()?(n===(this.shouldExternalEventBeHandled?TDB.ViewElementMouseEventType.MouseDownEvent:TDB.ViewElementMouseEventType.MouseClickEvent)&&this.shouldExit(TDB.ExitReason.ClickOutside)&&this.escape(),this.shouldExternalEventBeHandled?TDB.EventPropagation.Bubble:TDB.EventPropagation.PreventDefault):e.prototype.firstChanceMouseEvent.call(this,t,n,o)},n.prototype.onRestoreFocus=function(t){return!0},n.prototype.saveFocus=function(){this.originallyFocusedSet=TDB.ControlSet.getFocusedControlSet()},n.prototype.restoreFocus=function(){if(this.originallyFocusedSet&&this.onRestoreFocus(this.originallyFocusedSet)&&this.originallyFocusedSet.canEnter())this.originallyFocusedSet.enter();else{var e=t.Utilities.getDocumentActiveElement();e&&this.isFocusUnder()&&e.blur()}},n.prototype.getAriaAttributes=function(t){var e={},n=this.isEntered(t);return e[Aria.Attributes.Role]=this.role,e[Aria.Attributes.Expanded]=n?Aria.BooleanState.True:Aria.BooleanState.False,e[Aria.Attributes.Hidden]=this.isVisible(t)?Aria.BooleanState.False:Aria.BooleanState.True,e[Aria.Attributes.Label]=this.description,e},n.prototype.onPopupVisible=function(){this.isVisible()&&this.enter()},n.prototype.keyDown=function(t){return t.keyCode===KeyCodeType.F6Key&&t.ctrlKey&&!t.altKey?(this.hideWithoutRestoringFocus(),TDB.EventPropagation.Bubble):e.prototype.keyDown.call(this,t)},n}(TDB.ControlSet);e.PopupBaseVE=n}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(e,n){var o=t.call(this,e,{tabIndex:n.tabIndex,enabled:n.enabled})||this;return o.args=n,o.telemetryId=n.telemetryId,o.style=TDB.watchableTag(596476864,o,n.style?n.style:void 0),o.text=TDB.watchableTag(596476865,o,n.text?n.text:""),o}return __extends(e,t),e.prototype.textAreaAttrArgs=function(t){var e={class:this.args.cssClass||""};return e[ControlAttributes.Attributes.Disabled]=this.isEnabled(t)?ControlAttributes.DisabledState.Enabled:ControlAttributes.DisabledState.Disabled,this.args.placeholder&&(e.placeholder=this.args.placeholder),this.args.rows&&(e.rows=this.args.rows),this.args.maxLength&&(e.maxlength=this.args.maxLength.toString()),e["aria-label"]=this.args.description,e[Aria.Attributes.Role]=this.args.role,e.id=this.args.domId,e},e.prototype.mouseClicked=function(t){return ActionLogger.RecordClientAction(new ClientAction.ButtonClickAction(this.telemetryId,Diag.ULSCat.msoulscat_Story_Storyline)),TDB.EventPropagation.Bypass},e.prototype.contextMenu=function(t){return ActionLogger.RecordClientAction(new ClientAction.ButtonRightClickAction(this.telemetryId,Diag.ULSCat.msoulscat_Story_Storyline)),!1},e.prototype.textAreaStyleArgs=function(t){return this.style.getWatchedValue(t)},e.prototype.setStyle=function(t){this.style.setValue(t)},e.prototype.setValue=function(t){var e=this;this.args.context&&this.args.setValue?this.args.setValue.call(this.args.context,t):TDB.applyUpdate(function(){e.text.setValue(t)}),this.args.onValueUpdated&&this.args.updateContext&&this.args.onValueUpdated.call(this.args.updateContext)},e.prototype.getValue=function(t){return this.args.context&&this.args.getValue?this.args.getValue.call(this.args.context,t):this.text.getWatchedValue(t)},e.prototype.textAreaValueInitArgs=function(){return{context:this,setValue:this.setValue,getValue:this.getValue}},e.prototype.keyDown=function(t){var e=TDB.EventPropagation.Bubble;switch(t.keyCode){case KeyCodeType.UpArrowKey:case KeyCodeType.DownArrowKey:case KeyCodeType.LeftArrowKey:case KeyCodeType.RightArrowKey:case KeyCodeType.SpaceKey:case KeyCodeType.EnterKey:case KeyCodeType.DeleteKey:case KeyCodeType.BackspaceKey:case KeyCodeType.HomeKey:case KeyCodeType.EndKey:e=TDB.EventPropagation.Bypass}return e},e.prototype.firstChanceMouseEvent=function(e,n,o){return this.textAreaValueBinding&&this.textAreaValueBinding.getValue(),t.prototype.firstChanceMouseEvent.call(this,e,n,o)},e.prototype.getText=function(){return this.textAreaValueBinding?this.textAreaValueBinding.getValue():this.text.getWatchedValue()},e.prototype.setText=function(t){this.setValue(t)},e.prototype.getWatchedTextValue=function(t){return this.text.getWatchedValue(t)},e}(TDB.Control);t.TextAreaVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(e,n){var o=t.call(this,e)||this;return o._args=n,o}return __extends(e,t),e.prototype.textBlockClassNameArgs=function(t){return this._args.cssClass},e.prototype.textBlockTextArgs=function(t){return this._args.text},e.prototype.textBlockAttrArgs=function(t){var e={};return e[Aria.Attributes.Role]=this._args.role,this._args.level&&(e[Aria.Attributes.Level]=this._args.level.toString()),e},e}(TDB.ViewElement);t.TextBlockVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(e,n){var o=t.call(this,e,{enabled:n.enabled,tabIndex:n.tabIndex})||this;return o.args=n,n.labelledBy||n.description||n.domId||TDB.raiseRecoverableError("We should provide an attribute which can be used for the label of the element."),(n.getValue||n.setValue)&&n.textWatchable&&TDB.raiseRecoverableError("Either textWatchable or getValue/setValue callbacks can be used."),o.selectText=TDB.watcherTag(596476831,o,o,o.calculateSelectText),o.text=n.textWatchable||TDB.watchableTag(596476832,o,n.text||""),o.selectionStart=TDB.watchableTag(596476833,o,0),o.selectionEnd=TDB.watchableTag(596476834,o,0),o.placeholder=n.placeholder?TDB.watchableOption(o,n.placeholder):void 0,o.context=n.context?n.context:o,o.args.domFocus||(o.args.domFocus=TDB.watchableTag(596476835,o,!1)),o}return __extends(e,t),e.prototype.getText=function(t){var e=this.textValueBinding;return e?e.getValue(t):this.text.getWatchedValue(t)},e.prototype.getSelectionPositionStart=function(){var t=this.textInputSelectionBinding;return t?t.getSelectionStart():this.selectionStart.getValue()},e.prototype.getSelectionPositionEnd=function(){var t=this.textInputSelectionBinding;return t?t.getSelectionEnd():this.selectionEnd.getValue()},e.prototype.getWatchedText=function(t){return this.text.getWatchedValue(t)},e.prototype.getDescription=function(){return this.args.description},e.prototype.calculateSelectText=function(t){return this.args.selectTextOnFocus&&this.args.domFocus.getWatchedValue(t)},e.prototype.textAttrArgs=function(t){var e={class:this.args.cssClass||"",type:this.args.inputType||"text",autocomplete:this.args.autocomplete?"on":"off"};return this.args.readOnly&&(e.readonly="readonly"),e.placeholder=this.args.placeholder?this.placeholder.getWatchedValue(t):void 0,this.args.maxLength&&(e.maxlength=""+this.args.maxLength),e[Aria.Attributes.Label]=this.args.description,e[Aria.Attributes.Role]=this.args.role,e.name=this.args.name,e[Aria.Attributes.Title]=this.args.tooltip,e[ControlAttributes.Attributes.Disabled]=this.isEnabled(t)?ControlAttributes.DisabledState.Enabled:ControlAttributes.DisabledState.Disabled,e[Aria.Attributes.Id]=this.args.domId,e[Aria.Attributes.Labelledby]=this.args.labelledBy,this.args.context&&this.args.ariaInvalidState&&(e[Aria.Attributes.Invalid]=this.args.ariaInvalidState.call(this.args.context,this.text.getWatchedValue(t))?Aria.BooleanState.True:Aria.BooleanState.False),e},e.prototype.textClassNameArgs=function(t){return this.args.textColorState?this.args.textColorState.call(this.args.context,this.text.getWatchedValue(t)):this.args.cssClass},e.prototype.textSelectTextArgs=function(t){return this.selectText},e.prototype.textEventsInitArgs=function(){return this.args.onInput?{input:this.args.onInput}:{}},e.prototype.setText=function(t){var e=this;this.args.context&&this.args.setValue?this.args.setValue.call(this.args.context,t):TDB.applyUpdate(function(){return e.text.setValue(t)})},e.prototype.getValue=function(t){return this.args.context&&this.args.getValue?this.args.getValue.call(this.args.context,t):this.text.getWatchedValue(t)},e.prototype.textValueInitArgs=function(){return{context:this,setValue:this.setText,getValue:this.getValue}},e.prototype.textInputSelectionInitArgs=function(){return{context:this,getSelectionEnd:this.getSelectionEnd,getSelectionStart:this.getSelectionStart,setSelectionEnd:this.setSelectionEnd,setSelectionStart:this.setSelectionStart}},e.prototype.setSelectionEnd=function(t){var e=this;this.args.context&&this.args.getSelectionEnd?this.args.getSelectionEnd.call(this.args.context,t):TDB.applyUpdate(function(){e.selectionEnd.setValue(t)})},e.prototype.getSelectionEnd=function(t){return this.args.context&&this.args.getSelectionEnd?this.args.getSelectionEnd.call(this.args.context,t):this.selectionEnd.getWatchedValue(t)},e.prototype.getSelectionStart=function(t){return this.args.context&&this.args.getSelectionStart?this.args.getSelectionStart.call(this.args.context,t):this.selectionStart.getWatchedValue(t)},e.prototype.setSelectionStart=function(t){var e=this;this.args.context&&this.args.setSelectionStart?this.args.setSelectionStart.call(this.args.context,t):TDB.applyUpdate(function(){e.selectionStart.setValue(t)})},e.prototype.onGainingFocus=function(){var e=this;TDB.applyUpdate(function(){return e.args.domFocus.setValue(!0)}),this.args.context&&this.args.focusChanged&&this.args.focusChanged.call(this.args.context,!0),t.prototype.onGainingFocus.call(this)},e.prototype.onLosingFocus=function(){var e=this;TDB.applyUpdate(function(){return e.args.domFocus.setValue(!1)}),this.args.context&&this.args.focusChanged&&this.args.focusChanged.call(this.args.context,!1),t.prototype.onLosingFocus.call(this)},e.prototype.keyDown=function(e){return this.args.handleKeyDown?this.args.handleKeyDown.call(this.context,e):t.prototype.keyDown.call(this,e)},e.prototype.keyPress=function(e){return this.args.handleKeyPress?this.args.handleKeyPress.call(this.context,e):t.prototype.keyPress.call(this,e)},e}(TDB.Control);t.TextBoxVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=function(e){function n(n,o){var i=e.call(this,n,o)||this;if(i.args=o,i.text=TDB.watchableOption(i,o.text,""),i.elementId=o.telemetryId||o.id,o.role)throw t.RethrowLogger.createError("Only the tab role can be used with TabButtonVE. Do not pass in role attribute");return i}return __extends(n,e),n.prototype.textClassNameArgs=function(t){return this.args.textClass},n.prototype.wrapperClassNameArgs=function(t){return this.getButtonClass(t)},n.prototype.wrapperAttrArgs=function(t){var e={};return e[Aria.Attributes.Title]=this.tooltip.getWatchedValue(t),e[Aria.Attributes.Id]=this.elementId,e[ControlAttributes.Attributes.Disabled]=this.isEnabled(t)?ControlAttributes.DisabledState.Enabled:ControlAttributes.DisabledState.Disabled,e[Aria.Attributes.Controls]=this.args.controls,e[Aria.Attributes.Selected]=Aria.BooleanState.fromBoolean(this.isChecked.getWatchedValue(t)),e[Aria.Attributes.Role]=Aria.Roles.Tab,this.getButtonAttributes(t,e)},n.prototype.textTextArgs=function(t){return this.text.getWatchedValue(t)},n}(e.ToggleButtonVEBase);e.TabButtonVEBase=n}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e}(t.ToggleButtonVEBase);t.ToggleSwitchVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(e){function n(t,n){var o=e.call(this,t,n)||this;return o._args=n,o}return __extends(n,e),n.prototype.wrapperClassNameArgs=function(t){var e="userInfoWrapper",n=this.getButtonClass(t);return n&&(e+=" "+n),e},n.prototype.wrapperAttrArgs=function(t){var e=this.getButtonAttributes(t);return e[Aria.Attributes.Role]=this._args.role||Aria.Roles.Link,e[ControlAttributes.Attributes.Disabled]=this.isEnabled(t)?ControlAttributes.DisabledState.Enabled:ControlAttributes.DisabledState.Disabled,e},n.prototype.ifHasAccountPictureArgs=function(t){return 0!=this._args.userState.getUserPicture(t).length},n.prototype.doughboyPictureArgs=function(){return new TDB.ChildArgs(t.FontIconVE,{fontIconName:{value:FontIcons.DoughboyIcon},fontIconSizeClass:FontIcons.DoughboyIconSmallSize,fontIconWrapperClass:{value:"userInfoPicture"}})},n.prototype.userPictureAttrArgs=function(t){return{src:this._args.userState.getUserPicture(t),role:Aria.Roles.Presentation,alt:ResourceManager.ResolveString(Resources.ProfilePictureAltText,[this._args.userState.getUserName(t)])}},n.prototype.userNameTextArgs=function(t){return this._args.userState.getUserName(t)},n.prototype.userEmailTextArgs=function(t){return this._args.userState.getUserEmail(t)},n}(t.ButtonVE);t.UserInfoVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){var n=function(){function n(){}return n.getInstance=function(){return n.instance||(n.instance=new n),n.instance},n.setInstance=function(t){n.instance=t},n.clearInstance=function(){n.instance=void 0},n.prototype.GoToMyStories=function(){CommonMain.goToMyStoriesOrSignIn("AppBarAction : GoToMyStories")},n.prototype.GoToOfficeComMyStories=function(){StoryLog.TraceTag(595956494,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"User is being redirected to My Sways page on Office.com");var e=t.Common.UrlHelper.getInstance();t.Utilities.assignWindowLocation(e.getSwayUrlOnOfficeCom())},n.prototype.CreateNewStory=function(){e.UserStories.getInstance().createStoryOrSignIn("AppBarAction : CreateNewStory",null)},n.prototype.ShowFeedback=function(t){return t.loadResource(15).then(function(t){if(1!==t.state){var e={};CommonSettings.UserTenantId&&(e={telemetryGroup:{tenantId:CommonSettings.UserTenantId}}),OfficeBrowserFeedback.multiFeedback(e).catch(function(t){StoryLog.StructuredTraceTag(596477061,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"Ofeedback dialog failed",{error:t})})}else StoryLog.StructuredTraceTag(596477060,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.error,"Could not load feedback dialog",{error:t.error})})},n.prototype.ShowHelp=function(e,n){t.View.ViewElements.HelpDialog.createAndShow(e,n)},n.prototype.OpenUserProfile=function(){ActionLogger.RecordClientAction(new ClientAction.ButtonClickAction(ClientAction.ButtonId.AppBar_Profile,Diag.ULSCat.msoulscat_Story_Site)),t.Utilities.assignWindowLocation(CommonSettings.AccountSettingsUrl)},n.prototype.SignIn=function(){t.Identity.getActions().signIn()},n.prototype.SignOut=function(){t.Identity.getActions().signOut()},n.prototype.GoToPlay=function(n,o){CommonSettings.AuthoringFromLandingPageContextEnabled&&!o?e.UserStories.getInstance().onLoadingStory(n,!1,!0,!1,!1,"?play"):t.Utilities.assignWindowLocation(t.Common.UrlHelper.getInstance().playUrl(n))},n.prototype.GoToEdit=function(n){CommonSettings.AuthoringFromLandingPageContextEnabled?e.UserStories.getInstance().onLoadingStory(n,!0):CommonSettings.IsPublish?t.Utilities.assignWindowLocation(t.Common.UrlHelper.getInstance().getPublishedStoryViewUrl(n)):t.Utilities.assignWindowLocation(t.Common.UrlHelper.getInstance().viewUrl(n))},n.prototype.OpenTutorialVideos=function(){ActionLogger.RecordClientAction(new ClientAction.ButtonClickAction(ClientAction.ButtonId.AppBar_TutorialVideos,Diag.ULSCat.msoulscat_Story_Site)),window.open(t.Common.UrlHelper.getInstance().tutorialVideosUrl())},n.prototype.ToggleInternalFlight=function(){t.Utilities.assignWindowLocation(t.Common.UrlHelper.getInstance().internalFlightUrl())},n.prototype.TogglePremiumFeatures=function(){t.Utilities.assignWindowLocation(t.Common.UrlHelper.getInstance().toggleMockedPremiumFeaturesUrl())},n.prototype.DisableDeveloperCdn=function(){Cookie.removeDeveloperCdnCookie(),location.reload()},n}();e.AppBarAction=n}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n,o=CommonBindings.View.Bindings.DynamicMenu,i=t.Common,r=t.Common.TelemetryConstants;!function(t){t[t.UnknownElement=0]="UnknownElement",t[t.GlyphButton=1]="GlyphButton",t[t.CalloutGlyphButton=2]="CalloutGlyphButton",t[t.BuiltIn=3]="BuiltIn"}(n=e.AppBarChildType||(e.AppBarChildType={}));var a;!function(t){t[t.MyStories=0]="MyStories",t[t.CreateNew=1]="CreateNew",t[t.Edit=2]="Edit",t[t.Style=3]="Style",t[t.Feedback=4]="Feedback",t[t.User=5]="User",t[t.SignIn=6]="SignIn",t[t.Preview=7]="Preview",t[t.Share=8]="Share",t[t.Overflow=9]="Overflow",t[t.Remix=10]="Remix",t[t.Redo=11]="Redo",t[t.Undo=12]="Undo",t[t.Panels=13]="Panels",t[t.ShareToDocsDotCom=14]="ShareToDocsDotCom",t[t.ShareToFacebook=15]="ShareToFacebook",t[t.ShareToTwitter=16]="ShareToTwitter",t[t.ShareToLinkedIn=17]="ShareToLinkedIn",t[t.ShareToLink=18]="ShareToLink",t[t.Fullscreen=19]="Fullscreen",t[t.Authors=20]="Authors",t[t.ShareThis=21]="ShareThis",t[t.InternalFeatures=22]="InternalFeatures",t[t.DeveloperCdn=23]="DeveloperCdn",t[t.RefreshStories=24]="RefreshStories",t[t.TutorialVideos=25]="TutorialVideos",t[t.Cast=26]="Cast",t[t.Home=27]="Home",t[t.Content=28]="Content",t[t.Cards=29]="Cards",t[t.Design=30]="Design",t[t.Navigation=31]="Navigation",t[t.Play=32]="Play",t[t.ConsumptionSettings=33]="ConsumptionSettings"}(a=e.AppBarButtonLabel||(e.AppBarButtonLabel={}));var s=function(s){function l(e,n){var o=s.call(this,e,TDB.ControlSetFeatures.Isolated|TDB.ControlSetFeatures.PreserveFocusContext)||this;o._defaultTopPosition=0,o._appbarWidth=TDB.watchableTag(596476995,o,0),o._model=n,o._menuItems={};for(var i=0,r=n.buttons;i<r.length;i++){var a=r[i];if(o._menuItems[a.label])throw t.RethrowLogger.createError("Adding multiple buttons under same label: "+a.label);var l=o.createMenuItem(a);l&&(o._menuItems[a.label]=l)}return o.overflowVisible=TDB.watchableTag(596476998,o,!1),o.notifyMenuRefresh=TDB.notifierTag(596476996,o),o}return __extends(l,s),l.prototype.createMenuItem=function(e){switch(e.type){case n.UnknownElement:return e;case n.GlyphButton:return this.createGlyphButton(e);case n.CalloutGlyphButton:return this.createCalloutGlyphButton(e);case n.BuiltIn:switch(e.label){case a.TutorialVideos:return this.createTutorialVideosButton(e.cssClass);case a.Home:return this.createHomeButton();case a.SignIn:return this.createSignInButton();case a.CreateNew:return this.createCreateNewButton();case a.User:return this.createUserButton();case a.MyStories:return this.createMyStoriesButton();case a.InternalFeatures:return this.createInternalFeaturesButton();case a.DeveloperCdn:return this.createDeveloperCdnButton();default:throw t.RethrowLogger.createError("unrecognized app bar child label")}default:throw t.RethrowLogger.createError("unrecognized app bar child type")}},l.updateButtonArgs=function(t,e,n){t.cssClass=TDB.extendOption(t.cssClass,function(t){return t=t||(e?void 0:"headerFarButton"),n&&(t=(t?t+" ":"")+n),t})},l.prototype.createTextButton=function(t){var n=t.args;l.updateButtonArgs(n,t.ignoreDefaultCssClass);var o,i=new e.HideableMenuItem({primaryType:e.TextButtonVE,primaryArgs:n,viewElementVisible:t.menuItemVisible?{compute:new TDB.ComputedOptionArgs(this,t.menuItemVisible)}:{value:!0},stateMap:t.stateMap});return null!=t.overflowLabel&&(o={type:e.OverflowMenuChildType.GlyphButton,label:t.overflowLabel,visible:i.getOverflowVisibility(),category:t.category,args:{context:n.context,click:n.click,text:n.text,buttonId:n.buttonId}}),{label:t.label,menuItem:i,overflowArgs:o,isFar:t.isFar}},l.prototype.createLinkButton=function(t){var n=t.args;l.updateButtonArgs(n,t.ignoreDefaultCssClass,"linkFarButtonWrapper");var o,i=new e.HideableMenuItem({primaryType:e.LinkButtonVE,primaryArgs:n,viewElementVisible:t.menuItemVisible?{compute:new TDB.ComputedOptionArgs(this,t.menuItemVisible)}:{value:!0},stateMap:t.stateMap});return null!=t.overflowLabel&&(o={type:e.OverflowMenuChildType.LinkButton,label:t.overflowLabel,visible:i.getOverflowVisibility(),category:t.category,args:{context:n.context,click:n.click,text:n.text,buttonId:n.buttonId,url:n.url,telemetryId:t.overflowTelemetryId}}),{label:t.label,menuItem:i,overflowArgs:o,isFar:t.isFar}},l.prototype.createGlyphButton=function(t,n){void 0===n&&(n=e.GlyphButtonVE);var o=t.args;l.updateButtonArgs(o,t.ignoreDefaultCssClass),o.textPlacementRight=!0,o.shortcutIdentifiers&&(o.shortcutProcessor=e.DomEventRegister.getInstance().getRootPanelElement());var i,r=new e.CollapsibleMenuItem({primaryType:n,primaryArgs:o,stateMap:t.stateMap,viewElementVisible:o.visible});return null!=t.overflowLabel&&(i={type:e.OverflowMenuChildType.GlyphButton,label:t.overflowLabel,visible:r.getOverflowVisibility(),category:t.category,args:{context:o.context,click:o.click,text:o.text,buttonId:o.buttonId}}),{label:t.label,menuItem:r,overflowArgs:i,isFar:t.isFar}},l.prototype.createCalloutGlyphButton=function(t){return this.createGlyphButton(t,e.CalloutGlyphButtonVE)},l.prototype.createHomeButton=function(){var t=this._model,n=new e.StaticMenuItem({primaryType:e.HomeButtonVE,primaryArgs:{isEditMode:t.isEditMode,resourceFactory:this._model.resourceFactory}});return{label:a.Home,menuItem:n,overflowArgs:void 0,isFar:!1}},l.prototype.getOverflowItem=function(t){var e=this._menuItems[t.label];return e&&e.overflowArgs},l.prototype.createSignInButton=function(){var t={context:this,click:this.signInClicked,text:{value:Resources.SignIn},buttonId:ClientAction.ButtonId.AppBar_SignIn,telemetryId:r.signInButtonId};return this.createTextButton({args:t,label:a.SignIn,overflowLabel:e.OverflowButtonLabel.SignIn,stateMap:e.MenuItem.createLowPriorityStateMap(),isFar:!0,category:e.OverflowMenuCategory.Global})},l.prototype.signInClicked=function(t){return i.AppBarAction.getInstance().SignIn(),TDB.EventPropagation.Bypass},l.prototype.createCreateNewButton=function(){if(CommonSettings.IsEnabled&&i.Environment.getInstance().shouldShowAuthoringEntrypoints()){var t={context:this,click:this.createNewClicked,text:{value:Resources.CreateNew},buttonId:ClientAction.ButtonId.AppBar_CreateNew,telemetryId:r.createNewButtonAppBarId,tooltip:{value:Resources.CreateNewTooltip}};return this.createTextButton({args:t,label:a.CreateNew,overflowLabel:void 0,isFar:!0,category:e.OverflowMenuCategory.File})}},l.prototype.createNewClicked=function(t){return i.AppBarAction.getInstance().CreateNewStory(),TDB.EventPropagation.Bypass},l.prototype.createUserButton=function(){var t={context:this,click:this.toggleOverflowMenu,text:{value:CommonSettings.DisplayName||CommonSettings.EmailAddress},buttonId:ClientAction.ButtonId.AppBar_Profile,telemetryId:r.userButtonID};return this.createTextButton({args:t,label:a.User,overflowLabel:void 0,isFar:!0,category:e.OverflowMenuCategory.Global})},l.prototype.createMyStoriesButton=function(){var t={context:this,click:this.myStoriesClicked,text:{value:Resources.MyRemixes},url:i.UrlHelper.getInstance().mySwaysUrl(),buttonId:ClientAction.ButtonId.AppBar_MyStories,telemetryId:r.mySwaysHeaderButtonId,cssClass:{value:"headerFarButton ButtonVE"}};return this.createLinkButton({args:t,label:a.MyStories,overflowLabel:void 0,isFar:!0,category:e.OverflowMenuCategory.Navigation})},l.prototype.myStoriesClicked=function(t){return t.preventDefault(),i.AppBarAction.getInstance().GoToMyStories(),TDB.EventPropagation.Bypass},l.prototype.createTutorialVideosButton=function(n){if(CommonSettings.SiteTutorialVideosEnabled&&t.Common.Branding.tutorialButtonVisible()){var o={context:this,click:this.tutorialVideosClicked,text:{value:Resources.Tutorials},url:i.UrlHelper.getInstance().tutorialVideosUrl(),buttonId:ClientAction.ButtonId.AppBar_TutorialVideos,telemetryId:r.tutorialVideosButtonId,cssClass:{value:void 0!==n?n:"headerFarButton ButtonVE"},tooltip:{value:Resources.AppBarTutorialsButtonDescription}};return this.createLinkButton({args:o,label:a.TutorialVideos,overflowLabel:e.OverflowButtonLabel.TutorialVideos,stateMap:e.MenuItem.createLowPriorityStateMap(),overflowTelemetryId:r.tutorialVideosOverflowButtonId,isFar:!0,category:e.OverflowMenuCategory.Overflow})}},l.prototype.tutorialVideosClicked=function(t){return i.AppBarAction.getInstance().OpenTutorialVideos(),TDB.EventPropagation.PreventDefault},l.prototype.createInternalFeaturesButton=function(){if(i.Environment.getInstance().shouldDisplayInternalFeaturesButton()){var t={context:this,click:this.toggleInternalFlightClicked,text:{value:Resources.InternalFeatures},buttonId:ClientAction.ButtonId.AppBar_InternalFeatures,telemetryId:r.internalFeaturesEnabledAppBarButtonId,cssClass:{value:"headerFarButtonDynamic internalHeaderButtonDynamic"}};return this.createTextButton({args:t,label:a.InternalFeatures,overflowLabel:void 0,stateMap:e.MenuItem.createLowPriorityStateMap(),isFar:!0,category:e.OverflowMenuCategory.Settings})}},l.prototype.createDeveloperCdnButton=function(){if(i.Environment.getInstance().shouldDisplayDeveloperCdnButton()){var t={context:this,click:this.developerCdnClicked,text:{value:"DevCDN "+Cookie.getDeveloperCdnCookie()},buttonId:ClientAction.ButtonId.AppBar_DeveloperCdn,cssClass:{value:"headerFarButtonDynamic developerCdnButtonDynamic"}};return this.createTextButton({args:t,label:a.DeveloperCdn,overflowLabel:void 0,stateMap:e.MenuItem.createLowPriorityStateMap(),isFar:!0,category:e.OverflowMenuCategory.Settings})}},l.prototype.toggleInternalFlightClicked=function(t){return i.AppBarAction.getInstance().ToggleInternalFlight(),TDB.EventPropagation.Bypass},l.prototype.developerCdnClicked=function(t){return i.AppBarAction.getInstance().DisableDeveloperCdn(),TDB.EventPropagation.Bypass},l.prototype.overflowButtonArgs=function(){var t="headerFarButtonDynamic";i.Environment.getInstance().shouldDisplayInternalFeaturesButton()&&(t="headerFarButtonDynamic overflowInternalEnabledDynamic");var n=this._model.alwaysShowOverflowButton,o={context:this,click:this.toggleOverflowMenu,fontIconName:{value:FontIcons.AppBarOverflowButtonIcon},fontIconSizeClass:FontIcons.AppBarOverflowButtonIconSize,buttonId:ClientAction.ButtonId.AppBar_Overflow,description:{value:Resources.OverflowButtonShortDescription},tooltip:{value:Resources.OverflowButtonTooltip},telemetryId:r.overflowButtonId,cssClass:{value:t},hasPopup:!0,visible:n?{value:n}:{compute:new TDB.ComputedOptionArgs(this,this.calcOverflowButtonVisible)}};return new TDB.ChildArgs(e.GlyphButtonVE,o)},l.prototype.toggleOverflowMenu=function(t){return this.overflowMenu.toggle(),TDB.EventPropagation.Bypass},l.prototype.getButtonChildren=function(t){var e=this;return this._model.buttons.map(function(t){return e._menuItems[t.label]}).filter(function(e){return e&&e.isFar===t}).map(function(t){return t.menuItem.getPrimaryArgs()})},l.prototype.nearButtonsArgs=function(){return this.getButtonChildren(!1)},l.prototype.farButtonsArgs=function(){return this.getButtonChildren(!0)},l.prototype.overflowMenuArgs=function(){var t=this,n={userState:this._model.userState,currentStory:this._model.currentStory,visible:this.overflowVisible,resourceFactory:this._model.resourceFactory,getControllingElement:function(){return t.overflowButton},menuItems:ArrayExtensions.notNullOrUndefined(this._model.buttons.map(function(e){return t.getOverflowItem(e)}).concat(this._model.overflowButtons))};return new TDB.ChildArgs(e.OverflowMenuVE,n)},l.prototype.getOverflowMenu=function(){return this.overflowMenu},l.prototype.hasButton=function(t){return!!this._menuItems[t]||t===a.Overflow},l.prototype.getButton=function(t){var e=this._menuItems[t];if(e){var n=e.menuItem.getPrimaryArgs();return(this.nearButtons||[]).concat(this.farButtons||[]).firstOrDefault(function(t){return n.wouldBuild(t)})}},l.prototype.clickButton=function(t){this.getButton(t).mouseClicked(void 0)},l.prototype.commandWrapperDynamicMenuChunksArgs=function(t){return i.Environment.getInstance().isClientOnline(t),t.watch(this.notifyMenuRefresh),{visible:!0,menuChunks:[this],widthBuffer:0}},l.prototype.commandWrapperAttrArgs=function(t){var e={};return e[Aria.Attributes.Label]=Resources.ProductNameShort,e},l.prototype.addMenuItemIfValid=function(t,e){void 0!==this._menuItems[e]&&t.push(this._menuItems[e].menuItem)},l.prototype.getMenuItems=function(t){var e=[];this.addMenuItemIfValid(e,a.Home),this.addMenuItemIfValid(e,a.MyStories),this.addMenuItemIfValid(e,a.CreateNew),this.addMenuItemIfValid(e,a.SignIn),this.addMenuItemIfValid(e,a.RefreshStories),this.addMenuItemIfValid(e,a.Undo),this.addMenuItemIfValid(e,a.Redo),this.addMenuItemIfValid(e,a.Cast),this.addMenuItemIfValid(e,a.Preview),this.addMenuItemIfValid(e,a.Play),this.addMenuItemIfValid(e,a.Remix),this.addMenuItemIfValid(e,a.Content),this.addMenuItemIfValid(e,a.Authors),this.addMenuItemIfValid(e,a.Share),this.addMenuItemIfValid(e,a.Cards),this.addMenuItemIfValid(e,a.Design),this.addMenuItemIfValid(e,a.Navigation),this.addMenuItemIfValid(e,a.TutorialVideos),this.addMenuItemIfValid(e,a.InternalFeatures);for(var n in this._menuItems){var o=this._menuItems[+n];o&&!ArrayExtensions.contains(e,o.menuItem)&&this.addMenuItemIfValid(e,+n)}return e},l.prototype.getOverflowButtonWidth=function(){return void 0!==this.overflowButton?o.Binding.overflowMenuWidth:0},l.prototype.calcOverflowButtonVisible=function(t){if(CommonSettings.IsAuthenticated)return!0;for(var e=this.getMenuItems(t),n=0;n<e.length;n++)if(e[n].state.getWatchedValue(t)==o.MenuItemState.Overflow)return!0;return!1},l.prototype.getOverflowButtonVisible=function(){var t=this.overflowButton;return void 0!==t&&t.isVisible()},l.prototype.predictOverflowButtonVisible=function(t){return this.getOverflowButtonVisible()},l.prototype.commandWrapperStyleArgs=function(e){return{top:t.Utilities.toPxStr(this.getTopPosition(e))}},l.prototype.getTopPosition=function(t){return CookieConsent.isCookieConsentNotificationVisible(t)?CookieConsent.watchedConsentBannerHeight(t):this._defaultTopPosition},l.prototype.commandWrapperWidthWatcherInitArgs=function(){return this.updateWidth},l.prototype.updateWidth=function(t){var e=this;TDB.applyUpdate(function(){e._appbarWidth.setValue(t)})},l.prototype.consumptionWorldSwitch=function(t){return!1},l.prototype.getOrder=function(){return e.RegionOrderIndex.AppBar},l}(e.RegionViewElement);e.AppBarVEBase=s}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(e,n){var o=t.call(this,e,{features:TDB.ControlSetFeatures.TabDisabled})||this;return o.parent=e,o.args=n,o.sharedAppSwitcherSelector="#sharedAppSwitcher",o.o365TileClass=".o365cs-nav-appTile",o}return __extends(e,t),e.prototype.appSwitcherCopyHtmlArgs=function(){return this.sharedAppSwitcherSelector},e.prototype.toggle=function(){var e=this;return t.prototype.toggle.call(this),this.args.resourceFactory.loadResource(4).then(function(){e.isVisible()?(ExpandHeader(),$(e.o365TileClass).first().focus()):CollapseHeader()})},e.prototype.keyDown=function(t){return t.keyCode===KeyCodeType.EscapeKey?(this.escape(),TDB.EventPropagation.PreventDefault):TDB.EventPropagation.Bypass},e.prototype.onExiting=function(){t.prototype.onExiting.call(this),this.args.resourceFactory.loadResource(4).then(function(){CollapseHeader()})},e.prototype.getControllingElement=function(){return this.parent.appSwitcherButton},e}(t.PopupBaseVE);t.AppSwitcherVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(e){function n(t,n){var o=e.call(this,t,{features:TDB.ControlSetFeatures.Isolated})||this;return o.progressTitle=TDB.watchableTag(596476957,o,""),o.progressMessage=TDB.watchableTag(596476958,o,""),o.isProgressVisible=TDB.watchableTag(596476959,o,!1),o.hasMessage=TDB.watchableTag(596476960,o,!1),n.setContext(o),o}return __extends(n,e),n.prototype.showBlockingProgress=function(t,n,o){var i=this;1==this.isProgressVisible.getValue()&&this.progressTitle.getValue()==t||TDB.applyUpdate(function(){i.progressTitle.setValue(t),i.progressMessage.setValue(n),i.isProgressVisible.setValue(!0),i.hasMessage.setValue(null!==n&&void 0!==n&&n.trim().length>0)}),o?o.then(function(){platform.setImmediate(function(){e.prototype.show.call(i)})}):platform.setImmediate(function(){e.prototype.show.call(i)})},n.prototype.hide=function(){var t=this;0!=this.isProgressVisible.getValue()&&TDB.applyUpdate(function(){t.isProgressVisible.setValue(!1)}),e.prototype.hide.call(this)},n.prototype.ifBlockingProgressArgs=function(t){return this.isProgressVisible.getWatchedValue(t)},n.prototype.ifHasMessageArgs=function(t){return this.hasMessage.getWatchedValue(t)},n.prototype.BlockingProgressTitleTextArgs=function(t){return t.watchValue(this.progressTitle)},n.prototype.BlockingProgressMessageTextArgs=function(t){return t.watchValue(this.progressMessage)},n.prototype.BlockingProgressGifAttrArgs=function(t){return{src:CommonSettings.ContentBaseUrl+"LoadingWhiteSpinner60.gif"}},n.prototype.cancelArgs=function(){return new TDB.ChildArgs(t.TextButtonVE,{buttonId:ClientAction.ButtonId.BlockingProgress_Cancel,click:this.cancelAction,context:this,cssClass:{value:"BlockingProgressCancel"},text:{value:Resources.ButtonCancel}})},n.prototype.setOnCancel=function(t){this._cancelAction=t},n.prototype.cancelAction=function(t){return this._cancelAction(),TDB.EventPropagation.Bypass},n}(t.PopupBaseVE);t.BlockingProgressVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n,o=TDB.View.Bindings.AutoPrint,i=t.Common,r=t.Common.TelemetryConstants,a=t.View.ViewElements;!function(t){t[t.LinkButton=0]="LinkButton",t[t.GlyphButton=1]="GlyphButton",t[t.BuiltIn=2]="BuiltIn"}(n=e.OverflowMenuChildType||(e.OverflowMenuChildType={}));var s;!function(t){t[t.None=0]="None",t[t.Overflow=1]="Overflow",t[t.Navigation=2]="Navigation",t[t.File=3]="File",t[t.Settings=4]="Settings",t[t.Global=5]="Global",t[t.RecycleBin=6]="RecycleBin"}(s=e.OverflowMenuCategory||(e.OverflowMenuCategory={}));var l;!function(t){t[t.Preview=0]="Preview",t[t.MyStories=1]="MyStories",t[t.CreateNew=2]="CreateNew",t[t.Download=3]="Download",t[t.Feedback=4]="Feedback",t[t.User=5]="User",t[t.SignIn=6]="SignIn",t[t.SignOut=7]="SignOut",t[t.AccessibilityView=8]="AccessibilityView",t[t.AccessibilityChecker=9]="AccessibilityChecker",t[t.DuplicateStory=10]="DuplicateStory",t[t.ExportStory=11]="ExportStory",t[t.PrintStory=12]="PrintStory",t[t.InternalFeatures=13]="InternalFeatures",t[t.PremiumFeatures=14]="PremiumFeatures",t[t.TutorialVideos=15]="TutorialVideos",t[t.Share=16]="Share",t[t.Authors=17]="Authors",t[t.Undo=18]="Undo",t[t.Redo=19]="Redo",t[t.Remix=20]="Remix",t[t.Content=21]="Content",t[t.Cards=22]="Cards",t[t.Design=23]="Design",t[t.Navigation=24]="Navigation",t[t.AccessibilityViewExit=25]="AccessibilityViewExit",t[t.Play=26]="Play",t[t.DeleteSelected=27]="DeleteSelected",t[t.DeleteAll=28]="DeleteAll",t[t.RestoreSelected=29]="RestoreSelected",t[t.RestoreAll=30]="RestoreAll",t[t.ClearSelection=31]="ClearSelection",t[t.OpenInNewTab=32]="OpenInNewTab",t[t.MySways=33]="MySways",t[t.AllSways=34]="AllSways",t[t.SharedWithMe=35]="SharedWithMe",t[t.Recycled=36]="Recycled",t[t.Find=37]="Find",t[t.Viewed=38]="Viewed",t[t.Edited=39]="Edited",t[t.SwaySettingsPane=40]="SwaySettingsPane",t[t.Help=41]="Help",t[t.SaveAsTemplate=42]="SaveAsTemplate",t[t.Analytics=43]="Analytics"}(l=e.OverflowButtonLabel||(e.OverflowButtonLabel={}));var u;!function(t){t[t.DOCX=0]="DOCX",t[t.PDF=1]="PDF",t[t.AutoPrintPDF=2]="AutoPrintPDF",t[t.Unknown=3]="Unknown"}(u=e.OoxmlFileType||(e.OoxmlFileType={}));var c;!function(t){t[t.Export=0]="Export",t[t.Print=1]="Print",t[t.Unknown=2]="Unknown"}(c=e.OoxmlOutputType||(e.OoxmlOutputType={}));var d=function(d){function p(t,e){var n=d.call(this,t,{features:TDB.ControlSetFeatures.VerticalList,visible:e.visible,role:Aria.Roles.Menu,description:Resources.OverFlowButtonDescription,getControllingElement:e.getControllingElement})||this;return n._args=e,n.downloadUrl=TDB.watchableTag(596476883,n,null),n.printUrl=TDB.watchableTag(596476884,n,null),n.verticalPadding=TDB.watchableOption(n,e.verticalPadding,0),n.onPrintLoadAction=function(){},n.exportInProgress=!1,n.curentExportRequestId="",CommonSettings.IsTenantUser&&(n.o365ShellService=i.O365ShellService.getInstance(),n.swayStartPageFlightAvaliable=n.o365ShellService.getFlightInformationAvailableWatcher(n)),n}return __extends(p,d),p.prototype.isSwayStartPageUrlFlightEnabled=function(t){return CommonSettings.SwayButtonRedirectToOfficeCom&&this.swayStartPageFlightAvaliable&&this.swayStartPageFlightAvaliable.getWatchedValue(t)&&this.o365ShellService.isSwayStartPageUrlFlightEnabled()},p.prototype.makeClickHandler=function(t,e){var n=this,o=e.click;return function(i){return n.movesFocus(t)?n.hideWithoutRestoringFocus():n.hide(),o.call(e.context,i)}},p.prototype.addCommonButtonArgs=function(t,e){e.click=this.makeClickHandler(t,e),e.cssClass||(e.cssClass={value:"overflowButton"}),e.description||(e.description=e.text),e.fontIconSizeClass||(e.fontIconSizeClass=FontIcons.OverflowMenuItemButtonIconSize),e.fontIconWrapperClass||(e.fontIconWrapperClass={value:"overflowMenuFontIcon"}),e.glyphWrapperClass||(e.glyphWrapperClass="overflowMenuGlyph"),e.textClass||(e.textClass="overflowMenuText"),e.textPlacementRight||(e.textPlacementRight=!0),e.textPlacementLeft||(e.textPlacementLeft=!1)},p.prototype.createGlyphMenuItem=function(t,n,o){return this.addCommonButtonArgs(t,n),{contentArgs:n,contentType:e.GlyphButtonVE,visible:o}},p.prototype.createLinkMenuItem=function(t,n,o){return n.click=this.makeClickHandler(t,n),n.cssClass||(n.cssClass={value:"overflowButton overflowLinkButton"}),n.textCssClass||(n.textCssClass={value:"overflowMenuText segoeUI"}),{contentArgs:n,contentType:e.LinkButtonVE,visible:o}},p.prototype.movesFocus=function(t){var e=[l.AccessibilityChecker,l.Content,l.Cards,l.Design,l.Navigation,l.Feedback,l.Help,l.Share,l.Authors,l.DuplicateStory,l.SaveAsTemplate];return ArrayExtensions.contains(e,t)},p.prototype.createInternalFeaturesMenuItem=function(){var t=i.Environment.getInstance();if(!t.isProductionEnvironment()||i.UserState.getInstance().isInternalUser()){var e=t.areInternalFeaturesEnabled()?"Disable Internal Features":"Enable Internal Features";return this.createGlyphMenuItem(l.InternalFeatures,{context:this,click:this.internalFeaturesButtonClicked,text:{value:e},buttonId:ClientAction.ButtonId.AppBar_InternalFeatures,cssClass:{value:"overflowButton internalOverflowButton"},telemetryId:r.internalFeaturesEnabledOverflowMenuButtonId})}},p.prototype.internalFeaturesButtonClicked=function(t){return i.AppBarAction.getInstance().ToggleInternalFlight(),TDB.EventPropagation.Bypass},p.prototype.createPremiumFeaturesMenuItem=function(){if(!i.Environment.getInstance().isProductionEnvironment()||i.UserState.getInstance().isInternalUser()){var t=CommonSettings.IsPaidUser?"Disable Premium Features":"Enable Premium Features";return this.createGlyphMenuItem(l.PremiumFeatures,{context:this,click:this.premiumFeaturesButtonClicked,text:{value:t},buttonId:ClientAction.ButtonId.AppBar_PremiumFeatures,cssClass:{value:"overflowButton internalOverflowButton"},telemetryId:r.togglePremiumFeaturesOverflowMenuButtonId})}},p.prototype.premiumFeaturesButtonClicked=function(t){return i.AppBarAction.getInstance().TogglePremiumFeatures(),TDB.EventPropagation.Bypass},p.prototype.createCreateNewMenuItem=function(){var t=i.Environment.getInstance();if(CommonSettings.IsEnabled&&t.shouldShowAuthoringEntrypoints())return{contentArgs:this.getCreateNewButtonArgs(),contentType:e.GlyphButtonVE}},p.prototype.getCreateNewButtonArgs=function(){var t={context:this,click:this.createNewButtonClicked,enabled:i.Environment.getInstance().getClientOnline(),text:{value:Resources.CreateNew},tooltip:{value:Resources.AppBarCreateNewButtonDescription},fontIconName:{value:FontIcons.OverflowMenuCreateNewButtonIcon},fontIconWrapperClass:{value:"createNewOverflowButtonFontIconWrapper overflowMenuFontIcon"},buttonId:ClientAction.ButtonId.AppBar_CreateNew,telemetryId:r.createNewButtonOverflowMenuId};return this.addCommonButtonArgs(l.CreateNew,t),t},p.prototype.createNewButtonClicked=function(e){return this.exit(),t.Common.Environment.getInstance().runBeforeNavigationHandlers(this,function(){i.AppBarAction.getInstance().CreateNewStory()})?TDB.EventPropagation.PreventDefault:(i.AppBarAction.getInstance().CreateNewStory(),TDB.EventPropagation.Bypass)},p.prototype.createSettingsPaneMenuItem=function(t,e){return this.createGlyphMenuItem(l.SwaySettingsPane,{context:t,click:e,text:{value:Resources.SwaySettingsPaneTitleText},buttonId:ClientAction.ButtonId.AppBar_SwaySettingsPane,enabled:{value:!0},description:{value:Resources.SwaySettingsPaneTooltip},tooltip:{value:Resources.SwaySettingsPaneTooltip}})},p.prototype.createFeedbackMenuItem=function(t){return{contentArgs:this.getFeedbackButtonArgs(t),contentType:e.GlyphButtonVE}},p.prototype.getFeedbackButtonArgs=function(t){var e={context:this,click:this.feedbackClicked,text:{value:t},tooltip:{value:Resources.AppBarGiveFeedbackButtonDescription},fontIconName:{value:FontIcons.OverflowMenuFeedbackButtonIcon},buttonId:ClientAction.ButtonId.AppBar_Feedback,enabled:i.Environment.getInstance().getClientOnline(),telemetryId:r.addFeedbackButtonId};return this.addCommonButtonArgs(l.Feedback,e),e},p.prototype.feedbackClicked=function(t){return this.hide(),i.AppBarAction.getInstance().ShowFeedback(this._args.resourceFactory),TDB.EventPropagation.Bypass},p.prototype.createHelpMenuItem=function(e){var n=this,o=null!=this._args.currentStory,a=t.Common.Environment.getInstance().shouldShowAboutDialogButton();return this.createGlyphMenuItem(l.Help,{context:this,click:function(){return n.helpClicked(o,a)},text:{value:e},fontIconName:{value:FontIcons.OverflowMenuFeedbackButtonIcon},buttonId:ClientAction.ButtonId.AppBar_Help,enabled:i.Environment.getInstance().getClientOnline(),telemetryId:r.helpButtonId})},p.prototype.helpClicked=function(t,e){return this.hide(),i.AppBarAction.getInstance().ShowHelp(t,e),TDB.EventPropagation.Bypass},p.prototype.showDownloadArgs=function(){return CommonSettings.EnableStoryDownload||CommonSettings.IsExportStoryEnabled},p.prototype.downloadContainerAutoDownloadInitArgs=function(){return{url:this.downloadUrl}},p.prototype.createDownloadMenuItem=function(){return this.createGlyphMenuItem(l.Download,{context:this,click:this.downloadClicked,text:{value:Resources.DownloadStory},fontIconName:{value:FontIcons.OverflowMenuDuplicateButtonIcon},buttonId:ClientAction.ButtonId.AppBar_Download})},p.prototype.downloadClicked=function(t){var e=this,n=i.UrlHelper.getInstance().getDownloadUrl(window.location.toString());return TDB.applyUpdate(function(){return e.downloadUrl.setValue(n)}),this.hide(),TDB.EventPropagation.Bypass},p.prototype.createExportMenuItem=function(){var t=this;return this.createGlyphMenuItem(l.ExportStory,{context:this,click:function(e){return t.exportClicked(e)},text:{value:Resources.ExportStory},buttonId:ClientAction.ButtonId.AppBar_Export})},p.prototype.exportClicked=function(n){var o=this,r=this._args.currentStory?this._args.currentStory.getLookupId():"",a=i.UrlHelper.getInstance().exportStoryAllowedUrl(r);this.exportCanceled=!1;var s=new e.ExportRequest;s.outputType=c.Export;var l=JSON.stringify(s);return p.exportDialogRemoved=$.Deferred(),$.ajax(a,{name:"ExportStoryAllowed",description:"Determines whether or not export is allowed for this story",type:"POST",contentType:t.RequestManager.JsonContentType,data:l}).then(function(n,i,a){var s={title:Resources.ExportStoryDialogTitle,messages:[Resources.ExportStoryDialogMessage],description:Resources.ExportStoryDialogTitle,dialogLogMessage:"Export Story",lightDismiss:!0,dialogType:e.DialogType.Question,dialogWrapperCssClass:{value:"CenteredDialog ExportDialog"},dialogDOMRemoval:p.exportDialogRemoved,buttonsArgs:[{caption:{value:Resources.ExportStoryWordButtonCaption},isDefault:!0,onAction:function(){return o.sendExportRequest(r,u.DOCX,Resources.OutputName+".docx",c.Export)}},{caption:{value:Resources.ExportStoryPDFButtonCaption},onAction:function(){return o.sendExportRequest(r,u.PDF,Resources.OutputName+".pdf",c.Export)}},{caption:{value:Resources.ButtonClose},dismissOnAction:!0}]};t.View.Common.DialogManager.createAndShow(s)},function(t,e,n){o.onExportFail(u.Unknown,c.Export,403)}),this.hide(),TDB.EventPropagation.Bypass},p.prototype.showPrintArgs=function(){return CommonSettings.IsExportStoryEnabled},p.prototype.printContainerAutoPrintInitArgs=function(){var t=this;return{url:this.printUrl,onLoadAction:function(){return t.onPrintLoadAction()}}},p.prototype.createPrintMenuItem=function(){var t=this;return this.createGlyphMenuItem(l.PrintStory,{context:this,click:function(e){return t.printClicked(e)},text:{value:Resources.PrintStory},buttonId:ClientAction.ButtonId.AppBar_Print,shortcutIdentifiers:["Ctrl+PKey","Meta+PKey"],shortcutProcessor:a.DomEventRegister.getInstance().getRootPanelElement(),shortcutCallback:function(){e.OverflowMenuVE.printShortcutAdded&&e.OverflowMenuVE.printShortcutAdded.resolve()}})},p.prototype.printClicked=function(n){var o=this,i=this._args.currentStory?this._args.currentStory.getLookupId():"";if(this.exportCanceled=!1,t.Common.Environment.getInstance().supportsPrinting())this.sendExportRequest(i,u.PDF,Resources.OutputName+".pdf",c.Print);else{var r={title:Resources.ExportStoryForPrintDialogTitle,messages:[Resources.ExportStoryForPrintDoneDialogMessage],description:Resources.ExportStoryForPrintDialogTitle,dialogLogMessage:"Export for print",lightDismiss:!0,dialogType:e.DialogType.Question,dialogWrapperCssClass:{value:"CenteredDialog ExportDialog"},buttonsArgs:[{caption:{value:Resources.ExportStoryForPrintPDFButton},onAction:function(){return o.sendExportRequest(i,u.PDF,Resources.OutputName+".pdf",c.Export)},buttonId:ClientAction.ButtonId.ExportStoryForPrintingDialog_PDF},{caption:{value:Resources.ButtonClose},dismissOnAction:!0}]};t.View.Common.DialogManager.createAndShow(r)}return this.hide(),n.stopPropagation(),TDB.EventPropagation.PreventDefault},p.prototype.sendExportRequest=function(n,o,r,a){var s=this;if(!this.exportInProgress&&!t.View.Common.BlockingProgressManager.getInstance().isBlocking()){this.exportInProgress=!0;var l=function(){s.exportCanceled=!0,s.exportInProgress=!1,t.View.Common.BlockingProgressManager.getInstance().hide()};a===c.Print?t.View.Common.BlockingProgressManager.getInstance().show(this.getExportProgressTitle(o,a),l,Resources.PrintStoryProgressMessage):t.View.Common.BlockingProgressManager.getInstance().deferredShow(this.getExportProgressTitle(o,a),l,p.exportDialogRemoved);var u=i.UrlHelper.getInstance().exportStoryUrl(n),d=new e.ExportRequest;d.fileType=o,d.outputType=a;var g=this.curentExportRequestId=i.GuidGenerator.generateGuid(),h=JSON.stringify(d);StoryLog.StructuredTraceTag(596464386,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Created story export request data",{RequestData:h}),$.ajax(u,{name:"ExportStory",description:"Exports story to document",type:"POST",contentType:t.RequestManager.JsonContentType,dataType:"json",data:h}).then(function(t,e,i){var u=$.parseJSON(i.responseText);u.containsCharts?s.showChartConfirmationDialog(o,a,function(){s.onRequestSuccess(i.status,n,o,r,a,u,g,function(){return s.pollExportStatus(CommonSettings.ExportStoryMaxPollingRequestsCount,o,r,a,u,g)})},l):s.onRequestSuccess(i.status,n,o,r,a,u,g,function(){return s.pollExportStatus(CommonSettings.ExportStoryMaxPollingRequestsCount,o,r,a,u,g)})},function(t,e,n){s.onExportFail(o,a,t.status)})}},p.prototype.pollExportStatus=function(n,o,r,a,s,l){var u=this,c=this._args.currentStory?this._args.currentStory.getLookupId():"",d=i.UrlHelper.getInstance().exportStoryStatusUrl(c),p=new e.ExportRequest;p.fileType=o,p.outputType=a,p.eTag=s.eTag,p.cacheVersion=s.cacheVersion;var g=JSON.stringify(p);StoryLog.StructuredTraceTag(596464387,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Created story export status request data",{RequestData:g}),n>0?$.ajax(d,{name:"ExportStoryStatus",description:"Gets status of story export to document",type:"POST",contentType:t.RequestManager.JsonContentType,data:g}).then(function(t,e,i){u.onRequestSuccess(i.status,c,o,r,a,s,l,function(){return platform.setTimeout(function(){return u.pollExportStatus(n-1,o,r,a,s,l)},CommonSettings.ExportStoryPollingRequestsDelay)})},function(t,e,n){u.onExportFail(o,a,t.status)}):(StoryLog.StructuredTraceTag(596476885,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.error,"Export request timed out",{OutputType:a.toString(),FileType:o.toString(),StatusCode:status}),this.onExportFail(o,a))},p.prototype.onRequestSuccess=function(e,n,o,r,a,s,l,u){var d=this;if(this.exportCanceled)t.View.Common.BlockingProgressManager.getInstance().hide();else{if(this.curentExportRequestId!==l)return;if(200===e)if(StoryLog.StructuredTraceTag(596476886,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Story export request successful",{OutputType:a.toString(),FileType:o.toString()}),a===c.Export){var p=i.UrlHelper.getInstance().exportStoryGetUrl(n,o,r,a,s.eTag,s.cacheVersion);t.Utilities.browser.isiOS?(this.createAndShowBackgroundDialog(n,o,r,a,s,!0),t.View.Common.BlockingProgressManager.getInstance().hide()):(TDB.applyUpdate(function(){d.downloadUrl.setValue(p)}),t.View.Common.BlockingProgressManager.getInstance().hide(),this.exportInProgress=!1)}else t.Utilities.browser.isChrome&&"Desktop"===CommonSettings.ClientDevice?(this.onPrintLoadAction=function(){d.createAndShowBackgroundDialog(n,o,r,a,s,!1),t.View.Common.BlockingProgressManager.getInstance().hide(),StoryLog.TraceTag(596476887,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Print IFrame has finished loading")},TDB.applyUpdate(function(){d.printUrl.setValue(i.UrlHelper.getInstance().exportStoryGetUrl(n,o,r,a,s.eTag,s.cacheVersion,!0))})):(this.createAndShowBackgroundDialog(n,o,r,a,s,t.Utilities.browser.isiOS),t.View.Common.BlockingProgressManager.getInstance().hide());else 202===e?u():this.onExportFail(o,a)}},p.prototype.createAndShowBackgroundDialog=function(n,o,r,a,s,l){var u=this,c={message:l?"{0}":Resources.PrintStoryDoneDialogMessage,links:[new e.LinkWithAction(this.getUnderlyingDialogLinkText(l,o,a),function(){var t=i.UrlHelper.getInstance().exportStoryGetUrl(n,o,r,a,s.eTag,s.cacheVersion);l?(window.open(t),StoryLog.TraceTag(596476888,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Document opened in new tab. FileType: "+o)):(TDB.applyUpdate(function(){u.downloadUrl.setValue(t)}),StoryLog.TraceTag(596476889,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"PDF download link clicked"))})],linkStyle:"WhiteHyperlinks"},d=this.getUnderlyingDialogTitle(l,o,a),p={title:d,description:d,lightDismiss:!0,dialogType:e.DialogType.Question,dialogWrapperCssClass:{value:"CenteredDialog DonePrintingDialog"},buttonsArgs:[{caption:{value:Resources.ButtonClose},dismissOnAction:!0}],onClose:function(){u.removePrintIframe(),u.exportInProgress=!1},contentArgs:new TDB.ChildArgs(e.TextWithHyperlinkContentVE,c)};t.View.Common.DialogManager.createAndShow(p)},p.prototype.removePrintIframe=function(){var t=document.getElementById(o.IframeId);t&&document.body.removeChild(t)},p.prototype.getUnderlyingDialogTitle=function(e,n,o){if(e){if(o===c.Print)return Resources.PrintStoryFinishedTitleIOS;if(o===c.Export)return Resources.ExportStoryFinishedTitleIOS}else if(o===c.Print)return Resources.PrintStoryDoneDialogTitle;throw t.RethrowLogger.createError("Cannot get underlying dialog title for type: "+n+", outputType: "+o+", is iOS: "+e)},p.prototype.getUnderlyingDialogLinkText=function(e,n,o){if(e){if(o===c.Print)return Resources.PrintStoryFinishedMessageLinkIOS;if(o===c.Export){if(n===u.DOCX)return Resources.ExportStoryFinishedMessageLinkWordIOS;if(n===u.PDF)return Resources.ExportStoryFinishedMessageLinkPdfIOS}}else if(o===c.Print)return Resources.PrintStoryDoneDialogMessageLink;throw t.RethrowLogger.createError("Cannot get underlying dialog link text for type: "+n+", outputType: "+o+", is iOS: "+e)},p.prototype.getExportProgressTitle=function(e,n){if(n===c.Print)return Resources.PrintStoryProgressTitle;if(n===c.Export){if(e===u.DOCX)return Resources.ExportStoryWordProgressMessage;if(e===u.PDF)return Resources.ExportStoryPDFProgressMessage}throw t.RethrowLogger.createError("Cannot get progress dialog message for type: "+e+", outputType: "+n)},p.prototype.getGenericErrorTitle=function(e,n){if(n===c.Print)return Resources.PrintStoryErrorTitle;if(n===c.Export){if(e===u.DOCX)return Resources.ExportStoryWordErrorTitle;if(e===u.PDF)return Resources.ExportStoryPDFErrorTitle}throw t.RethrowLogger.createError("Cannot get error dialog title for type: "+e+", outputType: "+n)},p.prototype.getGenericErrorText=function(e){if(e===c.Print)return Resources.PrintStoryErrorMessage;if(e===c.Export)return Resources.ExportStoryErrorMessage;throw t.RethrowLogger.createError("Cannot get error dialog text for outputType: "+e)},p.prototype.showChartConfirmationDialog=function(n,o,i,r){var a={title:o===c.Export?Resources.ExportStoryChartsDialogTitle:Resources.PrintStoryChartsDialogTitle,description:o===c.Export?Resources.ExportStoryChartsDialogTitle:Resources.PrintStoryChartsDialogTitle,messages:[o===c.Export?Resources.ExportStoryChartsDialogMessage:Resources.PrintStoryChartsDialogMessage],lightDismiss:!0,dialogType:e.DialogType.Question,dialogWrapperCssClass:{value:"CenteredDialog ExportErrorDialog"},buttonsArgs:[{caption:{value:Resources.SharedChartsDialogContinueButton},isDefault:!0,onAction:i},{caption:{value:Resources.SharedChartsDialogCancelButton},onAction:r}],onCancel:r};t.View.Common.DialogManager.createAndShow(a)},p.prototype.onExportFail=function(e,n,o){var i=this;void 0===o&&(o=0),t.View.Common.BlockingProgressManager.getInstance().hide();var r,a;switch(o){case 403:r=Resources.ExportNotAllowedDialogTitle,a=Resources.ExportNotAllowedDialogMessage;break;default:r=this.getGenericErrorTitle(e,n),a=this.getGenericErrorText(n)}StoryLog.StructuredTraceTag(596476890,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Export failed",{OutputType:n.toString(),FileType:e.toString(),StatusCode:o}),ErrorDialog.ShowErrorDialog(r,a,"Undefined",function(){i.exportInProgress=!1},null,"ExportErrorDialog")},p.prototype.createDuplicateStoryMenuItem=function(t,n){return{contentArgs:this.getDuplicateStoryButtonArgs(t,n),contentType:e.GlyphButtonVE}},p.prototype.getDuplicateStoryButtonArgs=function(t,e){var n=this,o={context:this,click:function(){return n.duplicateStoryClicked(e.call(t)),TDB.EventPropagation.Bypass},text:{value:Resources.DuplicateStory},tooltip:{value:Resources.AppBarDuplicateStoryButtonDescription},fontIconName:{value:FontIcons.OverflowMenuDuplicateButtonIcon},buttonId:ClientAction.ButtonId.AppBar_Duplicate,enabled:i.Environment.getInstance().getClientOnline()};return this.addCommonButtonArgs(l.DuplicateStory,o),o},p.prototype.createSaveAsTemplateMenuItem=function(t,n){return{contentArgs:this.getSaveAsTemplateButtonArgs(t,n),contentType:e.GlyphButtonVE}},p.prototype.getSaveAsTemplateButtonArgs=function(t,e){var n=this,o={context:this,click:function(){return n.saveAsTemplateClicked(e.call(t)),TDB.EventPropagation.Bypass},text:{value:Resources.SaveAsTemplate},tooltip:{value:Resources.SaveAsTemplate},fontIconName:{value:FontIcons.OverflowMenuDuplicateButtonIcon},buttonId:ClientAction.ButtonId.AppBar_SaveAsTemplate,enabled:i.Environment.getInstance().getClientOnline()};return this.addCommonButtonArgs(l.SaveAsTemplate,o),o},p.prototype.duplicateStoryClicked=function(n){if(this.hide(),!BRSDialog.showIfAuthoringDisabled()){var o=this._args.currentStory?this._args.currentStory.getLookupId():"";e.DuplicateStoryDialog.createAndShow(o,n,t.Common.UrlHelper.getInstance().mySwaysUrl())}},p.prototype.saveAsTemplateClicked=function(n){if(this.hide(),!BRSDialog.showIfAuthoringDisabled()){var o=this._args.currentStory?this._args.currentStory.getLookupId():"";e.SaveAsTemplateDialog.createAndShow(o,n,t.Common.UrlHelper.getInstance().mySwaysUrl())}},p.prototype.createMyStoriesMenuItem=function(){return this.createGlyphMenuItem(l.MyStories,{context:this,click:this.myStoriesButtonClicked,text:{value:Resources.MyRemixes},tooltip:{value:Resources.AppBarSwayButtonDescription},buttonId:ClientAction.ButtonId.AppBar_MyStories,telemetryId:r.mySwayOverflowId,enabled:{compute:new TDB.ComputedOptionArgs(this,function(t){return!CommonSettings.AuthoringFromLandingPageContextEnabled||i.SinglePageAppHelper.retrieveMyStoriesSettings(t)})}})},p.prototype.myStoriesButtonClicked=function(e){var n=this;return this.exit(),e.preventDefault(),t.Common.Environment.getInstance().runBeforeNavigationHandlers(this,function(){n.navigateOnMySways()})?TDB.EventPropagation.PreventDefault:(this.navigateOnMySways(),TDB.EventPropagation.Bypass)},p.prototype.navigateOnMySways=function(){var t=i.AppBarAction.getInstance();this.isSwayStartPageUrlFlightEnabled()?t.GoToOfficeComMyStories():t.GoToMyStories()},p.prototype.createTutorialVideosMenuItem=function(e){if(CommonSettings.SiteTutorialVideosEnabled)return this.createLinkMenuItem(l.TutorialVideos,{context:this,click:this.tutorialVideosButtonClicked,text:{value:Resources.Tutorials},url:t.Common.UrlHelper.getInstance().tutorialVideosUrl(),cssClass:e?{value:e}:void 0,buttonId:ClientAction.ButtonId.AppBar_TutorialVideos,telemetryId:r.tutorialVideosButtonId})},p.prototype.tutorialVideosButtonClicked=function(t){return t.preventDefault(),i.AppBarAction.getInstance().OpenTutorialVideos(),TDB.EventPropagation.Bypass},p.prototype.createUserMenuItem=function(){var t=this.getUserMenuItemArgs();return{contentArgs:t,contentType:e.UserInfoVE,visible:t.visible}},p.prototype.getUserMenuItemArgs=function(){return{buttonId:ClientAction.ButtonId.AppBar_Profile,context:this,click:this.userButtonClicked,userState:this._args.userState,description:{value:ResourceManager.ResolveString(Resources.UserProfileTooltip,[this._args.userState.getDisplayName(),this._args.userState.getUserEmail()])},tooltip:{value:ResourceManager.ResolveString(Resources.UserProfileTooltip,[this._args.userState.getDisplayName(),this._args.userState.getUserEmail()])}}},p.prototype.userButtonClicked=function(t){return i.AppBarAction.getInstance().OpenUserProfile(),TDB.EventPropagation.Bypass},p.prototype.createSignOutMenuItem=function(){return this.createGlyphMenuItem(l.SignOut,{context:this,click:this.signOutButtonClicked,text:{value:Resources.SignOut},buttonId:ClientAction.ButtonId.AppBar_SignOut,telemetryId:r.signOutButtonId})},p.prototype.signOutButtonClicked=function(t){return i.AppBarAction.getInstance().SignOut(),TDB.EventPropagation.Bypass},p.prototype.createSignInMenuItem=function(){return this.createGlyphMenuItem(l.SignIn,{context:this,click:this.signInButtonClicked,text:{value:Resources.SignIn},buttonId:ClientAction.ButtonId.AppBar_SignIn,telemetryId:r.signInButtonId})},p.prototype.signInButtonClicked=function(t){return i.AppBarAction.getInstance().SignIn(),TDB.EventPropagation.Bypass},p.prototype.createContentSearchMenuItem=function(n,o){var r;if(!i.Environment.getInstance().areInternalFeaturesEnabled()){var a=t.Common.UrlHelper.getInstance();r={compute:new TDB.ComputedOptionArgs(a,a.isAccessibilityView)}}return this.createGlyphMenuItem(l.Find,{context:n,shortcutIdentifiers:["Ctrl+FKey"],shortcutProcessor:e.DomEventRegister.getInstance().getRootPanelElement(),click:o,text:{value:Resources.ContentSearchFind},buttonId:ClientAction.ButtonId.AppBar_Find},r)},p.prototype.createAccessibilityViewMenuItem=function(t){var e=new TDB.ReusingComputedOptionArgs(this,this.computeAccessibilityButtonTooltip);return this.accessibleViewUsesNewTab=t,this.createGlyphMenuItem(l.AccessibilityView,{context:this,shortcutIdentifiers:["Alt+Shift+VKey"],shortcutProcessor:a.DomEventRegister.getInstance().getRootPanelElement(),click:this.handleAccessibilityButtonClick,text:{compute:new TDB.ComputedOptionArgs(this,this.computeAccessibilityButtonText)},buttonId:ClientAction.ButtonId.AppBar_AccessibilityView,tooltip:{compute:e},enabled:i.Environment.getInstance().getClientOnline()})},p.prototype.createAccessibilityCheckerMenuItem=function(t,e){return this.createGlyphMenuItem(l.AccessibilityChecker,{context:t,click:e,text:{value:Resources.AccessibilityChecker},buttonId:ClientAction.ButtonId.AppBar_AccessibilityChecker,tooltip:{value:Resources.AccessibilityCheckerDescription}})},p.prototype.handleAccessibilityButtonClick=function(e){return t.Common.UrlHelper.getInstance().isAccessibilityView()?this.exitAccessibilityViewClicked(e):this.enterAccessibilityViewClicked(e)},p.prototype.computeAccessibilityButtonText=function(e){return t.Common.UrlHelper.getInstance().isAccessibilityView(e)?Resources.ExitAccessibilityView:Resources.AccessibilityView},p.prototype.computeAccessibilityButtonTooltip=function(e){return t.Common.UrlHelper.getInstance().isAccessibilityView(e)?Resources.ExitAccessibilityViewTooltip:Resources.AccessibilityViewTooltip},p.prototype.exitAccessibilityViewClicked=function(t){ActionLogger.RecordClientAction(new ClientAction.ButtonClickAction(ClientAction.ButtonId.AppBar_AccessibilityViewExit,Diag.ULSCat.msoulscat_Story_Site));var e=this._args.currentStory;return e&&e.leaveAccessibilityView(),TDB.EventPropagation.PreventDefault},p.prototype.enterAccessibilityViewClicked=function(t){return ActionLogger.RecordClientAction(new ClientAction.ButtonClickAction(ClientAction.ButtonId.AppBar_AccessibilityView,Diag.ULSCat.msoulscat_Story_Site)),this.navigateAccessibilityView(),TDB.EventPropagation.PreventDefault},p.prototype.navigateAccessibilityView=function(){var t=window,e=this._args.currentStory;return e&&(t=e.openAccessibilityView(this.accessibleViewUsesNewTab)||t),t},p.prototype.wrapperAttrArgs=function(t){return this.getAriaAttributes(t)},p.prototype.wrapperClassNameArgs=function(t){var e="overflowWrapper overflowWrapperWeb";return this._args.cssClass&&(e+=" "+this._args.cssClass),e},p.prototype.wrapperStyleArgs=function(e){return{maxHeight:t.Utilities.toPxStr(i.Environment.getInstance().getWindowSize(e).h-50-this.verticalPadding.getWatchedValue(e))}},p.prototype.wrapperSlideVisibleInitArgs=function(){return!1},p.prototype.wrapperSlideVisibleArgs=function(t){var n=this.findParent(e.PageRootVE);return{visible:t.watchValue(this._args.visible),done:this.onPopupVisible,duration:n.animationDisabled.getWatchedValue(t)?0:void 0}},p.prototype.ifLastSyncTimeArgs=function(t){return!(!this._args.currentStory||!i.Environment.getInstance().isClientOnline(t))&&this._args.currentStory.getLastSyncTime(t).length>0},p.prototype.lastSyncTimeTextArgs=function(t){return ResourceManager.ResolveString(Resources.LastSyncTimeDescription,[this.formattedLastSyncTime(t)])},p.prototype.lastSyncTimeAttrArgs=function(t){var e={};return e[Aria.Attributes.Title]=ResourceManager.ResolveString(Resources.LastSyncTimeDescription,[this.formattedLastSyncTime(t)]),e},p.prototype.formattedLastSyncTime=function(t){var e={month:"long",day:"numeric",hour:"numeric",minute:"numeric"},n=this._args.currentStory?this._args.currentStory.getLastSyncTime(t):"",o="",i=void 0;try{i=new Date(n)}catch(t){StoryLog.StructuredTraceTag(596476891,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"Creating date from lastSyncTime failed.",{"value of lastSyncTime":n,"error message":t.message})}if(void 0!==i)try{o=i.toLocaleDateString(CommonSettings.UserLocaleString,e)}catch(t){StoryLog.StructuredTraceTag(596476892,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"Formatting lastSyncTimeDate failed.",{"value of lastSyncTime":n,"value of user locale":CommonSettings.UserLocaleString,"error message":t.message})}return o},p.prototype.showOverflowItemsArgs=function(){return this.hasMenuItems(s.Overflow)},p.prototype.overflowMenuItemsArgs=function(){return this.getMenuItemArgs(s.Overflow)},p.prototype.showNavItemsArgs=function(){return this.hasMenuItems(s.Navigation)},p.prototype.navMenuItemsArgs=function(){return this.getMenuItemArgs(s.Navigation)},p.prototype.showFileItemsArgs=function(){return this.hasMenuItems(s.File)},p.prototype.fileMenuItemsArgs=function(){return this.getMenuItemArgs(s.File)},p.prototype.showSettingsItemsArgs=function(){return this.hasMenuItems(s.Settings)},p.prototype.settingsMenuItemsArgs=function(){return this.getMenuItemArgs(s.Settings)},p.prototype.showGlobalItemsArgs=function(){return this.hasMenuItems(s.Global)},p.prototype.globalMenuItemsArgs=function(){return this.getMenuItemArgs(s.Global)},p.prototype.showRecycleBinItemsArgs=function(){return this.hasMenuItems(s.RecycleBin)},p.prototype.recycleBinMenuItemsArgs=function(){return this.getMenuItemArgs(s.RecycleBin)},p.prototype.getMenuItems=function(t){return ArrayExtensions.notNullOrUndefined(this._args.menuItems.filter(function(e){return e&&e.category===t}))},p.prototype.hasMenuItems=function(t){return this.getMenuItems(t).length>0},p.prototype.getMenuItemArgs=function(t){var n=this,o=this.getMenuItems(t);return ArrayExtensions.notNullOrUndefined(o.map(function(t){return n.createItemArgs(t)})).map(function(t){return new TDB.ChildArgs(e.MenuItemVE,t)})},p.prototype.createItemArgs=function(e){if(e)switch(e.type){case n.LinkButton:return this.createLinkMenuItem(e.label,e.args,e.visible);case n.GlyphButton:return this.createGlyphMenuItem(e.label,e.args,e.visible);case n.BuiltIn:switch(e.label){case l.CreateNew:return this.createCreateNewMenuItem();case l.Feedback:return this.createFeedbackMenuItem(Resources.GiveFeedback);case l.Help:return this.createHelpMenuItem(Resources.HelpButton);case l.DuplicateStory:return this.createDuplicateStoryMenuItem(e.context,e.getStoryTitle);case l.SaveAsTemplate:return this.createSaveAsTemplateMenuItem(e.context,e.getStoryTitle);case l.User:return this.createUserMenuItem();case l.InternalFeatures:return this.createInternalFeaturesMenuItem();case l.PremiumFeatures:return this.createPremiumFeaturesMenuItem();case l.SwaySettingsPane:return this.createSettingsPaneMenuItem(e.context,e.click);case l.Download:return this.createDownloadMenuItem();case l.ExportStory:return this.createExportMenuItem();case l.PrintStory:return this.createPrintMenuItem();case l.MyStories:return this.createMyStoriesMenuItem();case l.TutorialVideos:return this.createTutorialVideosMenuItem();case l.SignOut:return this.createSignOutMenuItem();case l.SignIn:return this.createSignInMenuItem();case l.Find:return this.createContentSearchMenuItem(e.context,e.click);case l.AccessibilityView:return this.createAccessibilityViewMenuItem(e.useNewTab);case l.AccessibilityChecker:return this.createAccessibilityCheckerMenuItem(e.context,e.click);default:throw t.RethrowLogger.createError("unrecognized overflow item label")}default:throw t.RethrowLogger.createError("unrecognized overflow item type")}},p.prototype.getOverflowMenuItem=function(t){var e=this._args.menuItems.firstOrDefault(function(e){return e.label===t});return e&&this.createItemArgs(e)},p.prototype.hasOverflowMenuItem=function(t){return!!this.getOverflowMenuItem(t)},p.prototype.clickOverflowMenuItem=function(t){var e=this.getOverflowMenuItem(t);return e?e.contentArgs.click(void 0):TDB.EventPropagation.Bubble},p}(e.PopupBaseVE);e.OverflowMenuVEBase=d}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=t.Common.TelemetryConstants,o=t.Common,i=function(i){function r(t,e){var n=i.call(this,t)||this;return n.model=e,n._isEditMode=e.isEditMode,CommonSettings.IsTenantUser&&(n.o365ShellService=o.O365ShellService.getInstance(),n.swayStartPageFlightAvaliable=n.o365ShellService.getFlightInformationAvailableWatcher(n)),n}return __extends(r,i),r.prototype.isSwayStartPageUrlFlightEnabled=function(t){return CommonSettings.SwayButtonRedirectToOfficeCom&&this.swayStartPageFlightAvaliable&&this.swayStartPageFlightAvaliable.getWatchedValue(t)&&this.o365ShellService.isSwayStartPageUrlFlightEnabled()},r.prototype.homeLinkArgs=function(i){var a=this,s=r.getHomeLinkCssClass(),l=void 0;CommonSettings.SwayButtonExperimentEnabled&&o.UserState.getInstance().isUserOnFlight(FlightList.SwayButtonExperiment1)?s+=" homeButtonUnclickable":l=r.getHomeLinkHref(this.isSwayStartPageUrlFlightEnabled(i));var u={buttonId:ClientAction.ButtonId.AppBar_Home,cssClass:{value:s},text:{value:t.Common.Branding.getHomeText()},textCssClass:{value:"homeText"},url:l,telemetryId:n.swayButtonId,ulsCategory:Diag.ULSCat.msoulscat_Story_Site,nativeKeyboardHandling:!0,click:function(t){return a.homeButtonClicked(t)},description:{value:Resources.OutputName},tooltip:{value:Resources.AppBarSwayButtonDescription}};return new TDB.ChildArgs(e.LinkButtonVE,u)},r.prototype.homeButtonClicked=function(e){var n=this;StoryLog.BufferedTraceTag(596444893,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"homeButtonClicked",{pageId:this.pageId});var i=e;if(0===i.button&&!i.ctrlKey){if(StoryLog.BufferedTraceTag(596444894,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"homeButtonClicked not 1",{pageId:this.pageId}),CommonSettings.AuthoringFromLandingPageContextEnabled&&CommonSettings.IsRegisteredAuthor&&!t.Common.Branding.getAlternateHomeButtonHref()&&!this.isSwayStartPageUrlFlightEnabled())return StoryLog.BufferedTraceTag(596444895,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"homeButtonClicked AuthoringFromLandingPageContextEnabled etc.",{pageId:this.pageId}),t.Common.Environment.getInstance().runBeforeNavigationHandlers(this,function(){return o.AppBarAction.getInstance().GoToMyStories()})||(StoryLog.BufferedTraceTag(596444896,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"homeButtonClicked AuthoringFromLandingPageContextEnabled GoToMyStories",{pageId:this.pageId}),o.AppBarAction.getInstance().GoToMyStories(),StoryLog.BufferedTraceTag(596444897,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"homeButtonClicked AuthoringFromLandingPageContextEnabled GoToMyStories end",{pageId:this.pageId})),StoryLog.BufferedTraceTag(596444898,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"homeButtonClicked AuthoringFromLandingPageContextEnabled etc. end",{pageId:this.pageId}),TDB.EventPropagation.PreventDefault;if(t.Common.Environment.getInstance().runBeforeNavigationHandlers(this,function(){return location.href=r.getHomeLinkHref(n.isSwayStartPageUrlFlightEnabled())}))return TDB.EventPropagation.PreventDefault}return StoryLog.BufferedTraceTag(596444899,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"homeButtonClicked end",{pageId:this.pageId}),TDB.EventPropagation.Bypass},r.getHomeLinkCssClass=function(){return"homeLink activeHomeLink segoeUILight "+t.Common.Branding.getAdditionalBrandCssClasses()},r.getHomeLinkHref=function(e){var n=t.Common.Branding.getAlternateHomeButtonHref();return n||(n=CommonSettings.IsRegisteredAuthor?e?t.Common.UrlHelper.getInstance().getSwayUrlOnOfficeCom():t.Common.UrlHelper.getInstance().mySwaysUrl():t.Common.UrlHelper.getInstance().exploreUrl()),n},r.prototype.appSwitcherButtonArgs=function(){var o={buttonId:ClientAction.ButtonId.AppSwitcher,click:this.toggleAppSwitcher,context:this,cssClass:{value:"appSwitcher"+t.Common.Branding.getAdditionalBrandCssClasses()},fontIconName:{value:FontIcons.AppSwitcherWaffleIcon},fontIconSizeClass:FontIcons.AppSwitcherWaffleIconSize,description:{value:Resources.AppSwitcherButtonDescription},tooltip:{value:Resources.AppSwitcherButtonDescription},telemetryId:n.officeAppSwitcherButtonId,hasPopup:!0};return new TDB.ChildArgs(e.GlyphButtonVE,o)},r.prototype.toggleAppSwitcher=function(t){return CommonSettings.IsTenantUser&&this.o365ShellService.ShellIsStillLoading()&&this.o365ShellService.LoadShellData(),this.appSwitcher.toggle(),TDB.EventPropagation.Bypass},r.prototype.appSwitcherArgs=function(){return new TDB.ChildArgs(e.AppSwitcherVE,{resourceFactory:this.model.resourceFactory})},r}(TDB.FocusableViewElement);e.HomeButtonVEBase=i}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(e){function n(t,n){var o=e.call(this,t,n)||this;return n.click||n.nativeKeyboardHandling||TDB.raiseRecoverableError("Link should be handled straight by browser unless we have specific click handler"),o._args=n,o._textCssClassWatchableOption=TDB.watchableOption(o,n.textCssClass,""),n.text&&(o._textWatchableOption=TDB.watchableOption(o,n.text,"")),o}return __extends(n,e),n.prototype.linkClassNameArgs=function(t){return this.getRawButtonClass()},n.prototype.getTooltip=function(t){var e,n=this.tooltip.getWatchedValue(t);return n?e=n:this._textWatchableOption&&(e=this._textWatchableOption.getWatchedValue(t)),e},n.prototype.linkAttrArgs=function(t){var e={href:this._args.url,id:this._args.telemetryId,target:this._args.target,title:this.getTooltip(t)};return e[Aria.Attributes.Label]=this.description?this.description.getWatchedValue(t):void 0,e.target=this._args.target,e},n.prototype.iconArgs=function(){var e;if(this._args.clipClass&&this._args.glyphClass){var n={clipClass:{value:this._args.clipClass},glyphClass:{value:this._args.glyphClass},wrapperClass:{value:this._args.glyphCssClass}};e=new TDB.ChildArgs(t.GlyphVE,n)}else if(this._args.fontIconName&&this._args.fontIconSizeClass){var o={fontIconName:{value:this._args.fontIconName},fontIconSizeClass:this._args.fontIconSizeClass,fontIconWrapperClass:{value:this._args.fontIconWrapperClass}};e=new TDB.ChildArgs(t.FontIconVE,o)}else if(this._args.imageUrl){var i={alt:"",role:Aria.Roles.Presentation,src:this._args.imageUrl};e=new TDB.ChildArgs(t.BasicImageVE,i)}return e},n.prototype.contentArgs=function(e){var n;if(this._args.customContentElement)n=this._args.customContentElement;else if(this._textWatchableOption){var o={message:this._textWatchableOption.getWatchedValue(e)||"",messageCss:this._textCssClassWatchableOption.getWatchedValue(e)};n=new TDB.ChildArgs(t.SpanMessageVE,o)}return n},n}(t.ButtonVE);t.LinkButtonVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(e,n){var o=t.call(this,e,n)||this;return o.args=n,o.textWatchableOption=TDB.watchableOption(o,n.text,""),o.elementId=n.telemetryId||n.id,o}return __extends(e,t),e.prototype.textClassNameArgs=function(t){return this.args.textClass},e.prototype.wrapperClassNameArgs=function(t){return this.getButtonClass(t)},e.prototype.wrapperAttrArgs=function(t){var e={};return e[Aria.Attributes.Title]=this.tooltip.getWatchedValue(t),e[Aria.Attributes.Id]=this.elementId?this.elementId:void 0,e[ControlAttributes.Attributes.Disabled]=this.isEnabled(t)?ControlAttributes.DisabledState.Enabled:ControlAttributes.DisabledState.Disabled,e[Aria.Attributes.Controls]=this.args.controls?this.args.controls:void 0,void 0!==this.args.isSelected&&(e[Aria.Attributes.Selected]=Aria.BooleanState.fromBoolean(this.args.isSelected(t))),this.getButtonAttributes(t,e)},e.prototype.textTextArgs=function(t){return this.textWatchableOption.getWatchedValue(t)},e}(t.ButtonVE);t.TextButtonVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(e){function n(t,n){var o=e.call(this,t)||this;return o.dialogManager=n.dialogManager,o.args=n.displayArgs,null==o.args.buttonId&&(o.args.buttonId=ClientAction.ButtonId.DialogButton),o.args.linkUrl&&(o.args.link=!0),o.caption=TDB.watchableOption(o,o.args.caption),o}return __extends(n,e),n.prototype.onButtonClick=function(t){var e=this;return this.args.immediateOnAction&&this.args.immediateOnAction(t,this.args),!1!==this.args.dismissOnAction?this.dialogManager.closeCurrentDialog(function(){e.args.onAction&&e.args.onAction(t,e.args)}):this.args.onAction&&this.args.onAction(t,this.args),TDB.EventPropagation.Bypass},n.prototype.getControl=function(){return this.control},n.prototype.controlArgs=function(){if(void 0===this.args.customTextButton&&void 0===this.args.customGlyphButton||!this.args.isNeutralButton&&!this.args.isCheckbox||TDB.raiseRecoverableError("Cannot create custom button if other specific button is requested."),this.args.isNeutralButton){o={buttonId:this.args.buttonId,context:this,click:this.onButtonClick,cssClass:{value:"dlgButtonNeutral segoeUI"},id:this.args.id,textClass:"dlgButtonText",text:this.args.caption,tooltip:{value:this.args.tooltip},description:{value:this.args.description},tabIndex:this.args.tabIndex,enabled:this.args.enabled,actionTelemetryProvider:this.args.buttonClickDictionaryFunc};return new TDB.ChildArgs(t.TextButtonVE,o)}if(this.args.isCheckbox){var e={buttonId:this.args.buttonId,context:this,click:this.onButtonClick,cssClass:{value:"dlgButton segoeUI"},text:this.args.caption,description:{value:this.args.description},tabIndex:this.args.tabIndex,enabled:this.args.enabled,actionTelemetryProvider:this.args.buttonClickDictionaryFunc};return new TDB.ChildArgs(t.RegularCheckboxVE,e)}if(this.args.customTextButton)return this.args.customTextButton.context=this,this.args.customTextButton.click=this.onButtonClick,new TDB.ChildArgs(t.TextButtonVE,this.args.customTextButton);if(this.args.customGlyphButton)return this.args.customGlyphButton.context=this,this.args.customGlyphButton.click=this.onButtonClick,new TDB.ChildArgs(t.GlyphButtonVE,this.args.customGlyphButton);if(this.args.link){var n={url:this.args.linkUrl||"javascript:void(0)",message:this.caption.getValue(),context:this,class:"dlgBtnLink btn segoeUI",onClickHandler:this.onButtonClick,tabIndex:this.args.tabIndex};return new TDB.ChildArgs(t.ClickableLinkVE,n)}var o={buttonId:this.args.buttonId,context:this,click:this.onButtonClick,cssClass:{value:"dlgButton segoeUI"},id:this.args.id,textClass:"dlgButtonText",text:this.args.caption,tooltip:{value:this.args.tooltip},description:{value:this.args.description},tabIndex:this.args.tabIndex,enabled:this.args.enabled,actionTelemetryProvider:this.args.buttonClickDictionaryFunc};return new TDB.ChildArgs(t.TextButtonVE,o)},n.prototype.getButtonArguments=function(){return this.args},n}(TDB.FocusableViewElement);t.DialogButtonVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(e,n){var o=t.call(this,e)||this;return o._message=null,o._message=n.message,o}return __extends(e,t),e.prototype.contentParagraphTextArgs=function(t){return this._message},e}(TDB.FocusableViewElement);t.DialogMessageVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(e,n){var o=t.call(this,e)||this;return o._html=null,o._iframe={},o._isIframeVisible=!1,n.innerHTML&&(o._html={innerHTML:n.innerHTML}),n.iframe&&(o._isIframeVisible=!0,o._iframe=n.iframe),o}return __extends(e,t),e.prototype.htmlContentsPropsArgs=function(t){return this._html},e.prototype.iframeContentsIframeArgs=function(t){return this._iframe},e.prototype.ifIframeContentsArgs=function(){return this._isIframeVisible},e}(TDB.FocusableViewElement);t.DialogHtmlContainerVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e="loadingblackspinner.gif",n=function(t){function n(n,o){var i=t.call(this,n)||this;return i.model=o,i.model.spinnerImage||(i.model.spinnerImage=e),i.isBusy=TDB.watchableOption(i,i.model.ariaBusy,!0),i.model.ariaValueText||(i.model.ariaValueText=""),i}return __extends(n,t),n.prototype.loadingSpinnerAttrArgs=function(t){var e={src:CommonSettings.ContentBaseUrl+this.model.spinnerImage};return e[Aria.Attributes.Role]=Aria.Roles.Progressbar,e[Aria.Attributes.Valuetext]=this.model.ariaValueText,e[Aria.Attributes.Busy]=this.isBusy.getWatchedValue(t)?"true":"false",this.model.width&&(e.width=this.model.width.toString()),this.model.height&&(e.height=this.model.height.toString()),e},n.prototype.centeringDivClassNameArgs=function(){return this.model.centerVertically?"CenterVerticallyAndHorizontally":"CenterHorizontally"},n}(TDB.ViewElement);t.DialogLoadingSpinnerVEBase=n}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=function(n){function o(t,e){var o=n.call(this,t,{features:TDB.ControlSetFeatures.Isolated,visible:e.visible})||this;o.model=e;var i=e.args;return o.accessibilityMessageTimeoutExpired=TDB.watchableTag(596460943,o,!1),o.accessibilityMessage=TDB.watchableOption(o,i.accessibilityMessage),o.dialogCssClassWatchableOption=TDB.watchableOption(o,i.dialogCssClass,""),o.dialogWrapperCssClassWatchableOption=TDB.watchableOption(o,i.dialogWrapperCssClass,""),o}return __extends(o,n),o.prototype.getContent=function(){return this.content},o.prototype.getButtonVEs=function(){return this.buttons},o.prototype.escape=function(){var t=this.model.createLogDictionary();t.DialogLogMessage=this.model.args.dialogLogMessage,ActionLogger.RecordClientAction(new ClientAction.ButtonClickAction(ClientAction.ButtonId.DialogEscDismiss,Diag.ULSCat.msoulscat_Story_Site,t)),this.model.cancel(),n.prototype.escape.call(this)},o.prototype.onExiting=function(){n.prototype.onExiting.call(this),this.model.dialogManager.removeDialog(this.model)},o.prototype.shouldExit=function(t){var e=this.model.args;return this.model.getAllowCancel()&&!(e.disableEscDismiss&&t===TDB.ExitReason.EscapeButtonPressed)&&!(e.disableDismissOnClickOutside&&t===TDB.ExitReason.ClickOutside)},o.prototype.getInitialActiveChild=function(){var t=this.model.args.getInitialActiveChild;return t?t():n.prototype.getInitialActiveChild.call(this)},o.prototype.dialogWrapperStyleArgs=function(e){var n=this.model.args,o=n.width,i=n.height;return{width:o?t.Utilities.toPxStr(o):"",paddingLeft:o?"22px":"",paddingRight:o?"22px":"",height:i?t.Utilities.toPxStr(i):""}},o.prototype.dialogWrapperClassNameArgs=function(t){var e="dlg segoeUI",n=this.dialogCssClassWatchableOption.getWatchedValue(t);return void 0!==n&&(e+=" "+n),e},o.prototype.dialogWrapperCenterInitArgs=function(){return{vertical:!0,horizontal:!!this.model.args.width,isRtl:CommonSettings.SiteUiRtl}},o.prototype.dialogWrapperCenterArgs=function(t){return t.watch(this.model.isPositionChanged),!0},o.prototype.dialogWrapperAttrArgs=function(t){var e,n=this.model.args;return e={},e[Aria.Attributes.Label]=n.description,e[Aria.Attributes.Live]=null!=n.ariaLive?Aria.AriaLiveValue[n.ariaLive]:void 0,e[Aria.Attributes.Role]=n.ariaRole||Aria.Roles.Dialog,e},o.prototype.dialogWrapperEventsInitArgs=function(){var t=this;return{click:function(e){return e.target!==e.currentTarget||!t.model.args.lightDismissOnClickDialogWrapper||(t.model.lightDismiss(),!1)}}},o.prototype.titleTextArgs=function(t){return this.model.getTitleText(t)},o.prototype.ifTitleArgs=function(t){var e=this.model.getTitleText(t);return e&&e.length>0},o.prototype.accessibilityMessageTextArgs=function(t){if(this.accessibilityMessageTimeoutExpired.getWatchedValue(t))return this.accessibilityMessage.getWatchedValue(t)},o.prototype.accessibilityMessageAttrArgs=function(t){var e,n=this.model.args;return e={},e[Aria.Attributes.Live]=Aria.AriaLiveValue[void 0!==n.ariaLive?n.ariaLive:Aria.AriaLiveValue.Polite],e},o.prototype.buttonsArgs=function(t){var n=this;return(this.model.getButtons(t)||[]).map(function(t){return new TDB.ChildArgs(e.DialogButtonVE,{dialogManager:n.model.dialogManager,displayArgs:t})})},o.prototype.dialogMessageArgs=function(t){return this.model.getContentMessages(t).map(function(t){return new TDB.ChildArgs(e.DialogMessageVE,{message:t})})},o.prototype.contentArgs=function(){return this.model.contentArgs()},o.prototype.dialogDebugMessageArgs=function(t){return(this.model.args.debugMessages||[]).map(function(t){return new TDB.ChildArgs(e.DialogMessageVE,{message:t})})},o.prototype.dialogDebugMessagesContainerStyleArgs=function(){var t={};return this.model.environment.areInternalFeaturesEnabled()&&(t={display:"block"}),t},o.prototype.frostStyleArgs=function(t){return{opacity:this.model.getFrostOpacity(t)}},o.prototype.frostEventsInitArgs=function(){var t=this;return{click:function(e){return t.model.lightDismiss(),!1}}},o.prototype.wrapperFadeVisibleInitArgs=function(){return{onVisible:this.onPopupVisible}},o.prototype.onPopupVisible=function(){var t=this;n.prototype.onPopupVisible.call(this),platform.setTimeout(function(){TDB.applyUpdate(function(){return t.accessibilityMessageTimeoutExpired.setValue(!0)})},1e3)},o.prototype.wrapperFadeVisibleArgs=function(t){return{visible:this.isVisible(t)}},o.prototype.wrapperClassNameArgs=function(t){return"dlgWrapperClass "+this.dialogWrapperCssClassWatchableOption.getWatchedValue(t)},o.prototype.dialogContentClassNameArgs=function(t){var e="dlgContent",n=this.model.args;return void 0!==n.dialogContentCssClass&&(e=n.dialogContentCssClass+" "+e),e},o.prototype.dlgContentsContainerClassNameArgs=function(t){var e="dlgContentsContainer",n=this.model.args;return n.dialogContentsContainerCssClass&&(e=n.dialogContentsContainerCssClass+" "+e),e},o.prototype.dlgContentWrapperClassNameArgs=function(t){return this.model.args.dialogContentWrapperClass},o.prototype.keyDown=function(t){var e=this.model.args;return e.onKeyDown&&!e.onKeyDown.call(e.context,t)?TDB.EventPropagation.PreventDefault:t.keyCode===KeyCodeType.F6Key&&t.ctrlKey&&!t.altKey?TDB.EventPropagation.PreventDefault:n.prototype.keyDown.call(this,t)},o.prototype.removeFromDOM=function(){n.prototype.removeFromDOM.call(this),this.model.args.dialogDOMRemoval&&this.model.args.dialogDOMRemoval.resolve()},o}(e.PopupBaseVE);e.DialogVEBase=n}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){!function(t){t[t.Question=1]="Question",t[t.Info=2]="Info",t[t.Warning=3]="Warning",t[t.Error=4]="Error",t[t.Bug=5]="Bug"}(t.DialogType||(t.DialogType={}));var e=function(){function e(t){this.visible=TDB.watchableTag(596460379,this,!1),this.dialogManager=t.dialogManager;var e=t.displayArgs;this.args=e,this.environment=t.environment,this.messages=TDB.watchableTag(596452432,this,e.messages),this.buttonVEArgs=TDB.watchableTag(596452433,this,e.buttonsArgs),this.isPositionChanged=TDB.notifierTag(596452434,this),this.contentVEArgs=TDB.watchableTag(596452435,this,e.contentArgs)}return e.prototype.getViewArgs=function(){var e=this;return new TDB.ChildArgs(t.DialogVE,this,function(t){StoryLog.StructuredTraceTag(596452436,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Getting the dialog view args.",{dialogMessage:e.args.dialogLogMessage,isUndefined:!t}),e.ve=t})},e.prototype.getVE=function(){return this.ve},e.prototype.getAllowCancel=function(t){return!1!==this.args.allowCancel},e.prototype.getFrostOpacity=function(t){var n=this.args.frostOpacity;return void 0!==n?n.toString():e.defaultFrostOpacity},e.prototype.getContent=function(){return this.ve&&this.ve.getContent()},e.prototype.getButtons=function(t){return this.buttonVEArgs.getWatchedValue(t)},e.prototype.getButtonVEs=function(){return this.ve&&this.ve.getButtonVEs()},e.prototype.getTitleText=function(t){return this.args.title},e.prototype.getContentMessages=function(t){return this.messages.getWatchedValue(t)||[]},e.prototype.updateContent=function(t){var e=this;TDB.applyUpdate(function(){e.contentVEArgs.setValue(t)})},e.prototype.updateButtons=function(t){var e=this;TDB.applyUpdate(function(){e.buttonVEArgs.setValue(t)})},e.prototype.updateContentMessage=function(t){var e=this;TDB.applyUpdate(function(){e.messages.setValue(t)})},e.prototype.setOnCloseCallback=function(t){this.args.onClose=t},e.prototype.setOnCloseTestingCallback=function(t){this.args.onCloseTesting=t},e.prototype.getDefaultDialogButtonVE=function(){var t=this.getButtonVEs();return t&&t[ArrayExtensions.indexOfFirst(this.buttonVEArgs.getValue(),function(t){return t.isDefault})]},e.prototype.getType=function(){return this.args.dialogType},e.prototype.show=function(){var t=this,e=this.args;e.onShowing&&e.onShowing.call(e.context),this.centerDialog(),TDB.applyUpdate(function(){t.visible.setValue(!0)});var n="",o=this.messages.getValue();o&&o.length>0&&(n=o[0]),ActionLogger.RecordClientAction(new ClientAction.DialogShownData(e.title,n,e.dialogType,e.dialogLogMessage,this.createLogDictionary()))},e.prototype.close=function(t){var e=this.args;e.onCloseTesting&&e.onCloseTesting(),this.onClose(t)},e.prototype.cancel=function(){this.close(this.args.onCancel)},e.prototype.onClose=function(t){var e=this;TDB.applyUpdate(function(){e.visible.setValue(!1)}),this.dialogManager.removeDialog(this),t&&t();var n=this.args,o=n.onClose;o&&o.call(n.context)},e.prototype.centerDialog=function(){var t=this;TDB.applyUpdate(function(){t.isPositionChanged.notify()})},e.prototype.createLogDictionary=function(){var t=null,e=this.args;return e.dialogLogDictionary&&(t=e.dialogLogDictionary()),t||(t={}),t},e.prototype.lightDismiss=function(){this.args.lightDismiss&&this.cancel()},e.prototype.contentArgs=function(){return this.contentVEArgs},e.defaultFrostOpacity="0.25",e}();t.DialogViewModel=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.inputFilePickerAttrArgs=function(t){return{accept:DocumentIngestion.DocumentIngestionAPI.getSupportedFileFormatFilter()}},e.prototype.inputFilePickerAutoUploadInitArgs=function(){var t=this;return{filesReadyForUpload:function(e){return t.fileReadyForUpload(FileObject.createFromFile(e[0]))}}},e.prototype.fileReadyForUpload=function(t){var e=new ClientAction.SimpleClientActionData(ClientAction.ActionType.CreateFromDoc,Diag.ULSCat.msoulscat_Story_Site);e.setContext({FileSize:t.getSize(),FileType:t.getType(),FileExtension:DocumentIngestion.DocumentIngestionAPI.getFileExtension(t.getName())}),ActionLogger.RecordClientAction(e),DocumentIngestion.DocumentIngestionAPI.createStoryFromDocument(t)},e}(TDB.FocusableViewElement);t.DocIngestionFileInputVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=t.Common,o=function(){function o(t,e,n,i){this.lookupId=t,this.storyTitle=e,this.onDuplication=i,this.myStoriesUrl=n,o.dialogTitle=Resources.DuplicateStoryDialogTitle}return o.createAndShow=function(t,e,n,i){new o(t,e,n,i).show()},o.prototype.show=function(){var t=this,n={title:o.dialogTitle,acceptButtonText:Resources.DuplicateStoryDialogDuplicateButton,initialValue:this.storyTitle,textInputDescription:Resources.DuplicateStoryDialogDescription,textInputCss:"DuplicateStoryDialogTextInput",context:this,onAccept:function(e){var n=t.textEntryDialog.getContent();t.duplicate(n.getText())},allowEsc:!0,label:Resources.DuplicateStoryNewNameInputLabel,textInputTooltip:Resources.DuplicateStoryNewNameInputLabel,acceptButtonTooltip:Resources.DuplicateButtonTooltip};this.textEntryDialog=e.TextInputDialog.createAndShow(n)},o.prototype.duplicate=function(n){var i=this;o.lastDuplicationSucceeded=void 0,t.View.Common.DialogManager.closeCurrentDialog(),e.ProgressDialog.createAndShow(o.dialogTitle);var r={title:n,timezoneOffset:-(new Date).getTimezoneOffset()};$.ajax(t.Common.UrlHelper.getInstance().duplicateStoryUrl(this.lookupId),{name:"DuplicatingStory",description:"Duplicating a story",type:"POST",data:JSON.stringify(r),contentType:t.RequestManager.JsonContentType,dataType:"json",timeout:o.timeout}).then(function(t){i.onDuplicateSuccess(t)},function(t,e,o){i.onDuplicateError(t,n)})},o.prototype.onDuplicateSuccess=function(t){this.onDuplication&&t.storyTile&&this.onDuplication(new e.StoryTileModel(t.storyTile)),this.showSuccess(t)},o.prototype.showSuccess=function(e){t.View.Common.DialogManager.closeCurrentDialog();var i={title:o.dialogTitle,description:o.dialogTitle,noFocus:!1,dialogType:t.View.ViewElements.DialogType.Info,lightDismiss:!0};i.messages=[Resources.DuplicateStoryDialogSuccessMessage],i.buttonsArgs=[],this.myStoriesUrl&&i.buttonsArgs.push({caption:{value:Resources.DuplicateStoryDialogMyStoriesButton},onAction:function(t,e){n.AppBarAction.getInstance().GoToMyStories()},id:"goToMy"}),i.buttonsArgs.push({caption:{value:Resources.DuplicateStoryDialogEditButton},isDefault:!0,onAction:function(t,o){n.UserStories.getInstance().loadStory(e.lookupId,!0)},id:"editNow"}),t.View.Common.DialogManager.createAndShow(i),o.lastDuplicationSucceeded=!0},o.prototype.onDuplicateError=function(e,n){var i=this;if(t.View.Common.DialogManager.closeCurrentDialog(),t.Identity.isPasswordRequiredError(e))t.View.ViewElements.PasswordEntryDialog.createAndShow(this.lookupId,function(){i.duplicate(n)},function(){t.View.Common.DialogManager.closeCurrentDialog()});else{var r={title:o.dialogTitle,description:o.dialogTitle,noFocus:!1,dialogType:t.View.ViewElements.DialogType.Info,lightDismiss:!0,messages:[Resources.DuplicateStoryDialogGenericError],buttonsArgs:[{caption:{value:Resources.ButtonOK},isDefault:!0,dismissOnAction:!0}]};t.View.Common.DialogManager.createAndShow(r),o.lastDuplicationSucceeded=!1}},o.ifLastDuplicationSucceeded=function(){return o.lastDuplicationSucceeded},o.timeout=3e5,o}();e.DuplicateStoryDialog=o}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=t.Common,o=function(o){function i(t,n,i){var r=o.call(this,t,n,null,i)||this;return e.DuplicateStoryDialog.dialogTitle=Resources.EditTemplateDialogTitle,r}return __extends(i,o),i.createAndShow=function(t,e,n,o){new i(t,e,o).show()},i.prototype.show=function(){this.duplicate(this.storyTitle)},i.prototype.showSuccess=function(e){t.View.Common.DialogManager.closeCurrentDialog(),n.UserStories.getInstance().loadStory(e.lookupId,!0)},i}(e.DuplicateStoryDialog);e.EditTemplateDialog=o}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=function(e){function n(t,n){var o=e.call(this,t,n)||this;return o.loadingDeferred=$.Deferred(),o.playerEvents={onError:function(t){return o.onError(t)},onReady:function(){o.loadingDeferred&&o.loadingDeferred.resolve()},onStateChange:function(t){return o.onStateChange(t)}},o.loadPlayer(n.silentFailure),o}return __extends(n,e),n.prototype.onStateChange=function(t){var e=this;if(ActionLogger.RecordClientAction(new ClientAction.YouTubeVideoStateChange("unknown",t.data)),t.data===YT.PlayerState.ENDED){var n=document.webkitFullscreenElement;if(n&&TDB.ViewElement.dataFor(n).parent===this){document.webkitExitFullscreen();var o=function(){removeEventListener("webkitfullscreenchange",o),e.onStateChange(t)};return void addEventListener("webkitfullscreenchange",o)}}t.data===YT.PlayerState.PLAYING?this.onPlayerPlaying():t.data!==YT.PlayerState.PAUSED&&t.data!==YT.PlayerState.ENDED||this.onPlayerPaused()},n.prototype.doLoadPlayer=function(){return void 0===this.loadingDeferred?$.Deferred().reject().promise():this.loadingDeferred.promise()},n.prototype.playerYouTubePlayerCreateArgs=function(t){return{resourceFactory:this.model.resourceFactory,playerCallback:this.playerCallback,playerCallbackContext:this,playerEvents:this.playerEvents,playerEventsContext:this,playerParams:this.model.playerParams,videoId:this.model.getVideoId(t)}},n.prototype.playerYouTubePlayerResizeArgs=function(t){return{width:this.model.getWidth?this.model.getWidth(t):-1,height:this.model.getHeight?this.model.getHeight(t):-1}},n.prototype.playerCallback=function(t){this.player=t},n.prototype.doPlayVideo=function(){this.player.playVideo()},n.prototype.doPauseVideo=function(){this.player.pauseVideo()},n.prototype.onError=function(t){var e="",n="";switch(t.data){case 2:e="The request contains an invalid parameter value.",n="For example, this error occurs if you specify a video ID that does not have 11 characters, or if the video ID contains invalid characters, such as exclamation points or asterisks.";break;case 5:e="The requested content cannot be played in an HTML5 player or another error related to the HTML5 player has occurred.";break;case 100:e="The video requested was not found.",n="This error occurs when a video has been removed (for any reason) or has been marked as private.";break;case 101:e="The owner of the requested video does not allow it to be played in embedded players.",n="See https://apiblog.youtube.com/2011/12/understanding-playback-restrictions.html for more information.";break;case 150:e="The owner of the requested video does not allow it to be played in embedded players.",n="Google indicates this error as the same as 101. See https://apiblog.youtube.com/2011/12/understanding-playback-restrictions.html for more information.";break;default:e="unknown"}this.loadingDeferred&&(this.loadingDeferred.reject(),this.loadingDeferred=void 0),StoryLog.StructuredTraceTag(596476821,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"Youtube player error",{url:this.player&&this.player.getVideoUrl?this.player.getVideoUrl():this.model&&this.model.getVideoId(),data:t.data.toString(),description:e,moreinfo:n})},n.prototype.playerWrapperClassNameArgs=function(t){return this.model.cssName},n.prototype.loadNewVideo=function(e){if(!this.player||!this.player.loadVideoById)throw t.RethrowLogger.createError("Player has not yet been instantiated");this.player.loadVideoById(e)},n.prototype.getVideoDuration=function(){return this.player&&this.loadingDeferred&&"resolved"===this.loadingDeferred.state()?this.player.getDuration():0},n.prototype.isPaused=function(){return!(!this.player||!this.player.getPlayerState)&&this.player.getPlayerState()===YT.PlayerState.PAUSED},n.prototype.isPlaying=function(){return!(!this.player||!this.player.getPlayerState)&&this.player.getPlayerState()===YT.PlayerState.PLAYING},n}(e.ControllableVideoPlayerVE);e.YouTubePlayerVEBase=n}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var FileObject=function(){function t(t,e,n,o){this.blob=t,this.originalName=e,this.name=n,this.type=o}return t.prototype.getName=function(){return this.name},t.prototype.getOriginalName=function(){return this.originalName},t.prototype.getType=function(){return this.type},t.prototype.getBlob=function(){return this.blob},t.prototype.getSize=function(){return this.blob.size},t.prototype.getModelId=function(){return this.modelId},t.prototype.setModelId=function(t){this.modelId=t},t.getExtension=function(t){return t?t.slice(2+(t.lastIndexOf(".")-1>>>0)):""},t.getTypeFromExtension=function(e){if(!e)return"";switch(e.toLowerCase()){case"flac":return t.flacMimeType;default:return""}},t.createFromFile=function(e,n,o){if(void 0===n&&(n=null),void 0===o&&(o=null),!e)return null;var i=n||e.name,r=o||e.type;return r||(r=t.getTypeFromExtension(t.getExtension(i))),new t(e,e.name,i,r)},t.createFromBlob=function(e,n,o){return void 0===o&&(o=null),new t(e,o||n,n,e.type)},t.createFileObjects=function(e){for(var n=[],o=0;o<e.length;o++)n.push(t.createFromFile(e[o]));return n},t.flacMimeType="audio/flac",t}(),StoryApp;!function(t){!function(t){!function(t){var e=function(e){function n(t,n){var o=this;return n.role=n.role||Aria.Roles.Checkbox,o=e.call(this,t,n)||this,o.args=n,o}return __extends(n,e),n.prototype.glyphCheckboxWrapperClassNameArgs=function(t){return this.args.glyphCheckboxWrapperClass?this.args.glyphCheckboxWrapperClass:"glyphCheckboxDefaultWrapper"},n.prototype.checkboxAttrArgs=function(t){var e=this.isChecked.getWatchedValue(t);return this.getCheckboxWrapperAttributes(t,e)},n.prototype.checkboxClassNameArgs=function(t){return"glyphCheckbox "+(this.args.glyphCheckboxClass?this.args.glyphCheckboxClass:"")},n.prototype.backgroundGlyphArgs=function(){return new TDB.ChildArgs(t.GlyphVE,{clipClass:this.args.backgroundClipClass,glyphClass:this.args.backgroundGlyphClass,glyphUrl:this.args.glyphUrl,wrapperClass:{compute:new TDB.ComputedOptionArgs(this,this.getBackgroundGlyphWrapperClass)}})},n.prototype.textClassNameArgs=function(t){return(this.isEnabled(t)?"":"glyphCheckboxTextDisabled ")+(this.args.labelClass?this.args.labelClass:"")},n.prototype.textTextArgs=function(t){return this.args.label},n.prototype.getBackgroundGlyphWrapperClass=function(t){return this.isEnabled(t)?"":"glyphCheckboxBackgroundGlyphWrapperDisabled"},n}(t.CheckboxVE);t.GlyphCheckboxVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.wrapperClassNameArgs=function(t){return this.getButtonClass(t)},e.prototype.labelClassNameArgs=function(t){return"CheckboxVELabel"},e.prototype.labelTextArgs=function(t){return this.getLabel(t)},e.prototype.checkboxCheckedInitArgs=function(){return this.isChecked},e.prototype.checkboxAttrArgs=function(t){return this.getCheckboxWrapperAttributes(t,this.isChecked.getWatchedValue(t))},e}(t.CheckboxVE);t.RegularCheckboxVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=function(n){function o(t,e){var o=n.call(this,t)||this;return o.args=e,o.richTextElementsChecked=e.richTextElementsChecked||[],o.richTextElementsUnchecked=e.richTextElementsUnchecked||[],o.isChecked=e.checkedWatchable||TDB.watchableTag(596476874,o,!!e.checked),o.cssClass=TDB.watchableOption(o,e.cssClass,""),o.checkedIconWrapperClass=TDB.watchableOption(o,e.checkedIconWrapperClass,""),o.uncheckedIconWrapperClass=TDB.watchableOption(o,e.uncheckedIconWrapperClass,""),o.visible=TDB.watchableOption(o,e.visible,!0),o.enabled=TDB.watchableOption(o,e.enabled,!0),o}return __extends(o,n),o.prototype.checkboxArgs=function(){var t={context:this,click:this.onAction,attributes:{compute:new TDB.ComputedOptionArgs(this,this.getCheckboxAttributes)},buttonId:this.args.buttonId,cssClass:{compute:new TDB.ComputedOptionArgs(this,this.checkboxIconWrapperClass)},description:{compute:new TDB.ComputedOptionArgs(this,this.getCheckboxDescription)},fontIconName:this.args.fontIconName,fontIconSizeClass:this.args.fontIconSize,role:this.args.role||Aria.Roles.Checkbox,labeledby:this.messageWrapperId(),tabIndex:this.args.tabIndex,enabled:{watchable:this.enabled}};return void 0!==this.args.tooltipDefault&&null!==this.args.tooltipDefault&&(t.tooltip={watchable:TDB.watchableTag(596476875,this,this.args.tooltipDefault)}),new TDB.ChildArgs(e.GlyphButtonVE,t)},o.prototype.getCheckbox=function(){return this.checkbox},o.prototype.onAction=function(t){var e=this;if(!this.enabled.getValue())return TDB.EventPropagation.Bypass;var n=TDB.asRW(this.isChecked);return n&&TDB.applyUpdate(function(){return n.setValue(!e.isChecked.getValue())}),this.args.context&&this.args.click?this.args.click.call(this.args.context,t):TDB.EventPropagation.Bypass},o.prototype.getChecked=function(t){return this.isChecked.getWatchedValue(t)},o.prototype.setChecked=function(e){var n=TDB.asRW(this.isChecked);if(!n)throw t.RethrowLogger.createError("Cannot set checked since it's a read-only watchable.");n.setValue(e)},o.prototype.isVisible=function(t){return this.visible.getWatchedValue(t)},o.prototype.getCheckboxAttributes=function(t){var e={};return e[Aria.Attributes.Checked]=this.getChecked(t)?Aria.CheckboxState.True:Aria.CheckboxState.False,e},o.prototype.getCheckboxDescription=function(t){var e=this.getChecked(t)?this.args.descriptionChecked:this.args.descriptionUnchecked;return e||this.args.descriptionDefault},o.prototype.wrapperClassNameArgs=function(t){return this.cssClass.getWatchedValue(t)},o.prototype.wrapperAttrArgs=function(t){var e={},n=this.enabled.getWatchedValue(t);return e[ControlAttributes.Attributes.Disabled]=n?ControlAttributes.DisabledState.Enabled:ControlAttributes.DisabledState.Disabled,e[Aria.Attributes.Disabled]=n?void 0:Aria.BooleanState.True,e},o.prototype.ifButtonWrapperArgs=function(t){return this.isVisible(t)},o.prototype.messageWrapperId=function(){return this.args.descriptionChecked||this.args.descriptionUnchecked||this.args.descriptionDefault?void 0:"message_"+this.id},o.prototype.checkboxIconWrapperClass=function(t){return this.getChecked(t)?this.checkedIconWrapperClass.getWatchedValue(t):this.uncheckedIconWrapperClass.getWatchedValue(t)},o.prototype.messagePartsWrapperAttrArgs=function(t){var e={};return e[Aria.Attributes.Id]=this.messageWrapperId(),e},o.prototype.messagePartsWrapperClassNameArgs=function(t){var e="RichCheckboxMessageParts";return this.args.messagePartsWrapperClass&&(e+=" "+this.args.messagePartsWrapperClass),e},o.prototype.messagePartsArgs=function(t){return this.getChecked(t)?this.richTextElementsChecked:this.richTextElementsUnchecked},o.prototype.mouseClicked=function(t){return this.onAction(t)},o}(TDB.FocusableViewElement);e.RichCheckboxVEBase=n}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(e,n){var o=t.call(this,e,{enabled:n.enabled})||this;return o.args=n,o.checked=TDB.watcherTag(596476877,o,o,o.computeChecked),o.buttonId=n.buttonId,o.ulsCategory=n.ulsCategory,o}return __extends(e,t),e.prototype.computeChecked=function(t){return!!this.args.getSelectedRadioButton&&this.args.value===this.args.getSelectedRadioButton.call(this.args.context,t)},e.prototype.hasExplanationArgs=function(){return!!this.args.explanationText},e.prototype.wrapperClassNameArgs=function(){return this.args.wrapperClass},e.prototype.keyDown=function(t){var e=TDB.EventPropagation.Bubble;switch(t.keyCode){case KeyCodeType.EnterKey:case KeyCodeType.SpaceKey:e=this.onAction()}return e},e.prototype.mouseDown=function(t){return 1!=t.which?TDB.EventPropagation.Bypass:(this.isEnabled()&&this.onAction(),TDB.EventPropagation.Bypass)},e.prototype.onAction=function(){return this.args.context&&this.args.click?(this.logButtonClick(),this.args.click.call(this.args.context,this.args.value),TDB.EventPropagation.PreventDefault):TDB.EventPropagation.Bubble},e.prototype.inputClassNameArgs=function(){return this.args.inputClass},e.prototype.labelClassNameArgs=function(){return this.args.labelClass},e.prototype.textClassNameArgs=function(){return this.args.textClass},e.prototype.explanationClassNameArgs=function(){return this.args.explanationTextClass},e.prototype.inputPropsArgs=function(t){var e={};return e.id=this.args.id,e.name=this.args.radioGroupName,e[ControlAttributes.Attributes.Disabled]=this.isEnabled(t)?ControlAttributes.DisabledState.Enabled:ControlAttributes.DisabledState.Disabled,e},e.prototype.labelAttrArgs=function(t){return{for:this.args.id}},e.prototype.textTextArgs=function(){return this.args.text},e.prototype.explanationTextArgs=function(){return this.args.explanationText},e.prototype.inputCheckedInitArgs=function(){return this.checked},e.prototype.isChecked=function(){return this.checked.getValue()},e.prototype.wrapperAttrArgs=function(t){return this.getRadioButtonAttributes(t)},e.prototype.getRadioButtonAttributes=function(t){var e={},n=this.args.description?this.args.description:this.args.text;return e[Aria.Attributes.Role]=Aria.Roles.Radio,this.args.text||(e[Aria.Attributes.Label]=n,e[Aria.Attributes.Title]=n),e[Aria.Attributes.Checked]=this.checked.getWatchedValue(t)?Aria.BooleanState.True:Aria.BooleanState.False,e},e.prototype.logButtonClick=function(){ActionLogger.RecordClientAction(new ClientAction.ButtonClickAction(this.buttonId,this.ulsCategory))},e}(TDB.Control);t.RadioButtonVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e;!function(t){t[t.Initial=0]="Initial",t[t.PressedOnce=1]="PressedOnce",t[t.PressedMultiple=2]="PressedMultiple"}(e||(e={}));var n=function(n){function o(t,o){var i=n.call(this,t,{features:TDB.ControlSetFeatures.TabDisabled|TDB.ControlSetFeatures.TabInto|TDB.ControlSetFeatures.HorizontalList|TDB.ControlSetFeatures.VerticalList|TDB.ControlSetFeatures.PreserveFocusContext})||this;return i.args=o,i.throttlingState=e.Initial,i}return __extends(o,n),o.prototype.radioButtonsArgs=function(){var e=this;return this.args.radioButtons.forEach(function(t){t.radioGroupName!==e.args.radioGroupName&&(t.radioGroupName=e.args.radioGroupName)}),this.args.radioButtons.map(function(e){return new TDB.ChildArgs(t.RadioButtonVE,e)})},o.prototype.onNavigateList=function(t,e,o){var i=n.prototype.onNavigateList.call(this,t,e,o);return this.args.noSelectOnNavigation||this.adjustThrottlingStateOnKeyDown(),i},o.prototype.keyUp=function(t){return this.args.noSelectOnNavigation?TDB.EventPropagation.Bubble:this.activeChild?(this.adjustThrottlingStateOnKeyUp(),TDB.EventPropagation.PreventDefault):TDB.EventPropagation.Bubble},o.prototype.adjustThrottlingStateOnKeyDown=function(){this.throttlingState===e.Initial?(this.throttlingState=e.PressedOnce,this.selectActiveRadioButton()):this.throttlingState===e.PressedOnce&&(this.throttlingState=e.PressedMultiple)},o.prototype.adjustThrottlingStateOnKeyUp=function(){this.throttlingState===e.PressedMultiple&&this.selectActiveRadioButton(),this.throttlingState=e.Initial},o.prototype.activate=function(){if(this.args.noSelectOnNavigation)return n.prototype.activate.call(this);var t=ArrayExtensions.firstOrDefault(this.radioButtons,function(t){return t.isChecked()});return t&&this.setActiveChild(t),n.prototype.activate.call(this)},o.prototype.selectActiveRadioButton=function(){this.activeChild.onAction()},o.prototype.wrapperAttrArgs=function(){var t={};return t.class=this.args.wrapperClass,this.args.titleId&&(t[Aria.Attributes.Labelledby]=this.args.titleId),t},o}(TDB.ControlSet);t.RadioGroupVEBase=n}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){!function(t){t[t.None=0]="None",t[t.SearchHit=1]="SearchHit",t[t.CurrentSearchHit=2]="CurrentSearchHit"}(t.HighlightingType||(t.HighlightingType={}))}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){!function(t){t[t.None=0]="None",t[t.MatchCase=1]="MatchCase",t[t.WholeWord=2]="WholeWord"}(t.SearchOptions||(t.SearchOptions={}))}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(){function t(){}return t}();t.SearchRange=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(){function t(){}return t}();t.SearchResult=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(){function t(){}return t}();t.SearchResults=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(e){function n(t,n){var o=e.call(this,t,{features:TDB.ControlSetFeatures.VerticalList,visible:n.visible,description:n.description,role:Aria.Roles.Menu,getControllingElement:n.getControllingElement})||this;return o.args=n,o}return __extends(n,e),n.prototype.getSearchOptions=function(){var e=t.SearchOptions.None;return this.matchWordsOnlyCheckbox&&this.matchWordsOnlyCheckbox.getChecked()&&(e|=t.SearchOptions.WholeWord),this.matchCaseCheckbox&&this.matchCaseCheckbox.getChecked()&&(e|=t.SearchOptions.MatchCase),e},n.prototype.menuWrapperAttrArgs=function(t){return this.getAriaAttributes(t)},n.prototype.menuWrapperSlideVisibleInitArgs=function(){return!1},n.prototype.menuWrapperSlideVisibleArgs=function(e){var n=this.findParent(t.PageRootVE);return{visible:this.isVisible(e),duration:n.animationDisabled.getWatchedValue(e)?0:void 0}},n.prototype.matchWordsOnlyCheckboxArgs=function(){var e=ResourceManager.resolveWithChildArgs(Resources.ContentSearchWholeWords,[]),n={buttonId:ClientAction.ButtonId.ContentSearch_Options_WholeWord,cssClass:{value:"contentSearchOptionsCheckbox"},checkedIconWrapperClass:{value:"contentSearchOptionsCheckboxChecked"},uncheckedIconWrapperClass:{value:"contentSearchOptionsCheckboxUnchecked"},messagePartsWrapperClass:"contentSearchOptionsCheckboxMessage",fontIconName:{value:FontIcons.CheckboxFontIcon},fontIconSize:FontIcons.CheckboxFontIconSize,richTextElementsUnchecked:e,richTextElementsChecked:e};return new TDB.ChildArgs(t.RichCheckboxVE,n)},n.prototype.matchCaseCheckboxArgs=function(){var e=ResourceManager.resolveWithChildArgs(Resources.ContentSearchMatchCase,[]),n={buttonId:ClientAction.ButtonId.ContentSearch_Options_MatchCase,cssClass:{value:"contentSearchOptionsCheckbox"},checkedIconWrapperClass:{value:"contentSearchOptionsCheckboxChecked"},uncheckedIconWrapperClass:{value:"contentSearchOptionsCheckboxUnchecked"},messagePartsWrapperClass:"contentSearchOptionsCheckboxMessage",fontIconName:{value:FontIcons.CheckboxFontIcon},fontIconSize:FontIcons.CheckboxFontIconSize,richTextElementsUnchecked:e,richTextElementsChecked:e};return new TDB.ChildArgs(t.RichCheckboxVE,n)},n.prototype.handleMouseEvent=function(t,e){return TDB.EventPropagation.PreventDefault},n}(t.PopupBaseVE);t.ContentSearchOptionsMenuVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=t.Common.UrlHelper,o=function(o){function i(t,e){var n=o.call(this,t,TDB.ControlSetFeatures.Isolated|TDB.ControlSetFeatures.AutoEnter,e.activatable)||this;return n.args=e,n.statusText=TDB.watchableTag(596476766,n,null),n.nextEnabled=TDB.watchableTag(596476767,n,!1),n.previousEnabled=TDB.watchableTag(596476768,n,!1),n.currentResult=0,n.searchBoxFocused=TDB.watchableTag(596476769,n,!1),n.optionsMenuVisible=TDB.watchableTag(596476770,n,!1),n.searchInProgress=TDB.watchableTag(596476771,n,!1),n}return __extends(i,o),i.prototype.contentSearchPaneAttrArgs=function(t){var e={};return e[Aria.Attributes.Label]=Resources.ProductNameShort,e},i.prototype.searchFormClassNameArgs=function(t){return"contentSearchForm"+(t.watchValue(this.searchBoxFocused)?" contentSearchFormFocused":"")},i.prototype.searchBoxArgs=function(){var t={cssClass:"contentSearchTextBox contentSearchFocusable",placeholder:{value:Resources.ContentSearchBoxPlaceholder},selectTextOnFocus:!1,description:Resources.ContentSearchBoxDescription,tabIndex:1,domFocus:this.searchBoxFocused,handleKeyDown:this.handleTextBoxKeyDown};return new TDB.ChildArgs(e.TextBoxVE,t)},i.prototype.searchButtonArgs=function(){var t={buttonId:ClientAction.ButtonId.ContentSearch_Search,click:this.executeSearch,context:this,cssClass:{value:"contentSearchExecuteButton contentSearchFocusable"},description:{value:Resources.ContentSearchExecuteSearch},tooltip:{value:Resources.ContentSearchExecuteSearch},fontIconName:{value:FontIcons.SearchIcon},fontIconSizeClass:e.ContentSearchVE.contentSearchIconSizeClass,tabIndex:2};return new TDB.ChildArgs(e.GlyphButtonVE,t)},i.prototype.previousButtonArgs=function(){var t={buttonId:ClientAction.ButtonId.ContentSearch_Previous,click:this.previousResult,context:this,enabled:{watchable:this.previousEnabled},cssClass:{value:"contentSearchPreviousButton contentSearchFocusable"},description:{value:Resources.ContentSearchPrevious},tooltip:{value:Resources.ContentSearchPrevious},fontIconName:{value:FontIcons.NavigateBackIcon},fontIconSizeClass:e.ContentSearchVE.contentSearchIconSizeClass,tabIndex:3};return new TDB.ChildArgs(e.GlyphButtonVE,t)},i.prototype.nextButtonArgs=function(){var t={buttonId:ClientAction.ButtonId.ContentSearch_Next,click:this.nextResult,context:this,enabled:{watchable:this.nextEnabled},cssClass:{value:"contentSearchNextButton contentSearchFocusable"},description:{value:Resources.ContentSearchNext},tooltip:{value:Resources.ContentSearchNext},fontIconName:{value:FontIcons.NavigateForwardIcon},fontIconSizeClass:e.ContentSearchVE.contentSearchIconSizeClass,tabIndex:4};return new TDB.ChildArgs(e.GlyphButtonVE,t)},i.prototype.closeButtonArgs=function(){var t={buttonId:ClientAction.ButtonId.ContentSearch_Close,click:this.closeSearch,context:this,cssClass:{value:"contentSearchCloseButton contentSearchFocusable"},description:{value:Resources.ContentSearchClose},fontIconName:{value:FontIcons.ClosePaneIcon},fontIconSizeClass:e.ContentSearchVE.contentSearchIconSizeClass,tabIndex:5};return new TDB.ChildArgs(e.GlyphButtonVE,t)},i.prototype.optionsButtonArgs=function(){var t={buttonId:ClientAction.ButtonId.AddContent_Search,click:this.showOptions,context:this,description:{value:Resources.ContentSearchShowOptions},tooltip:{value:Resources.ContentSearchShowOptions},cssClass:{value:"contentSearchOptionsButton contentSearchFocusable"},fontIconArgs:{value:{fontIconName:{value:FontIcons.SearchOptionsIcon},fontIconWrapperClass:{value:"StrictSizingFontIconWrapper"},fontIconSizeClass:e.ContentSearchVE.contentSearchIconSizeClass}},tabIndex:6,hasPopup:!0,checkedWatchable:this.optionsMenuVisible};return new TDB.ChildArgs(e.ToggleButtonVE,t)},i.prototype.contentSearchOptionsMenuArgs=function(){var t=this,n={getControllingElement:function(){return t.optionsButton},visible:this.optionsMenuVisible,description:Resources.ContentSearchShowOptions};return new TDB.ChildArgs(e.ContentSearchOptionsMenuVE,n)},i.prototype.searchStatusTextArgs=function(t){return this.statusText.getWatchedValue(t)},i.prototype.searchingSpinnerAttrArgs=function(t){return{src:CommonSettings.ContentBaseUrl+"LoadingBlackSpinner.gif",alt:""}},i.prototype.searchingSpinnerVisibleArgs=function(t){return this.searchInProgress.getWatchedValue(t)},i.prototype.keyDown=function(t){switch(t.keyCode){case KeyCodeType.EnterKey:if(!(t.altKey||t.ctrlKey||t.metaKey))return this.executeSearch(t),TDB.EventPropagation.PreventDefault;break;case KeyCodeType.EscapeKey:if(!(t.altKey||t.ctrlKey||t.metaKey||t.shiftKey))return this.closeSearch(t),TDB.EventPropagation.PreventDefault}return o.prototype.keyDown.call(this,t)},i.prototype.reset=function(){var t=this;TDB.applyUpdate(function(){return t.clearResults()})},i.prototype.contentUpdated=function(){var t=this;TDB.applyUpdate(function(){return t.navigateTo(t.currentResult)})},i.prototype.handleTextBoxKeyDown=function(t){var e=TDB.EventPropagation.Bubble;switch(t.keyCode){case KeyCodeType.UpArrowKey:case KeyCodeType.DownArrowKey:case KeyCodeType.LeftArrowKey:case KeyCodeType.RightArrowKey:case KeyCodeType.SpaceKey:case KeyCodeType.DeleteKey:case KeyCodeType.BackspaceKey:case KeyCodeType.HomeKey:case KeyCodeType.EndKey:e=TDB.EventPropagation.Bypass}return e},i.prototype.closeSearch=function(t){var e=this;return TDB.applyUpdate(function(){return e.clearResults()}),this.args.closed?this.args.closed.call(this.args.context,t):TDB.EventPropagation.Bypass},i.prototype.nextResult=function(t){var e=this;return TDB.applyUpdate(function(){return e.navigateTo(e.currentResult+1)}),TDB.EventPropagation.Bypass},i.prototype.previousResult=function(t){var e=this;return TDB.applyUpdate(function(){return e.navigateTo(e.currentResult-1)}),TDB.EventPropagation.Bypass},i.prototype.executeSearch=function(t){var n=this,o=this.searchBox.getText();if(this.results&&this.searchQuery&&o===this.searchQuery)return t.shiftKey?this.previousResult(t):this.nextResult(t);if(TDB.applyUpdate(function(){return n.clearResults()}),this.searchQuery=o,o&&o.length>0){var i=this.contentSearchOptionsMenu?this.contentSearchOptionsMenu.getSearchOptions():e.SearchOptions.None;this.fetchSearchResults(this.args.lookupId,o,i)}return TDB.EventPropagation.Bypass},i.prototype.showOptions=function(t){var e=this;return this.optionsButton.isChecked.getValue()?(TDB.applyUpdate(function(){return e.clearResults()}),this.contentSearchOptionsMenu.enter()):this.contentSearchOptionsMenu.exit(),TDB.EventPropagation.Bypass},i.prototype.fetchSearchResults=function(e,o,i){var r=this;TDB.applyUpdate(function(){r.setStatus(Resources.ContentSearchInProgress),r.searchInProgress.setValue(!0)}),$.ajax(n.getInstance().getSearchApiUrl(e,o,i),{context:this,type:"GET",contentType:t.RequestManager.JsonContentType,dataType:"json",cache:!1,success:function(t,e,n){r.searchDone(t,e,n)},error:function(t,e,n){r.searchDone(void 0,e,t,n)}})},i.prototype.searchDone=function(t,e,n,o){var i=this;TDB.applyUpdate(function(){i.searchInProgress.setValue(!1),t?(i.results=t,i.navigateTo(0)):i.clearResults(Resources.ContentSearchFailed)})},i.prototype.navigateTo=function(t){if(this.results){var n=!0;if(this.args.onNavigate&&(n=this.args.onNavigate.call(this.args.context)),0===this.results.totalResults)this.setStatus(Resources.ContentSearchNoResults),this.currentResult=0;else{t<0?this.currentResult=this.results.totalResults-1:t>=this.results.totalResults?this.currentResult=0:this.currentResult=t;var o=ResourceManager.ResolveString(Resources.ContentSearchCurrentOfTotal,[this.currentResult+1,this.results.totalResults]);this.setStatus(o)}if(this.setNextEnabled(this.results.totalResults>1),this.setPreviousEnabled(this.results.totalResults>1),this.args.highlighter&&n)for(var i=0;i<this.results.results.length;i++)this.args.highlighter.call(this.args.context,this.results.results[i],i===this.currentResult?e.HighlightingType.CurrentSearchHit:e.HighlightingType.SearchHit)}},i.prototype.setStatus=function(t){this.statusText.setValue(t)},i.prototype.setNextEnabled=function(t){this.nextEnabled.setValue(t)},i.prototype.setPreviousEnabled=function(t){this.previousEnabled.setValue(t)},i.prototype.clearResults=function(t){void 0===t&&(t=null),this.setStatus(t),this.currentResult=0,this.results=void 0,this.searchQuery=void 0,this.setPreviousEnabled(!1),this.setNextEnabled(!1),this.args.highlighter&&this.args.highlighter.call(this.args.context,null,e.HighlightingType.None)},i.otherSearchHitClass="contentSearchOtherHit",i.currentSearchHitClass="contentSearchCurrentHit",i.contentSearchIconSizeClass="fontIconSize20x20",i}(e.RegionViewElement);e.ContentSearchVEBase=o}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(){function t(){}return t}();t.Answer=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(){function t(){}return t}();t.CheckboxAnswer=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){!function(t){t[t.Checkbox=1]="Checkbox"}(t.QuestionType||(t.QuestionType={}));var e=function(t){function e(e,n){var o=t.call(this,e)||this;return o.parent=e,o._args=n,o}return __extends(e,t),e.prototype.getId=function(){return this._args.id},e.prototype.ifQuestionTitleArgs=function(){return!!this._args.question},e.prototype.questionTitleClassNameArgs=function(t){return"SurveyQuestionTitle"},e.prototype.questionTitleTextArgs=function(t){return this._args.question},e.prototype.ifQuestionSubtitleArgs=function(){return!!this._args.questionSubtitle},e.prototype.questionSubtitleClassNameArgs=function(t){return"SurveyQuestionSubtitle"},e.prototype.questionSubtitleTextArgs=function(t){return this._args.questionSubtitle},e.prototype.ifQuestionExplanationArgs=function(){return!!this._args.questionExplanation},e.prototype.questionExplanationClassNameArgs=function(t){return"SurveyQuestionExplanation"},e.prototype.questionExplanationTextArgs=function(t){return this._args.questionExplanation},e}(TDB.FocusableViewElement);t.QuestionVE=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(e){function n(t,n){var o=e.call(this,t,n)||this;return o._args=n,o._hasTwoColumns=n.hasTwoColumns,o}return __extends(n,e),n.prototype.getSelectedValues=function(){var t={};return this._checkboxes&&this._checkboxes.forEach(function(e){t[e.getLabel()]=e.isChecked.getValue()}),t},n.prototype.getTextBoxValue=function(){return this._textBox?this._textBox.getText():""},n.prototype.getAnswer=function(){var e=new t.CheckboxAnswer;return e.checkboxOptions=this.getSelectedValues(),e.textboxValue=this.getTextBoxValue(),e},n.prototype.ifTextBoxArgs=function(){return!!this._args.hasTextBox},n.prototype.textBoxOptionClassNameArgs=function(t){return this._hasTwoColumns?"SurveyQuestionCheckboxTwoColumnsWidth":""},n.prototype.textBoxLabelClassNameArgs=function(t){return"SurveyQuestionTextBoxText"},n.prototype.textBoxLabelTextArgs=function(t){return this._args.textBoxLabel},n.prototype.checkboxOptionsArgs=function(){var e=this;return this._args.checkboxOptions.map(function(n,o){var i={buttonId:ClientAction.ButtonId.Checkbox,text:{value:n},description:{value:n},nativeKeyboardHandling:!0};return i.cssClass=e._args.hasTwoColumns?{value:"SurveyQuestionCheckboxTwoColumnsWidth"}:void 0,i.tabIndex=e._args.tabOrder?e._args.tabOrder[o]:void 0,new TDB.ChildArgs(t.RegularCheckboxVE,i)})},n.prototype.getCheckboxOptions=function(){return this._checkboxes},n.prototype.textBoxArgs=function(){var e=this._args,n={placeholder:{value:e.textBoxPlaceholder},selectTextOnFocus:!0,cssClass:e.textBoxCss?e.textBoxCss:"SurveyQuestionTextBox",maxLength:e.textBoxLength?e.textBoxLength:100,description:e.question||Resources.SurveyQuestionTextBoxDescription};return new TDB.ChildArgs(t.TextBoxVE,n)},n.prototype.getTextBox=function(){return this._textBox},n}(t.QuestionVE);t.CheckboxQuestionVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(e){function n(t,n){var o=e.call(this,t)||this;return o.parent=t,o._args=n,o}return __extends(n,e),n.prototype.errorMessageVisibleArgs=function(t){var e=this._args.errorMessage;return e&&!!e.getWatchedValue(t)},n.prototype.errorMessageTextArgs=function(t){var e=this._args.errorMessage;return e?e.getWatchedValue(t):""},n.prototype.questionBoxesArgs=function(){return this._args.questions.filter(function(e){return e.questionType===t.QuestionType.Checkbox}).map(function(e){return new TDB.ChildArgs(t.CheckboxQuestionVE,e)})},n.prototype.getAnswers=function(){for(var t={},e=0,n=this.questionBoxes;e<n.length;e++){var o=n[e];t[o.getId()]=o.getAnswer()}return t},n.prototype.getQuestionBoxes=function(){return this.questionBoxes},n}(TDB.FocusableViewElement);t.SurveyBoxVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(e,n){var o=t.call(this,e)||this;return o.index=n,o}return __extends(e,t),e.prototype.isSelected=function(t){return this.index===this.parent.getSelectedTabIndex(t)},e.prototype.tabClicked=function(t){return this.parent.tabClicked(this.index),TDB.EventPropagation.Bypass},e.prototype.getIndex=function(){return this.index},e}(TDB.FocusableViewElement);t.TabVE=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(e,n){var o=t.call(this,e,{features:TDB.ControlSetFeatures.HorizontalList|TDB.ControlSetFeatures.VerticalList|TDB.ControlSetFeatures.TabInto|TDB.ControlSetFeatures.TabDisabled|TDB.ControlSetFeatures.PreserveFocusContext})||this;return o.model=n,o}return __extends(e,t),e.prototype.tabsArgs=function(){return this.model.tabsArgs()},e.prototype.tabClicked=function(t){this.model.selectTabIndex(t)},e.prototype.getSelectedTabIndex=function(t){return this.model.getSelectedTabIndex(t)},e.prototype.getNumberOfTabs=function(){return this.model.getNumberOfTabs()},e}(TDB.ControlSet);t.TabHeaderVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=function(){function e(t){this.args=t,this.selectedTabIndex=TDB.watchableTag(596457536,this,-1),this.previouslySelectedTabIndex=-1}return e.prototype.tabsArgs=function(){var t=this;return this.args.tabKeys.map(function(e,n){return t.tabConstructor(n,e)})},e.prototype.selectTabIndex=function(t){this.changeStateOfTabIndex(t),void 0!==this.args.tabSelected&&this.args.tabSelected.call(this.args.context,t)},e.prototype.changeStateOfTabIndex=function(e){var n=this,o=this.args.tabKeys;if(e<0||e>=o.length)throw t.RethrowLogger.createError("Invalid tab index: "+e+"; Number of tabs: "+o.length);this.previouslySelectedTabIndex=this.selectedTabIndex.getValue(),TDB.applyUpdate(function(){n.selectedTabIndex.setValue(e)})},e.prototype.getSelectedTabIndex=function(t){return this.selectedTabIndex.getWatchedValue(t)},e.prototype.getPreviouslySelectedTabIndex=function(){return this.previouslySelectedTabIndex},e.prototype.getNumberOfTabs=function(){return this.args.tabKeys.length},e.prototype.tabConstructor=function(t,e){return this.args.tabConstructor.call(this.args.context,t,e)},e}();e.TabHeaderViewModel=n}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=t.View.ViewElements,o=function(t){function e(e,n){var o=t.call(this,e,n.index)||this;return o._args=n,o}return __extends(e,t),e.prototype.textButtonVEArgs=function(){var t=this,e={};e[Aria.Attributes.Posinset]=(this.getIndex()+1).toString(),e[Aria.Attributes.Setsize]=this.parent.getNumberOfTabs().toString();var o={buttonId:this._args.buttonId?this._args.buttonId:ClientAction.ButtonId.AddContent_ContentSource_TextTab,click:this.tabClicked,context:this,cssClass:{compute:new TDB.ComputedOptionArgs(this,this.textClass)},description:{value:this._args.description},isSelected:function(e){return t.isSelected(e)},text:{value:this._args.text},textClass:"ContentNavRadioButtonLabel",tooltip:{value:this._args.tooltip},role:this._args.role||Aria.Roles.Tab,attributes:{value:e}};return new TDB.ChildArgs(n.TextButtonVE,o)},e.prototype.textClass=function(t){var e=this._args.cssClass;return null==this._args.text&&(""!==e&&(e+=" "),e+="BasicContentPageTabInvisible"),this.isSelected(t)&&(""!==e&&(e+=" "),e+=this._args.selectedClass),e},e}(e.TabVE);e.TextTabVEBase=o}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(n){var o=t.Common,i=function(t){function i(e,n){var o=t.call(this,e)||this;return o.args=n,o}return __extends(i,t),i.prototype.notificationBarWrapperArgs=function(){return n.NotificationBarViewModel.getNotificationBar(this).getViewElementArgs()},i.prototype.getAppBarArgs=function(){var t=[],e=[];return t.push({type:n.AppBarChildType.BuiltIn,label:n.AppBarButtonLabel.Home}),t.push({type:n.AppBarChildType.BuiltIn,label:n.AppBarButtonLabel.DeveloperCdn}),t.push({type:n.AppBarChildType.BuiltIn,label:n.AppBarButtonLabel.InternalFeatures}),e.push({type:n.OverflowMenuChildType.BuiltIn,label:n.OverflowButtonLabel.InternalFeatures,category:n.OverflowMenuCategory.File}),e.push({type:n.OverflowMenuChildType.BuiltIn,label:n.OverflowButtonLabel.PremiumFeatures,category:n.OverflowMenuCategory.File}),CommonSettings.IsAuthenticated?CommonSettings.IsEnabled?o.Environment.getInstance().shouldShowAuthoringEntrypoints()?(t.push({type:n.AppBarChildType.BuiltIn,label:n.AppBarButtonLabel.MyStories}),t.push({type:n.AppBarChildType.BuiltIn,label:n.AppBarButtonLabel.TutorialVideos}),e.push({type:n.OverflowMenuChildType.BuiltIn,label:n.OverflowButtonLabel.MyStories,category:n.OverflowMenuCategory.Navigation}),e.push({type:n.OverflowMenuChildType.BuiltIn,label:n.OverflowButtonLabel.CreateNew,category:n.OverflowMenuCategory.File}),e.push({type:n.OverflowMenuChildType.BuiltIn,label:n.OverflowButtonLabel.Help,category:n.OverflowMenuCategory.Global}),e.push({type:n.OverflowMenuChildType.BuiltIn,label:n.OverflowButtonLabel.User,category:n.OverflowMenuCategory.Global}),e.push({type:n.OverflowMenuChildType.BuiltIn,label:n.OverflowButtonLabel.SignOut,category:n.OverflowMenuCategory.Global})):(t.push({type:n.AppBarChildType.BuiltIn,label:n.AppBarButtonLabel.TutorialVideos}),e.push({type:n.OverflowMenuChildType.BuiltIn,label:n.OverflowButtonLabel.MyStories,category:n.OverflowMenuCategory.Navigation}),e.push({type:n.OverflowMenuChildType.BuiltIn,label:n.OverflowButtonLabel.Help,category:n.OverflowMenuCategory.Global}),e.push({type:n.OverflowMenuChildType.BuiltIn,label:n.OverflowButtonLabel.User,category:n.OverflowMenuCategory.Global}),e.push({type:n.OverflowMenuChildType.BuiltIn,label:n.OverflowButtonLabel.SignOut,category:n.OverflowMenuCategory.Global})):(t.push({type:n.AppBarChildType.BuiltIn,label:n.AppBarButtonLabel.TutorialVideos}),t.push({type:n.AppBarChildType.BuiltIn,label:n.AppBarButtonLabel.User}),e.push({type:n.OverflowMenuChildType.BuiltIn,label:n.OverflowButtonLabel.User,category:n.OverflowMenuCategory.Global}),e.push({type:n.OverflowMenuChildType.BuiltIn,label:n.OverflowButtonLabel.SignOut,category:n.OverflowMenuCategory.Global})):(t.push({type:n.AppBarChildType.BuiltIn,label:n.AppBarButtonLabel.TutorialVideos}),t.push({type:n.AppBarChildType.BuiltIn,label:n.AppBarButtonLabel.SignIn})),{buttons:t,overflowButtons:e,userState:o.UserState.getInstance(),isEditMode:!1,resourceFactory:this.args.resourceFactory}},i.prototype.appBarArgs=function(){var t=this;return new TDB.ChildArgs(n.AppBarVE,this.getAppBarArgs(),function(e){t.appBar=e})},i.prototype.getAppBar=function(){return this.appBar},i.prototype.homeWrapperAttrArgs=function(t){var n={},o=!!e.Common.DialogManager.getCurrentDialog(t);return n[Aria.Attributes.Hidden]=o?Aria.BooleanState.True:void 0,n},i}(TDB.FocusableViewElement);n.PageWithAppBarBaseVE=i}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(e,n){var o=t.call(this,e,{features:TDB.ControlSetFeatures.TabDisabled|TDB.ControlSetFeatures.HorizontalList|TDB.ControlSetFeatures.NoWrappingNavigation|TDB.ControlSetFeatures.PreserveFocusContext|TDB.ControlSetFeatures.TabInto})||this;return o.args=n,o.viewModel=n.viewModel,o}return __extends(e,t),e.prototype.carouselListAttrArgs=function(){var t={};return t[Aria.Attributes.Label]=this.args.description,t[Aria.Attributes.Role]=Aria.Roles.Listbox,t},e.prototype.visibleListItemsArgs=function(t){return this.viewModel.getVisibleOptionsArgsAndTypes(t).map(function(t){return new TDB.ChildArgs(t.optionType,t.optionArgs)})},e.prototype.getListItems=function(){return this.viewModel.args.optionArgsAndTypes},e.prototype.getActivatableChildren=function(){return this.visibleListItems&&this.visibleListItems.filter(function(t){return t.canActivate()})},e.prototype.canActivate=function(){var e=this.getActivatableChildren();return!(!t.prototype.canActivate.call(this)||!e)&&e.length>0},e.prototype.onNavigateList=function(e,n,o){var i=n;if(e===TDB.OffsetOrigin.Current)if(i<0){if(this.activeChild===this.getFirstVisibleOption()&&this.getPreviousOptionsAvailable())return this.showPreviousOptions(),this.setLastVisibleOptionActive(),TDB.EventPropagation.PreventDefault}else if(i>0&&this.activeChild===this.getLastVisibleOption()&&this.getNextOptionsAvailable())return this.showNextOptions(),this.setFirstVisibleOptionActive(),TDB.EventPropagation.PreventDefault;return t.prototype.onNavigateList.call(this,e,n,o)},e.prototype.showNextOptions=function(t){void 0===t&&(t=!1);var e=this.viewModel.getStartIndex()+this.viewModel.getNumColumns();return e<this.viewModel.getOptionsCount()&&this.viewModel.transitionOptions(e),t&&!this.getNextOptionsAvailable()&&this.setLastVisibleOptionActive(),e},e.prototype.showPreviousOptions=function(t){void 0===t&&(t=!1);var e=this.viewModel.getStartIndex();if(0!==e){var n=e-this.viewModel.getNumColumns();return n<0&&(n=0),this.viewModel.transitionOptions(n),t&&!this.getPreviousOptionsAvailable()&&this.setFirstVisibleOptionActive(),n}return e},e.prototype.setFirstVisibleOptionActive=function(){this.setActiveChild(this.getFirstVisibleOption())},e.prototype.setLastVisibleOptionActive=function(){this.setActiveChild(this.getLastVisibleOption())},e.prototype.getAllVisibleOptions=function(){return this.visibleListItems},e.prototype.getFirstVisibleOption=function(){return this.visibleListItems[0]},e.prototype.getLastVisibleOption=function(){return ArrayExtensions.lastOrDefault(this.visibleListItems)},e.prototype.getNumColumns=function(){return this.viewModel.getNumColumns()},e.prototype.getPreviousOptionsAvailable=function(t){return this.viewModel.calcPrevButtonVisible(t)},e.prototype.getNextOptionsAvailable=function(t){return this.viewModel.calcNextButtonVisible(t)},e.prototype.getListLength=function(){return this.viewModel.args.optionArgsAndTypes.length},e}(TDB.ControlSet);t.CarouselListVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=t.Common,o=function(t){function e(e,n){var o=t.call(this,e)||this;return o.args=n,o.startIndex=TDB.watchableTag(596476955,o,0),o.numColumns=TDB.watcherTag(596476956,o,o,o.calculateNumColumns),o.args.optionArgsAndTypes.forEach(function(t,e){t.optionArgs.listIndex||(t.optionArgs.listIndex=e)}),o}return __extends(e,t),e.prototype.calculateNumColumns=function(t){var e=n.Environment.getInstance().getWindowSize(t).w;return e>=1366?4:e>1024?3:2},e.prototype.getVisibleOptionsArgsAndTypes=function(t){var e=this.getOptionsCount(),n=this.getStartIndex(t),o=t.watchValue(this.numColumns);return this.args.optionArgsAndTypes.slice(n,Math.min(e,n+o))},e.prototype.getFirstUnvisitedElement=function(t){return this.startIndex.getWatchedValue(t)+this.numColumns.getWatchedValue(t)-1},e.prototype.setStartIndex=function(t){var e=this;TDB.applyUpdate(function(){e.startIndex.setValue(t)})},e.prototype.getStartIndex=function(t){return this.startIndex.getWatchedValue(t)},e.prototype.getNumColumns=function(){return this.numColumns.getValue()},e.prototype.calcPrevButtonVisible=function(t){return this.getStartIndex(t)>0},e.prototype.calcNextButtonVisible=function(t){var e=this.getOptionsCount();return this.getStartIndex(t)+this.numColumns.getWatchedValue(t)<e},e.prototype.getOptionsCount=function(){return this.args.optionArgsAndTypes.length},e.prototype.transitionOptions=function(t){this.getStartIndex()!==t&&this.setStartIndex(t)},e}(Disposable);e.CarouselListViewModel=o}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(e){function n(n,o){var i=e.call(this,n)||this;if(i.args=o,o.viewModel)i.carouselListViewModel=o.viewModel;else{var r={optionArgsAndTypes:o.optionArgsAndTypes};i.carouselListViewModel=new t.CarouselListViewModel(i,r)}return i}return __extends(n,e),n.prototype.nextClicked=function(t){var e=this.carouselList.showNextOptions(!0);return this.logButtonClick(ClientAction.ButtonId.CarouselNext,e),TDB.EventPropagation.Bypass},n.prototype.previousClicked=function(t){var e=this.carouselList.showPreviousOptions(!0);return this.logButtonClick(ClientAction.ButtonId.CarouselPrevious,e),TDB.EventPropagation.Bypass},n.prototype.carouselWrapperAttrArgs=function(t){var e={};return e[Aria.Attributes.Role]=Aria.Roles.Group,e[Aria.Attributes.Label]=this.args.description,e},n.prototype.carouselWrapperClassNameArgs=function(t){var e="Carousel";return this.args.carouselCssClass&&(e+=" "+this.args.carouselCssClass),e},n.prototype.carouselListArgs=function(){var e=this.args,n={viewModel:this.carouselListViewModel,logString:e.logString,description:e.description};return new TDB.ChildArgs(t.CarouselListVE,n)},n.prototype.previousButtonArgs=function(e){var n=this.carouselListViewModel,o=this.args.previousButtonCssClass;!this.args.hideDisabledNextPreviousButtons||n.calcNextButtonVisible(e)||n.calcPrevButtonVisible(e)||(o+=" HiddenCarouselNextPreviousButton");var i={buttonId:this.args.previousButtonID,click:this.previousClicked,context:this,cssClass:{value:o},description:{value:this.args.previousButtonDescription},tooltip:{value:this.args.previousButtonDescription},fontIconName:{value:FontIcons.CarouselPreviousIcon},fontIconSizeClass:FontIcons.CarouselPreviousIconSize,fontIconWrapperClass:{value:"CarouselNextPreviousButtonIcon"},enabled:{compute:new TDB.ComputedOptionArgs(n,n.calcPrevButtonVisible)}};return new TDB.ChildArgs(t.GlyphButtonVE,i)},n.prototype.nextButtonArgs=function(e){var n=this.carouselListViewModel,o=this.args.nextButtonCssClass;!this.args.hideDisabledNextPreviousButtons||n.calcNextButtonVisible(e)||n.calcPrevButtonVisible(e)||(o+=" HiddenCarouselNextPreviousButton");var i={buttonId:this.args.nextButtonID,click:this.nextClicked,context:this,cssClass:{value:o},description:{value:this.args.nextButtonDescription},tooltip:{value:this.args.nextButtonDescription},fontIconName:{value:FontIcons.CarouselNextIcon},fontIconSizeClass:FontIcons.CarouselNextIconSize,fontIconWrapperClass:{value:"CarouselNextPreviousButtonIcon"},enabled:{compute:new TDB.ComputedOptionArgs(n,n.calcNextButtonVisible)}};return new TDB.ChildArgs(t.GlyphButtonVE,i)},n.prototype.logButtonClick=function(t,e){var n={NewStartIndex:e.toString(),NumVisibleOptions:this.carouselListViewModel.getNumColumns().toString(),NumTotalOptions:this.args.optionArgsAndTypes.length.toString(),CarouselName:this.args.logString};ActionLogger.RecordClientAction(new ClientAction.ButtonClickAction(t,Diag.ULSCat.msoulscat_Story_Style,n))},n}(TDB.FocusableViewElement);t.AccessibleCarouselVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(e){function n(t){var n=e.call(this,t)||this;return n.subTitleText=TDB.watchableTag(596132051,n,""),n}return __extends(n,e),n.prototype.disambiguationWrapperButtonsAttrArgs=function(t){var e={};return e[Aria.Attributes.Label]=Resources.ResultsPanelLabel,e},n.prototype.disambiguationCaptionTextArgs=function(t){return this.subTitleText.getWatchedValue(t)},n.prototype.OutlineDisambiguationPanelWrapperClassNameArgs=function(t){return this.choicesAvailable(t)?"outlineDisambiguationPanelWrapper":"outlineDisambiguationPanelWrapperHidden"},n.prototype.ifDisambiguationPanelArgs=function(t){return this.choicesAvailable(t)},n.prototype.choicesAvailable=function(t){var e=this.parent.choices.getWatchedValue(t);return e&&e.length>0},n.prototype.disambiguationButtonsArgs=function(e){for(var n=[],o=this.parent.choices.getWatchedValue(e),i=o.length,r=0;r<i;r++)n.push(new TDB.ChildArgs(t.TextButtonVE,this.createOutlineDialogDisambiguationButtonVEArgs(o[r])));return n},n.prototype.createOutlineDialogDisambiguationButtonVEArgs=function(t){var e=this;return{buttonId:ClientAction.ButtonId.CreateOutline_DisambiguationOption,cssClass:{value:"outlineDisambiguationButton"},text:{value:t},role:Aria.Roles.Option,click:function(n){return e.parent.sendCreateOutlineRequest(t),TDB.EventPropagation.Bypass}}},n}(t.GridViewPanelVE);t.OutlineDialogDisambiguationPanelVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(e){function n(t,n){var o=e.call(this,t,{features:TDB.ControlSetFeatures.PreserveFocusContext|TDB.ControlSetFeatures.TabInto|TDB.ControlSetFeatures.TabDisabled|TDB.ControlSetFeatures.VerticalList|TDB.ControlSetFeatures.NoWrappingNavigation})||this;return o.args=n,o.dropdownVisible=TDB.watchableTag(596476943,o,!1),o.wrapperClassName=TDB.watchableOption(o,n?n.wrapperClassName:void 0,void 0),o.listItemsArgsWatchable=TDB.watchableOption(o,n?n.listItemsArgs:void 0,[]),o}return __extends(n,e),n.prototype.onOptionInvoked=function(t){return t.getRole()===Aria.Roles.Button?this.toggleDropdownVisible()||this.activateTriggerControl():this.closeDropdown(),!1},n.prototype.toggleDropdownVisible=function(){var t=!this.dropdownVisible.getValue();return this.setDropdownVisibility(t),t},n.prototype.closeDropdown=function(){this.setDropdownVisibility(!1),this.activateTriggerControl()},n.prototype.getDropdownVisibility=function(t){return this.dropdownVisible.getWatchedValue(t)},n.prototype.setDropdownVisibility=function(t,e){var n=this;if(t!==this.dropdownVisible.getValue()){this.preventAutofocus=!!e,TDB.applyUpdate(function(){n.dropdownVisible.setValue(t)});var o=new ClientAction.ButtonClickAction(this.args.dropdownTelemetryId,this.args.ulsCategory,{Opened:t.toString()});ActionLogger.RecordClientAction(o)}},n.prototype.onExiting=function(){e.prototype.onExiting.call(this),this.args&&this.args.hideOnExit&&this.setDropdownVisibility(!1)},n.prototype.activateTriggerControl=function(){this.dropdownButton?this.dropdownButton.activate():this.args.dropdownTriggerControl&&this.args.dropdownTriggerControl.activate()},n.prototype.getActivatableChildren=function(){return this.getDropdownVisibility()?this.listItems&&this.listItems.filter(function(t){return t.canActivate()}):this.dropdownButton&&this.dropdownButton.canActivate()?[this.dropdownButton]:[]},n.prototype.canActivate=function(){var t=this.getActivatableChildren();return!(!e.prototype.canActivate.call(this)||!t)&&t.length>0},n.prototype.getListIndex=function(t,e){return this.listItemsArgsWatchable.getWatchedValue(e).indexOf(t)},n.prototype.getListLength=function(t){return this.listItemsArgsWatchable.getWatchedValue(t).length},n.prototype.keyDown=function(t){var n=this.getDropdownVisibility();switch(t.keyCode){case KeyCodeType.EscapeKey:if(!(t.altKey||t.ctrlKey||t.metaKey)&&n)return this.closeDropdown(),TDB.EventPropagation.PreventDefault;case KeyCodeType.UpArrowKey:case KeyCodeType.DownArrowKey:if(!n)return TDB.EventPropagation.Bubble;default:return e.prototype.keyDown.call(this,t)}},n.prototype.headerTextArgs=function(){return this.args.headerText?this.args.headerText:""},n.prototype.headerAttrArgs=function(){return{id:this.args.headerId}},n.prototype.ifAriaLiveStatusArgs=function(){return!!this.args.statusText},n.prototype.statusTextArgs=function(t){return this.args.statusText?this.args.statusText.getWatchedValue(t):void 0},n.prototype.statusStyleArgs=function(t){return{display:this.statusTextArgs(t)?void 0:"none"}},n.prototype.wrapperClassNameArgs=function(t){return this.wrapperClassName.getWatchedValue(t)||"DropdownListWrapper"},n.prototype.ifReadyToDisplayArgs=function(t){return!this.args.readyToDisplay||this.args.readyToDisplay.getWatchedValue(t)},n.prototype.dropdownButtonArgs=function(){if(this.args.dropdownButtonArgs)return this.args.dropdownButtonArgs.role=Aria.Roles.Button,new TDB.ChildArgs(this.args.listItemType,this.args.dropdownButtonArgs)},n.prototype.listItemsWrapperAttrArgs=function(t){var e={};return e[Aria.Attributes.Role]=Aria.Roles.Menu,e[Aria.Attributes.Labelledby]=this.args.headerId,e[Aria.Attributes.Label]=this.args.headerText,e[Aria.Attributes.Hidden]=this.getDropdownVisibility(t)?Aria.BooleanState.False:Aria.BooleanState.True,e},n.prototype.listItemsArgs=function(t){for(var e=this,n=this.listItemsArgsWatchable.getWatchedValue(t),o=0;o<n.length;o++)n[o].role=Aria.Roles.Menuitemradio;return n.map(function(t){return new TDB.ChildArgs(e.args.listItemType,t)})},n.prototype.listItemsWrapperSlideVisibleInitArgs=function(){return!1},n.prototype.listItemsWrapperSlideVisibleArgs=function(e){var o=this.findParent(t.PageRootVE);return{visible:this.getDropdownVisibility(e),done:this.onDropdownVisible,duration:o.animationDisabled.getWatchedValue(e)?0:n.dropdownSlidingDurationMs}},n.prototype.setFocusToSelectedListItem=function(){if(this.listItems){var t=this.listItems.firstOrDefault(function(t){return t.isSelected()})||this.listItems.first();t&&this.setActiveChild(t)}},n.prototype.onDropdownVisible=function(){this.getDropdownVisibility()&&!this.preventAutofocus&&this.setFocusToSelectedListItem()},n.dropdownSlidingDurationMs=300,n}(TDB.ControlSet);t.DropdownListVEBase=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=CommonBindings.View.Bindings,n=TDB.View.Bindings,o=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;TDB.perfMeasurement("AppBarVE_create",function(){var o=n;n.addChild(new i.CcommandWrapper(o),t,e)})},e}(t.AppBarVEBase);t.AppBarVE=o;var i;!function(t){var o=function(o){function i(t){var e=o.call(this,null)||this;return e._context=t,e}return __extends(i,o),i.prototype._create=function(o,i){var r=this._context,a=document.createElement("div");this.domElement=a,a._context=r,a.id="h_bar",a.setAttribute("role","banner"),a.className="headerNew",this._DynamicMenuBinding=new e.DynamicMenu.Binding(a,o,r,this,r.commandWrapperDynamicMenuChunksArgs),this._WidthWatcherBinding=new e.WidthWatcher.Binding(a,o,r,this,r.commandWrapperWidthWatcherInitArgs()),this._AttrBinding=new n.Attr.Binding(a,o,r,this,r.commandWrapperAttrArgs),this._StyleBinding=new n.Style.Binding(a,o,r,this,r.commandWrapperStyleArgs),this.receivePhaseNotification(TDB.UpdatePhase.ReadWrite);this.addChild(new TDB.NewForeachInstructionVE(r,TDB.immutableWatchable(r.nearButtonsArgs()),"nearButtons"),a,null),this.addChild(new t.C1(r),a,null);var s=r.overflowMenuArgs();s&&this.addChild(new TDB.NewSubTemplateInstructionVE(r,TDB.immutableWatchable(s),"overflowMenu"),a,null),this._addToDom(o,i)},i.prototype.onUpdate=function(t){this._DynamicMenuBinding.update(t),this._AttrBinding.update(t),this._StyleBinding.update(t)},i.prototype.disposeBindings=function(){this._DynamicMenuBinding.dispose(),this._WidthWatcherBinding.dispose()},i}(TDB.ViewElement);t.CcommandWrapper=o;var i=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var n=this._context,o=document.createElement("div");this.domElement=o,o._context=n,o.id="h_farButtons",o.className="headerFarButtonWrapper";this.addChild(new TDB.NewForeachInstructionVE(n,TDB.immutableWatchable(n.farButtonsArgs()),"farButtons"),o,null);var i=n.overflowButtonArgs();i&&this.addChild(new TDB.NewSubTemplateInstructionVE(n,TDB.immutableWatchable(i),"overflowButton"),o,null),this._addToDom(t,e)},e}(TDB.ViewElement);t.C1=i}(i||(i={}));var r=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new a.CifBlockingProgress(n),t,e)},e}(t.BlockingProgressVEBase);t.BlockingProgressVE=r;var a;!function(t){var e=function(e){function n(t){var n=this,o=TDB.watcherTag(4543754,t,null,t.ifBlockingProgressArgs);return(n=e.call(this,o)||this).addResource(o),n._context=t,n}return __extends(n,e),n.prototype.buildChildren=function(e,n){var o=this._context;this.addChild(new t.C1(o),e,n)},n}(TDB.IfInstructionVE);t.CifBlockingProgress=e;var o=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="BlockingProgress",i.setAttribute("role","alertdialog");this.addChild(new t.C2(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C1=o;var i=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="BlockingProgressMessageContainer";this.addChild(new t.CBlockingProgressGif(o),i,null),this.addChild(new t.C3(o),i,null);var r=o.cancelArgs();r&&this.addChild(r.build(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C2=i;var r=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("img");this.domElement=i,i._context=o,this._AttrBinding=new n.Attr.Binding(i,t,o,this,o.BlockingProgressGifAttrArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._AttrBinding.update(t)},e}(TDB.ViewElement);t.CBlockingProgressGif=r;var a=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="BlockingProgressTextContainer";this.addChild(new t.CBlockingProgressTitle(o),i,null),this.addChild(new t.CifHasMessage(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C3=a;var s=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("p");this.domElement=i,i._context=o,i.className="BlockingProgressTitle",this._TextBinding=new n.Text.Binding(i,t,o,this,o.BlockingProgressTitleTextArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._TextBinding.update(t)},e}(TDB.ViewElement);t.CBlockingProgressTitle=s;var l=function(e){function n(t){var n=this,o=TDB.watcherTag(4543754,t,null,t.ifHasMessageArgs);return(n=e.call(this,o)||this).addResource(o),n._context=t,n}return __extends(n,e),n.prototype.buildChildren=function(e,n){var o=this._context;this.addChild(new t.CBlockingProgressMessage(o),e,n)},n}(TDB.IfInstructionVE);t.CifHasMessage=l;var u=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("p");this.domElement=i,i._context=o,i.className="BlockingProgressMessage",this._TextBinding=new n.Text.Binding(i,t,o,this,o.BlockingProgressMessageTextArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._TextBinding.update(t)},e}(TDB.ViewElement);t.CBlockingProgressMessage=u}(a||(a={}));var s=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new l.CcontentSearchPane(n),t,e)},e}(t.ContentSearchVEBase);t.ContentSearchVE=s;var l;!function(t){var o=function(e){function o(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(o,e),o.prototype._create=function(e,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,r.className="contentSearchPane",r.setAttribute("role","search"),this._AttrBinding=new n.Attr.Binding(r,e,i,this,i.contentSearchPaneAttrArgs);this.addChild(new t.C1(i),r,null),this.addChild(new t.C2(i),r,null);var a=i.closeButtonArgs();a&&this.addChild(a.build(i),r,null),this._addToDom(e,o)},o.prototype.onUpdate=function(t){this._AttrBinding.update(t)},o}(TDB.ViewElement);t.CcontentSearchPane=o;var i=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var n=this._context,o=document.createElement("div");this.domElement=o,o._context=n,o.className="contentSearchLeftPadding",this._addToDom(t,e)},e}(TDB.ViewElement);t.C1=i;var r=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="contentSearchMainControls";this.addChild(new t.C3(o),i,null),this.addChild(new t.C4(o),i,null),this.addChild(new t.CsearchForm(o),i,null);var r=o.previousButtonArgs();r&&this.addChild(r.build(o),i,null),(r=o.nextButtonArgs())&&this.addChild(r.build(o),i,null),this.addChild(new t.C5(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C2=r;var a=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var n=this._context,o=document.createElement("div");this.domElement=o,o._context=n,o.className="contentSearchVerticalSeparator contentSearchVerticalSeparatorLeft",this._addToDom(t,e)},e}(TDB.ViewElement);t.C3=a;var s=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var n=this._context,o=document.createElement("div");this.domElement=o,o._context=n,o.className="contentSearchOptionsContainer";var i=n.optionsButtonArgs();i&&this.addChild(new TDB.NewSubTemplateInstructionVE(n,TDB.immutableWatchable(i),"optionsButton"),o,null),(i=n.contentSearchOptionsMenuArgs())&&this.addChild(new TDB.NewSubTemplateInstructionVE(n,TDB.immutableWatchable(i),"contentSearchOptionsMenu"),o,null),this._addToDom(t,e)},e}(TDB.ViewElement);t.C4=s;var l=function(n){function o(t){var e=n.call(this,null)||this;return e._context=t,e}return __extends(o,n),o.prototype._create=function(n,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,n,i,this,i.searchFormClassNameArgs);var a=i.searchBoxArgs();a&&this.addChild(new TDB.NewSubTemplateInstructionVE(i,TDB.immutableWatchable(a),"searchBox"),r,null),this.addChild(new t.CsearchStatus(i),r,null),this.addChild(new t.CsearchingSpinner(i),r,null),(a=i.searchButtonArgs())&&this.addChild(a.build(i),r,null),this._addToDom(n,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t)},o}(TDB.ViewElement);t.CsearchForm=l;var u=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("span");this.domElement=i,i._context=o,i.setAttribute("aria-live","polite"),i.className="contentSearchStatus",this._TextBinding=new n.Text.Binding(i,t,o,this,o.searchStatusTextArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._TextBinding.update(t)},e}(TDB.ViewElement);t.CsearchStatus=u;var c=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("img");this.domElement=i,i._context=o,i.className="contentSearchSpinner",i.setAttribute("role","presentation"),this._VisibleBinding=new n.Visible.Binding(i,t,o,this,o.searchingSpinnerVisibleArgs),this._AttrBinding=new n.Attr.Binding(i,t,o,this,o.searchingSpinnerAttrArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._VisibleBinding.update(t),this._AttrBinding.update(t)},e}(TDB.ViewElement);t.CsearchingSpinner=c;var d=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var n=this._context,o=document.createElement("div");this.domElement=o,o._context=n,o.className="contentSearchVerticalSeparator",this._addToDom(t,e)},e}(TDB.ViewElement);t.C5=d}(l||(l={}));var u=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new c.CmenuWrapper(n),t,e)},e}(t.ContentSearchOptionsMenuVEBase);t.ContentSearchOptionsMenuVE=u;var c;!function(t){var o=function(o){function i(t){var e=o.call(this,null)||this;return e._context=t,e}return __extends(i,o),i.prototype._create=function(o,i){var r=this._context,a=document.createElement("div");this.domElement=a,a._context=r,a.className="contentSearchOptionsMenu",this._SlideVisibleBinding=new e.SlideVisible.Binding(a,o,r,this,r.menuWrapperSlideVisibleInitArgs(),r.menuWrapperSlideVisibleArgs),this._AttrBinding=new n.Attr.Binding(a,o,r,this,r.menuWrapperAttrArgs),this.receivePhaseNotification(TDB.UpdatePhase.ReadWrite);this.addChild(new t.C1(r),a,null),this.addChild(new t.C2(r),a,null),this._addToDom(o,i)},i.prototype.onUpdate=function(t){this._SlideVisibleBinding.update(t),this._AttrBinding.update(t)},i}(TDB.ViewElement);t.CmenuWrapper=o;var i=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var n=this._context,o=document.createElement("div");this.domElement=o,o._context=n,o.setAttribute("role","menuitem");var i=n.matchWordsOnlyCheckboxArgs();i&&this.addChild(new TDB.NewSubTemplateInstructionVE(n,TDB.immutableWatchable(i),"matchWordsOnlyCheckbox"),o,null),this._addToDom(t,e)},e}(TDB.ViewElement);t.C1=i;var r=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var n=this._context,o=document.createElement("div");this.domElement=o,o._context=n,o.setAttribute("role","menuitem");var i=n.matchCaseCheckboxArgs();i&&this.addChild(new TDB.NewSubTemplateInstructionVE(n,TDB.immutableWatchable(i),"matchCaseCheckbox"),o,null),this._addToDom(t,e)},e}(TDB.ViewElement);t.C2=r}(c||(c={}));var d=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new p.CifButtonWrapper(n),t,e)},e}(t.RegularCheckboxVEBase);t.RegularCheckboxVE=d;var p;!function(t){var o=function(e){function n(t){var n=this,o=TDB.watcherTag(4543754,t,null,t.ifButtonWrapperArgs);return(n=e.call(this,o)||this).addResource(o),n._context=t,n}return __extends(n,e),n.prototype.buildChildren=function(e,n){var o=this._context;this.addChild(new t.Cwrapper(o),e,n)},n}(TDB.IfInstructionVE);t.CifButtonWrapper=o;var i=function(o){function i(t){var e=o.call(this,null)||this;return e._context=t,e}return __extends(i,o),i.prototype._create=function(o,i){var r=this._context,a=document.createElement("div");this.domElement=a,a._context=r,this._ClassNameBinding=new e.ClassName.Binding(a,o,r,this,r.wrapperClassNameArgs),this._StyleBinding=new n.Style.Binding(a,o,r,this,r.wrapperStyleArgs);this.addChild(new t.Ccheckbox(r),a,null),this.addChild(new t.Clabel(r),a,null),this._addToDom(o,i)},i.prototype.onUpdate=function(t){this._ClassNameBinding.update(t),this._StyleBinding.update(t)},i}(TDB.ViewElement);t.Cwrapper=i;var r=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("input");this.domElement=i,i._context=o,i.setAttribute("type","checkbox"),this._CheckedBinding=new n.Checked.Binding(i,t,o,this,o.checkboxCheckedInitArgs()),this._FocusableBinding=o.focusableBinding=new n.Focusable.Binding(i,t,o,this,o.FocusableInitArgs()),this._AttrBinding=new n.Attr.Binding(i,t,o,this,o.checkboxAttrArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._CheckedBinding.update(t),this._FocusableBinding.update(t),this._AttrBinding.update(t)},e.prototype.disposeBindings=function(){this._CheckedBinding.dispose(),this._FocusableBinding.dispose(),this._context.focusableBinding=void 0},e}(TDB.ViewElement);t.Ccheckbox=r;var a=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.labelClassNameArgs),this._TextBinding=new n.Text.Binding(r,t,i,this,i.labelTextArgs),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t),this._TextBinding.update(t)},o}(TDB.ViewElement);t.Clabel=a}(p||(p={}));var g=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new h.Cdiv(n),t,e)},e}(t.DivVEBase);t.DivVE=g;var h;!function(t){var o=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.divClassNameArgs),this._StyleBinding=new n.Style.Binding(r,t,i,this,i.divStyleArgs),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t),this._StyleBinding.update(t)},o}(TDB.ViewElement);t.Cdiv=o}(h||(h={}));var m=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new y.C1(n),t,e)},e}(t.DocIngestionFileInputVEBase);t.DocIngestionFileInputVE=m;var y;!function(t){var e=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="docIngestionFileInput";this.addChild(new t.C2(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C1=e;var o=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("form");this.domElement=i,i._context=o,i.id="hCreateNewFromOfficeForm",i.className="hiddenContent",i.setAttribute("method","POST"),i.setAttribute("enctype","multipart/form-data"),i.setAttribute("encoding","multipart/form-data");this.addChild(new t.CinputFilePicker(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C2=o;var i=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("input");this.domElement=i,i._context=o,i.id="officeFileInput",i.setAttribute("type","file"),this._AttrBinding=new n.Attr.Binding(i,t,o,this,o.inputFilePickerAttrArgs),this._AutoUploadBinding=new n.AutoUpload.Binding(i,t,o,this,o.inputFilePickerAutoUploadInitArgs()),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._AttrBinding.update(t)},e.prototype.disposeBindings=function(){this._AutoUploadBinding.dispose()},e}(TDB.ViewElement);t.CinputFilePicker=i}(y||(y={}));var f=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new S.CifWrapper(n),t,e)},e}(t.GlyphVEBase);t.GlyphVE=f;var S;!function(t){var o=function(e){function n(t){var n=this,o=TDB.watcherTag(4543754,t,null,t.ifWrapperArgs);return(n=e.call(this,o)||this).addResource(o),n._context=t,n}return __extends(n,e),n.prototype.buildChildren=function(e,n){var o=this._context;this.addChild(new t.Cwrapper(o),e,n)},n}(TDB.IfInstructionVE);t.CifWrapper=o;var i=function(n){function o(t){var e=n.call(this,null)||this;return e._context=t,e}return __extends(o,n),o.prototype._create=function(n,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,n,i,this,i.wrapperClassNameArgs);this.addChild(new t.Cclip(i),r,null),this._addToDom(n,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t)},o}(TDB.ViewElement);t.Cwrapper=i;var r=function(e){function o(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(o,e),o.prototype._create=function(e,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._AttrBinding=new n.Attr.Binding(r,e,i,this,i.clipAttrArgs),this._DisableDragDropBinding=new n.DisableDragDrop.Binding(r,e,i,this);this.addChild(new t.Cglyph(i),r,null),this._addToDom(e,o)},o.prototype.onUpdate=function(t){this._AttrBinding.update(t)},o.prototype.disposeBindings=function(){this._DisableDragDropBinding.dispose()},o}(TDB.ViewElement);t.Cclip=r;var a=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("img");this.domElement=i,i._context=o,this._AttrBinding=new n.Attr.Binding(i,t,o,this,o.glyphAttrArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._AttrBinding.update(t)},e}(TDB.ViewElement);t.Cglyph=a}(S||(S={}));var C=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new v.CifButtonWrapper(n),t,e)},e}(t.GlyphButtonVEBase);t.GlyphButtonVE=C;var v;!function(t){var o=function(e){function n(t){var n=this,o=TDB.watcherTag(4543754,t,null,t.ifButtonWrapperArgs);return(n=e.call(this,o)||this).addResource(o),n._context=t,n}return __extends(n,e),n.prototype.buildChildren=function(e,n){var o=this._context;this.addChild(new t.Cwrapper(o),e,n)},n}(TDB.IfInstructionVE);t.CifButtonWrapper=o;var i=function(o){function i(t){var e=o.call(this,null)||this;return e._context=t,e}return __extends(i,o),i.prototype._create=function(o,i){var r=this._context,a=document.createElement("button");this.domElement=a,a._context=r,this._FocusableBinding=r.focusableBinding=new n.Focusable.Binding(a,o,r,this,r.FocusableInitArgs()),this._ClassNameBinding=new e.ClassName.Binding(a,o,r,this,r.wrapperClassNameArgs),this._StyleBinding=new n.Style.Binding(a,o,r,this,r.wrapperStyleArgs),this._AttrBinding=new n.Attr.Binding(a,o,r,this,r.wrapperAttrArgs),this._PropsBinding=new n.Props.Binding(a,o,r,this,r.wrapperPropsArgs);this.addChild(new t.CglyphWrapper(r),a,null),this.addChild(new t.CincludeLabelText(r),a,null),this._addToDom(o,i)},i.prototype.onUpdate=function(t){this._FocusableBinding.update(t),this._ClassNameBinding.update(t),this._StyleBinding.update(t),this._AttrBinding.update(t),this._PropsBinding.update(t)},i.prototype.disposeBindings=function(){this._FocusableBinding.dispose(),this._context.focusableBinding=void 0},i}(TDB.ViewElement);t.Cwrapper=i;var r=function(o){function i(t){var e=o.call(this,null)||this;return e._context=t,e}return __extends(i,o),i.prototype._create=function(o,i){var r=this._context,a=document.createElement("div");this.domElement=a,a._context=r,this._StyleBinding=new n.Style.Binding(a,o,r,this,r.glyphWrapperStyleArgs),this._ClassNameBinding=new e.ClassName.Binding(a,o,r,this,r.glyphWrapperClassNameArgs);this.addChild(new t.C1(r),a,null),this._addToDom(o,i)},i.prototype.onUpdate=function(t){this._StyleBinding.update(t),this._ClassNameBinding.update(t)},i}(TDB.ViewElement);t.CglyphWrapper=r;var a=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="flexCenter";this.addChild(new t.CfontIconPresent(o),i,null),o.ifGlyphTextArgs()&&this.addChild(new t.CglyphText(o),i,null),this.addChild(new t.CifShowShortcut(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C1=a;var s=function(t){function e(e){var n=this,o=TDB.watcherTag(4519824,e,null,e.fontIconPresentArgs);return(n=t.call(this,o)||this).addResource(o),n._context=e,n}return __extends(e,t),e.prototype.buildChildren=function(t,e,n){var o=this._context;switch(t){case!0:(i=o.fontIconVEArgs())&&this.addChild(i.build(o),e,n);break;case!1:var i=o.glyphVEArgs();i&&this.addChild(i.build(o),e,n)}},e}(TDB.SwitchInstructionVE);t.CfontIconPresent=s;var l=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._TextBinding=new n.Text.Binding(r,t,i,this,i.glyphTextTextArgs),this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.glyphTextClassNameArgs),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._TextBinding.update(t),this._ClassNameBinding.update(t)},o}(TDB.ViewElement);t.CglyphText=l;var u=function(e){function n(t){var n=this,o=TDB.watcherTag(4543754,t,null,t.ifShowShortcutArgs);return(n=e.call(this,o)||this).addResource(o),n._context=t,n}return __extends(n,e),n.prototype.buildChildren=function(e,n){var o=this._context;this.addChild(new t.CshortcutLabel(o),e,n)},n}(TDB.IfInstructionVE);t.CifShowShortcut=u;var c=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="ShortcutLabelText",this._TextBinding=new n.Text.Binding(i,t,o,this,o.shortcutLabelTextArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._TextBinding.update(t)},e}(TDB.ViewElement);t.CshortcutLabel=c;var d=function(e){function n(t){var n=this,o=TDB.watcherTag(4543754,t,null,t.includeLabelTextArgs);return(n=e.call(this,o)||this).addResource(o),n._context=t,n}return __extends(n,e),n.prototype.buildChildren=function(e,n){var o=this._context;this.addChild(new t.Ctext(o),e,n)},n}(TDB.IfInstructionVE);t.CincludeLabelText=d;var p=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.textClassNameArgs),this._TextBinding=new n.Text.Binding(r,t,i,this,i.textTextArgs),this._StyleBinding=new n.Style.Binding(r,t,i,this,i.textStyleArgs),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t),this._TextBinding.update(t),this._StyleBinding.update(t)},o}(TDB.ViewElement);t.Ctext=p}(v||(v={}));var _=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new v.CifButtonWrapper(n),t,e)},e}(t.VideoGlyphButtonVEBase);t.VideoGlyphButtonVE=_;var w=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new T.CglyphCheckboxWrapper(n),t,e)},e}(t.GlyphCheckboxVEBase);t.GlyphCheckboxVE=w;var T;!function(t){var o=function(n){function o(t){var e=n.call(this,null)||this;return e._context=t,e}return __extends(o,n),o.prototype._create=function(n,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,n,i,this,i.glyphCheckboxWrapperClassNameArgs);this.addChild(new t.Ccheckbox(i),r,null),this.addChild(new t.Ctext(i),r,null),this._addToDom(n,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t)},o}(TDB.ViewElement);t.CglyphCheckboxWrapper=o;var i=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._AttrBinding=new n.Attr.Binding(r,t,i,this,i.checkboxAttrArgs),this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.checkboxClassNameArgs),this._FocusableBinding=i.focusableBinding=new n.Focusable.Binding(r,t,i,this,i.FocusableInitArgs());var a=i.backgroundGlyphArgs();a&&this.addChild(a.build(i),r,null),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._AttrBinding.update(t),this._ClassNameBinding.update(t),this._FocusableBinding.update(t)},o.prototype.disposeBindings=function(){this._FocusableBinding.dispose(),this._context.focusableBinding=void 0},o}(TDB.ViewElement);t.Ccheckbox=i;var r=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.textClassNameArgs),this._TextBinding=new n.Text.Binding(r,t,i,this,i.textTextArgs),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t),this._TextBinding.update(t)},o}(TDB.ViewElement);t.Ctext=r}(T||(T={}));var A=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;TDB.perfMeasurement("HomeButtonVE_create",function(){var o=n;n.addChild(new D.C1(o),t,e)})},e}(t.HomeButtonVEBase);t.HomeButtonVE=A;var D;!function(t){var e=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="homeButtonWrapper";var r=o.appSwitcherButtonArgs();r&&this.addChild(new TDB.NewSubTemplateInstructionVE(o,TDB.immutableWatchable(r),"appSwitcherButton"),i,null),this.addChild(new t.C2(o),i,null);var a=TDB.watcherTag(17323653,o,null,o.homeLinkArgs),s=new TDB.NewSubTemplateInstructionVE(o,a);s.addResource(a),this.addChild(s,i,null),(r=o.appSwitcherArgs())&&this.addChild(new TDB.NewSubTemplateInstructionVE(o,TDB.immutableWatchable(r),"appSwitcher"),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C1=e;var n=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var n=this._context,o=document.createElement("div");this.domElement=o,o._context=n,o.className="pipeNear",this._addToDom(t,e)},e}(TDB.ViewElement);t.C2=n}(D||(D={}));var B=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new I.CifButtonWrapper(n),t,e)},e}(t.LinkButtonVEBase);t.LinkButtonVE=B;var I;!function(t){var o=function(e){function n(t){var n=this,o=TDB.watcherTag(4543754,t,null,t.ifButtonWrapperArgs);return(n=e.call(this,o)||this).addResource(o),n._context=t,n}return __extends(n,e),n.prototype.buildChildren=function(e,n){var o=this._context;this.addChild(new t.Clink(o),e,n)},n}(TDB.IfInstructionVE);t.CifButtonWrapper=o;var i=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("a");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.linkClassNameArgs),this._AttrBinding=new n.Attr.Binding(r,t,i,this,i.linkAttrArgs),this._FocusableBinding=i.focusableBinding=new n.Focusable.Binding(r,t,i,this,i.FocusableInitArgs());var a=i.iconArgs();a&&this.addChild(a.build(i),r,null);var s=TDB.watcherTag(17323653,i,null,i.contentArgs),l=new TDB.NewSubTemplateInstructionVE(i,s);l.addResource(s),this.addChild(l,r,null),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t),this._AttrBinding.update(t),this._FocusableBinding.update(t)},o.prototype.disposeBindings=function(){this._FocusableBinding.dispose(),this._context.focusableBinding=void 0},o}(TDB.ViewElement);t.Clink=i}(I||(I={}));var b=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new E.CifLoadingMessage(n),t,e)},e}(t.LoadingMessageVEBase);t.LoadingMessageVE=b;var E;!function(t){var o=function(e){function n(t){var n=this,o=TDB.watcherTag(4543754,t,null,t.ifLoadingMessageArgs);return(n=e.call(this,o)||this).addResource(o),n._context=t,n}return __extends(n,e),n.prototype.buildChildren=function(e,n){var o=this._context;this.addChild(new t.CloadingMessageContainer(o),e,n)},n}(TDB.IfInstructionVE);t.CifLoadingMessage=o;var i=function(n){function o(t){var e=n.call(this,null)||this;return e._context=t,e}return __extends(o,n),o.prototype._create=function(n,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,n,i,this,i.loadingMessageContainerClassNameArgs);this.addChild(new t.C1(i),r,null),this._addToDom(n,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t)},o}(TDB.ViewElement);t.CloadingMessageContainer=i;var r=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="LoadingMessageWrapper";this.addChild(new t.Canimation(o),i,null),this.addChild(new t.Ctext(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C1=r;var a=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("img");this.domElement=i,i._context=o,i.className="LoadingDots",this._AttrBinding=new n.Attr.Binding(i,t,o,this,o.animationAttrArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._AttrBinding.update(t)},e}(TDB.ViewElement);t.Canimation=a;var s=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,r.setAttribute("aria-live","polite"),r.setAttribute("aria-atomic","true"),this._TextBinding=new n.Text.Binding(r,t,i,this,i.textTextArgs),this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.textClassNameArgs),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._TextBinding.update(t),this._ClassNameBinding.update(t)},o}(TDB.ViewElement);t.Ctext=s}(E||(E={}));var x=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new P.Cwrapper(n),t,e)},e}(t.NotificationVEBase);t.NotificationVE=x;var P;!function(t){var o=function(o){function i(t){var e=o.call(this,null)||this;return e._context=t,e}return __extends(i,o),i.prototype._create=function(o,i){var r=this._context,a=document.createElement("div");this.domElement=a,a._context=r,this._SlideVisibleBinding=new e.SlideVisible.Binding(a,o,r,this,r.wrapperSlideVisibleInitArgs(),r.wrapperSlideVisibleArgs),this._ClassNameBinding=new e.ClassName.Binding(a,o,r,this,r.wrapperClassNameArgs),this._AttrBinding=new n.Attr.Binding(a,o,r,this,r.wrapperAttrArgs),this.receivePhaseNotification(TDB.UpdatePhase.ReadWrite);this.addChild(new t.CnotificationContent(r),a,null),this.addChild(new t.CnotificationPadding(r),a,null),this.addChild(new t.C1(r),a,null),this._addToDom(o,i)},i.prototype.onUpdate=function(t){this._SlideVisibleBinding.update(t),this._ClassNameBinding.update(t),this._AttrBinding.update(t)},i}(TDB.ViewElement);t.Cwrapper=o;var i=function(t){function n(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(n,t),n.prototype._create=function(t,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,this._ClassNameBinding=new e.ClassName.Binding(i,t,o,this,o.notificationContentClassNameArgs),this._OverflowBinding=o.notificationContentOverflowBinding=new e.Overflow.Binding(i,t,o,this,o.notificationContentOverflowInitArgs(),o.notificationContentOverflowArgs),this.receivePhaseNotification(TDB.UpdatePhase.ReadWrite);var r=TDB.watcherTag(17323652,o,null,o.notificationMessageArgs),a=new TDB.NewForeachInstructionVE(o,r);a.addResource(r),this.addChild(a,i,null),this._addToDom(t,n)},n.prototype.onUpdate=function(t){this._ClassNameBinding.update(t),this._OverflowBinding.update(t)},n.prototype.disposeBindings=function(){this._OverflowBinding.dispose(),this._context.notificationContentOverflowBinding=void 0},n}(TDB.ViewElement);t.CnotificationContent=i;var r=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,this._StyleBinding=new n.Style.Binding(i,t,o,this,o.notificationPaddingStyleArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._StyleBinding.update(t)},e}(TDB.ViewElement);t.CnotificationPadding=r;var a=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var n=this._context,o=document.createElement("div");this.domElement=o,o._context=n,o.className="NotificationBarButtonsWrapper";var i=TDB.watcherTag(17323653,n,null,n.seeMoreButtonArgs),r=new TDB.NewSubTemplateInstructionVE(n,i,"seeMoreButton");r.addResource(i),this.addChild(r,o,null);var a=TDB.watcherTag(17323652,n,null,n.rightButtonsArgs),s=new TDB.NewForeachInstructionVE(n,a);s.addResource(a),this.addChild(s,o,null),this._addToDom(t,e)},e}(TDB.ViewElement);t.C1=a}(P||(P={}));var R=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;TDB.perfMeasurement("OverflowMenuVE_create",function(){var o=n;n.addChild(new L.Cwrapper(o),t,e)})},e}(t.OverflowMenuVEBase);t.OverflowMenuVE=R;var L;!function(t){var o=function(o){function i(t){var e=o.call(this,null)||this;return e._context=t,e}return __extends(i,o),i.prototype._create=function(o,i){var r=this._context,a=document.createElement("div");this.domElement=a,a._context=r,this._AttrBinding=new n.Attr.Binding(a,o,r,this,r.wrapperAttrArgs),this._SlideVisibleBinding=new e.SlideVisible.Binding(a,o,r,this,r.wrapperSlideVisibleInitArgs(),r.wrapperSlideVisibleArgs),this._ClassNameBinding=new e.ClassName.Binding(a,o,r,this,r.wrapperClassNameArgs),this._StyleBinding=new n.Style.Binding(a,o,r,this,r.wrapperStyleArgs),this.receivePhaseNotification(TDB.UpdatePhase.ReadWrite);if(this.addChild(new t.CifLastSyncTime(r),a,null),r.showOverflowItemsArgs()){for(var s=(u=r.overflowMenuItemsArgs()).length,l=0;l<s;++l)this.addChild(u[l].build(r),a,null);this.addChild(new t.C1(r),a,null)}if(r.showNavItemsArgs()){for(var s=(u=r.navMenuItemsArgs()).length,l=0;l<s;++l)this.addChild(u[l].build(r),a,null);this.addChild(new t.C1(r),a,null)}if(r.showFileItemsArgs()){for(var s=(u=r.fileMenuItemsArgs()).length,l=0;l<s;++l)this.addChild(u[l].build(r),a,null);this.addChild(new t.C1(r),a,null)}if(r.showSettingsItemsArgs()){for(var s=(u=r.settingsMenuItemsArgs()).length,l=0;l<s;++l)this.addChild(u[l].build(r),a,null);this.addChild(new t.C1(r),a,null)}if(r.showGlobalItemsArgs())for(var s=(u=r.globalMenuItemsArgs()).length,l=0;l<s;++l)this.addChild(u[l].build(r),a,null);if(r.showRecycleBinItemsArgs())for(var u=r.recycleBinMenuItemsArgs(),s=u.length,l=0;l<s;++l)this.addChild(u[l].build(r),a,null);r.showDownloadArgs()&&this.addChild(new t.CdownloadContainer(r),a,null),r.showPrintArgs()&&this.addChild(new t.CprintContainer(r),a,null),this._addToDom(o,i)},i.prototype.onUpdate=function(t){this._AttrBinding.update(t),this._SlideVisibleBinding.update(t),this._ClassNameBinding.update(t),this._StyleBinding.update(t)},i}(TDB.ViewElement);t.Cwrapper=o;var i=function(e){function n(t){var n=this,o=TDB.watcherTag(4543754,t,null,t.ifLastSyncTimeArgs);return(n=e.call(this,o)||this).addResource(o),n._context=t,n}return __extends(n,e),n.prototype.buildChildren=function(e,n){var o=this._context;this.addChild(new t.ClastSyncTime(o),e,n)},n}(TDB.IfInstructionVE);t.CifLastSyncTime=i;var r=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="overflowLastSyncTime",i.setAttribute("role","menuitem"),this._TextBinding=new n.Text.Binding(i,t,o,this,o.lastSyncTimeTextArgs),this._AttrBinding=new n.Attr.Binding(i,t,o,this,o.lastSyncTimeAttrArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._TextBinding.update(t),this._AttrBinding.update(t)},e}(TDB.ViewElement);t.ClastSyncTime=r;var a=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var n=this._context,o=document.createElement("div");this.domElement=o,o._context=n,o.className="overflowSeperator",this._addToDom(t,e)},e}(TDB.ViewElement);t.C1=a;var s=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,this._AutoDownloadBinding=new n.AutoDownload.Binding(i,t,o,this,o.downloadContainerAutoDownloadInitArgs()),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._AutoDownloadBinding.update(t)},e}(TDB.ViewElement);t.CdownloadContainer=s;var l=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,this._AutoPrintBinding=new n.AutoPrint.Binding(i,t,o,this,o.printContainerAutoPrintInitArgs()),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._AutoPrintBinding.update(t)},e}(TDB.ViewElement);t.CprintContainer=l}(L||(L={}));var V=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new U.CifVisualLinkSpinner(n),t,e),this.addChild(new U.CifVisualLinkError(n),t,e),this.addChild(new U.CifVisualLinkContent(n),t,e)},e}(t.VisualLinkVEBase);t.VisualLinkVE=V;var U;!function(t){var e=function(e){function n(t){var n=this,o=TDB.watcherTag(4543754,t,null,t.ifVisualLinkSpinnerArgs);return(n=e.call(this,o)||this).addResource(o),n._context=t,n}return __extends(n,e),n.prototype.buildChildren=function(e,n){var o=this._context;this.addChild(new t.C1(o),e,n)},n}(TDB.IfInstructionVE);t.CifVisualLinkSpinner=e;var o=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="visualLinkPlaceholder";this.addChild(new t.CvisualLinkSpinner(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C1=o;var i=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("img");this.domElement=i,i._context=o,i.setAttribute("role","progressbar"),i.className="visualLinkSpinner",i.setAttribute("aria-busy","true"),this._AttrBinding=new n.Attr.Binding(i,t,o,this,o.visualLinkSpinnerAttrArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._AttrBinding.update(t)},e}(TDB.ViewElement);t.CvisualLinkSpinner=i;var r=function(e){function n(t){var n=this,o=TDB.watcherTag(4543754,t,null,t.ifVisualLinkErrorArgs);return(n=e.call(this,o)||this).addResource(o),n._context=t,n}return __extends(n,e),n.prototype.buildChildren=function(e,n){var o=this._context;this.addChild(new t.C2(o),e,n)},n}(TDB.IfInstructionVE);t.CifVisualLinkError=r;var a=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="visualLinkPlaceholder";this.addChild(new t.CerrorMessage(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C2=a;var s=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="visualLinkErrorText",this._TextBinding=new n.Text.Binding(i,t,o,this,o.errorMessageTextArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._TextBinding.update(t)},e}(TDB.ViewElement);t.CerrorMessage=s;var l=function(e){function n(t){var n=this,o=TDB.watcherTag(4543754,t,null,t.ifVisualLinkContentArgs);return(n=e.call(this,o)||this).addResource(o),n._context=t,n}return __extends(n,e),n.prototype.buildChildren=function(e,n){var o=this._context;this.addChild(new t.CvisualLink(o),e,n),this.addChild(new t.CvisualLinkOverlay(o),e,n)},n}(TDB.IfInstructionVE);t.CifVisualLinkContent=l;var u=function(e){function o(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(o,e),o.prototype._create=function(e,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._AttrBinding=new n.Attr.Binding(r,e,i,this,i.visualLinkAttrArgs);this.addChild(new t.C3(i),r,null),this._addToDom(e,o)},o.prototype.onUpdate=function(t){this._AttrBinding.update(t)},o}(TDB.ViewElement);t.CvisualLink=u;var c=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="visualLinkContent",i.setAttribute("style","text-align: center;");this.addChild(new t.CvisualLinkTable(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C3=c;var d=function(e){function o(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(o,e),o.prototype._create=function(e,o){var i=this._context,r=document.createElement("table");this.domElement=r,r._context=i,r.className="visualLinkTable",r.setAttribute("cellpadding","0"),r.setAttribute("cellspacing","0"),r.setAttribute("border","0"),r.setAttribute("style","border: 1px solid #D2D2D2; margin: auto; width: 600px;"),this._AttrBinding=new n.Attr.Binding(r,e,i,this,i.visualLinkTableAttrArgs);this.addChild(new t.CifVisualLinkImageRow(i),r,null),this.addChild(new t.CifVisualLinkTitleRow(i),r,null),this.addChild(new t.CifVisualLinkDescriptionRow(i),r,null),this.addChild(new t.C9(i),r,null),this._addToDom(e,o)},o.prototype.onUpdate=function(t){this._AttrBinding.update(t)},o}(TDB.ViewElement);t.CvisualLinkTable=d;var p=function(e){function n(t){var n=this,o=TDB.watcherTag(4543754,t,null,t.ifVisualLinkImageRowArgs);return(n=e.call(this,o)||this).addResource(o),n._context=t,n}return __extends(n,e),n.prototype.buildChildren=function(e,n){var o=this._context;this.addChild(new t.C4(o),e,n)},n}(TDB.IfInstructionVE);t.CifVisualLinkImageRow=p;var g=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("tr");this.domElement=i,i._context=o,i.className="visualLinkImageRow",i.setAttribute("aria-hidden","true");this.addChild(new t.C5(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C4=g;var h=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("td");this.domElement=i,i._context=o,i.setAttribute("align","center");this.addChild(new t.CthumbnailLink(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C5=h;var m=function(e){function o(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(o,e),o.prototype._create=function(e,o){var i=this._context,r=document.createElement("a");this.domElement=r,r._context=i,r.setAttribute("target","_blank"),r.setAttribute("rel","nofollow noreferrer"),this._AttrBinding=new n.Attr.Binding(r,e,i,this,i.thumbnailLinkAttrArgs);this.addChild(new t.CthumbnailImg(i),r,null),this._addToDom(e,o)},o.prototype.onUpdate=function(t){this._AttrBinding.update(t)},o}(TDB.ViewElement);t.CthumbnailLink=m;var y=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("img");this.domElement=i,i._context=o,i.className="visualLinkImage",this._AttrBinding=new n.Attr.Binding(i,t,o,this,o.thumbnailImgAttrArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._AttrBinding.update(t)},e}(TDB.ViewElement);t.CthumbnailImg=y;var f=function(e){function n(t){var n=this,o=TDB.watcherTag(4543754,t,null,t.ifVisualLinkTitleRowArgs);return(n=e.call(this,o)||this).addResource(o),n._context=t,n}return __extends(n,e),n.prototype.buildChildren=function(e,n){var o=this._context;this.addChild(new t.C6(o),e,n)},n}(TDB.IfInstructionVE);t.CifVisualLinkTitleRow=f;var S=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("tr");this.domElement=i,i._context=o,i.className="visualLinkTitleRow",i.setAttribute("aria-labelledby","visualLinkTitle");this.addChild(new t.C7(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C6=S;var C=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("td");this.domElement=i,i._context=o,i.className="visualLinkTitleCell",i.setAttribute("style","padding: 13px 20px 0px 20px; text-align: center; vertical-align: top;"),i.setAttribute("aria-hidden","true");this.addChild(new t.CtitleLink(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C7=C;var v=function(e){function o(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(o,e),o.prototype._create=function(e,o){var i=this._context,r=document.createElement("a");this.domElement=r,r._context=i,r.setAttribute("style","text-decoration: none; text-underline: none;"),r.setAttribute("target","_blank"),r.setAttribute("rel","nofollow noreferrer"),this._AttrBinding=new n.Attr.Binding(r,e,i,this,i.titleLinkAttrArgs);this.addChild(new t.Ctitle(i),r,null),this._addToDom(e,o)},o.prototype.onUpdate=function(t){this._AttrBinding.update(t)},o}(TDB.ViewElement);t.CtitleLink=v;var _=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("span");this.domElement=i,i._context=o,i.className="visualLinkTitle",i.setAttribute("style","color: #424242; font-size: 21px; line-height: 28px; font-family: 'Segoe UI Semilight', 'Segoe UI', Helvetica, Tahoma, Geneva, Verdana, sans-serif;           text-decoration: none; text-underline: none;"),this._TextBinding=new n.Text.Binding(i,t,o,this,o.titleTextArgs),this._AttrBinding=new n.Attr.Binding(i,t,o,this,o.titleAttrArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._TextBinding.update(t),this._AttrBinding.update(t)},e}(TDB.ViewElement);t.Ctitle=_;var w=function(e){function n(t){var n=this,o=TDB.watcherTag(4543754,t,null,t.ifVisualLinkDescriptionRowArgs);return(n=e.call(this,o)||this).addResource(o),n._context=t,n}return __extends(n,e),n.prototype.buildChildren=function(e,n){var o=this._context;this.addChild(new t.C8(o),e,n)},n}(TDB.IfInstructionVE);t.CifVisualLinkDescriptionRow=w;var T=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("tr");this.domElement=i,i._context=o,i.className="visualLinkDescriptionRow",i.setAttribute("aria-labelledby","visualLinkDescription");this.addChild(new t.CdescriptionCell(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C8=T;var A=function(e){function o(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(o,e),o.prototype._create=function(e,o){var i=this._context,r=document.createElement("td");this.domElement=r,r._context=i,r.className="visualLinkDescriptionCell",r.setAttribute("style","padding: 13px 20px 0px 20px; vertical-align: top; text-align: left;"),r.setAttribute("aria-hidden","true"),this._CssBinding=new n.Css.Binding(r,e,i,this,i.descriptionCellCssArgs),this.receivePhaseNotification(TDB.UpdatePhase.ReadWrite);this.addChild(new t.Cdescription(i),r,null),this._addToDom(e,o)},o.prototype.onUpdate=function(t){this._CssBinding.update(t)},o}(TDB.ViewElement);t.CdescriptionCell=A;var D=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("span");this.domElement=i,i._context=o,i.className="visualLinkDescription",i.setAttribute("style","color: #424242; font-size: 13px; line-height: 15px; font-family: 'Segoe UI Regular', 'Segoe UI', Helvetica, Tahoma, Geneva, Verdana, sans-serif;"),this._TextBinding=new n.Text.Binding(i,t,o,this,o.descriptionTextArgs),this._AttrBinding=new n.Attr.Binding(i,t,o,this,o.descriptionAttrArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._TextBinding.update(t),this._AttrBinding.update(t)},e}(TDB.ViewElement);t.Cdescription=D;var B=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("tr");this.domElement=i,i._context=o,i.className="visualLinkButtonRow";this.addChild(new t.C10(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C9=B;var I=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("td");this.domElement=i,i._context=o,i.setAttribute("align","center"),i.setAttribute("style","padding: 20px; border-collapse: collapse; mso-table-lspace: 0; mso-table-rspace: 0;");this.addChild(new t.C11(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C10=I;var b=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("table");this.domElement=i,i._context=o,i.setAttribute("border","0"),i.setAttribute("cellpadding","0"),i.setAttribute("cellspacing","0"),i.setAttribute("style","border-spacing: 0; border-collapse: collapse; mso-table-lspace: 0; mso-table-rspace: 0; margin: auto;");this.addChild(new t.C12(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C11=b;var E=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("tr");this.domElement=i,i._context=o;this.addChild(new t.C13(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C12=E;var x=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("td");this.domElement=i,i._context=o,i.setAttribute("align","center"),i.setAttribute("style","border-collapse: collapse; mso-table-lspace: 0; mso-table-rspace: 0; background-color: #008272; word-break: break-word; word-wrap: break-word; padding: 3px 20px;");this.addChild(new t.CgoToSwayButton(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C13=x;var P=function(e){function o(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(o,e),o.prototype._create=function(e,o){var i=this._context,r=document.createElement("a");this.domElement=r,r._context=i,r.setAttribute("target","_blank"),r.setAttribute("rel","nofollow noreferrer"),r.setAttribute("style","display: block; border-width: 1px; font-family: 'Segoe UI Semilight', 'Segoe UI', Helvetica, Tahoma, Geneva, Verdana, sans-serif;             -webkit-font-smoothing: antialiased; font-size: 15px; line-height: 20px; text-align: center; background-color: #008272;             border-style: solid; border-color: #008272; text-decoration: none; text-underline: none;"),this._AttrBinding=new n.Attr.Binding(r,e,i,this,i.goToSwayButtonAttrArgs);this.addChild(new t.CgoToSwayButtonContent(i),r,null),this._addToDom(e,o)},o.prototype.onUpdate=function(t){this._AttrBinding.update(t)},o}(TDB.ViewElement);t.CgoToSwayButton=P;var R=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("span");this.domElement=i,i._context=o,i.setAttribute("style","text-decoration: none; text-underline: none; color: white;"),this._TextBinding=new n.Text.Binding(i,t,o,this,o.goToSwayButtonContentTextArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._TextBinding.update(t)},e}(TDB.ViewElement);t.CgoToSwayButtonContent=R;var L=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="visualLinkOverlay",this._CssBinding=new n.Css.Binding(i,t,o,this,o.visualLinkOverlayCssArgs),this.receivePhaseNotification(TDB.UpdatePhase.ReadWrite);var r=TDB.watcherTag(17323653,o,null,o.visualLinkOverlayIconArgs),a=new TDB.NewSubTemplateInstructionVE(o,r);a.addResource(r),this.addChild(a,i,null),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._CssBinding.update(t)},e}(TDB.ViewElement);t.CvisualLinkOverlay=L}(U||(U={}));var k=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new F.CifMenuItemWrapper(n),t,e)},e}(t.MenuItemVEBase);t.MenuItemVE=k;var F;!function(t){var e=function(e){function n(t){var n=this,o=TDB.watcherTag(4543754,t,null,t.ifMenuItemWrapperArgs);return(n=e.call(this,o)||this).addResource(o),n._context=t,n}return __extends(n,e),n.prototype.buildChildren=function(e,n){var o=this._context;this.addChild(new t.C1(o),e,n)},n}(TDB.IfInstructionVE);t.CifMenuItemWrapper=e;var n=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var n=this._context,o=document.createElement("div");this.domElement=o,o._context=n,o.setAttribute("role","menuitem");var i=n.contentArgs();i&&this.addChild(i.build(n),o,null),this._addToDom(t,e)},e}(TDB.ViewElement);t.C1=n}(F||(F={}));var M=function(e){function n(t,n){return e.call(this,t,n)||this}return __extends(n,e),n.prototype._create=function(e,n){var o=this;switch(o.HTMLTagArgs()){case t.ListItemHTMLTag.DIV:this.addChild(new O.Cwrapper(o),e,n);break;case t.ListItemHTMLTag.LI:this.addChild(new O.Cwrapper1(o),e,n)}},n}(t.ListItemVEBase);t.ListItemVE=M;var O;!function(t){var o=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,r.setAttribute("role","listitem"),this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.wrapperClassNameArgs),this._AttrBinding=new n.Attr.Binding(r,t,i,this,i.wrapperAttrArgs);var a=i.contentArgs();a&&this.addChild(a.build(i),r,null),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t),this._AttrBinding.update(t)},o}(TDB.ViewElement);t.Cwrapper=o;var i=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("li");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.wrapperClassNameArgs),this._AttrBinding=new n.Attr.Binding(r,t,i,this,i.wrapperAttrArgs);var a=i.contentArgs();a&&this.addChild(a.build(i),r,null),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t),this._AttrBinding.update(t)},o}(TDB.ViewElement);t.Cwrapper1=i}(O||(O={}));var N=function(e){function n(t,n){return e.call(this,t,n)||this}return __extends(n,e),n.prototype._create=function(e,n){var o=this;switch(o.HTMLTagArgs()){case t.ListHTMLTag.DIV:this.addChild(new W.Clist(o),e,n);break;case t.ListHTMLTag.UL:this.addChild(new W.Clist1(o),e,n);break;case t.ListHTMLTag.OL:this.addChild(new W.Clist2(o),e,n)}},n}(t.ListVEBase);t.ListVE=N;var W;!function(t){var o=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,r.setAttribute("role","list"),this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.listClassNameArgs),this._AttrBinding=new n.Attr.Binding(r,t,i,this,i.listAttrArgs);for(var a=i.listItemsArgs(),s=a.length,l=0;l<s;++l)this.addChild(a[l].build(i),r,null);this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t),this._AttrBinding.update(t)},o}(TDB.ViewElement);t.Clist=o;var i=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("ul");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.listClassNameArgs),this._AttrBinding=new n.Attr.Binding(r,t,i,this,i.listAttrArgs);for(var a=i.listItemsArgs(),s=a.length,l=0;l<s;++l)this.addChild(a[l].build(i),r,null);this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t),this._AttrBinding.update(t)},o}(TDB.ViewElement);t.Clist1=i;var r=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("ol");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.listClassNameArgs),this._AttrBinding=new n.Attr.Binding(r,t,i,this,i.listAttrArgs);for(var a=i.listItemsArgs(),s=a.length,l=0;l<s;++l)this.addChild(a[l].build(i),r,null);this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t),this._AttrBinding.update(t)},o}(TDB.ViewElement);t.Clist2=r}(W||(W={}));var H=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this,o=n.pageViewArgs();o&&this.addChild(o,t,e);var i=TDB.watcherTag(17323653,n,null,n.dialogArgs);(o=new TDB.NewSubTemplateInstructionVE(n,i)).addResource(i),this.addChild(o,t,e),this.addChild(new z.CshowLink(n),t,e)},e}(t.PageRootVEBase);t.PageRootVE=H;var z;!function(t){var e=function(e){function n(t){var n=this,o=TDB.watcherTag(4543754,t,null,t.showLinkArgs);return(n=e.call(this,o)||this).addResource(o),n._context=t,n}return __extends(n,e),n.prototype.buildChildren=function(e,n){var o=this._context;this.addChild(new t.Clink(o),e,n)},n}(TDB.IfInstructionVE);t.CshowLink=e;var o=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="linkHoverText",this._TextBinding=new n.Text.Binding(i,t,o,this,o.linkTextArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._TextBinding.update(t)},e}(TDB.ViewElement);t.Clink=o}(z||(z={}));var G=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new q.Cwrapper(n),t,e)},e}(t.RadioButtonVEBase);t.RadioButtonVE=G;var q;!function(t){var o=function(o){function i(t){var e=o.call(this,null)||this;return e._context=t,e}return __extends(i,o),i.prototype._create=function(o,i){var r=this._context,a=document.createElement("div");this.domElement=a,a._context=r,this._FocusableBinding=r.focusableBinding=new n.Focusable.Binding(a,o,r,this,r.FocusableInitArgs()),this._ClassNameBinding=new e.ClassName.Binding(a,o,r,this,r.wrapperClassNameArgs),this._AttrBinding=new n.Attr.Binding(a,o,r,this,r.wrapperAttrArgs);this.addChild(new t.Cinput(r),a,null),this.addChild(new t.Clabel(r),a,null),this._addToDom(o,i)},i.prototype.onUpdate=function(t){this._FocusableBinding.update(t),this._ClassNameBinding.update(t),this._AttrBinding.update(t)},i.prototype.disposeBindings=function(){this._FocusableBinding.dispose(),this._context.focusableBinding=void 0},i}(TDB.ViewElement);t.Cwrapper=o;var i=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("input");this.domElement=r,r._context=i,r.setAttribute("type","radio"),this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.inputClassNameArgs),this._CheckedBinding=new n.Checked.Binding(r,t,i,this,i.inputCheckedInitArgs()),this._PropsBinding=new n.Props.Binding(r,t,i,this,i.inputPropsArgs),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t),this._CheckedBinding.update(t),this._PropsBinding.update(t)},o.prototype.disposeBindings=function(){this._CheckedBinding.dispose()},o}(TDB.ViewElement);t.Cinput=i;var r=function(o){function i(t){var e=o.call(this,null)||this;return e._context=t,e}return __extends(i,o),i.prototype._create=function(o,i){var r=this._context,a=document.createElement("label");this.domElement=a,a._context=r,this._ClassNameBinding=new e.ClassName.Binding(a,o,r,this,r.labelClassNameArgs),this._AttrBinding=new n.Attr.Binding(a,o,r,this,r.labelAttrArgs);this.addChild(new t.Ctext(r),a,null),r.hasExplanationArgs()&&this.addChild(new t.Cexplanation(r),a,null),this._addToDom(o,i)},i.prototype.onUpdate=function(t){this._ClassNameBinding.update(t),this._AttrBinding.update(t)},i}(TDB.ViewElement);t.Clabel=r;var a=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("span");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.textClassNameArgs),this._TextBinding=new n.Text.Binding(r,t,i,this,i.textTextArgs),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t),this._TextBinding.update(t)},o}(TDB.ViewElement);t.Ctext=a;var s=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("span");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.explanationClassNameArgs),this._TextBinding=new n.Text.Binding(r,t,i,this,i.explanationTextArgs),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t),this._TextBinding.update(t)},o}(TDB.ViewElement);t.Cexplanation=s}(q||(q={}));var j=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new K.Cwrapper(n),t,e)},e}(t.RadioGroupVEBase);t.RadioGroupVE=j;var K;!function(t){var e=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.setAttribute("role","radiogroup"),this._AttrBinding=new n.Attr.Binding(i,t,o,this,o.wrapperAttrArgs);this.addChild(new TDB.NewForeachInstructionVE(o,TDB.immutableWatchable(o.radioButtonsArgs()),"radioButtons"),i,null),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._AttrBinding.update(t)},e}(TDB.ViewElement);t.Cwrapper=e}(K||(K={}));var J=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new $.CifButtonWrapper(n),t,e)},e}(t.RichCheckboxVEBase);t.RichCheckboxVE=J;var $;!function(t){var o=function(e){function n(t){var n=this,o=TDB.watcherTag(4543754,t,null,t.ifButtonWrapperArgs);return(n=e.call(this,o)||this).addResource(o),n._context=t,n}return __extends(n,e),n.prototype.buildChildren=function(e,n){var o=this._context;this.addChild(new t.Cwrapper(o),e,n)},n}(TDB.IfInstructionVE);t.CifButtonWrapper=o;var i=function(o){function i(t){var e=o.call(this,null)||this;return e._context=t,e}return __extends(i,o),i.prototype._create=function(o,i){var r=this._context,a=document.createElement("div");this.domElement=a,a._context=r,this._ClassNameBinding=new e.ClassName.Binding(a,o,r,this,r.wrapperClassNameArgs),this._AttrBinding=new n.Attr.Binding(a,o,r,this,r.wrapperAttrArgs);var s=r.checkboxArgs();s&&this.addChild(new TDB.NewSubTemplateInstructionVE(r,TDB.immutableWatchable(s),"checkbox"),a,null),this.addChild(new t.CmessagePartsWrapper(r),a,null),this._addToDom(o,i)},i.prototype.onUpdate=function(t){this._ClassNameBinding.update(t),this._AttrBinding.update(t)},i}(TDB.ViewElement);t.Cwrapper=i;var r=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.messagePartsWrapperClassNameArgs),this._AttrBinding=new n.Attr.Binding(r,t,i,this,i.messagePartsWrapperAttrArgs);var a=TDB.watcherTag(17323652,i,null,i.messagePartsArgs),s=new TDB.NewForeachInstructionVE(i,a);s.addResource(a),this.addChild(s,r,null),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t),this._AttrBinding.update(t)},o}(TDB.ViewElement);t.CmessagePartsWrapper=r}($||($={}));var Q=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new Y.CifSlidebarWrapper(n),t,e)},e}(t.SlidebarVEBase);t.SlidebarVE=Q;var Y;!function(t){var o=function(e){function n(t){var n=this,o=TDB.watcherTag(4543754,t,null,t.ifSlidebarWrapperArgs);return(n=e.call(this,o)||this).addResource(o),n._context=t,n}return __extends(n,e),n.prototype.buildChildren=function(e,n){var o=this._context;this.addChild(new t.CslidebarTitle(o),e,n),this.addChild(new t.CslidebarWrapper(o),e,n)},n}(TDB.IfInstructionVE);t.CifSlidebarWrapper=o;var i=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="SlidebarTitle",this._AttrBinding=new n.Attr.Binding(i,t,o,this,o.slidebarTitleAttrArgs),this._TextBinding=new n.Text.Binding(i,t,o,this,o.slidebarTitleTextArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._AttrBinding.update(t),this._TextBinding.update(t)},e}(TDB.ViewElement);t.CslidebarTitle=i;var r=function(e){function o(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(o,e),o.prototype._create=function(e,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._AttrBinding=new n.Attr.Binding(r,e,i,this,i.slidebarWrapperAttrArgs),this._FocusableBinding=i.focusableBinding=new n.Focusable.Binding(r,e,i,this,i.FocusableInitArgs()),this._EventsBinding=new n.Events.Binding(r,e,i,this,i.slidebarWrapperEventsInitArgs()),this._CssBinding=new n.Css.Binding(r,e,i,this,i.slidebarWrapperCssArgs),this.receivePhaseNotification(TDB.UpdatePhase.ReadWrite);this.addChild(new t.C1(i),r,null),this.addChild(new t.CslideLimiter(i),r,null),this.addChild(new t.C5(i),r,null),this._addToDom(e,o)},o.prototype.onUpdate=function(t){this._AttrBinding.update(t),this._FocusableBinding.update(t),this._CssBinding.update(t)},o.prototype.disposeBindings=function(){this._FocusableBinding.dispose(),this._EventsBinding.dispose(),this._context.focusableBinding=void 0},o}(TDB.ViewElement);t.CslidebarWrapper=r;var a=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="SlidebarLineDecoration";this.addChild(new t.C2(o),i,null),o.showTicksArgs()&&this.addChild(new t.C3(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C1=a;var s=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="SlidebarLine";this.addChild(new t.CslidebarFullLine(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C2=s;var l=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="SlidebarFullLine",this._StyleBinding=new n.Style.Binding(i,t,o,this,o.slidebarFullLineStyleArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._StyleBinding.update(t)},e}(TDB.ViewElement);t.CslidebarFullLine=l;var u=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var n=this._context,o=document.createElement("div");this.domElement=o,o._context=n,o.className="SlidebarTicksContainer";for(var i=n.slideTicksArgs(),r=i.length,a=0;a<r;++a)this.addChild(i[a].build(n),o,null);this._addToDom(t,e)},e}(TDB.ViewElement);t.C3=u;var c=function(e){function o(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(o,e),o.prototype._create=function(e,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,r.className="SlidebarLimiter",this._PositionBinding=i.slideLimiterPositionBinding=new n.Position.Binding(r,e,i,this);this.addChild(new t.Cslide(i),r,null),this._addToDom(e,o)},o.prototype.disposeBindings=function(){this._context.slideLimiterPositionBinding=void 0},o}(TDB.ViewElement);t.CslideLimiter=c;var d=function(o){function i(t){var e=o.call(this,null)||this;return e._context=t,e}return __extends(i,o),i.prototype._create=function(o,i){var r=this._context,a=document.createElement("div");this.domElement=a,a._context=r,a.className="Slide",this._DraggableBinding=new n.Draggable.Binding(a,o,r,this,r.slideDraggableInitArgs(),r.slideDraggableOptionsArgs),this._StyleBinding=new n.Style.Binding(a,o,r,this,r.slideStyleArgs),this._TouchToMouseBinding=new e.TouchToMouse.Binding(a,o,r,this,r.slideTouchToMouseArgs),this._AttrBinding=new n.Attr.Binding(a,o,r,this,r.slideAttrArgs),this.receivePhaseNotification(TDB.UpdatePhase.ReadWrite);r.showTooltipArgs()&&this.addChild(new t.CslideTooltip(r),a,null),this.addChild(new t.C4(r),a,null),this._addToDom(o,i)},i.prototype.onUpdate=function(t){this._DraggableBinding.update(t),this._StyleBinding.update(t),this._TouchToMouseBinding.update(t),this._AttrBinding.update(t)},i.prototype.disposeBindings=function(){this._DraggableBinding.dispose(),this._TouchToMouseBinding.dispose()},i}(TDB.ViewElement);t.Cslide=d;var p=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="SlideTooltip",i.setAttribute("role","tooltip"),this._TextBinding=new n.Text.Binding(i,t,o,this,o.slideTooltipTextArgs),this._StyleBinding=new n.Style.Binding(i,t,o,this,o.slideTooltipStyleArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._TextBinding.update(t),this._StyleBinding.update(t)},e}(TDB.ViewElement);t.CslideTooltip=p;var g=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var n=this._context,o=document.createElement("div");this.domElement=o,o._context=n,o.className="SlideVisible",this._addToDom(t,e)},e}(TDB.ViewElement);t.C4=g;var h=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var n=this._context,o=document.createElement("div");this.domElement=o,o._context=n,o.className="SlidebarPointsContainer";for(var i=n.slidebarPointsArgs(),r=i.length,a=0;a<r;++a)this.addChild(i[a].build(n),o,null);this._addToDom(t,e)},e}(TDB.ViewElement);t.C5=h}(Y||(Y={}));var X=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new Z.CspanMessage(n),t,e)},e}(t.SpanMessageVEBase);t.SpanMessageVE=X;var Z;!function(t){var o=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("span");this.domElement=r,r._context=i,this._TextBinding=new n.Text.Binding(r,t,i,this,i.spanMessageTextArgs),this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.spanMessageClassNameArgs),this._StyleBinding=new n.Style.Binding(r,t,i,this,i.spanMessageStyleArgs),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._TextBinding.update(t),this._ClassNameBinding.update(t),this._StyleBinding.update(t)},o}(TDB.ViewElement);t.CspanMessage=o}(Z||(Z={}));var tt=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new et.CclickableLink(n),t,e)},e}(t.ClickableLinkVEBase);t.ClickableLinkVE=tt;var et;!function(t){var e=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("a");this.domElement=i,i._context=o,this._TextBinding=new n.Text.Binding(i,t,o,this,o.clickableLinkTextArgs),this._AttrBinding=new n.Attr.Binding(i,t,o,this,o.clickableLinkAttrArgs),this._FocusableBinding=o.focusableBinding=new n.Focusable.Binding(i,t,o,this,o.FocusableInitArgs()),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._TextBinding.update(t),this._AttrBinding.update(t),this._FocusableBinding.update(t)},e.prototype.disposeBindings=function(){this._FocusableBinding.dispose(),this._context.focusableBinding=void 0},e}(TDB.ViewElement);t.CclickableLink=e}(et||(et={}));var nt=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new ot.CifButtonWrapper(n),t,e)},e}(t.ToggleButtonVEBase);t.ToggleButtonVE=nt;var ot;!function(t){var o=function(e){function n(t){var n=this,o=TDB.watcherTag(4543754,t,null,t.ifButtonWrapperArgs);return(n=e.call(this,o)||this).addResource(o),n._context=t,n}return __extends(n,e),n.prototype.buildChildren=function(e,n){var o=this._context,i=TDB.watcherTag(17323653,o,null,o.calloutArgs),r=new TDB.NewSubTemplateInstructionVE(o,i);r.addResource(i),this.addChild(r,e,n),this.addChild(new t.Cwrapper(o),e,n)},n}(TDB.IfInstructionVE);t.CifButtonWrapper=o;var i=function(o){function i(t){var e=o.call(this,null)||this;return e._context=t,e}return __extends(i,o),i.prototype._create=function(o,i){var r=this._context,a=document.createElement("button");this.domElement=a,a._context=r,this._FocusableBinding=r.focusableBinding=new n.Focusable.Binding(a,o,r,this,r.FocusableInitArgs()),this._ClassNameBinding=new e.ClassName.Binding(a,o,r,this,r.wrapperClassNameArgs),this._AttrBinding=new n.Attr.Binding(a,o,r,this,r.wrapperAttrArgs),this._PropsBinding=new n.Props.Binding(a,o,r,this,r.wrapperPropsArgs);var s=TDB.watcherTag(17323653,r,null,r.fontIconArgs),l=new TDB.NewSubTemplateInstructionVE(r,s);l.addResource(s),this.addChild(l,a,null),r.ifGlyphTextArgs()&&this.addChild(new v.CglyphText(r),a,null),this.addChild(new t.ChasSuperScript(r),a,null),this.addChild(new t.CdisplayText(r),a,null),this.addChild(new v.CifShowShortcut(r),a,null),this._addToDom(o,i)},i.prototype.onUpdate=function(t){this._FocusableBinding.update(t),this._ClassNameBinding.update(t),this._AttrBinding.update(t),this._PropsBinding.update(t)},i.prototype.disposeBindings=function(){this._FocusableBinding.dispose(),this._context.focusableBinding=void 0},i}(TDB.ViewElement);t.Cwrapper=i;var r=function(e){function n(t){var n=this,o=TDB.watcherTag(4543754,t,null,t.hasSuperScriptArgs);return(n=e.call(this,o)||this).addResource(o),n._context=t,n}return __extends(n,e),n.prototype.buildChildren=function(e,n){var o=this._context;this.addChild(new t.CsuperScript(o),e,n)},n}(TDB.IfInstructionVE);t.ChasSuperScript=r;var a=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("sup");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.superScriptClassNameArgs),this._TextBinding=new n.Text.Binding(r,t,i,this,i.superScriptTextArgs),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t),this._TextBinding.update(t)},o}(TDB.ViewElement);t.CsuperScript=a;var s=function(e){function n(t){var n=this,o=TDB.watcherTag(4543754,t,null,t.displayTextArgs);return(n=e.call(this,o)||this).addResource(o),n._context=t,n}return __extends(n,e),n.prototype.buildChildren=function(e,n){var o=this._context;this.addChild(new t.CtextElement(o),e,n)},n}(TDB.IfInstructionVE);t.CdisplayText=s;var l=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("span");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.textElementClassNameArgs),this._TextBinding=new n.Text.Binding(r,t,i,this,i.textElementTextArgs),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t),this._TextBinding.update(t)},o}(TDB.ViewElement);t.CtextElement=l}(ot||(ot={}));var it=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new rt.CifButtonWrapper(n),t,e)},e}(t.TabButtonVEBase);t.TabButtonVE=it;var rt;!function(t){var o=function(e){function n(t){var n=this,o=TDB.watcherTag(4543754,t,null,t.ifButtonWrapperArgs);return(n=e.call(this,o)||this).addResource(o),n._context=t,n}return __extends(n,e),n.prototype.buildChildren=function(e,n){var o=this._context;this.addChild(new t.Cwrapper(o),e,n)},n}(TDB.IfInstructionVE);t.CifButtonWrapper=o;var i=function(o){function i(t){var e=o.call(this,null)||this;return e._context=t,e}return __extends(i,o),i.prototype._create=function(o,i){var r=this._context,a=document.createElement("button");this.domElement=a,a._context=r,this._FocusableBinding=r.focusableBinding=new n.Focusable.Binding(a,o,r,this,r.FocusableInitArgs()),this._ClassNameBinding=new e.ClassName.Binding(a,o,r,this,r.wrapperClassNameArgs),this._StyleBinding=new n.Style.Binding(a,o,r,this,r.wrapperStyleArgs),this._AttrBinding=new n.Attr.Binding(a,o,r,this,r.wrapperAttrArgs);this.addChild(new t.Ctext(r),a,null),this.addChild(new v.CifShowShortcut(r),a,null),this._addToDom(o,i)},i.prototype.onUpdate=function(t){this._FocusableBinding.update(t),this._ClassNameBinding.update(t),this._StyleBinding.update(t),this._AttrBinding.update(t)},i.prototype.disposeBindings=function(){this._FocusableBinding.dispose(),this._context.focusableBinding=void 0},i}(TDB.ViewElement);t.Cwrapper=i;var r=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.textClassNameArgs),this._TextBinding=new n.Text.Binding(r,t,i,this,i.textTextArgs),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t),this._TextBinding.update(t)},o}(TDB.ViewElement);t.Ctext=r}(rt||(rt={}));var at=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new st.CtextArea(n),t,e)},e}(t.TextAreaVEBase);t.TextAreaVE=at;var st;!function(t){var e=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("textarea");this.domElement=i,i._context=o,this._AttrBinding=new n.Attr.Binding(i,t,o,this,o.textAreaAttrArgs),this._FocusableBinding=o.focusableBinding=new n.Focusable.Binding(i,t,o,this,o.FocusableInitArgs()),this._ValueBinding=o.textAreaValueBinding=new n.Value.Binding(i,t,o,this,o.textAreaValueInitArgs()),this._StyleBinding=new n.Style.Binding(i,t,o,this,o.textAreaStyleArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._AttrBinding.update(t),this._FocusableBinding.update(t),this._ValueBinding.update(t),this._StyleBinding.update(t)},e.prototype.disposeBindings=function(){this._FocusableBinding.dispose(),this._ValueBinding.dispose();var t=this._context;t.focusableBinding=void 0,t.textAreaValueBinding=void 0},e}(TDB.ViewElement);t.CtextArea=e}(st||(st={}));var lt=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new ut.CtextBlock(n),t,e)},e}(t.TextBlockVEBase);t.TextBlockVE=lt;var ut;!function(t){var o=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.textBlockClassNameArgs),this._TextBinding=new n.Text.Binding(r,t,i,this,i.textBlockTextArgs),this._AttrBinding=new n.Attr.Binding(r,t,i,this,i.textBlockAttrArgs),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t),this._TextBinding.update(t),this._AttrBinding.update(t)},o}(TDB.ViewElement);t.CtextBlock=o}(ut||(ut={}));var ct=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new dt.Ctext(n),t,e)},e}(t.TextBoxVEBase);t.TextBoxVE=ct;var dt;!function(t){var o=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("input");this.domElement=r,r._context=i,r.setAttribute("type","text"),r.setAttribute("mode","watched"),this._AttrBinding=new n.Attr.Binding(r,t,i,this,i.textAttrArgs),this._FocusableBinding=i.focusableBinding=new n.Focusable.Binding(r,t,i,this,i.FocusableInitArgs()),this._SelectTextBinding=new e.SelectText.Binding(r,t,i,this,i.textSelectTextArgs),this._ValueBinding=i.textValueBinding=new n.Value.Binding(r,t,i,this,i.textValueInitArgs()),this._EventsBinding=new n.Events.Binding(r,t,i,this,i.textEventsInitArgs()),this._InputSelectionBinding=i.textInputSelectionBinding=new n.InputSelection.Binding(r,t,i,this,i.textInputSelectionInitArgs()),this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.textClassNameArgs),this.receivePhaseNotification(TDB.UpdatePhase.ReadWrite),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._AttrBinding.update(t),this._FocusableBinding.update(t),this._SelectTextBinding.update(t),this._ValueBinding.update(t),this._InputSelectionBinding.update(t),this._ClassNameBinding.update(t)},o.prototype.disposeBindings=function(){this._FocusableBinding.dispose(),this._ValueBinding.dispose(),this._EventsBinding.dispose(),this._InputSelectionBinding.dispose();var t=this._context;t.focusableBinding=void 0,t.textValueBinding=void 0,t.textInputSelectionBinding=void 0},o}(TDB.ViewElement);t.Ctext=o}(dt||(dt={}));var pt=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new rt.CifButtonWrapper(n),t,e)},e}(t.TextButtonVEBase);t.TextButtonVE=pt;var gt=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new ht.Cwrapper(n),t,e)},e}(t.ToggleSwitchVEBase);t.ToggleSwitchVE=gt;var ht;!function(t){var e=function(e){function o(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(o,e),o.prototype._create=function(e,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,r.className="ToggleSwitchWrapper",this._FocusableBinding=i.focusableBinding=new n.Focusable.Binding(r,e,i,this,i.FocusableInitArgs()),this._AttrBinding=new n.Attr.Binding(r,e,i,this,i.wrapperAttrArgs),this._PropsBinding=new n.Props.Binding(r,e,i,this,i.wrapperPropsArgs);this.addChild(new t.C1(i),r,null),this._addToDom(e,o)},o.prototype.onUpdate=function(t){this._FocusableBinding.update(t),this._AttrBinding.update(t),this._PropsBinding.update(t)},o.prototype.disposeBindings=function(){this._FocusableBinding.dispose(),this._context.focusableBinding=void 0},o}(TDB.ViewElement);t.Cwrapper=e;var o=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var n=this._context,o=document.createElement("label");this.domElement=o,o._context=n,o.setAttribute("role","presentation"),this._addToDom(t,e)},e}(TDB.ViewElement);t.C1=o}(ht||(ht={}));var mt=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this,o=n.controlArgs();o&&this.addChild(new TDB.NewSubTemplateInstructionVE(n,TDB.immutableWatchable(o),"control"),t,e)},e}(t.DialogButtonVEBase);t.DialogButtonVE=mt;var yt=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new ft.CcontentParagraph(n),t,e)},e}(t.DialogMessageVEBase);t.DialogMessageVE=yt;var ft;!function(t){var e=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("p");this.domElement=i,i._context=o,i.className="dlgContentP",this._TextBinding=new n.Text.Binding(i,t,o,this,o.contentParagraphTextArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._TextBinding.update(t)},e}(TDB.ViewElement);t.CcontentParagraph=e}(ft||(ft={}));var St=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new Ct.C1(n),t,e)},e}(t.DialogHtmlContainerVEBase);t.DialogHtmlContainerVE=St;var Ct;!function(t){var e=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o;this.addChild(new t.ChtmlContents(o),i,null),o.ifIframeContentsArgs()&&this.addChild(new t.CiframeContents(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C1=e;var o=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,this._PropsBinding=new n.Props.Binding(i,t,o,this,o.htmlContentsPropsArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._PropsBinding.update(t)},e}(TDB.ViewElement);t.ChtmlContents=o;var i=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("iframe");this.domElement=i,i._context=o,this._IframeBinding=new n.Iframe.Binding(i,t,o,this,o.iframeContentsIframeArgs),this.receivePhaseNotification(TDB.UpdatePhase.ReadWrite),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._IframeBinding.update(t)},e}(TDB.ViewElement);t.CiframeContents=i}(Ct||(Ct={}));var vt=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new _t.CcenteringDiv(n),t,e)},e}(t.DialogLoadingSpinnerVEBase);t.DialogLoadingSpinnerVE=vt;var _t;!function(t){var o=function(n){function o(t){var e=n.call(this,null)||this;return e._context=t,e}return __extends(o,n),o.prototype._create=function(n,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,n,i,this,i.centeringDivClassNameArgs);this.addChild(new t.CloadingSpinner(i),r,null),this._addToDom(n,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t)},o}(TDB.ViewElement);t.CcenteringDiv=o;var i=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("img");this.domElement=i,i._context=o,this._AttrBinding=new n.Attr.Binding(i,t,o,this,o.loadingSpinnerAttrArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._AttrBinding.update(t)},e}(TDB.ViewElement);t.CloadingSpinner=i}(_t||(_t={}));var wt=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new Tt.CifButtonWrapper(n),t,e)},e}(t.UserInfoVEBase);t.UserInfoVE=wt;var Tt;!function(t){var o=function(e){function n(t){var n=this,o=TDB.watcherTag(4543754,t,null,t.ifButtonWrapperArgs);return(n=e.call(this,o)||this).addResource(o),n._context=t,n}return __extends(n,e),n.prototype.buildChildren=function(e,n){var o=this._context;this.addChild(new t.Cwrapper(o),e,n)},n}(TDB.IfInstructionVE);t.CifButtonWrapper=o;var i=function(o){function i(t){var e=o.call(this,null)||this;return e._context=t,e}return __extends(i,o),i.prototype._create=function(o,i){var r=this._context,a=document.createElement("button");this.domElement=a,a._context=r,this._FocusableBinding=r.focusableBinding=new n.Focusable.Binding(a,o,r,this,r.FocusableInitArgs()),this._ClassNameBinding=new e.ClassName.Binding(a,o,r,this,r.wrapperClassNameArgs),this._StyleBinding=new n.Style.Binding(a,o,r,this,r.wrapperStyleArgs),this._AttrBinding=new n.Attr.Binding(a,o,r,this,r.wrapperAttrArgs);this.addChild(new t.C1(r),a,null),this.addChild(new t.C2(r),a,null),this._addToDom(o,i)},i.prototype.onUpdate=function(t){this._FocusableBinding.update(t),this._ClassNameBinding.update(t),this._StyleBinding.update(t),this._AttrBinding.update(t)},i.prototype.disposeBindings=function(){this._FocusableBinding.dispose(),this._context.focusableBinding=void 0},i}(TDB.ViewElement);t.Cwrapper=i;var r=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="flexCenter";this.addChild(new t.CifHasAccountPicture(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C1=r;var a=function(e){function n(t){var n=this,o=TDB.watcherTag(4519824,t,null,t.ifHasAccountPictureArgs);return(n=e.call(this,o)||this).addResource(o),n._context=t,n}return __extends(n,e),n.prototype.buildChildren=function(e,n,o){var i=this._context;switch(e){case!0:this.addChild(new t.CuserPicture(i),n,o);break;case!1:var r=i.doughboyPictureArgs();r&&this.addChild(r.build(i),n,o)}},n}(TDB.SwitchInstructionVE);t.CifHasAccountPicture=a;var s=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("img");this.domElement=i,i._context=o,i.className="userInfoPicture clip20x20",this._AttrBinding=new n.Attr.Binding(i,t,o,this,o.userPictureAttrArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._AttrBinding.update(t)},e}(TDB.ViewElement);t.CuserPicture=s;var l=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="userInfoContent";this.addChild(new t.CuserName(o),i,null),this.addChild(new t.CuserEmail(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C2=l;var u=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("p");this.domElement=i,i._context=o,i.className="segoeUI userNameDisplay",this._TextBinding=new n.Text.Binding(i,t,o,this,o.userNameTextArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._TextBinding.update(t)},e}(TDB.ViewElement);t.CuserName=u;var c=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("p");this.domElement=i,i._context=o,i.className="segoeUI userEmailDisplay",this._TextBinding=new n.Text.Binding(i,t,o,this,o.userEmailTextArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._TextBinding.update(t)},e}(TDB.ViewElement);t.CuserEmail=c}(Tt||(Tt={}));var At=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new Dt.Cwrapper(n),t,e)},e}(t.DialogVEBase);t.DialogVE=At;var Dt;!function(t){var o=function(n){function o(t){var e=n.call(this,null)||this;return e._context=t,e}return __extends(o,n),o.prototype._create=function(n,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._FadeVisibleBinding=new e.FadeVisible.Binding(r,n,i,this,i.wrapperFadeVisibleInitArgs(),i.wrapperFadeVisibleArgs),this._ClassNameBinding=new e.ClassName.Binding(r,n,i,this,i.wrapperClassNameArgs);this.addChild(new t.Cfrost(i),r,null),this.addChild(new t.CdialogWrapper(i),r,null),this._addToDom(n,o)},o.prototype.onUpdate=function(t){this._FadeVisibleBinding.update(t),this._ClassNameBinding.update(t)},o.prototype.disposeBindings=function(){this._FadeVisibleBinding.dispose()},o}(TDB.ViewElement);t.Cwrapper=o;var i=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="dlgFrost",i.setAttribute("role","presentation"),this._StyleBinding=new n.Style.Binding(i,t,o,this,o.frostStyleArgs),this._EventsBinding=new n.Events.Binding(i,t,o,this,o.frostEventsInitArgs()),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._StyleBinding.update(t)},e.prototype.disposeBindings=function(){this._EventsBinding.dispose()},e}(TDB.ViewElement);t.Cfrost=i;var r=function(o){function i(t){var e=o.call(this,null)||this;return e._context=t,e}return __extends(i,o),i.prototype._create=function(o,i){var r=this._context,a=document.createElement("div");this.domElement=a,a._context=r,this._StyleBinding=new n.Style.Binding(a,o,r,this,r.dialogWrapperStyleArgs),this._CenterBinding=new n.Center.Binding(a,o,r,this,r.dialogWrapperCenterInitArgs(),r.dialogWrapperCenterArgs),this._ClassNameBinding=new e.ClassName.Binding(a,o,r,this,r.dialogWrapperClassNameArgs),this._AttrBinding=new n.Attr.Binding(a,o,r,this,r.dialogWrapperAttrArgs),this._EventsBinding=new n.Events.Binding(a,o,r,this,r.dialogWrapperEventsInitArgs()),this.receivePhaseNotification(TDB.UpdatePhase.ReadWrite);this.addChild(new t.CdialogContent(r),a,null),this._addToDom(o,i)},i.prototype.onUpdate=function(t){this._StyleBinding.update(t),this._CenterBinding.update(t),this._ClassNameBinding.update(t),this._AttrBinding.update(t)},i.prototype.disposeBindings=function(){this._CenterBinding.dispose(),this._EventsBinding.dispose()},i}(TDB.ViewElement);t.CdialogWrapper=r;var a=function(n){function o(t){var e=n.call(this,null)||this;return e._context=t,e}return __extends(o,n),o.prototype._create=function(n,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,n,i,this,i.dialogContentClassNameArgs);this.addChild(new t.CdlgContentsContainer(i),r,null),this.addChild(new t.C1(i),r,null),this.addChild(new t.CdialogDebugMessagesContainer(i),r,null),this._addToDom(n,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t)},o}(TDB.ViewElement);t.CdialogContent=a;var s=function(n){function o(t){var e=n.call(this,null)||this;return e._context=t,e}return __extends(o,n),o.prototype._create=function(n,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,n,i,this,i.dlgContentsContainerClassNameArgs);this.addChild(new t.CifTitle(i),r,null),this.addChild(new t.CaccessibilityMessage(i),r,null);var a=TDB.watcherTag(17323652,i,null,i.dialogMessageArgs),s=new TDB.NewForeachInstructionVE(i,a);s.addResource(a),this.addChild(s,r,null),this.addChild(new t.CdlgContentWrapper(i),r,null),this._addToDom(n,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t)},o}(TDB.ViewElement);t.CdlgContentsContainer=s;var l=function(e){function n(t){var n=this,o=TDB.watcherTag(4543754,t,null,t.ifTitleArgs);return(n=e.call(this,o)||this).addResource(o),n._context=t,n}return __extends(n,e),n.prototype.buildChildren=function(e,n){var o=this._context;this.addChild(new t.Ctitle(o),e,n)},n}(TDB.IfInstructionVE);t.CifTitle=l;var u=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="dlgTitle",this._TextBinding=new n.Text.Binding(i,t,o,this,o.titleTextArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._TextBinding.update(t)},e}(TDB.ViewElement);t.Ctitle=u;var c=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="inlineScreenReaderOnly",this._TextBinding=new n.Text.Binding(i,t,o,this,o.accessibilityMessageTextArgs),this._AttrBinding=new n.Attr.Binding(i,t,o,this,o.accessibilityMessageAttrArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._TextBinding.update(t),this._AttrBinding.update(t)},e}(TDB.ViewElement);t.CaccessibilityMessage=c;var d=function(t){function n(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(n,t),n.prototype._create=function(t,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,this._ClassNameBinding=new e.ClassName.Binding(i,t,o,this,o.dlgContentWrapperClassNameArgs);this.addChild(new TDB.NewSubTemplateInstructionVE(o,o.contentArgs(),"content"),i,null),this._addToDom(t,n)},n.prototype.onUpdate=function(t){this._ClassNameBinding.update(t)},n}(TDB.ViewElement);t.CdlgContentWrapper=d;var p=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var n=this._context,o=document.createElement("div");this.domElement=o,o._context=n,o.className="dlgButtons";var i=TDB.watcherTag(17323652,n,null,n.buttonsArgs),r=new TDB.NewForeachInstructionVE(n,i,"buttons");r.addResource(i),this.addChild(r,o,null),this._addToDom(t,e)},e}(TDB.ViewElement);t.C1=p;var g=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="dlgDebugMessagesContainer",this._StyleBinding=new n.Style.Binding(i,t,o,this,o.dialogDebugMessagesContainerStyleArgs);var r=TDB.watcherTag(17323652,o,null,o.dialogDebugMessageArgs),a=new TDB.NewForeachInstructionVE(o,r);a.addResource(r),this.addChild(a,i,null),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._StyleBinding.update(t)},e}(TDB.ViewElement);t.CdialogDebugMessagesContainer=g}(Dt||(Dt={}));var Bt=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new It.CplayerWrapper(n),t,e)},e}(t.YouTubePlayerVEBase);t.YouTubePlayerVE=Bt;var It;!function(t){var n=function(n){function o(t){var e=n.call(this,null)||this;return e._context=t,e}return __extends(o,n),o.prototype._create=function(n,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,n,i,this,i.playerWrapperClassNameArgs);this.addChild(new t.Cplayer(i),r,null),this._addToDom(n,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t)},o}(TDB.ViewElement);t.CplayerWrapper=n;var o=function(t){function n(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(n,t),n.prototype._create=function(t,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,this._YouTubePlayerBinding=new e.YouTubePlayer.Binding(i,t,o,this,o.playerYouTubePlayerCreateArgs,o.playerYouTubePlayerResizeArgs),this._addToDom(t,n)},n.prototype.onUpdate=function(t){this._YouTubePlayerBinding.update(t)},n.prototype.disposeBindings=function(){this._YouTubePlayerBinding.dispose()},n}(TDB.ViewElement);t.Cplayer=o}(It||(It={}));var bt=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new Et.CerrorMessageVisible(n),t,e),this.addChild(new Et.C1(n),t,e)},e}(t.SurveyBoxVEBase);t.SurveyBoxVE=bt;var Et;!function(t){var e=function(e){function n(t){var n=this,o=TDB.watcherTag(4543754,t,null,t.errorMessageVisibleArgs);return(n=e.call(this,o)||this).addResource(o),n._context=t,n}return __extends(n,e),n.prototype.buildChildren=function(e,n){var o=this._context;this.addChild(new t.CerrorMessage(o),e,n)},n}(TDB.IfInstructionVE);t.CerrorMessageVisible=e;var o=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("p");this.domElement=i,i._context=o,i.className="SurveyError",i.setAttribute("role","alert"),this._TextBinding=new n.Text.Binding(i,t,o,this,o.errorMessageTextArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._TextBinding.update(t)},e}(TDB.ViewElement);t.CerrorMessage=o;var i=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var n=this._context,o=document.createElement("div");this.domElement=o,o._context=n;this.addChild(new TDB.NewForeachInstructionVE(n,TDB.immutableWatchable(n.questionBoxesArgs()),"questionBoxes"),o,null),this._addToDom(t,e)},e}(TDB.ViewElement);t.C1=i}(Et||(Et={}));var xt=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new Pt.C1(n),t,e)},e}(t.CheckboxQuestionVEBase);t.CheckboxQuestionVE=xt;var Pt;!function(t){var o=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="SurveyQuestionWrapper";this.addChild(new t.C2(o),i,null),o.ifQuestionSubtitleArgs()&&this.addChild(new t.CquestionSubtitle(o),i,null),this.addChild(new TDB.NewForeachInstructionVE(o,TDB.immutableWatchable(o.checkboxOptionsArgs()),"_checkboxes"),i,null),o.ifTextBoxArgs()&&this.addChild(new t.CtextBoxOption(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C1=o;var i=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o;o.ifQuestionTitleArgs()&&this.addChild(new t.CquestionTitle(o),i,null),o.ifQuestionExplanationArgs()&&this.addChild(new t.CquestionExplanation(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C2=i;var r=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("span");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.questionTitleClassNameArgs),this._TextBinding=new n.Text.Binding(r,t,i,this,i.questionTitleTextArgs),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t),this._TextBinding.update(t)},o}(TDB.ViewElement);t.CquestionTitle=r;var a=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("span");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.questionExplanationClassNameArgs),this._TextBinding=new n.Text.Binding(r,t,i,this,i.questionExplanationTextArgs),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t),this._TextBinding.update(t)},o}(TDB.ViewElement);t.CquestionExplanation=a;var s=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.questionSubtitleClassNameArgs),this._TextBinding=new n.Text.Binding(r,t,i,this,i.questionSubtitleTextArgs),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t),this._TextBinding.update(t)},o}(TDB.ViewElement);t.CquestionSubtitle=s;var l=function(n){function o(t){var e=n.call(this,null)||this;return e._context=t,e}return __extends(o,n),o.prototype._create=function(n,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,n,i,this,i.textBoxOptionClassNameArgs);this.addChild(new t.CtextBoxLabel(i),r,null);var a=i.textBoxArgs();a&&this.addChild(new TDB.NewSubTemplateInstructionVE(i,TDB.immutableWatchable(a),"_textBox"),r,null),this._addToDom(n,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t)},o}(TDB.ViewElement);t.CtextBoxOption=l;var u=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.textBoxLabelClassNameArgs),this._TextBinding=new n.Text.Binding(r,t,i,this,i.textBoxLabelTextArgs),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t),this._TextBinding.update(t)},o}(TDB.ViewElement);t.CtextBoxLabel=u}(Pt||(Pt={}));var Rt=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){for(var n=this,o=n.tabsArgs(),i=o.length,r=0;r<i;++r)this.addChild(o[r].build(n),t,e)},e}(t.TabHeaderVEBase);t.TabHeaderVE=Rt;var Lt=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this,o=n.textButtonVEArgs();o&&this.addChild(o.build(n),t,e)},e}(t.TextTabVEBase);t.TextTabVE=Lt;var Vt=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new Ut.Cwrapper(n),t,e)},e}(t.DialogTextInputVEBase);t.DialogTextInputVE=Vt;var Ut;!function(t){var o=function(n){function o(t){var e=n.call(this,null)||this;return e._context=t,e}return __extends(o,n),o.prototype._create=function(n,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,n,i,this,i.wrapperClassNameArgs);this.addChild(new t.Cdescription(i),r,null),this.addChild(new t.C1(i),r,null),this.addChild(new t.CerrorMessage(i),r,null),this._addToDom(n,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t)},o}(TDB.ViewElement);t.Cwrapper=o;var i=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("p");this.domElement=i,i._context=o,this._TextBinding=new n.Text.Binding(i,t,o,this,o.descriptionTextArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._TextBinding.update(t)},e}(TDB.ViewElement);t.Cdescription=i;var r=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o;this.addChild(new t.CtextInput(o),i,null),this.addChild(new t.CloadingSpinner(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C1=r;var a=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("input");this.domElement=r,r._context=i,r.setAttribute("type","text"),this._AttrBinding=new n.Attr.Binding(r,t,i,this,i.textInputAttrArgs),this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.textInputClassNameArgs),this._ValueBinding=i.textInputValueBinding=new n.Value.Binding(r,t,i,this,i.textInputValueInitArgs()),this._FocusableBinding=i.focusableBinding=new n.Focusable.Binding(r,t,i,this,i.FocusableInitArgs()),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._AttrBinding.update(t),this._ClassNameBinding.update(t),this._ValueBinding.update(t),this._FocusableBinding.update(t)},o.prototype.disposeBindings=function(){this._ValueBinding.dispose(),this._FocusableBinding.dispose();var t=this._context;t.textInputValueBinding=void 0,t.focusableBinding=void 0},o}(TDB.ViewElement);t.CtextInput=a;var s=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("img");this.domElement=i,i._context=o,i.setAttribute("role","progressbar"),i.className="OpenUrlDialogLoadingSpinner",i.setAttribute("aria-busy","true"),i.setAttribute("alt",""),this._AttrBinding=new n.Attr.Binding(i,t,o,this,o.loadingSpinnerAttrArgs),this._VisibleBinding=new n.Visible.Binding(i,t,o,this,o.loadingSpinnerVisibleArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._AttrBinding.update(t),this._VisibleBinding.update(t)},e}(TDB.ViewElement);t.CloadingSpinner=s;var l=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("p");this.domElement=r,r._context=i,r.setAttribute("aria-live","polite"),this._TextBinding=new n.Text.Binding(r,t,i,this,i.errorMessageTextArgs),this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.errorMessageClassNameArgs),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._TextBinding.update(t),this._ClassNameBinding.update(t)},o}(TDB.ViewElement);t.CerrorMessage=l}(Ut||(Ut={}));var kt=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new Ft.Cmessage(n),t,e),this.addChild(new Ft.C1(n),t,e)},e}(t.EditStoryDialogVEBase);t.EditStoryDialogVE=kt;var Ft;!function(t){var e=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="EditStoryDialogMessage",this._TextBinding=new n.Text.Binding(i,t,o,this,o.messageTextArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._TextBinding.update(t)},e}(TDB.ViewElement);t.Cmessage=e;var o=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="EditStoryDialogUserInfoWrapper";this.addChild(new t.Cimage(o),i,null),this.addChild(new t.Cname(o),i,null),this.addChild(new t.Cdomain(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C1=o;var i=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("img");this.domElement=i,i._context=o,i.className="EditStoryDialogUserInfoProfile",this._AttrBinding=new n.Attr.Binding(i,t,o,this,o.imageAttrArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._AttrBinding.update(t)},e}(TDB.ViewElement);t.Cimage=i;var r=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="EditStoryDialogUserInfoName",this._TextBinding=new n.Text.Binding(i,t,o,this,o.nameTextArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._TextBinding.update(t)},e}(TDB.ViewElement);t.Cname=r;var a=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="EditStoryDialogUserInfoDomain",this._TextBinding=new n.Text.Binding(i,t,o,this,o.domainTextArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._TextBinding.update(t)},e}(TDB.ViewElement);t.Cdomain=a}(Ft||(Ft={}));var Mt=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new Ot.CifWrapper(n),t,e)},e}(t.FeedbackSurveyStarVEBase);t.FeedbackSurveyStarVE=Mt;var Ot;!function(t){var o=function(e){function n(t){var n=this,o=TDB.watcherTag(4543754,t,null,t.ifWrapperArgs);return(n=e.call(this,o)||this).addResource(o),n._context=t,n}return __extends(n,e),n.prototype.buildChildren=function(e,n){var o=this._context;this.addChild(new t.Cwrapper(o),e,n)},n}(TDB.IfInstructionVE);t.CifWrapper=o;var i=function(o){function i(t){var e=o.call(this,null)||this;return e._context=t,e}return __extends(i,o),i.prototype._create=function(o,i){var r=this._context,a=document.createElement("div");this.domElement=a,a._context=r,this._ClassNameBinding=new e.ClassName.Binding(a,o,r,this,r.wrapperClassNameArgs),this._EventsBinding=new n.Events.Binding(a,o,r,this,r.wrapperEventsInitArgs());this.addChild(new t.ClayersContainer(r),a,null),this._addToDom(o,i)},i.prototype.onUpdate=function(t){this._ClassNameBinding.update(t)},i.prototype.disposeBindings=function(){this._EventsBinding.dispose()},i}(TDB.ViewElement);t.Cwrapper=i;var r=function(t){function n(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(n,t),n.prototype._create=function(t,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,this._ClassNameBinding=new e.ClassName.Binding(i,t,o,this,o.layersContainerClassNameArgs);var r=TDB.watcherTag(17323652,o,null,o.layersArgs),a=new TDB.NewForeachInstructionVE(o,r);a.addResource(r),this.addChild(a,i,null),this._addToDom(t,n)},n.prototype.onUpdate=function(t){this._ClassNameBinding.update(t)},n}(TDB.ViewElement);t.ClayersContainer=r}(Ot||(Ot={}));var Nt=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new Wt.Cwrapper(n),t,e)},e}(t.FeedbackSurveyStarsSliderVEBase);t.FeedbackSurveyStarsSliderVE=Nt;var Wt;!function(t){var e=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="feedbackSurveyStars",this._AttrBinding=new n.Attr.Binding(i,t,o,this,o.wrapperAttrArgs),this._FocusableBinding=o.focusableBinding=new n.Focusable.Binding(i,t,o,this,o.FocusableInitArgs());this.addChild(new TDB.NewForeachInstructionVE(o,TDB.immutableWatchable(o.ratingStarsArgs()),"ratingStars"),i,null),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._AttrBinding.update(t),this._FocusableBinding.update(t)},e.prototype.disposeBindings=function(){this._FocusableBinding.dispose(),this._context.focusableBinding=void 0},e}(TDB.ViewElement);t.Cwrapper=e}(Wt||(Wt={}));var Ht=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new zt.CcalloutWrapper(n),t,e)},e}(t.BasicCalloutVEBase);t.BasicCalloutVE=Ht;var zt;!function(t){var o=function(n){function o(t){var e=n.call(this,null)||this;return e._context=t,e}return __extends(o,n),o.prototype._create=function(n,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,n,i,this,i.calloutWrapperClassNameArgs);this.addChild(new t.CcalloutTapWrapper(i),r,null),this.addChild(new t.CcalloutBox(i),r,null),this.addChild(new t.CcalloutStatus(i),r,null),this._addToDom(n,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t)},o}(TDB.ViewElement);t.CcalloutWrapper=o;var i=function(o){function i(t){var e=o.call(this,null)||this;return e._context=t,e}return __extends(i,o),i.prototype._create=function(o,i){var r=this._context,a=document.createElement("div");this.domElement=a,a._context=r,this._ClassNameBinding=new e.ClassName.Binding(a,o,r,this,r.calloutTapWrapperClassNameArgs),this._CalloutFadeBinding=new e.CalloutFade.Binding(a,o,r,this,r.calloutTapWrapperCalloutFadeInitArgs(),r.calloutTapWrapperCalloutFadeArgs),this._EventsBinding=new n.Events.Binding(a,o,r,this,r.calloutTapWrapperEventsInitArgs()),this._VisibleBinding=new n.Visible.Binding(a,o,r,this,r.calloutTapWrapperVisibleArgs);this.addChild(new t.CcalloutTapAnimationInner(r),a,null),this.addChild(new t.CcalloutTapAnimationOuter(r),a,null),this._addToDom(o,i)},i.prototype.onUpdate=function(t){this._ClassNameBinding.update(t),this._CalloutFadeBinding.update(t),this._VisibleBinding.update(t)},i.prototype.disposeBindings=function(){this._CalloutFadeBinding.dispose(),this._EventsBinding.dispose()},i}(TDB.ViewElement);t.CcalloutTapWrapper=i;var r=function(t){function n(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(n,t),n.prototype._create=function(t,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,this._ClassNameBinding=new e.ClassName.Binding(i,t,o,this,o.calloutTapAnimationInnerClassNameArgs),this._addToDom(t,n)},n.prototype.onUpdate=function(t){this._ClassNameBinding.update(t)},n}(TDB.ViewElement);t.CcalloutTapAnimationInner=r;var a=function(t){function n(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(n,t),n.prototype._create=function(t,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,this._ClassNameBinding=new e.ClassName.Binding(i,t,o,this,o.calloutTapAnimationOuterClassNameArgs),this._addToDom(t,n)},n.prototype.onUpdate=function(t){this._ClassNameBinding.update(t)},n}(TDB.ViewElement);t.CcalloutTapAnimationOuter=a;var s=function(o){function i(t){var e=o.call(this,null)||this;return e._context=t,e}return __extends(i,o),i.prototype._create=function(o,i){var r=this._context,a=document.createElement("div");this.domElement=a,a._context=r,this._CalloutFadeBinding=new e.CalloutFade.Binding(a,o,r,this,r.calloutBoxCalloutFadeInitArgs(),r.calloutBoxCalloutFadeArgs),this._ClassNameBinding=new e.ClassName.Binding(a,o,r,this,r.calloutBoxClassNameArgs),this._EventsBinding=new n.Events.Binding(a,o,r,this,r.calloutBoxEventsInitArgs()),this._AttrBinding=new n.Attr.Binding(a,o,r,this,r.calloutBoxAttrArgs);this.addChild(new t.CcalloutBeak(r),a,null),this.addChild(new t.CcalloutBeakBorder(r),a,null),this.addChild(new t.CcalloutText(r),a,null),this.addChild(new t.Cwrapper(r),a,null),this._addToDom(o,i)},i.prototype.onUpdate=function(t){this._CalloutFadeBinding.update(t),this._ClassNameBinding.update(t),this._AttrBinding.update(t)},i.prototype.disposeBindings=function(){this._CalloutFadeBinding.dispose(),this._EventsBinding.dispose()},i}(TDB.ViewElement);t.CcalloutBox=s;var l=function(t){function n(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(n,t),n.prototype._create=function(t,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,this._ClassNameBinding=new e.ClassName.Binding(i,t,o,this,o.calloutBeakClassNameArgs),this._addToDom(t,n)},n.prototype.onUpdate=function(t){this._ClassNameBinding.update(t)},n}(TDB.ViewElement);t.CcalloutBeak=l;var u=function(t){function n(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(n,t),n.prototype._create=function(t,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,this._ClassNameBinding=new e.ClassName.Binding(i,t,o,this,o.calloutBeakBorderClassNameArgs),this._addToDom(t,n)},n.prototype.onUpdate=function(t){this._ClassNameBinding.update(t)},n}(TDB.ViewElement);t.CcalloutBeakBorder=u;var c=function(e){function o(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(o,e),o.prototype._create=function(e,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,r.className="calloutText",this._AttrBinding=new n.Attr.Binding(r,e,i,this,i.calloutTextAttrArgs);this.addChild(new t.CcalloutHeader(i),r,null),this.addChild(new t.CcalloutBody(i),r,null);var a=i.linkArgs();a&&this.addChild(a.build(i),r,null),this._addToDom(e,o)},o.prototype.onUpdate=function(t){this._AttrBinding.update(t)},o}(TDB.ViewElement);t.CcalloutText=c;var d=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="calloutHeader",this._TextBinding=new n.Text.Binding(i,t,o,this,o.calloutHeaderTextArgs),this._StyleBinding=new n.Style.Binding(i,t,o,this,o.calloutHeaderStyleArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._TextBinding.update(t),this._StyleBinding.update(t)},e}(TDB.ViewElement);t.CcalloutHeader=d;var p=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="calloutBody",this._TextBinding=new n.Text.Binding(i,t,o,this,o.calloutBodyTextArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._TextBinding.update(t)},e}(TDB.ViewElement);t.CcalloutBody=p;var g=function(t){function n(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(n,t),n.prototype._create=function(t,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,this._ClassNameBinding=new e.ClassName.Binding(i,t,o,this,o.wrapperClassNameArgs);var r=o.closeButtonArgs();r&&this.addChild(r.build(o),i,null),this._addToDom(t,n)},n.prototype.onUpdate=function(t){this._ClassNameBinding.update(t)},n}(TDB.ViewElement);t.Cwrapper=g;var h=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("span");this.domElement=i,i._context=o,i.setAttribute("aria-live","polite"),i.setAttribute("aria-atomic","true"),i.className="calloutStatus",this._TextBinding=new n.Text.Binding(i,t,o,this,o.calloutStatusTextArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._TextBinding.update(t)},e}(TDB.ViewElement);t.CcalloutStatus=h}(zt||(zt={}));var Gt=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new qt.C1(n),t,e)},e}(t.FRECarouselVEBase);t.FRECarouselVE=Gt;var qt;!function(t){var o=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="freCarouselWrapper";this.addChild(new t.CcarouselContentWrapper(o),i,null),this.addChild(new t.CcarouselFooterWrapper(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C1=o;var i=function(t){function n(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(n,t),n.prototype._create=function(t,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,this._ClassNameBinding=new e.ClassName.Binding(i,t,o,this,o.carouselContentWrapperClassNameArgs);this.addChild(new TDB.NewSubTemplateInstructionVE(o,o.contentArgs()),i,null),this._addToDom(t,n)},n.prototype.onUpdate=function(t){this._ClassNameBinding.update(t)},n}(TDB.ViewElement);t.CcarouselContentWrapper=i;var r=function(n){function o(t){var e=n.call(this,null)||this;return e._context=t,e}return __extends(o,n),o.prototype._create=function(n,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,n,i,this,i.carouselFooterWrapperClassNameArgs);this.addChild(new t.CdismissButtonWrapper(i),r,null),this.addChild(new t.CpauseWrapper(i),r,null),this.addChild(new t.CplayWrapper(i),r,null),this.addChild(new t.CpreviousWrapperVisible(i),r,null),this.addChild(new t.C2(i),r,null),this.addChild(new t.CnextWrapper(i),r,null),this._addToDom(n,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t)},o}(TDB.ViewElement);t.CcarouselFooterWrapper=r;var a=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,r.className="buttons",this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.dismissButtonWrapperClassNameArgs),this._VisibleBinding=new n.Visible.Binding(r,t,i,this,i.dismissButtonWrapperVisibleArgs);var a=i.dismissButtonArgs();a&&this.addChild(new TDB.NewSubTemplateInstructionVE(i,TDB.immutableWatchable(a),"_dismissButtonVE"),r,null),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t),this._VisibleBinding.update(t)},o}(TDB.ViewElement);t.CdismissButtonWrapper=a;var s=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,r.className="buttons",this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.pauseWrapperClassNameArgs),this._VisibleBinding=new n.Visible.Binding(r,t,i,this,i.pauseWrapperVisibleArgs);var a=i.pauseButtonArgs();a&&this.addChild(new TDB.NewSubTemplateInstructionVE(i,TDB.immutableWatchable(a),"pauseButton"),r,null),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t),this._VisibleBinding.update(t)},o}(TDB.ViewElement);t.CpauseWrapper=s;var l=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,r.className="buttons",this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.playWrapperClassNameArgs),this._VisibleBinding=new n.Visible.Binding(r,t,i,this,i.playWrapperVisibleArgs);var a=i.playButtonArgs();a&&this.addChild(new TDB.NewSubTemplateInstructionVE(i,TDB.immutableWatchable(a),"playButton"),r,null),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t),this._VisibleBinding.update(t)},o}(TDB.ViewElement);t.CplayWrapper=l;var u=function(e){function n(t){var n=this,o=TDB.watcherTag(4543754,t,null,t.previousWrapperVisibleArgs);return(n=e.call(this,o)||this).addResource(o),n._context=t,n}return __extends(n,e),n.prototype.buildChildren=function(e,n){var o=this._context;this.addChild(new t.CpreviousWrapper(o),e,n)},n}(TDB.IfInstructionVE);t.CpreviousWrapperVisible=u;var c=function(t){function n(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(n,t),n.prototype._create=function(t,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="buttons",this._ClassNameBinding=new e.ClassName.Binding(i,t,o,this,o.previousWrapperClassNameArgs);var r=o.previousButtonArgs();r&&this.addChild(r.build(o),i,null),this._addToDom(t,n)},n.prototype.onUpdate=function(t){this._ClassNameBinding.update(t)},n}(TDB.ViewElement);t.CpreviousWrapper=c;var d=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var n=this._context,o=document.createElement("div");this.domElement=o,o._context=n,o.className="buttons freCarouselIndexButtonsWrapper";for(var i=n.indexButtonsArgs(),r=i.length,a=0;a<r;++a)this.addChild(i[a].build(n),o,null);this._addToDom(t,e)},e}(TDB.ViewElement);t.C2=d;var p=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,r.className="buttons",this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.nextWrapperClassNameArgs),this._VisibleBinding=new n.Visible.Binding(r,t,i,this,i.nextWrapperVisibleArgs);var a=i.nextButtonArgs();a&&this.addChild(new TDB.NewSubTemplateInstructionVE(i,TDB.immutableWatchable(a),"nextButton"),r,null),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t),this._VisibleBinding.update(t)},o}(TDB.ViewElement);t.CnextWrapper=p}(qt||(qt={}));var jt=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new Kt.CifButtonWrapper(n),t,e)},e}(t.CalloutGlyphButtonVEBase);t.CalloutGlyphButtonVE=jt;var Kt;!function(t){var o=function(e){function n(t){var n=this,o=TDB.watcherTag(4543754,t,null,t.ifButtonWrapperArgs);return(n=e.call(this,o)||this).addResource(o),n._context=t,n}return __extends(n,e),n.prototype.buildChildren=function(e,n){var o=this._context;this.addChild(new t.CcalloutGlyphButtonWrapper(o),e,n)},n}(TDB.IfInstructionVE);t.CifButtonWrapper=o;var i=function(n){function o(t){var e=n.call(this,null)||this;return e._context=t,e}return __extends(o,n),o.prototype._create=function(n,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,n,i,this,i.calloutGlyphButtonWrapperClassNameArgs);var a=TDB.watcherTag(17323653,i,null,i.calloutArgs),s=new TDB.NewSubTemplateInstructionVE(i,a);s.addResource(a),this.addChild(s,r,null),this.addChild(new t.Cwrapper(i),r,null),this._addToDom(n,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t)},o}(TDB.ViewElement);t.CcalloutGlyphButtonWrapper=i;var r=function(o){function i(t){var e=o.call(this,null)||this;return e._context=t,e}return __extends(i,o),i.prototype._create=function(o,i){var r=this._context,a=document.createElement("button");this.domElement=a,a._context=r,this._FocusableBinding=r.focusableBinding=new n.Focusable.Binding(a,o,r,this,r.FocusableInitArgs()),this._ClassNameBinding=new e.ClassName.Binding(a,o,r,this,r.wrapperClassNameArgs),this._StyleBinding=new n.Style.Binding(a,o,r,this,r.wrapperStyleArgs),this._AttrBinding=new n.Attr.Binding(a,o,r,this,r.wrapperAttrArgs),this._PropsBinding=new n.Props.Binding(a,o,r,this,r.wrapperPropsArgs);this.addChild(new t.CglyphWrapper(r),a,null),this.addChild(new v.CincludeLabelText(r),a,null),this._addToDom(o,i)},i.prototype.onUpdate=function(t){this._FocusableBinding.update(t),this._ClassNameBinding.update(t),this._StyleBinding.update(t),this._AttrBinding.update(t),this._PropsBinding.update(t)},i.prototype.disposeBindings=function(){this._FocusableBinding.dispose(),this._context.focusableBinding=void 0},i}(TDB.ViewElement);t.Cwrapper=r;var a=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,this._StyleBinding=new n.Style.Binding(i,t,o,this,o.glyphWrapperStyleArgs);this.addChild(new v.C1(o),i,null),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._StyleBinding.update(t)},e}(TDB.ViewElement);t.CglyphWrapper=a}(Kt||(Kt={}));var Jt=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new $t.CifWrapper(n),t,e)},e}(t.FontIconVEBase);t.FontIconVE=Jt;var $t;!function(t){var n=function(e){function n(t){var n=this,o=TDB.watcherTag(4543754,t,null,t.ifWrapperArgs);return(n=e.call(this,o)||this).addResource(o),n._context=t,n}return __extends(n,e),n.prototype.buildChildren=function(e,n){var o=this._context;this.addChild(new t.Cwrapper(o),e,n)},n}(TDB.IfInstructionVE);t.CifWrapper=n;var o=function(t){function n(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(n,t),n.prototype._create=function(t,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,this._ClassNameBinding=new e.ClassName.Binding(i,t,o,this,o.wrapperClassNameArgs);this.addChild(new Ot.ClayersContainer(o),i,null),this._addToDom(t,n)},n.prototype.onUpdate=function(t){this._ClassNameBinding.update(t)},n}(TDB.ViewElement);t.Cwrapper=o}($t||($t={}));var Qt=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new Yt.Clayer(n),t,e)},e}(t.FontIconLayerVEBase);t.FontIconLayerVE=Qt;var Yt;!function(t){var n=function(t){function n(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(n,t),n.prototype._create=function(t,n){var o=this._context,i=document.createElement("span");this.domElement=i,i._context=o,i.setAttribute("aria-hidden","true"),this._ClassNameBinding=new e.ClassName.Binding(i,t,o,this,o.layerClassNameArgs),this._addToDom(t,n)},n.prototype.onUpdate=function(t){this._ClassNameBinding.update(t)},n}(TDB.ViewElement);t.Clayer=n}(Yt||(Yt={}));var Xt=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new Zt.C1(n),t,e)},e}(t.FREPage1VEBase);t.FREPage1VE=Xt;var Zt;!function(t){var o=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.id="FREPage1Wrapper";this.addChild(new t.Ctitle(o),i,null),this.addChild(new t.CaccessibilityMessage(o),i,null),this.addChild(new t.C2(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C1=o;var i=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._TextBinding=new n.Text.Binding(r,t,i,this,i.titleTextArgs),this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.titleClassNameArgs),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._TextBinding.update(t),this._ClassNameBinding.update(t)},o}(TDB.ViewElement);t.Ctitle=i;var r=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="inlineScreenReaderOnly",this._TextBinding=new n.Text.Binding(i,t,o,this,o.accessibilityMessageTextArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._TextBinding.update(t)},e}(TDB.ViewElement);t.CaccessibilityMessage=r;var a=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.setAttribute("aria-hidden","true"),i.setAttribute("role","presentation");this.addChild(new t.CsubtitleWrapper(o),i,null),this.addChild(new t.Cimage(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C2=a;var s=function(n){function o(t){var e=n.call(this,null)||this;return e._context=t,e}return __extends(o,n),o.prototype._create=function(n,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,r.className="frePage1SubtitleWrapper",this._ClassNameBinding=new e.ClassName.Binding(r,n,i,this,i.subtitleWrapperClassNameArgs);this.addChild(new t.Csubtitle(i),r,null),this._addToDom(n,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t)},o}(TDB.ViewElement);t.CsubtitleWrapper=s;var l=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._TextBinding=new n.Text.Binding(r,t,i,this,i.subtitleTextArgs),this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.subtitleClassNameArgs),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._TextBinding.update(t),this._ClassNameBinding.update(t)},o}(TDB.ViewElement);t.Csubtitle=l;var u=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("img");this.domElement=r,r._context=i,this._AttrBinding=new n.Attr.Binding(r,t,i,this,i.imageAttrArgs),this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.imageClassNameArgs),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._AttrBinding.update(t),this._ClassNameBinding.update(t)},o}(TDB.ViewElement);t.Cimage=u}(Zt||(Zt={}));var te=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new ee.C1(n),t,e)},e}(t.FREPage2VEBase);t.FREPage2VE=te;var ee;!function(t){var o=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.id="FREPage2Wrapper";this.addChild(new Zt.Ctitle(o),i,null),this.addChild(new Zt.CaccessibilityMessage(o),i,null),this.addChild(new t.C2(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C1=o;var i=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.setAttribute("aria-hidden","true"),i.setAttribute("role","presentation");this.addChild(new t.CimageWrapper(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C2=i;var r=function(n){function o(t){var e=n.call(this,null)||this;return e._context=t,e}return __extends(o,n),o.prototype._create=function(n,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,n,i,this,i.imageWrapperClassNameArgs);this.addChild(new t.Caction(i),r,null),this.addChild(new t.CbackgroundImage(i),r,null),this.addChild(new t.CsourceImage(i),r,null),this._addToDom(n,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t)},o}(TDB.ViewElement);t.CimageWrapper=r;var a=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._TextBinding=new n.Text.Binding(r,t,i,this,i.actionTextArgs),this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.actionClassNameArgs),this._StyleBinding=new n.Style.Binding(r,t,i,this,i.actionStyleArgs),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._TextBinding.update(t),this._ClassNameBinding.update(t),this._StyleBinding.update(t)},o}(TDB.ViewElement);t.Caction=a;var s=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("img");this.domElement=r,r._context=i,this._AttrBinding=new n.Attr.Binding(r,t,i,this,i.backgroundImageAttrArgs),this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.backgroundImageClassNameArgs),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._AttrBinding.update(t),this._ClassNameBinding.update(t)},o}(TDB.ViewElement);t.CbackgroundImage=s;var l=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("img");this.domElement=r,r._context=i,this._AttrBinding=new n.Attr.Binding(r,t,i,this,i.sourceImageAttrArgs),this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.sourceImageClassNameArgs),this._StyleBinding=new n.Style.Binding(r,t,i,this,i.sourceImageStyleArgs),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._AttrBinding.update(t),this._ClassNameBinding.update(t),this._StyleBinding.update(t)},o}(TDB.ViewElement);t.CsourceImage=l}(ee||(ee={}));var ne=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new oe.C1(n),t,e)},e}(t.FREPage3VEBase);t.FREPage3VE=ne;var oe;!function(t){var o=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.id="FREPage3Wrapper";this.addChild(new Zt.Ctitle(o),i,null),this.addChild(new Zt.CaccessibilityMessage(o),i,null),this.addChild(new t.C2(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C1=o;var i=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.setAttribute("aria-hidden","true"),i.setAttribute("role","presentation");this.addChild(new t.CimageWrapper(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C2=i;var r=function(n){function o(t){var e=n.call(this,null)||this;return e._context=t,e}return __extends(o,n),o.prototype._create=function(n,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,n,i,this,i.imageWrapperClassNameArgs);this.addChild(new t.Caction(i),r,null),this.addChild(new t.Cimage(i),r,null),this.addChild(new Zt.Csubtitle(i),r,null),this._addToDom(n,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t)},o}(TDB.ViewElement);t.CimageWrapper=r;var a=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._TextBinding=new n.Text.Binding(r,t,i,this,i.actionTextArgs),this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.actionClassNameArgs),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._TextBinding.update(t),this._ClassNameBinding.update(t)},o}(TDB.ViewElement);t.Caction=a;var s=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("img");this.domElement=i,i._context=o,this._AttrBinding=new n.Attr.Binding(i,t,o,this,o.imageAttrArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._AttrBinding.update(t)},e}(TDB.ViewElement);t.Cimage=s}(oe||(oe={}));var ie=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new re.CnotificationBar(n),t,e)},e}(t.NotificationBarVEBase);t.NotificationBarVE=ie;var re;!function(t){var e=function(e){function o(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(o,e),o.prototype._create=function(e,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,r.id="notificationBar",r.setAttribute("role","region"),this._AttrBinding=new n.Attr.Binding(r,e,i,this,i.notificationBarAttrArgs);var a=TDB.watcherTag(17323653,i,null,i.notificationArgs),s=new TDB.NewSubTemplateInstructionVE(i,a,"notification");s.addResource(a),this.addChild(s,r,null),this.addChild(new t.CaccessibilityNotificationText(i),r,null),this._addToDom(e,o)},o.prototype.onUpdate=function(t){this._AttrBinding.update(t)},o}(TDB.ViewElement);t.CnotificationBar=e;var o=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="inlineScreenReaderOnly",i.setAttribute("aria-live","polite"),i.setAttribute("aria-atomic","true"),this._TextBinding=new n.Text.Binding(i,t,o,this,o.accessibilityNotificationTextTextArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._TextBinding.update(t)},e}(TDB.ViewElement);t.CaccessibilityNotificationText=o}(re||(re={}));var ae=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){for(var n=this,o=n.messageContentArgs(),i=o.length,r=0;r<i;++r)this.addChild(o[r].build(n),t,e)},e}(t.DynamicMessageVEBase);t.DynamicMessageVE=ae;var se=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new le.COutlineDisambiguationPanelWrapper(n),t,e)},e}(t.OutlineDialogDisambiguationPanelVEBase);t.OutlineDialogDisambiguationPanelVE=se;var le;!function(t){var o=function(n){function o(t){var e=n.call(this,null)||this;return e._context=t,e}return __extends(o,n),o.prototype._create=function(n,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,n,i,this,i.OutlineDisambiguationPanelWrapperClassNameArgs);this.addChild(new t.C1(i),r,null),this.addChild(new t.C2(i),r,null),this._addToDom(n,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t)},o}(TDB.ViewElement);t.COutlineDisambiguationPanelWrapper=o;var i=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.setAttribute("aria-live","polite"),i.setAttribute("aria-atomic","true");this.addChild(new t.CdisambiguationCaption(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C1=i;var r=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="outlineSubTitleText",this._TextBinding=new n.Text.Binding(i,t,o,this,o.disambiguationCaptionTextArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._TextBinding.update(t)},e}(TDB.ViewElement);t.CdisambiguationCaption=r;var a=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="outlineDisambiguationWrapper";this.addChild(new t.CdisambiguationWrapperButtons(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C2=a;var s=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="outlineDisambiguationButtonsWrapper",i.setAttribute("role","listbox"),this._AttrBinding=new n.Attr.Binding(i,t,o,this,o.disambiguationWrapperButtonsAttrArgs);var r=TDB.watcherTag(17323652,o,null,o.disambiguationButtonsArgs),a=new TDB.NewForeachInstructionVE(o,r);a.addResource(r),this.addChild(a,i,null),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._AttrBinding.update(t)},e}(TDB.ViewElement);t.CdisambiguationWrapperButtons=s}(le||(le={}));var ue=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new ce.C1(n),t,e),this.addChild(new ce.CpoweredBy(n),t,e),this.addChild(new ce.C2(n),t,e);var o=n.disambiguationPanelArgs();o&&this.addChild(new TDB.NewSubTemplateInstructionVE(n,TDB.immutableWatchable(o),"panel"),t,e)},e}(t.OutlineDialogContentVEBase);t.OutlineDialogContentVE=ue;var ce;!function(t){var e=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="outlineTextBoxWrapper";var r=o.titleTextBoxArgs();r&&this.addChild(new TDB.NewSubTemplateInstructionVE(o,TDB.immutableWatchable(r),"topicTextBox"),i,null),this.addChild(new t.Canimation(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C1=e;var o=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("img");this.domElement=i,i._context=o,i.className="outlineDialogLoadingDots",i.setAttribute("role","progressbar"),this._AttrBinding=new n.Attr.Binding(i,t,o,this,o.animationAttrArgs),this._VisibleBinding=new n.Visible.Binding(i,t,o,this,o.animationVisibleArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._AttrBinding.update(t),this._VisibleBinding.update(t)},e}(TDB.ViewElement);t.Canimation=o;var i=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="poweredByText",this._TextBinding=new n.Text.Binding(i,t,o,this,o.poweredByTextArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._TextBinding.update(t)},e}(TDB.ViewElement);t.CpoweredBy=i;var r=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.setAttribute("aria-live","polite"),i.setAttribute("aria-atomic","true");this.addChild(new t.CerrorMessage(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C2=r;var a=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="outlineCaptionText",this._TextBinding=new n.Text.Binding(i,t,o,this,o.errorMessageTextArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._TextBinding.update(t)},e}(TDB.ViewElement);t.CerrorMessage=a}(ce||(ce={}));var de=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new pe.Cimage(n),t,e)},e}(t.BasicImageVEBase);t.BasicImageVE=de;var pe;!function(t){var o=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("img");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.imageClassNameArgs),this._EventsBinding=new n.Events.Binding(r,t,i,this,i.imageEventsInitArgs()),this._AttrBinding=new n.Attr.Binding(r,t,i,this,i.imageAttrArgs),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t),this._AttrBinding.update(t)},o.prototype.disposeBindings=function(){this._EventsBinding.dispose()},o}(TDB.ViewElement);t.Cimage=o}(pe||(pe={}));var ge=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new he.CcarouselWrapper(n),t,e)},e}(t.AccessibleCarouselVEBase);t.AccessibleCarouselVE=ge;var he;!function(t){var o=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._AttrBinding=new n.Attr.Binding(r,t,i,this,i.carouselWrapperAttrArgs),this._ClassNameBinding=new e.ClassName.Binding(r,t,i,this,i.carouselWrapperClassNameArgs);var a=TDB.watcherTag(17323653,i,null,i.previousButtonArgs),s=new TDB.NewSubTemplateInstructionVE(i,a,"previousButton");s.addResource(a),this.addChild(s,r,null);var l=i.carouselListArgs();l&&this.addChild(new TDB.NewSubTemplateInstructionVE(i,TDB.immutableWatchable(l),"carouselList"),r,null);a=TDB.watcherTag(17323653,i,null,i.nextButtonArgs);(s=new TDB.NewSubTemplateInstructionVE(i,a,"nextButton")).addResource(a),this.addChild(s,r,null),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._AttrBinding.update(t),this._ClassNameBinding.update(t)},o}(TDB.ViewElement);t.CcarouselWrapper=o}(he||(he={}));var me=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new ye.CcarouselList(n),t,e)},e}(t.CarouselListVEBase);t.CarouselListVE=me;var ye;!function(t){var e=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("ul");this.domElement=i,i._context=o,i.className="CarouselList",this._AttrBinding=new n.Attr.Binding(i,t,o,this,o.carouselListAttrArgs);var r=TDB.watcherTag(17323652,o,null,o.visibleListItemsArgs),a=new TDB.NewForeachInstructionVE(o,r,"visibleListItems");a.addResource(r),this.addChild(a,i,null),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._AttrBinding.update(t)},e}(TDB.ViewElement);t.CcarouselList=e}(ye||(ye={}));var fe=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new Se.CappSwitcher(n),t,e)},e}(t.AppSwitcherVEBase);t.AppSwitcherVE=fe;var Se;!function(t){var n=function(t){function n(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(n,t),n.prototype._create=function(t,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,this._CopyHtmlBinding=new e.CopyHtml.Binding(i,t,o,this,o.appSwitcherCopyHtmlArgs),this.receivePhaseNotification(TDB.UpdatePhase.ReadWrite),this._addToDom(t,n)},n.prototype.onUpdate=function(t){this._CopyHtmlBinding.update(t)},n}(TDB.ViewElement);t.CappSwitcher=n}(Se||(Se={}));var Ce=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new ve.C1(n),t,e)},e}(t.PasswordEntryDialogContentVEBase);t.PasswordEntryDialogContentVE=Ce;var ve;!function(t){var e=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="PasswordEntryDialogContent";this.addChild(new t.C2(o),i,null),this.addChild(new t.CifShowErrorMessage(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C1=e;var o=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="PasswordEntryTextBoxWrapper";this.addChild(new t.C3(o),i,null);var r=o.passwordTextBoxArgs();r&&this.addChild(new TDB.NewSubTemplateInstructionVE(o,TDB.immutableWatchable(r),"passwordTextBox"),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C2=o;var i=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="SpinnerWrapper";this.addChild(new t.CifShowLoadingSpinner(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C3=i;var r=function(e){function n(t){var n=e.call(this,t.ifShowLoadingSpinnerArgs())||this;return n._context=t,n}return __extends(n,e),n.prototype.buildChildren=function(e,n){var o=this._context;this.addChild(new t.CloadingSpinner(o),e,n)},n}(TDB.IfInstructionVE);t.CifShowLoadingSpinner=r;var a=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("img");this.domElement=i,i._context=o,i.setAttribute("role","progressbar"),i.className="LoadingSpinner",i.setAttribute("aria-busy","true"),this._AttrBinding=new n.Attr.Binding(i,t,o,this,o.loadingSpinnerAttrArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._AttrBinding.update(t)},e}(TDB.ViewElement);t.CloadingSpinner=a;var s=function(e){function n(t){var n=e.call(this,t.ifShowErrorMessageArgs())||this;return n._context=t,n}return __extends(n,e),n.prototype.buildChildren=function(e,n){var o=this._context;this.addChild(new t.CerrorMessage(o),e,n)},n}(TDB.IfInstructionVE);t.CifShowErrorMessage=s;var l=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="PasswordErrorMessage",i.setAttribute("aria-live","assertive"),this._TextBinding=new n.Text.Binding(i,t,o,this,o.errorMessageTextArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._TextBinding.update(t)},e}(TDB.ViewElement);t.CerrorMessage=l}(ve||(ve={}));var _e=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;switch(n.supportsScrollingArgs()){case!0:this.addChild(new we.Ciframe(n),t,e);break;case!1:this.addChild(new we.Cwrapper(n),t,e)}},e}(t.IframeVEBase);t.IframeVE=_e;var we;!function(t){var o=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("iframe");this.domElement=r,r._context=i,r.setAttribute("frameborder","0"),this._Attr1Binding=new n.Attr.Binding(r,t,i,this,i.iframeAttr1Args),this._Attr2Binding=new n.Attr.Binding(r,t,i,this,i.iframeAttr2Args),this._EventsBinding=new n.Events.Binding(r,t,i,this,i.iframeEventsInitArgs()),this._StyleBinding=new n.Style.Binding(r,t,i,this,i.iframeStyleArgs),this._MessageBinding=i.iframeMessageBinding=new e.Message.Binding(r,t,i,this,i.iframeMessageInitArgs()),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._Attr1Binding.update(t),this._Attr2Binding.update(t),this._StyleBinding.update(t)},o.prototype.disposeBindings=function(){this._EventsBinding.dispose(),this._MessageBinding.dispose(),this._context.iframeMessageBinding=void 0},o}(TDB.ViewElement);t.Ciframe=o;var i=function(e){function o(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(o,e),o.prototype._create=function(e,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,r.className="iframe-scroller",this._StyleBinding=new n.Style.Binding(r,e,i,this,i.wrapperStyleArgs);this.addChild(new t.Ciframe(i),r,null),this._addToDom(e,o)},o.prototype.onUpdate=function(t){this._StyleBinding.update(t)},o}(TDB.ViewElement);t.Cwrapper=i}(we||(we={}));var Te=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new Ae.Cwrapper(n),t,e)},e}(t.DropdownListVEBase);t.DropdownListVE=Te;var Ae;!function(t){var o=function(n){function o(t){var e=n.call(this,null)||this;return e._context=t,e}return __extends(o,n),o.prototype._create=function(n,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,n,i,this,i.wrapperClassNameArgs);this.addChild(new t.Cheader(i),r,null),i.ifAriaLiveStatusArgs()&&this.addChild(new t.Cstatus(i),r,null),this.addChild(new t.CifReadyToDisplay(i),r,null),this._addToDom(n,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t)},o}(TDB.ViewElement);t.Cwrapper=o;var i=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="DropdownListHeader",this._AttrBinding=new n.Attr.Binding(i,t,o,this,o.headerAttrArgs),this._TextBinding=new n.Text.Binding(i,t,o,this,o.headerTextArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._AttrBinding.update(t),this._TextBinding.update(t)},e}(TDB.ViewElement);t.Cheader=i;var r=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="DropdownListAriaLiveStatus",i.setAttribute("aria-live","polite"),i.setAttribute("aria-atomic","true"),this._StyleBinding=new n.Style.Binding(i,t,o,this,o.statusStyleArgs),this._TextBinding=new n.Text.Binding(i,t,o,this,o.statusTextArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._StyleBinding.update(t),this._TextBinding.update(t)},e}(TDB.ViewElement);t.Cstatus=r;var a=function(e){function n(t){var n=this,o=TDB.watcherTag(4543754,t,null,t.ifReadyToDisplayArgs);return(n=e.call(this,o)||this).addResource(o),n._context=t,n}return __extends(n,e),n.prototype.buildChildren=function(e,n){var o=this._context,i=o.dropdownButtonArgs();i&&this.addChild(new TDB.NewSubTemplateInstructionVE(o,TDB.immutableWatchable(i),"dropdownButton"),e,n),this.addChild(new t.ClistItemsWrapper(o),e,n)},n}(TDB.IfInstructionVE);t.CifReadyToDisplay=a;var s=function(t){function o(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(o,t),o.prototype._create=function(t,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,r.className="DropdownListListItemsWrapper",this._AttrBinding=new n.Attr.Binding(r,t,i,this,i.listItemsWrapperAttrArgs),this._SlideVisibleBinding=new e.SlideVisible.Binding(r,t,i,this,i.listItemsWrapperSlideVisibleInitArgs(),i.listItemsWrapperSlideVisibleArgs),this.receivePhaseNotification(TDB.UpdatePhase.ReadWrite);var a=TDB.watcherTag(17323652,i,null,i.listItemsArgs),s=new TDB.NewForeachInstructionVE(i,a,"listItems");s.addResource(a),this.addChild(s,r,null),this._addToDom(t,o)},o.prototype.onUpdate=function(t){this._AttrBinding.update(t),this._SlideVisibleBinding.update(t)},o}(TDB.ViewElement);t.ClistItemsWrapper=s}(Ae||(Ae={}));var De=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new Be.C1(n),t,e)},e}(t.PeoplePickerSuggestedResultsVEBase);t.PeoplePickerSuggestedResultsVE=De;var Be;!function(t){var e=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var n=this._context,o=document.createElement("div");this.domElement=o,o._context=n,o.className="entitySuggestions",o.setAttribute("role","listbox");var i=TDB.watcherTag(17323652,n,null,n.entitySuggestionsArgs),r=new TDB.NewForeachInstructionVE(n,i,"entitySuggestions");r.addResource(i),this.addChild(r,o,null),this._addToDom(t,e)},e}(TDB.ViewElement);t.C1=e}(Be||(Be={}));var Ie=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this,o=TDB.watcherTag(17323653,n,null,n.entityListArgs),i=new TDB.NewSubTemplateInstructionVE(n,o,"entityList");i.addResource(o),this.addChild(i,t,e),this.addChild(new be.C1(n),t,e)},e}(t.PeoplePickerSelectedResultsVEBase);t.PeoplePickerSelectedResultsVE=Ie;var be;!function(t){var e=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="entityPickerInputSpinner";var r=o.entityPickerInputArgs();r&&this.addChild(new TDB.NewSubTemplateInstructionVE(o,TDB.immutableWatchable(r),"entityPickerInput"),i,null),this.addChild(new t.CifSpinner(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C1=e;var o=function(e){function n(t){var n=this,o=TDB.watcherTag(4543754,t,null,t.ifSpinnerArgs);return(n=e.call(this,o)||this).addResource(o),n._context=t,n}return __extends(n,e),n.prototype.buildChildren=function(e,n){var o=this._context;this.addChild(new t.CwaitingSpinner(o),e,n)},n}(TDB.IfInstructionVE);t.CifSpinner=o;var i=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("img");this.domElement=i,i._context=o,i.setAttribute("role","progressbar"),i.className="entityPickerSpinner",i.setAttribute("aria-busy","true"),this._AttrBinding=new n.Attr.Binding(i,t,o,this,o.waitingSpinnerAttrArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._AttrBinding.update(t)},e}(TDB.ViewElement);t.CwaitingSpinner=i}(be||(be={}));var Ee=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new xe.CentityPickerWrapper(n),t,e)},e}(t.EntityPickerVEBase);t.EntityPickerVE=Ee;var xe;!function(t){var o=function(n){function o(t){var e=n.call(this,null)||this;return e._context=t,e}return __extends(o,n),o.prototype._create=function(n,o){var i=this._context,r=document.createElement("div");this.domElement=r,r._context=i,this._ClassNameBinding=new e.ClassName.Binding(r,n,i,this,i.entityPickerWrapperClassNameArgs);var a=i.selectedResultsArgs();a&&this.addChild(new TDB.NewSubTemplateInstructionVE(i,TDB.immutableWatchable(a),"selectedResults"),r,null),this.addChild(new t.CsuggestionsVisible(i),r,null),this.addChild(new t.CnoSuggestions(i),r,null),this.addChild(new t.CentitySuggestionsReader(i),r,null),this._addToDom(n,o)},o.prototype.onUpdate=function(t){this._ClassNameBinding.update(t)},o}(TDB.ViewElement);t.CentityPickerWrapper=o;var i=function(t){function e(e){var n=this,o=TDB.watcherTag(4543754,e,null,e.suggestionsVisibleArgs);return(n=t.call(this,o)||this).addResource(o),n._context=e,n}return __extends(e,t),e.prototype.buildChildren=function(t,e){var n=this._context,o=n.suggestedResultsArgs();o&&this.addChild(new TDB.NewSubTemplateInstructionVE(n,TDB.immutableWatchable(o),"suggestedResults"),t,e)},e}(TDB.IfInstructionVE);t.CsuggestionsVisible=i;var r=function(e){function n(t){var n=this,o=TDB.watcherTag(4543754,t,null,t.noSuggestionsArgs);return(n=e.call(this,o)||this).addResource(o),n._context=t,n}return __extends(n,e),n.prototype.buildChildren=function(e,n){var o=this._context;this.addChild(new t.CnoSuggestionsText(o),e,n)},n}(TDB.IfInstructionVE);t.CnoSuggestions=r;var a=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="entityPickerNoSuggestions",i.setAttribute("role","alert"),this._TextBinding=new n.Text.Binding(i,t,o,this,o.noSuggestionsTextTextArgs),this._AttrBinding=new n.Attr.Binding(i,t,o,this,o.noSuggestionsTextAttrArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._TextBinding.update(t),this._AttrBinding.update(t)},e}(TDB.ViewElement);t.CnoSuggestionsText=a;var s=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("span");this.domElement=i,i._context=o,i.setAttribute("aria-live","assertive"),i.setAttribute("aria-atomic","true"),i.className="inlineScreenReaderOnly",this._TextBinding=new n.Text.Binding(i,t,o,this,o.entitySuggestionsReaderTextArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._TextBinding.update(t)},e}(TDB.ViewElement);t.CentitySuggestionsReader=s}(xe||(xe={}));var Pe=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new Re.C1(n),t,e)},e}(t.EntityListVEBase);t.EntityListVE=Pe;var Re;!function(t){var e=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var n=this._context,o=document.createElement("div");this.domElement=o,o._context=n,o.className="entityListWrapper",o.setAttribute("role","listbox");var i=TDB.watcherTag(17323652,n,null,n.entitiesArgs),r=new TDB.NewForeachInstructionVE(n,i,"entityList");r.addResource(i),this.addChild(r,o,null),this._addToDom(t,e)},e}(TDB.ViewElement);t.C1=e}(Re||(Re={}));var Le=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new Ve.C1(n),t,e)},e}(t.TextWithHyperlinkContentVEBase);t.TextWithHyperlinkContentVE=Le;var Ve;!function(t){var e=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var n=this._context,o=document.createElement("div");this.domElement=o,o._context=n,o.className="TextWithHyperlinkContent";for(var i=n.messageArgs(),r=i.length,a=0;a<r;++a)this.addChild(i[a].build(n),o,null);this._addToDom(t,e)},e}(TDB.ViewElement);t.C1=e}(Ve||(Ve={}));var Ue=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new ke.C1(n),t,e)},e}(t.TransientCalloutGlyphButtonVEBase);t.TransientCalloutGlyphButtonVE=Ue;var ke;!function(t){var e=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var n=this._context,o=document.createElement("div");this.domElement=o,o._context=n,o.className="transientCalloutGlyphButton";var i=TDB.watcherTag(17323653,n,null,n.buttonArgs),r=new TDB.NewSubTemplateInstructionVE(n,i,"button");r.addResource(i),this.addChild(r,o,null);i=TDB.watcherTag(17323653,n,null,n.calloutArgs);(r=new TDB.NewSubTemplateInstructionVE(n,i,"callout")).addResource(i),this.addChild(r,o,null),this._addToDom(t,e)},e}(TDB.ViewElement);t.C1=e}(ke||(ke={}));var Fe=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){var n=this;this.addChild(new Me.C1(n),t,e)},e}(t.GlyphTextCalloutBodyVEBase);t.GlyphTextCalloutBodyVE=Fe;var Me;!function(t){var o=function(e){function n(t){var n=e.call(this,null)||this;return n._context=t,n}return __extends(n,e),n.prototype._create=function(e,n){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="calloutGlyphText";var r=o.calloutGlyphArgs();r&&this.addChild(r.build(o),i,null),this.addChild(new t.CcalloutText(o),i,null),this._addToDom(e,n)},n}(TDB.ViewElement);t.C1=o;var i=function(o){function i(t){var e=o.call(this,null)||this;return e._context=t,e}return __extends(i,o),i.prototype._create=function(o,i){var r=this._context,a=document.createElement("div");this.domElement=a,a._context=r,this._AttrBinding=new n.Attr.Binding(a,o,r,this,r.calloutTextAttrArgs),this._ClassNameBinding=new e.ClassName.Binding(a,o,r,this,r.calloutTextClassNameArgs);this.addChild(new t.CcalloutHeader(r),a,null),this.addChild(new t.CcalloutBody(r),a,null),this._addToDom(o,i)},i.prototype.onUpdate=function(t){this._AttrBinding.update(t),this._ClassNameBinding.update(t)},i}(TDB.ViewElement);t.CcalloutText=i;var r=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="calloutHeader",this._TextBinding=new n.Text.Binding(i,t,o,this,o.calloutHeaderTextArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._TextBinding.update(t)},e}(TDB.ViewElement);t.CcalloutHeader=r;var a=function(t){function e(e){var n=t.call(this,null)||this;return n._context=e,n}return __extends(e,t),e.prototype._create=function(t,e){var o=this._context,i=document.createElement("div");this.domElement=i,i._context=o,i.className="calloutBody",this._TextBinding=new n.Text.Binding(i,t,o,this,o.calloutBodyTextArgs),this._addToDom(t,e)},e.prototype.onUpdate=function(t){this._TextBinding.update(t)},e}(TDB.ViewElement);t.CcalloutBody=a}(Me||(Me={}));var Oe=function(t){function e(e,n){return t.call(this,e,n)||this}return __extends(e,t),e.prototype._create=function(t,e){for(var n=this,o=n.componentsArgs(),i=o.length,r=0;r<i;++r)this.addChild(o[r].build(n),t,e)},e}(t.CompositeVEBase);t.CompositeVE=Oe}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(e,n){var o=t.call(this,e,n)||this;return o.args=n,o.visible=TDB.watchable(o,!1),o}return __extends(e,t),e.prototype.show=function(){var t=this;this.currentTimeout&&clearTimeout(this.currentTimeout),TDB.applyUpdate(function(){t.screenReaderText.setValue(t.readerText),t.visible.setValue(!0)}),this.currentTimeout=platform.setTimeout(function(){TDB.applyUpdate(function(){t.screenReaderText.setValue(void 0),t.visible.setValue(!1)}),t.currentTimeout=void 0},this.args.visibilityTimeout)},e.prototype.isVisible=function(t){return this.visible.getWatchedValue(t)},e.prototype.calloutWrapperClassNameArgs=function(e){var n=t.prototype.calloutWrapperClassNameArgs.call(this,e);return this.isVisible(e)||(n+=" hiddenContent"),n},e}(t.BasicCalloutVE);t.TransientCalloutVE=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){!function(e){var n=t.View.ViewElements,o=function(){function o(){}return o.createArgsForSwayTitle=function(){var o=e.getFirstRunManager().getFirstRunType(),i=e.CalloutID.SwayTitle,r={calloutBoxClassName:"AddTitle-callout",headerText:{value:t.Common.Branding.getStringFirstRunAddTitleHeader()},readerText:Resources.FirstRunAddSwayTitleReader,beakPosition:n.BeakPosition.TopLeft,delay:e.getDelayForCallout(i,o),calloutID:i};return o===e.FirstRunType.Default?r:(o===e.FirstRunType.FRENonEmpty?r.headerText={value:t.Common.Branding.getStringFirstRunAddTitleHeaderNonEmpty()}:TDB.raiseRecoverableError("Unhandled first run type: "+o,TDB.LogLevel.error),r)},o.createArgsForTitleJack=function(t){var o=e.getFirstRunManager().getFirstRunType(),i=e.CalloutID.TitleJack,r={calloutBoxClassName:"NewTitleJack-callout",calloutTapClassName:"NewTitleJack-tap-callout",headerText:{value:Resources.FirstRunTitleJackV2},readerText:Resources.FirstRunTitleJackReader,calloutID:i,delay:e.getDelayForCallout(i,o),beakPosition:n.BeakPosition.TopLeft,context:t};return o===e.FirstRunType.Default?r:(o===e.FirstRunType.FRENonEmpty?r.headerText={value:Resources.FirstRunTitleJackHeaderNonEmpty}:TDB.raiseRecoverableError("Unhandled first run type: "+o,TDB.LogLevel.error),r)},o.createArgsForStylesButton=function(t){var o=e.getFirstRunManager().getFirstRunType(),i=e.CalloutID.StylesButton;return{calloutWrapperClassName:"SwarBarButtonCalloutWrapper",calloutBoxClassName:"StylesButton-callout",calloutTapClassName:"",headerText:{value:Resources.StylesButtonCallout},readerText:Resources.StylesButtonCallout,calloutID:i,delay:e.getDelayForCallout(i,o),beakPosition:n.BeakPosition.TopRight,context:t}},o.createArgsForDesignButton=function(t){var o=e.getFirstRunManager().getFirstRunType(),i=e.CalloutID.DesignButton;return{calloutWrapperClassName:"SwarBarButtonCalloutWrapper",calloutBoxClassName:"DesignButton-callout",calloutTapClassName:"",headerText:{value:Resources.DesignNavigationTooltip},readerText:Resources.DesignNavigationTooltip,calloutID:i,delay:e.getDelayForCallout(i,o),beakPosition:n.BeakPosition.TopLeft,context:t}},o.createArgsForPullQuote=function(t){var o=e.getFirstRunManager().getFirstRunType(),i=e.CalloutID.PullQuote;return{calloutWrapperClassName:"LayoutCalloutWrapper",calloutBoxClassName:"PullQuote-callout",calloutTapClassName:"",headerText:{value:Resources.PullQuoteFREText},readerText:Resources.PullQuoteFREText,calloutID:i,delay:e.getDelayForCallout(i,o),beakPosition:n.BeakPosition.BottomLeft,context:t}},o.createArgsForDigitalPrintStoryline=function(t){var o=e.getFirstRunManager().getFirstRunType(),i=e.CalloutID.DigitalPrintStoryline;return{calloutWrapperClassName:"SwarBarButtonCalloutWrapper",calloutBoxClassName:"StorylineButton-callout",calloutTapClassName:"",headerText:{value:Resources.FirstRunDigitalPrintStoryline},readerText:Resources.FirstRunDigitalPrintStoryline,calloutID:i,delay:e.getDelayForCallout(i,o),beakPosition:n.BeakPosition.TopLeft,context:t}},o.createArgsForDigitalPrintPlay=function(t){var o=e.getFirstRunManager().getFirstRunType(),i=e.CalloutID.DigitalPrintPlay;return{calloutWrapperClassName:"SwarBarButtonCalloutWrapper",calloutBoxClassName:"PlayButton-callout",calloutTapClassName:"",headerText:{value:Resources.FirstRunDigitalPrintPlay},readerText:Resources.FirstRunDigitalPrintPlay,calloutID:i,delay:e.getDelayForCallout(i,o),beakPosition:n.BeakPosition.TopRight,context:t,dismissCallback:function(){e.FirstRunTriggers.digitalPrintPlayCalloutDismissed=!0}}},o.createArgsForDigitalPrintShare=function(t){var o=e.getFirstRunManager().getFirstRunType(),i=e.CalloutID.DigitalPrintShare;return{calloutWrapperClassName:"SwarBarButtonCalloutWrapper",calloutBoxClassName:"ShareSway-callout",calloutTapClassName:"",headerText:{value:Resources.FirstRunDigitalPrintShare},readerText:Resources.FirstRunDigitalPrintShare,calloutID:i,delay:e.getDelayForCallout(i,o),beakPosition:n.BeakPosition.TopRight,context:t,dismissCallback:function(){e.FirstRunTriggers.digitalPrintShareCalloutDismissed=!0,e.FirstRunTriggers.shareExperienceOffered()}}},o.createArgsForDigitalPrintAuthoring=function(t){var o=e.CalloutID.DigitalPrintAuthoring;return{calloutWrapperClassName:"DigitalPrintAuthoringCalloutWrapper",calloutBoxClassName:"IngestionSurvey-callout",headerText:{value:Resources.FirstRunDigitalPrintQuickEdits},readerText:Resources.FirstRunDigitalPrintQuickEdits,beakPosition:n.BeakPosition.Left,calloutID:o,delay:e.getDelayForCallout(o,e.FirstRunType.Default),dismissCallback:function(){return e.FirstRunTriggers.authoringCalloutDismissed()}}},o.createArgsForSourceSelector=function(t){var o=e.getFirstRunManager().getFirstRunType(t),i=e.CalloutID.AddContentSourcesDropdown,r={calloutBoxClassName:"AddContentSourceSelector-callout",headerText:{value:Resources.FirstRunAddContentSourceSelectorHeader},readerText:ResourceManager.ResolveString(Resources.FirstRunAddContentSourceSelectorReader,["{0}",Resources.SourceSelectorButtonDescription]),calloutID:i,delay:e.getDelayForCallout(i,o),beakPosition:n.BeakPosition.TopLeft};return o===e.FirstRunType.Default||o===e.FirstRunType.FRENonEmpty?r:(TDB.raiseRecoverableError("Unhandled first run type: "+o,TDB.LogLevel.error),r)},o.createArgsForPreviewHeader=function(){var o=e.getFirstRunManager().getFirstRunType(),i=e.CalloutID.PreviewHeader,r={calloutWrapperClassName:"PreviewHeader-callout",calloutTapClassName:"PreviewHeader-tap-callout",headerText:{value:t.Common.Branding.getStringFirstRunPreviewHeaderHeader()},readerText:Resources.FirstRunPreviewReader,calloutID:i,delay:e.getDelayForCallout(i,o),beakPosition:n.BeakPosition.Right};return o===e.FirstRunType.Default||o===e.FirstRunType.FRENonEmpty?r:(TDB.raiseRecoverableError("Unhandled first run type: "+o,TDB.LogLevel.error),r)},o.createArgsForPreviewButton=function(o){var i=e.getFirstRunManager().getFirstRunType(),r=e.CalloutID.PreviewHeader,a={calloutBoxClassName:o,calloutTapClassName:"PreviewButton-tap-callout",headerText:{value:t.Common.Branding.getStringFirstRunPreviewHeaderHeader()},readerText:Resources.FirstRunPreviewReader,calloutID:r,delay:e.getDelayForCallout(r,i),beakPosition:n.BeakPosition.TopRight};return i===e.FirstRunType.Default||i===e.FirstRunType.FRENonEmpty?a:(TDB.raiseRecoverableError("Unhandled first run type: "+i,TDB.LogLevel.error),a)},o.createArgsForPlayButton=function(){var o=e.CalloutID.PlayButton;return{calloutBoxClassName:"PlayButton-callout",calloutTapClassName:"PlayButton-tap-callout",headerText:{compute:new TDB.ComputedOptionArgs(this,function(n){var o=e.getFirstRunManager().getFirstRunType(n),i=t.Common.Branding.getStringFirstRunPlayButtonHeader();return o===e.FirstRunType.Default?i:o===e.FirstRunType.FRENonEmpty?Resources.FirstRunPlayButtonHeaderNonEmpty:(TDB.raiseRecoverableError("Unhandled first run type: "+o,TDB.LogLevel.error),i)})},readerText:Resources.FirstRunPlayButtonReader,beakPosition:n.BeakPosition.TopRight,calloutID:o,delay:e.getDelayForCallout(o,e.FirstRunType.Default)}},o.createArgsForReturnToAuthoring=function(){var t=e.getFirstRunManager().getFirstRunType(),o=e.CalloutID.ReturnToAuthoring,i={calloutTapClassName:"ReturnToAuthoring-tap-callout",calloutWrapperClassName:"ReturnToAuthoring-callout-wrapper",headerText:{value:Resources.FirstRunReturnToAuthoringHeader},readerText:Resources.FirstRunReturnToAuthoringReader,beakPosition:n.BeakPosition.TopRight,calloutID:o,delay:e.getDelayForCallout(o,t),inAnimation:"none"};return t===e.FirstRunType.Default?(i.calloutBoxClassName="ReturnToAuthoring-calloutV2",i.headerText={value:Resources.FirstRunReturnToAuthoringV2}):t===e.FirstRunType.FRENonEmpty?(i.calloutBoxClassName="ReturnToAuthoring-callout",i.headerText={value:Resources.FirstRunReturnToAuthoringHeaderNonEmpty}):TDB.raiseRecoverableError("Unhandled first run type: "+t,TDB.LogLevel.error),i},o.createArgsForShareButton=function(t){var o=e.getFirstRunManager().getFirstRunType(t);if(o!==e.FirstRunType.Default){if(o===e.FirstRunType.FRENonEmpty){var i=e.CalloutID.ShareSway;return{calloutBoxClassName:"ShareSway-callout",calloutTapClassName:"ShareSway-tap-callout",headerText:{value:Resources.FirstRunShareYourSwayHeader},beakPosition:n.BeakPosition.TopRight,calloutID:i,inAnimation:"none",delay:e.getDelayForCallout(i,o)}}return void TDB.raiseRecoverableError("Unhandled first run type: "+o,TDB.LogLevel.error)}},o.createArgsForCustomColorEntry=function(t){var o=e.getFirstRunManager().getFirstRunType(),i=e.CalloutID.CustomColorEntry;return{calloutWrapperClassName:"SwarBarButtonCalloutWrapper",calloutBoxClassName:"CustomColor-callout",headerText:{value:Resources.CustomColorTooltip},readerText:Resources.CustomColorTooltip,beakPosition:n.BeakPosition.BottomLeft,calloutID:i,inAnimation:"none",delay:e.getDelayForCallout(i,o)}},o}();e.CalloutArgsCreator=o}(e.FRE||(e.FRE={}))}(e.Common||(e.Common={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=t.View.Common.FRE,o=function(t){function e(e,o){var i=t.call(this,e,o)||this;return i.calloutID=o.calloutID,i.dismissCallback=o.dismissCallback,n.getCalloutManager().addCallout(i.calloutID,i),i}return __extends(e,t),e.prototype.isVisible=function(t){return n.getCalloutManager().getCurrentCalloutID(t)===this.calloutID},e.prototype.dismissCallout=function(e){e||(t.prototype.dismiss.call(this),n.CommonFirstRunHelper.logFirstRunExperienceAction(ClientAction.ActionType.CalloutExited,n.FirstRunActionType.CalloutExited)),n.getCalloutManager().updateCallout(n.CalloutID.None),this.dismissCallback&&this.dismissCallback()},e}(e.BasicCalloutVE);e.FRECalloutVE=o}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){!function(t){!function(t){t[t.None=0]="None",t[t.SwayLoaded=1]="SwayLoaded",t[t.SwayTitleAdded=2]="SwayTitleAdded",t[t.JackClicked=3]="JackClicked",t[t.PreviewEntered=4]="PreviewEntered",t[t.PlayEntered=5]="PlayEntered",t[t.ReturnToAuthoringClicked=6]="ReturnToAuthoringClicked",t[t.RemixClicked=7]="RemixClicked",t[t.UndoClicked=8]="UndoClicked",t[t.Navigated=9]="Navigated",t[t.VerticalNavigated=10]="VerticalNavigated",t[t.PanoramaNavigated=11]="PanoramaNavigated",t[t.ExpoNavigated=12]="ExpoNavigated",t[t.WorldChanged=13]="WorldChanged",t[t.ThresholdContentAdded=14]="ThresholdContentAdded",t[t.DetailViewEnter=15]="DetailViewEnter",t[t.DetailViewExit=16]="DetailViewExit",t[t.StackSeen=17]="StackSeen",t[t.StackClicked=18]="StackClicked",t[t.ContentPaneOpened=19]="ContentPaneOpened",t[t.ContentPaneUserInteractedWithSearchBox=20]="ContentPaneUserInteractedWithSearchBox",t[t.ContentPaneChooseASourceClicked=21]="ContentPaneChooseASourceClicked",t[t.ContentPaneSourceWithoutSearchChoosen=22]="ContentPaneSourceWithoutSearchChoosen",t[t.ContentPaneClosed=23]="ContentPaneClosed",t[t.CalloutExited=24]="CalloutExited",t[t.CalloutPhasedOut=25]="CalloutPhasedOut",t[t.StorylineVisible=26]="StorylineVisible",t[t.PublishClicked=27]="PublishClicked",t[t.UnauthenticatedUserOpenedMenu=28]="UnauthenticatedUserOpenedMenu",t[t.HintsAvailable=29]="HintsAvailable",t[t.TextboxTextTyped=30]="TextboxTextTyped",t[t.ConsumptionSettingsButtonClicked=31]="ConsumptionSettingsButtonClicked",t[t.AutoPlaySettingsButtonClicked=32]="AutoPlaySettingsButtonClicked",t[t.AutoPlayStarted=33]="AutoPlayStarted",t[t.AutoPlayStopped=34]="AutoPlayStopped",t[t.ShareButtonClicked=35]="ShareButtonClicked",t[t.DesignOpened=36]="DesignOpened",t[t.CustomColorClicked=37]="CustomColorClicked",t[t.ValidCustomColorEntered=38]="ValidCustomColorEntered",t[t.IngestedDocumentSurvey=39]="IngestedDocumentSurvey",t[t.DigitalPrint=40]="DigitalPrint",t[t.NavigatedToDesign=41]="NavigatedToDesign",t[t.AuthoringEntered=42]="AuthoringEntered",t[t.AuthoringDismissed=43]="AuthoringDismissed",t[t.ShareDismissed=44]="ShareDismissed",t[t.MultipleAuthoringActionsTaken=45]="MultipleAuthoringActionsTaken",t[t.StylesButtonPressed=46]="StylesButtonPressed",t[t.ShareSwayAADRecipients=47]="ShareSwayAADRecipients",t[t.PullQuoteSeen=48]="PullQuoteSeen"}(t.FirstRunActionType||(t.FirstRunActionType={}));var e=function(){function t(t){this.args=t}return t.prototype.getFirstRunActionArgs=function(){return this.args},t}();t.FirstRunAction=e}(t.FRE||(t.FRE={}))}(t.Common||(t.Common={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){!function(e){!function(t){t[t.Authoring=0]="Authoring",t[t.Consumption=1]="Consumption"}(e.ExperienceType||(e.ExperienceType={}));var n;!function(t){t[t.None=0]="None",t[t.EmbedVisibility=1]="EmbedVisibility",t[t.FullVisibility=2]="FullVisibility"}(n=e.FREVisibility||(e.FREVisibility={}));var o=function(){function o(){}return o.getFREVisibility=function(t,e){return CommonSettings.ContextualFirstRunEnabled?t===StoryViewMode.Embedded?e===EmbedHostType.dd||e===EmbedHostType.ddprofile?n.None:n.EmbedVisibility:n.FullVisibility:n.None},o.initializeSessionCount=function(e){e===StoryViewMode.Edit&&t.Common.Environment.getInstance().shouldShowAuthoringEntrypoints?o.sessionCount=CommonSettings.AuthoringSessionCount:CommonSettings.IsAuthenticated?o.sessionCount=CommonSettings.ConsumptionSessionCount:o.sessionCount=parseInt(Cookie.getCookie(this.ConsumptionCountCookieName))||0},o.incrementCookieCount=function(t){var e=Cookie.getCookie(t),n=0;e&&(n=parseInt(e)),Cookie.setCookie(t,(++n).toString(),{})},o.updateCalloutShownCookie=function(t){var n,i=Cookie.getCookie(o.CalloutShownCountCookieName)||"{}";try{n=JSON.parse(i)}catch(e){StoryLog.StructuredTraceTag(596449287,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.error,"Parsing calloutShownCookie failed :"+o.CalloutShownCountCookieName,{exception:e?e.toString():"",calloutID:t,cookieValue:i})}n||(n={});var r=e.CalloutID[t];n[r]?n[r]++:n[r]=1,Cookie.setCookie(o.CalloutShownCountCookieName,JSON.stringify(n),{})},o.updateCalloutShown=function(n){if(CommonSettings.IsAuthenticated){var i={description:"Update count of times this callout was shown",type:"POST",processData:!1,data:JSON.stringify({calloutID:e.CalloutID[n]}),contentType:t.RequestManager.JsonContentType,error:function(t,e,n){"timeout"===e||t&&(0==t.status||400==t.status)?StoryLog.StructuredTraceTag(596476815,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"updateCalloutShown() returned a warning",{ErrorStatus:e,ErrorThrown:n,Status:t?t.status.toString():null}):StoryLog.StructuredTraceTag(596476816,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"updateCalloutShown() returned an error",{ErrorStatus:e,ErrorThrown:n,Status:t?t.status.toString():null})},timeout:o.updateCalloutCountTimeout};$.ajax(t.Common.UrlHelper.getInstance().updateCalloutShownCount(),i)}},o.logFirstRunExperienceAction=function(t,n){var o=e.getCalloutManager(),i=o.getCurrentCalloutID(),r=o.getCurrentCalloutStartTime(),a=platform.now()-r,s=new ClientAction.FirstRunExperienceData(t,n,i,a);ActionLogger.RecordClientAction(s)},o.ConsumptionCountCookieName="ConsumptionExperienceCount",o.CalloutShownCountCookieName="CalloutShownCount",o.updateCalloutCountTimeout=3e4,o.calloutDismissClickCount=5,o.idleTimeTreshold=7e3,o.playEntered=!1,o.sessionCount=0,o}();e.CommonFirstRunHelper=o}(e.FRE||(e.FRE={}))}(e.Common||(e.Common={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){!function(e){function n(){if(!o){o=[];var e=t.View.Common.FRE.firstRunCallouts;for(var n in e){var i=e[n];i.countCompletionActionIfCalloutNotShown&&o.push(i)}}return o}e.firstRunCallouts={swayTitle:{id:e.CalloutID.SwayTitle,completionAction:e.FirstRunActionType.SwayTitleAdded,countCompletionActionIfCalloutNotShown:!1,navigateAwayActions:[],showOnlyInAuthoringMode:!0,isOldCallout:!0,allowedVisibility:[e.FREVisibility.FullVisibility]},titleJack:{id:e.CalloutID.TitleJack,completionAction:e.FirstRunActionType.JackClicked,countCompletionActionIfCalloutNotShown:!1,navigateAwayActions:[],showOnlyInAuthoringMode:!0,isOldCallout:!0,allowedVisibility:[e.FREVisibility.FullVisibility]},verticalNavigation:{id:e.CalloutID.VerticalNavigation,completionAction:e.FirstRunActionType.Navigated,countCompletionActionIfCalloutNotShown:!1,navigateAwayActions:[e.FirstRunActionType.StorylineVisible,e.FirstRunActionType.DetailViewEnter,e.FirstRunActionType.AutoPlayStarted],showOnlyInAuthoringMode:!1,isOldCallout:!0,allowedVisibility:[e.FREVisibility.FullVisibility,e.FREVisibility.EmbedVisibility]},panoramaNavigation:{id:e.CalloutID.PanoramaNavigation,completionAction:e.FirstRunActionType.Navigated,countCompletionActionIfCalloutNotShown:!1,navigateAwayActions:[e.FirstRunActionType.StorylineVisible,e.FirstRunActionType.DetailViewEnter,e.FirstRunActionType.AutoPlayStarted],showOnlyInAuthoringMode:!1,isOldCallout:!0,allowedVisibility:[e.FREVisibility.FullVisibility,e.FREVisibility.EmbedVisibility]},expoNavigation:{id:e.CalloutID.ExpoNavigation,completionAction:e.FirstRunActionType.Navigated,countCompletionActionIfCalloutNotShown:!1,navigateAwayActions:[e.FirstRunActionType.StorylineVisible,e.FirstRunActionType.DetailViewEnter,e.FirstRunActionType.AutoPlayStarted],showOnlyInAuthoringMode:!1,isOldCallout:!0,allowedVisibility:[e.FREVisibility.FullVisibility,e.FREVisibility.EmbedVisibility]},playButton:{id:e.CalloutID.PlayButton,completionAction:e.FirstRunActionType.PlayEntered,countCompletionActionIfCalloutNotShown:!1,navigateAwayActions:[],showOnlyInAuthoringMode:!0,isOldCallout:!0,allowedVisibility:[e.FREVisibility.FullVisibility]},returnToAuthoring:{id:e.CalloutID.ReturnToAuthoring,completionAction:e.FirstRunActionType.ReturnToAuthoringClicked,countCompletionActionIfCalloutNotShown:!1,navigateAwayActions:[],showOnlyInAuthoringMode:!0,isOldCallout:!0,allowedVisibility:[e.FREVisibility.FullVisibility]},undoButton:{id:e.CalloutID.UndoButton,completionAction:e.FirstRunActionType.UndoClicked,countCompletionActionIfCalloutNotShown:!1,navigateAwayActions:[],showOnlyInAuthoringMode:!0,isOldCallout:!0,allowedVisibility:[e.FREVisibility.FullVisibility]},previewHeader:{id:e.CalloutID.PreviewHeader,completionAction:e.FirstRunActionType.PreviewEntered,countCompletionActionIfCalloutNotShown:!1,navigateAwayActions:[],showOnlyInAuthoringMode:!0,isOldCallout:!0,allowedVisibility:[e.FREVisibility.FullVisibility]},detailView:{id:e.CalloutID.DetailView,completionAction:e.FirstRunActionType.DetailViewExit,countCompletionActionIfCalloutNotShown:!1,navigateAwayActions:[],showOnlyInAuthoringMode:!1,isOldCallout:!0,allowedVisibility:[e.FREVisibility.FullVisibility]},photoStack:{id:e.CalloutID.PhotoStack,completionAction:e.FirstRunActionType.StackClicked,countCompletionActionIfCalloutNotShown:!1,navigateAwayActions:[e.FirstRunActionType.StorylineVisible],showOnlyInAuthoringMode:!1,isOldCallout:!0,allowedVisibility:[e.FREVisibility.FullVisibility]},storyline:{id:e.CalloutID.Storyline,completionAction:e.FirstRunActionType.Navigated,countCompletionActionIfCalloutNotShown:!1,navigateAwayActions:[e.FirstRunActionType.StorylineVisible],showOnlyInAuthoringMode:!0,allowedVisibility:[e.FREVisibility.FullVisibility]},emptySwayPreview:{id:e.CalloutID.EmptySwayPreview,completionAction:e.FirstRunActionType.Navigated,countCompletionActionIfCalloutNotShown:!1,navigateAwayActions:[e.FirstRunActionType.StorylineVisible],showOnlyInAuthoringMode:!0,allowedVisibility:[e.FREVisibility.FullVisibility]},addContentSearchBox:{id:e.CalloutID.AddContentSearchBox,completionAction:e.FirstRunActionType.ContentPaneUserInteractedWithSearchBox,countCompletionActionIfCalloutNotShown:!0,navigateAwayActions:[e.FirstRunActionType.ContentPaneClosed,e.FirstRunActionType.ContentPaneSourceWithoutSearchChoosen],showOnlyInAuthoringMode:!0,allowedVisibility:[e.FREVisibility.FullVisibility]},addContentSourcesDropdown:{id:e.CalloutID.AddContentSourcesDropdown,completionAction:e.FirstRunActionType.ContentPaneChooseASourceClicked,countCompletionActionIfCalloutNotShown:!0,navigateAwayActions:[e.FirstRunActionType.ContentPaneClosed],showOnlyInAuthoringMode:!0,allowedVisibility:[e.FREVisibility.FullVisibility]},publishButton:{id:e.CalloutID.PublishButton,completionAction:e.FirstRunActionType.PublishClicked,countCompletionActionIfCalloutNotShown:!0,navigateAwayActions:[],showOnlyInAuthoringMode:!0,allowedVisibility:[e.FREVisibility.FullVisibility]},remixButton:{id:e.CalloutID.RemixButton,completionAction:e.FirstRunActionType.RemixClicked,countCompletionActionIfCalloutNotShown:!1,navigateAwayActions:[],showOnlyInAuthoringMode:!0,allowedVisibility:[e.FREVisibility.FullVisibility]},overflowButton:{id:e.CalloutID.OverflowButton,completionAction:e.FirstRunActionType.UnauthenticatedUserOpenedMenu,countCompletionActionIfCalloutNotShown:!1,navigateAwayActions:[],showOnlyInAuthoringMode:!1,allowedVisibility:[e.FREVisibility.FullVisibility]},firstHintHeader:{id:e.CalloutID.FirstHint,completionAction:e.FirstRunActionType.TextboxTextTyped,countCompletionActionIfCalloutNotShown:!1,navigateAwayActions:[],showOnlyInAuthoringMode:!0,allowedVisibility:[e.FREVisibility.FullVisibility]},autoPlayConsumptionSettingsButton:{id:e.CalloutID.AutoPlayConsumptionSettingsButton,completionAction:e.FirstRunActionType.ConsumptionSettingsButtonClicked,countCompletionActionIfCalloutNotShown:!1,navigateAwayActions:[e.FirstRunActionType.StorylineVisible,e.FirstRunActionType.DetailViewEnter],showOnlyInAuthoringMode:!1,allowedVisibility:[e.FREVisibility.FullVisibility]},autoPlaySettingsButton:{id:e.CalloutID.AutoPlaySettingsButton,completionAction:e.FirstRunActionType.AutoPlaySettingsButtonClicked,countCompletionActionIfCalloutNotShown:!1,navigateAwayActions:[e.FirstRunActionType.StorylineVisible,e.FirstRunActionType.DetailViewEnter,e.FirstRunActionType.AutoPlayStopped],showOnlyInAuthoringMode:!1,allowedVisibility:[e.FREVisibility.FullVisibility]},shareButton:{id:e.CalloutID.ShareSway,completionAction:e.FirstRunActionType.ShareButtonClicked,countCompletionActionIfCalloutNotShown:!1,navigateAwayActions:[],showOnlyInAuthoringMode:!0,allowedVisibility:[e.FREVisibility.FullVisibility]},stylesButton:{id:e.CalloutID.StylesButton,completionAction:e.FirstRunActionType.StylesButtonPressed,countCompletionActionIfCalloutNotShown:!1,navigateAwayActions:[e.FirstRunActionType.StorylineVisible,e.FirstRunActionType.DetailViewEnter,e.FirstRunActionType.AutoPlayStarted],showOnlyInAuthoringMode:!0,allowedVisibility:[e.FREVisibility.FullVisibility]},designButton:{id:e.CalloutID.DesignButton,completionAction:e.FirstRunActionType.ThresholdContentAdded,countCompletionActionIfCalloutNotShown:!1,navigateAwayActions:[e.FirstRunActionType.PreviewEntered],showOnlyInAuthoringMode:!0,allowedVisibility:[e.FREVisibility.FullVisibility]},newCustomColorButton:{id:e.CalloutID.CustomColorEntry,completionAction:e.FirstRunActionType.ValidCustomColorEntered,countCompletionActionIfCalloutNotShown:!1,navigateAwayActions:[],showOnlyInAuthoringMode:!0,allowedVisibility:[e.FREVisibility.FullVisibility]},ingestedDocumentSurvey:{id:e.CalloutID.IngestedDocumentSurvey,completionAction:e.FirstRunActionType.IngestedDocumentSurvey,countCompletionActionIfCalloutNotShown:!1,navigateAwayActions:[],showOnlyInAuthoringMode:!0,allowedVisibility:[e.FREVisibility.FullVisibility]},digitalPrintWelcome:{id:e.CalloutID.DigitalPrintWelcome,completionAction:e.FirstRunActionType.ShareButtonClicked,countCompletionActionIfCalloutNotShown:!1,navigateAwayActions:[],showOnlyInAuthoringMode:!1,allowedVisibility:[e.FREVisibility.FullVisibility]},digitalPrintAuthoring:{id:e.CalloutID.DigitalPrintAuthoring,completionAction:e.FirstRunActionType.AuthoringEntered,countCompletionActionIfCalloutNotShown:!1,navigateAwayActions:[],showOnlyInAuthoringMode:!1,allowedVisibility:[e.FREVisibility.FullVisibility]},digitalPrintStoryline:{id:e.CalloutID.DigitalPrintStoryline,completionAction:e.FirstRunActionType.MultipleAuthoringActionsTaken,countCompletionActionIfCalloutNotShown:!1,navigateAwayActions:[],showOnlyInAuthoringMode:!0,allowedVisibility:[e.FREVisibility.FullVisibility]},digitalPrintShare:{id:e.CalloutID.DigitalPrintShare,completionAction:e.FirstRunActionType.AuthoringDismissed,countCompletionActionIfCalloutNotShown:!1,navigateAwayActions:[],showOnlyInAuthoringMode:!0,allowedVisibility:[e.FREVisibility.FullVisibility]},digitalPrintPlay:{id:e.CalloutID.DigitalPrintPlay,completionAction:e.FirstRunActionType.ShareDismissed,countCompletionActionIfCalloutNotShown:!1,navigateAwayActions:[],showOnlyInAuthoringMode:!0,allowedVisibility:[e.FREVisibility.FullVisibility]},shareSwayAADRecipients:{id:e.CalloutID.ShareSwayAADRecipients,completionAction:e.FirstRunActionType.ShareButtonClicked,countCompletionActionIfCalloutNotShown:!1,navigateAwayActions:[],showOnlyInAuthoringMode:!1,allowedVisibility:[e.FREVisibility.FullVisibility]},pullquote:{id:e.CalloutID.PullQuote,completionAction:e.FirstRunActionType.PullQuoteSeen,countCompletionActionIfCalloutNotShown:!1,navigateAwayActions:[],showOnlyInAuthoringMode:!1,allowedVisibility:[e.FREVisibility.FullVisibility]}};var o;e.getCalloutsThatCanBeDismissedWithoutBeingShown=n}(e.FRE||(e.FRE={}))}(e.Common||(e.Common={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){!function(e){var n=t.Common,o=function(){function t(){}return t.swayLoaded=function(t){var n={type:e.FirstRunActionType.SwayLoaded,triggeredCallouts:[e.firstRunCallouts.swayTitle],userInitiated:t};return e.getFirstRunManager().applyAction(new e.FirstRunAction(n))},t.swayTitleAdded=function(t){var n=t?[]:[e.firstRunCallouts.titleJack],o={type:e.FirstRunActionType.SwayTitleAdded,triggeredCallouts:n,userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(o))},t.jackClicked=function(){var t={type:e.FirstRunActionType.JackClicked,triggeredCallouts:[],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(t))},t.previewEnteredFromVertical=function(n){t.commonPreviewEntered(n,[e.firstRunCallouts.verticalNavigation,e.firstRunCallouts[t.AutoPlayConsumptionSettingsCalloutName]])},t.previewEnteredFromPanorama=function(n){t.commonPreviewEntered(n,[e.firstRunCallouts.panoramaNavigation,e.firstRunCallouts[t.AutoPlayConsumptionSettingsCalloutName]])},t.previewEnteredFromExpo=function(n){t.commonPreviewEntered(n,[e.firstRunCallouts.expoNavigation,e.firstRunCallouts[t.AutoPlayConsumptionSettingsCalloutName]])},t.playEnteredFromVertical=function(){var n={type:e.FirstRunActionType.PlayEntered,triggeredCallouts:[e.firstRunCallouts.verticalNavigation,t.setCalloutsForEditButtonOrTemplate(),e.firstRunCallouts[t.AutoPlayConsumptionSettingsCalloutName]],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(n))},t.playEnteredFromPanorama=function(){var n={type:e.FirstRunActionType.PlayEntered,triggeredCallouts:[e.firstRunCallouts.panoramaNavigation,t.setCalloutsForEditButtonOrTemplate(),e.firstRunCallouts[t.AutoPlayConsumptionSettingsCalloutName]],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(n))},t.playEnteredFromExpo=function(){var n={type:e.FirstRunActionType.PlayEntered,triggeredCallouts:[e.firstRunCallouts.expoNavigation,t.setCalloutsForEditButtonOrTemplate(),e.firstRunCallouts[t.AutoPlayConsumptionSettingsCalloutName]],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(n))},t.previewEnteredNoOverflow=function(e){t.commonPreviewEntered(e,[])},t.playEnteredNoOverflow=function(){var n={type:e.FirstRunActionType.PlayEntered,triggeredCallouts:[t.setCalloutsForEditButtonOrTemplate(),e.firstRunCallouts[t.AutoPlayConsumptionSettingsCalloutName]],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(n))},t.returnToAuthoringClicked=function(){var t=[];e.getFirstRunManager().getFirstRunType()===e.FirstRunType.FRENonEmpty&&t.push(e.firstRunCallouts.shareButton),n.Branding.publishButtonFREVisible()&&t.push(e.firstRunCallouts.publishButton);var o={type:e.FirstRunActionType.ReturnToAuthoringClicked,triggeredCallouts:t,userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(o))},t.remixClicked=function(){var t={type:e.FirstRunActionType.RemixClicked,triggeredCallouts:[e.firstRunCallouts.undoButton],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(t))},t.undoClicked=function(){var t={type:e.FirstRunActionType.UndoClicked,triggeredCallouts:[],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(t))},t.navigatedFromPlay=function(){var n={type:e.FirstRunActionType.Navigated,triggeredCallouts:[t.setCalloutsForEditButtonOrTemplate(),e.firstRunCallouts[t.AutoPlayConsumptionSettingsCalloutName]],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(n))},t.thresholdContentAdded=function(t){var n={type:e.FirstRunActionType.ThresholdContentAdded,triggeredCallouts:[e.firstRunCallouts.designButton],userInitiated:t};return e.getFirstRunManager().applyAction(new e.FirstRunAction(n))},t.detailViewEntered=function(){var t={type:e.FirstRunActionType.DetailViewEnter,triggeredCallouts:[e.firstRunCallouts.detailView],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(t))},t.detailViewExited=function(){var t={type:e.FirstRunActionType.DetailViewExit,triggeredCallouts:[],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(t))},t.stackSeen=function(){var t={type:e.FirstRunActionType.StackSeen,triggeredCallouts:[e.firstRunCallouts.photoStack],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(t))},t.stackClicked=function(){var t={type:e.FirstRunActionType.StackClicked,triggeredCallouts:[],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(t))},t.previewEnteredEmptySway=function(t){var n={type:e.FirstRunActionType.PreviewEntered,triggeredCallouts:t?[e.firstRunCallouts.storyline]:[e.firstRunCallouts.emptySwayPreview],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(n))},t.previewEnteredNonEmptySway=function(n){if(t.shouldShowRemixCalloutOnPreview(n)){var o={type:e.FirstRunActionType.PreviewEntered,triggeredCallouts:[e.firstRunCallouts.remixButton],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(o)),t.logRemixCalloutTriggerHappened()}},t.contentPaneOpened=function(t,n){var o;o=n?t||e.getFirstRunManager().getFirstRunType()===e.FirstRunType.FRENonEmpty?[e.firstRunCallouts.addContentSourcesDropdown,e.firstRunCallouts.addContentSearchBox]:[e.firstRunCallouts.addContentSearchBox,e.firstRunCallouts.addContentSourcesDropdown]:[e.firstRunCallouts.addContentSourcesDropdown];var i={type:e.FirstRunActionType.ContentPaneOpened,triggeredCallouts:o,userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(i))},t.designOpened=function(){var t={type:e.FirstRunActionType.DesignOpened,triggeredCallouts:[e.firstRunCallouts.stylesButton],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(t))},t.stylesButtonPressed=function(){var t={type:e.FirstRunActionType.StylesButtonPressed,triggeredCallouts:[],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(t))},t.contentPaneUserInteractedWithSearchBox=function(){var t={type:e.FirstRunActionType.ContentPaneUserInteractedWithSearchBox,triggeredCallouts:[],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(t))},t.contentPaneChooseASourceClicked=function(){var t={type:e.FirstRunActionType.ContentPaneChooseASourceClicked,triggeredCallouts:[],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(t))},t.sourceWithoutSearchSelected=function(){var t={type:e.FirstRunActionType.ContentPaneSourceWithoutSearchChoosen,triggeredCallouts:[],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(t))},t.contentPaneClosed=function(){var t={type:e.FirstRunActionType.ContentPaneClosed,triggeredCallouts:[],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(t))},t.storylineVisible=function(){var t={type:e.FirstRunActionType.StorylineVisible,triggeredCallouts:[],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(t))},t.publishClicked=function(){var t={type:e.FirstRunActionType.PublishClicked,triggeredCallouts:[],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(t))},t.unauthenticatedUserOpenedMenu=function(){var t={type:e.FirstRunActionType.UnauthenticatedUserOpenedMenu,triggeredCallouts:[],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(t))},t.hintsAvailable=function(){var t={type:e.FirstRunActionType.HintsAvailable,triggeredCallouts:[e.firstRunCallouts.firstHintHeader],userInitiated:!1};e.getFirstRunManager().applyAction(new e.FirstRunAction(t))},t.swayTextboxTextTyped=function(){var t={type:e.FirstRunActionType.TextboxTextTyped,triggeredCallouts:[],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(t))},t.shareButtonClicked=function(){var t={type:e.FirstRunActionType.ShareButtonClicked,triggeredCallouts:[],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(t))},t.consumptionSettingsButtonClicked=function(){var t={type:e.FirstRunActionType.ConsumptionSettingsButtonClicked,triggeredCallouts:[],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(t))},t.autoPlaySettingsButtonClicked=function(){var t={type:e.FirstRunActionType.AutoPlaySettingsButtonClicked,triggeredCallouts:[],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(t))},t.autoPlayStarted=function(){var n={type:e.FirstRunActionType.AutoPlayStarted,triggeredCallouts:[e.firstRunCallouts[t.AutoPlaySettingsCalloutName]],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(n))},t.autoPlayStopped=function(){var t={type:e.FirstRunActionType.AutoPlayStopped,triggeredCallouts:[],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(t))},t.newCustomColorClicked=function(){var t={type:e.FirstRunActionType.CustomColorClicked,triggeredCallouts:[e.firstRunCallouts.newCustomColorButton],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(t))},t.validCustomColorEntered=function(){var t={type:e.FirstRunActionType.ValidCustomColorEntered,triggeredCallouts:[],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(t))},t.ingestedDocumentSurveyReached=function(){var t={type:e.FirstRunActionType.IngestedDocumentSurvey,triggeredCallouts:[e.firstRunCallouts.ingestedDocumentSurvey],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(t))},t.digitalPrintEntryPoint=function(){var t={type:e.FirstRunActionType.DigitalPrint,triggeredCallouts:[e.firstRunCallouts.digitalPrintWelcome],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(t))},t.shareSwayAADRecipients=function(){var t={type:e.FirstRunActionType.ShareSwayAADRecipients,triggeredCallouts:[e.firstRunCallouts.shareSwayAADRecipients],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(t))},t.navigatedToDesign=function(){var t={type:e.FirstRunActionType.NavigatedToDesign,triggeredCallouts:[e.firstRunCallouts.digitalPrintAuthoring],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(t))},t.multipleAuthoringActionsTaken=function(){var t={type:e.FirstRunActionType.MultipleAuthoringActionsTaken,triggeredCallouts:[e.firstRunCallouts.digitalPrintStoryline],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(t))},t.authoringCalloutDismissed=function(){var t={type:e.FirstRunActionType.AuthoringDismissed,triggeredCallouts:[e.firstRunCallouts.digitalPrintShare],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(t))},t.shareExperienceOffered=function(){t.digitalPrintShareCalloutDismissed&&platform.setTimeout(function(){var t={type:e.FirstRunActionType.ShareDismissed,triggeredCallouts:[e.firstRunCallouts.digitalPrintPlay],userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(t))},2e3)},t.lightWeightAuthoring=function(){t.digitalPrintPlayCalloutDismissed&&++t.contextMenuCounter===t.contextMenuCalloutCountTrigger&&t.multipleAuthoringActionsTaken()},t.pullquoteVisible=function(t){var n={type:e.FirstRunActionType.PullQuoteSeen,triggeredCallouts:[e.firstRunCallouts.pullquote],userInitiated:!0,triggerContext:t};e.getFirstRunManager().applyAction(new e.FirstRunAction(n))},t.commonPreviewEntered=function(o,i){e.getFirstRunManager().getFirstRunType()===e.FirstRunType.FRENonEmpty?++t.numPreviewEntered>t.previewEnteredTreshold&&i.push(e.firstRunCallouts.playButton):i.push(e.firstRunCallouts.playButton),t.shouldShowRemixCalloutOnPreview(o)&&(i.push(e.firstRunCallouts.remixButton),t.logRemixCalloutTriggerHappened()),n.Branding.publishButtonFREVisible()&&i.push(e.firstRunCallouts.publishButton);var r={type:e.FirstRunActionType.PreviewEntered,triggeredCallouts:i,userInitiated:!0};e.getFirstRunManager().applyAction(new e.FirstRunAction(r))},t.shouldShowRemixCalloutOnPreview=function(e){return!(e<t.MinNumElementsForRemixFRE||!CommonSettings.FRERemixButtonEnabled)&&CommonSettings.CurrentUserType===UserType.AAD_EDU},t.logRemixCalloutTriggerHappened=function(){ActionLogger.RecordClientAction(new ClientAction.SimpleClientActionData(ClientAction.ActionType.RemixCalloutTriggerHappened,Diag.ULSCat.msoulscat_Story_Site))},t.setCalloutsForEditButtonOrTemplate=function(){return CommonSettings.TemplateStoriesEnabled&&CommonSettings.IsTemplateSway?e.firstRunCallouts.overflowButton:e.firstRunCallouts.returnToAuthoring},t.MinNumElementsForRemixFRE=4,t.AutoPlayConsumptionSettingsCalloutName="autoPlayConsumptionSettingsButton",t.AutoPlaySettingsCalloutName="autoPlaySettingsButton",t.numPreviewEntered=0,t.previewEnteredTreshold=3,t.digitalPrintPlayCalloutDismissed=!1,t.digitalPrintShareCalloutDismissed=!1,t.contextMenuCounter=0,t.contextMenuCalloutCountTrigger=3,t}();e.FirstRunTriggers=o}(e.FRE||(e.FRE={}))}(e.Common||(e.Common={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){!function(e){var n=function(){function n(t,n){this.firstRunType=TDB.watchableTag(596476812,this,e.FirstRunType.Default),this.storyViewMode=t,this.currentCompletionAction=null,this.currentNavigateAwayActions=[],this.alreadySeenCallouts=new Array,this.calloutManager=e.getCalloutManager(),this.extraClicks=0,this.visibility=n,this.lastActionTimestamp=platform.now(),this.swayLoadedTriggered=!1,this.isPublishEntryPoint=CommonSettings.IsPublish,this.setCalloutShownCountFromJSON()}return n.prototype.getFirstRunType=function(t){return this.firstRunType.getWatchedValue(t)},n.prototype.updateFirstRunType=function(t){var e=this;TDB.applyUpdate(function(){return e.firstRunType.setValue(t)})},n.prototype.setup=function(t,n,o){this.currentCompletionAction=e.FirstRunActionType.SwayLoaded,this.storyViewMode=t,this.visibility=n,o&&(this.currentNavigateAwayActions=[],this.alreadySeenCallouts=new Array,this.extraClicks=0),this.calloutManager=e.getCalloutManager(),this.calloutManager.updateCallout(e.CalloutID.None)},n.prototype.getVisibility=function(){return this.visibility},n.prototype.handleClick=function(t){var n=this;return $(t.target).closest(".dlg").length>0||this.extraClicks++,this.swayLoadedTriggered||this.firstRunType.getValue()!==e.FirstRunType.FRENonEmpty||(this.lastActionTimestamp=platform.now(),platform.setTimeout(function(){return n.handleIdleTime()},e.CommonFirstRunHelper.idleTimeTreshold)),this.extraClicks>=e.CommonFirstRunHelper.calloutDismissClickCount&&this.calloutManager.getCurrentCalloutID()!==e.CalloutID.None&&this.calloutManager.getCurrentCalloutID()!==e.CalloutID.IngestedDocumentSurvey&&(e.CommonFirstRunHelper.logFirstRunExperienceAction(ClientAction.ActionType.FirstRunExperience_CalloutPhasedOut,e.FirstRunActionType.CalloutPhasedOut),this.calloutManager.clearCallouts(),this.currentCompletionAction=e.FirstRunActionType.None,this.currentNavigateAwayActions=[],this.extraClicks=0),this.extraClicks},n.prototype.handleKeyEvent=function(t){var n=this;this.firstRunType.getValue()===e.FirstRunType.FRENonEmpty&&(this.swayLoadedTriggered||(this.lastActionTimestamp=platform.now(),platform.setTimeout(function(){return n.handleIdleTime()},e.CommonFirstRunHelper.idleTimeTreshold)))},n.prototype.handleIdleTime=function(){platform.now()-this.lastActionTimestamp>=e.CommonFirstRunHelper.idleTimeTreshold&&(this.swayLoadedTriggered=e.FirstRunTriggers.swayLoaded(!1))},n.prototype.applyAction=function(t){if(!t.getFirstRunActionArgs().userInitiated&&this.calloutManager&&this.calloutManager.getCurrentCalloutID()!=e.CalloutID.None)return!1;var n=t.getFirstRunActionArgs().type===this.currentCompletionAction,o=ArrayExtensions.contains(this.currentNavigateAwayActions,t.getFirstRunActionArgs().type);(n||o)&&(e.CommonFirstRunHelper.logFirstRunExperienceAction(n?ClientAction.ActionType.FirstRunExperience_CorrectCompletionAction:ClientAction.ActionType.FirstRunExperience_UserNavigatedAwayFromContentThatHasCallout,t.getFirstRunActionArgs().type),this.calloutManager.clearCallouts(),this.currentCompletionAction=e.FirstRunActionType.None,this.currentNavigateAwayActions=[],this.extraClicks=-1);for(var i=e.getCalloutsThatCanBeDismissedWithoutBeingShown(),r=0;r<i.length;r++){var a=i[r];a.completionAction===t.getFirstRunActionArgs().type&&this.shouldShowCallout(a)&&(e.CommonFirstRunHelper.logFirstRunExperienceAction(ClientAction.ActionType.FirstRunExperience_UserCompletedActionBeforeCalloutWasShown,a.completionAction),this.updateCalloutShown(a),this.alreadySeenCallouts[a.id]=!0)}return this.triggerCallout(t)},n.prototype.clearCalloutHistory=function(t){this.alreadySeenCallouts[t]=!1},n.prototype.triggerCallout=function(t){for(var n=t.getFirstRunActionArgs().triggeredCallouts,o=t.getFirstRunActionArgs().triggerContext,i=0;i<n.length;i++){var r=n[i];if(this.shouldShowCallout(r))return this.calloutManager&&this.calloutManager.getCurrentCalloutID()!=e.CalloutID.None&&e.CommonFirstRunHelper.logFirstRunExperienceAction(ClientAction.ActionType.FirstRunExperience_CalloutDismissedInFavorOfNewCallout,t.getFirstRunActionArgs().type),this.triggerFirstRunCallout(r,o),!0}return!1},n.prototype.isAuthoringMode=function(){return CommonSettings.IsAuthenticated&&CommonSettings.IsEnabled&&this.storyViewMode===StoryViewMode.Edit},n.prototype.maxTimesToShow=function(t){return this.isDigitalPrintCalloutID(t)?CommonSettings.FirstRunEnabledPublishSessionCount:t==e.CalloutID.PullQuote?1:CommonSettings.FirstRunEnabledSessionCount},n.prototype.shouldShowCallout=function(n){var o=this.calloutShownCount[e.CalloutID[n.id]]>=this.maxTimesToShow(n.id),i=CommonSettings.IsFirstRun||!o&&!this.oldCalloutAlreadySeen(n)||n.id===e.CalloutID.IngestedDocumentSurvey;return i=i&&!(!this.isPublishEntryPoint&&this.isDigitalPrintCalloutID(n.id)),i=i&&!this.alreadySeenCallouts[n.id],i=i&&ArrayExtensions.contains(n.allowedVisibility,this.visibility),i=i&&(!n.showOnlyInAuthoringMode||this.isAuthoringMode()),i=i&&t.Common.Environment.getInstance().shouldShowAuthoringEntrypoints()},n.prototype.isDigitalPrintCalloutID=function(t){return t==e.CalloutID.DigitalPrintAuthoring||t==e.CalloutID.DigitalPrintPlay||t==e.CalloutID.DigitalPrintShare||t==e.CalloutID.DigitalPrintWelcome||t==e.CalloutID.DigitalPrintStoryline},n.prototype.oldCalloutAlreadySeen=function(t){return e.CommonFirstRunHelper.sessionCount>CommonSettings.FirstRunEnabledSessionCount&&t.isOldCallout},n.prototype.triggerFirstRunCallout=function(t,e){if(this.updateCalloutShown(t),this.calloutManager){this.calloutManager.updateCallout(t.id,e);var n=this.calloutManager.getCallout(t.id);n&&platform.setTimeout(function(){return n.setup()},1e3*n.getDelay())}this.alreadySeenCallouts[t.id]=!0,this.extraClicks=-1,this.currentCompletionAction=t.completionAction,this.currentNavigateAwayActions=t.navigateAwayActions},n.prototype.updateCalloutShown=function(t){this.updateCalloutShownRequest(t),this.calloutShownCount[e.CalloutID[t.id]]?this.calloutShownCount[e.CalloutID[t.id]]++:this.calloutShownCount[e.CalloutID[t.id]]=1},n.prototype.updateCalloutShownRequest=function(t){t.showOnlyInAuthoringMode||e.CommonFirstRunHelper.updateCalloutShownCookie(t.id),e.CommonFirstRunHelper.updateCalloutShown(t.id)},n.prototype.setCalloutShownCountFromJSON=function(){var t,n=CommonSettings.IsAuthenticated;try{t=n?CommonSettings.ContextualHintData:Cookie.getCookie(e.CommonFirstRunHelper.CalloutShownCountCookieName),this.calloutShownCount=JSON.parse(t||"{}")}catch(e){StoryLog.StructuredTraceTag(596476813,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.error,"Parsing calloutShownCountJSON failed :"+this.calloutShownCount,{isAuthenticated:n,cookieCount:t,exception:e?e.toString():""}),this.calloutShownCount={}}},n}();e.FirstRunManager=n}(e.FRE||(e.FRE={}))}(e.Common||(e.Common={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){!function(t){function e(){return o||new t.NullFirstRunManager}function n(e,n,i){return i?o=new t.MockFirstRunManager(e,n):n===t.FREVisibility.None?o=new t.NullFirstRunManager:o&&o instanceof t.FirstRunManager||(o=new t.FirstRunManager(e,n)),o.setup(e,n,i),o}var o;t.getFirstRunManager=e,t.initializeFirstRunManager=n;!function(t){t[t.Default=0]="Default",t[t.FRENonEmpty=1]="FRENonEmpty"}(t.FirstRunType||(t.FirstRunType={}))}(t.FRE||(t.FRE={}))}(t.Common||(t.Common={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){!function(t){var e=function(){function e(){}return e.prototype.addCallout=function(t,e){},e.prototype.getCallout=function(t){return null},e.prototype.getCurrentCalloutID=function(e){return t.CalloutID.None},e.prototype.getCurrentCalloutStartTime=function(){return null},e.prototype.isActiveCallout=function(t,e){return!1},e.prototype.getCurrentTriggerContext=function(){},e.prototype.updateCallout=function(t,e){},e.prototype.clearCallouts=function(){},e.prototype.setup=function(){},e}();t.NullFRECalloutManager=e}(t.FRE||(t.FRE={}))}(t.Common||(t.Common={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){!function(t){var e=function(){function e(){this.isPublishEntryPoint=!1}return e.prototype.setup=function(t,e,n){},e.prototype.handleClick=function(){return 0},e.prototype.handleKeyEvent=function(t){},e.prototype.applyAction=function(t){return!1},e.prototype.getVisibility=function(){return t.FREVisibility.None},e.prototype.getFirstRunType=function(e){return t.FirstRunType.Default},e.prototype.updateFirstRunType=function(t){},e.prototype.clearCalloutHistory=function(t){},e}();t.NullFirstRunManager=e}(t.FRE||(t.FRE={}))}(t.Common||(t.Common={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.updateCalloutShownRequest=function(t){},e}(t.FirstRunManager);t.MockFirstRunManager=e}(t.FRE||(t.FRE={}))}(t.Common||(t.Common={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(e,n){var o=t.call(this,e,{buttonId:n.buttonId,context:n.context,calculateChecked:n.calculateChecked,role:Aria.Roles.Option,tooltip:n.tooltip})||this;return o.carouselListItemArgs=n,o.parentCarouselList=e,o}return __extends(e,t),e.prototype.getOptionAttrArgs=function(t){var e=this.getButtonAttributes(t);return e[Aria.Attributes.Posinset]=(this.carouselListItemArgs.listIndex+1).toString(),e[Aria.Attributes.Setsize]=this.parentCarouselList.getListLength().toString(),e[Aria.Attributes.Selected]=this.isChecked.getWatchedValue(t)?Aria.BooleanState.True:Aria.BooleanState.False,e[Aria.Attributes.Pressed]=void 0,e},e}(t.ToggleButtonVE);t.CarouselListItemVE=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(e){function n(t,n){var o=e.call(this,t,n)||this;return o.args=n,o.selected=TDB.watchableOption(o,n.isSelected,!1),o.dropdownList=t,o}return __extends(n,e),n.prototype.getRole=function(){return this.args.role},n.prototype.isSelected=function(t){return this.selected.getWatchedValue(t)},n.prototype.onAction=function(t){return this.dropdownList.onOptionInvoked(this),TDB.EventPropagation.Bypass},n.prototype.wrapperAttrArgs=function(t){return this.getWrapperAttributes(t)},n.prototype.wrapperClassNameArgs=function(t){return this.isSelected(t)?"DropdownListItem DropdownListItemSelected":"DropdownListItem"},n.prototype.chevronIconArgs=function(){if(this.args.role===Aria.Roles.Button){var e={fontIconName:{value:FontIcons.DropdownChevronIcon},fontIconSizeClass:FontIcons.DropdownChevronIconSize,fontIconWrapperClass:{compute:new TDB.ComputedOptionArgs(this,this.getCssClassForDropdownButton)}};return new TDB.ChildArgs(t.FontIconVE,e)}},n.prototype.getWrapperAttributes=function(t){var e=this.getButtonAttributes(t);return this.args.role===Aria.Roles.Button?this.addButtonAttributes(t,e):this.addDefaultListItemAttributes(t,e),e[ControlAttributes.Attributes.Disabled]=this.isEnabled(t)?ControlAttributes.DisabledState.Enabled:ControlAttributes.DisabledState.Disabled,e},n.prototype.getCssClassForDropdownButton=function(t){return this.dropdownList.getDropdownVisibility(t)?"DropdownListChevronButton DropdownListChevronButtonActive":"DropdownListChevronButton"},n.prototype.addButtonAttributes=function(t,e){e[Aria.Attributes.Expanded]=Aria.BooleanState.fromBoolean(this.dropdownList.getDropdownVisibility(t)),e[Aria.Attributes.Haspopup]=Aria.BooleanState.True},n.prototype.addDefaultListItemAttributes=function(t,e){e[Aria.Attributes.Posinset]=(this.dropdownList.getListIndex(this.args,t)+1).toString(),e[Aria.Attributes.Setsize]=this.dropdownList.getListLength(t).toString(),e[Aria.Attributes.Checked]=Aria.BooleanState.fromBoolean(this.isSelected(t))},n}(t.ButtonVE);t.DropdownListItemVE=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var Flags=function(){function t(e,n){if(this.type=e,this.value=n,!t.isValid(e,n))throw StoryApp.RethrowLogger.createError("invalid value for flags")}return t.prototype.none=function(){return 0===this.value},t.prototype.has=function(t){return(t&this.value)===t},t.prototype.includes=function(t){return(t.value&this.value)===t.value},t.prototype.set=function(t){this.value=this.value|t},t.prototype.unset=function(t){this.value=this.value&~t},t.prototype.raw=function(){return this.value},t.prototype.serialize=function(){return t.serialize(this.type,this.value)},t.prototype.reset=function(){this.value=0},t.serialize=function(t,e){for(var n=[],o=0;o<32;++o){var i=1<<o,r=t[i];if(void 0===t[i])break;e&i&&n.push(r)}return n.join(", ")},t.deserialize=function(e,n){var o=n.split(", ").map(function(t){return e[t]}).reduce(function(t,e){return t|e},0);if(!t.isValid(e,o))throw StoryApp.RethrowLogger.createError("invalid value for flags");return o},t.isValid=function(t,e){for(var n=0,o=0;o<32;++o){var i=1<<o;if(void 0===t[i])break;n|=i}return!(e&~n)},t}(),CommonSettings,ResourceManager;!function(t){function e(t,e){return void 0!==e&&(t=StoryApp.Utilities.formatString(t,e)),t}function n(t,e,n){var o=[];if(!n)return[e.fromString(t)];for(var i=/\{(\d+)\}/g,r=t.split(/\{\d+\}/),a=0;a<r.length;a++){var s=i.exec(t),l=s?s[0]:void 0,u=s?parseInt(s[1]):void 0;if(r[a].length>0&&o.push(e.fromString(r[a])),!l)break;if(void 0===n[u]||null===n[u])throw StoryApp.RethrowLogger.createError("args["+u+"] should be defined.");o.push(e.fromArg(n[u]))}return o}function o(t,e,o){return n(t,new s(o),e)}function i(t,e,n){return r(o(t,e,n))}function r(t){return t.map(function(t){return t.link?new TDB.ChildArgs(a.ClickableLinkVE,t.link):new TDB.ChildArgs(a.SpanMessageVE,t.span)})}var a=StoryApp.View.ViewElements;t.ResolveString=e,t.resolveWithViewElementArgs=o,t.resolveWithChildArgs=i,t.convertToChildArgs=r;var s=function(){function t(t){this.css=t}return t.prototype.fromString=function(t){return{span:{message:t,messageCss:this.css}}},t.prototype.fromArg=function(e){if(t.isNullOrUndefined(e))throw StoryApp.RethrowLogger.createError("arg should not be undefined or null");return t.isNullOrUndefined(e.url)&&t.isNullOrUndefined(e.title)?t.isNullOrUndefined(e.message)?{span:{message:e.toString()}}:{span:e}:{link:e}},t.isNullOrUndefined=function(t){return null===t||void 0===t},t}()}(ResourceManager||(ResourceManager={}));var StoryApp;!function(t){var e=function(){function t(){}return t.logIfError=function(e){try{return e()}catch(e){throw t.createError(e)}},t.createError=function(t){void 0===t&&(t=""),"string"==typeof t&&(t=new Error(t));var e=""+(t.stack||t);if(StoryLog.TraceTag(596464652,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,e),e.length>StoryLog.assumedMaxLogLength){StoryLog.TraceTag(596464518,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"End of long stack: "+e.substring(e.length-StoryLog.assumedMaxLogLength-"End of long stack:".length))}return t},t}();t.RethrowLogger=e}(StoryApp||(StoryApp={}));var State={DocumentUnloading:!1,PauseUpdates:!1,DisableRequestManager:!1},StoryApp;!function(t){!function(e){var n=function(){function e(){this.o365TileClass=".o365cs-nav-appTile",this.getShellService=this.GetShellServiceInfo()}return e.getInstance=function(){return null==e.s_instance&&(e.s_instance=new e),e.s_instance},e.prototype.ShellIsStillLoading=function(){return 0!==$(".SwitcherLoading").length},e.prototype.LoadShellData=function(){var t=this;this.AddLauncherIfNotPresent(),"undefined"!=typeof O365Shell&&"resolved"===this.getShellService.state()?(StoryLog.TraceTag(596477155,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"O365ShellService : LoadShellData : O365 JS now available so start rendering shell."),O365Shell.SetData($.parseJSON(this.cachedNavBarJsonData)),O365Shell.RenderAsync({launcher:"sw_bar_launcher",switcher:"sw_bar"},this.RenderShellData,function(){$(t.o365TileClass).first().focus()})):(StoryLog.TraceTag(596477154,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"O365ShellService : LoadShellData : O365Shell not defined yet."),"rejected"===this.getShellService.state()&&(this.getShellService=this.GetShellServiceInfo()))},e.prototype.AddLauncherIfNotPresent=function(){if(0===$("#sw_bar_launcher").length){var t=$("<div>",{id:"sw_bar_launcher"}),e=$("#sw_bar");0!==e.length&&e.append(t)}},e.prototype.RenderShellData=function(){StoryLog.TraceTag(596477153,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"O365ShellService : RenderShellData : O365 Shell is ready to render.");var t=$("#sw_bar");0!==t.length&&t.removeClass("SwitcherLoading")},e.prototype.GetShellServiceInfo=function(){var e=this;return StoryLog.TraceTag(596477184,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"O365ShellService : GetShellServiceInfo : Getting Shell info needed to get O365 Shell JS and CSS"),$.getJSON(CommonSettings.GetO365ShellInfoUrl,null,function(){}).done(function(t){StoryLog.TraceTag(596477185,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Successfully acquired O365 Shell info."),e.cachedNavBarJsonData=t.NavBarDataJson,e.cachedFlights=t.FlightNames,e.swayHomeUrl=e.parseSwayHomePageUrl(),e.addShellCss(t.CssUrl),e.addShellJs(t.JsUrl)}).fail(function(){var e=t.Common.Environment.getInstance().isProductionEnvironment()?Diag.ULSTraceLevel.warning:Diag.ULSTraceLevel.info;StoryLog.TraceTag(596477186,Diag.ULSCat.msoulscat_Story_Site,e,"Failed to acquire O365 Shell info.")})},e.prototype.parseSwayHomePageUrl=function(){var t;try{var e=JSON.parse(this.cachedNavBarJsonData);if(e){var n=ArrayExtensions.firstOrDefault(e.WorkloadLinks,function(t){return"ShellSway"===t.Id});n&&(t=n.Url)}}finally{return t}},e.prototype.addShellCss=function(t){var e=$("<link />").attr({charset:"UTF-8",href:t,rel:"stylesheet",type:"text/css"});$(document.head).append(e)},e.prototype.addShellJs=function(t){var e=$("<script />").attr({src:t,type:"text/javascript"});$(document.head).append(e)},e.prototype.getFlightInformationAvailableWatcher=function(t){var e=TDB.watchableTag(595952713,t,null!=this.cachedFlights);return null==this.cachedFlights&&this.updateFlightInformation(e),e},e.prototype.updateFlightInformation=function(t){this.getShellService.then(function(){return TDB.applyUpdate(function(){return t.setValue(!0)},TDB.Justification.Initialization)})},e.prototype.isSwayStartPageUrlFlightEnabled=function(){return this.cachedFlights&&-1!==this.cachedFlights.indexOf(CommonSettings.OfficeComSwayHomepageUrlFlightName)},e}();e.O365ShellService=n}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var CancellationSource=function(){function t(){this._completed=!1}return t.prototype.cancel=function(){var t=this._completed;this._completed=!0,!t&&this._onCancelled&&this._onCancelled()},t.prototype.registerOnCancelled=function(t,e){var n=this;if(this._onCancelled)throw StoryApp.RethrowLogger.createError("Cancellation callback already registered.");t.then(function(){n._completed=!0}),this._onCancelled=e},t}(),Cookie=function(){function t(){}return t.getCookie=function(t){for(var e=document.cookie.split("; "),n=0;n<e.length;n++){var o=e[n],i=o.indexOf("=");if(!(i<0)&&o.substr(0,i)===t)return o.substr(i+1)}return null},t.setCookie=function(t,e,n){var o=t+"="+e;n.path&&(o+="; path="+n.path),n.domain&&(o+="; domain="+n.domain),n.maxAge&&(o+="; max-age="+n.maxAge),n.expires&&(o+="; expires="+n.expires.toUTCString()),n.secure&&(o+="; secure"),document.cookie=o},t.getAnonUserId=function(){return t.getCookie(t._anonUserCookieKey)},t.setODCSMForceRefresh=function(e){var n=new Date;n.setMinutes(n.getMinutes()+10);var o={expires:n,path:"/"};t.setCookie(e,"true",o)},t.setPageRequestInfo=function(e){var n=(new Date).getTime().toString(),o=new Date;o.setTime(o.getTime()+1e3);var i={expires:o,path:"/",secure:!0};t.setCookie(t._requestTimeCookieKey,n,i),t.setCookie(t._requestTargetCookieKey,e,i);var r=new Date;r.setDate(r.getDate()-90),t.setCookie(t._redirectOperationCookieKey,"",{expires:r,path:"/"})},t.setUnsupportedBrowserCookie=function(){t.setCookie(t._unsupportedBrowserCookieKey,"true",{path:"/"})},t.getUnsupportedBrowserCookie=function(){return t.getCookie(t._unsupportedBrowserCookieKey)},t.setDeveloperCdnCookie=function(e){t.setCookie(t._developerCdnCookieKey,e,{path:"/",expires:new Date(Date.now()+864e5)})},t.getDeveloperCdnCookie=function(){return t.getCookie(t._developerCdnCookieKey)},t.getMockingCookie=function(){var e=t.getCookie(t._mockingCookieKey);if(e){var n={};return e.split("&").forEach(function(t){var e=t.split("="),o=e[0],i=e[1];o&&i&&(n[o]=i)}),{enabled:"EnabledFromClient"===n.mode,userNumber:Number(n.mockUserNumber),signedIn:"true"===n.mockSignedIn.toLowerCase(),isAAD:"AAD"==n.mockUserType}}},t.removeDeveloperCdnCookie=function(){t.removeCookie(t._developerCdnCookieKey)},t.removeCookie=function(e,n){void 0===n&&(n=null),t.setCookie(e,"",{path:"/",expires:new Date(0),domain:n})},t._anonUserCookieKey="anonuserid",t._requestTimeCookieKey="pagerequesttime",t._requestTargetCookieKey="pagerequesttarget",t._redirectOperationCookieKey="pagerequestoperation",t._unsupportedBrowserCookieKey="unsupportedbrowser",t._developerCdnCookieKey="DeveloperCDN",t._mockingCookieKey="story-mocking",t.CookieBlockerCookieKey="cookieblocked",t}(),PageType;!function(t){t[t.Basic=0]="Basic",t[t.SuggestedContent=1]="SuggestedContent",t[t.MyDevice=2]="MyDevice",t[t.AddSource=4]="AddSource",t[t.Camera=5]="Camera",t[t.UnavailableForClient=6]="UnavailableForClient"}(PageType||(PageType={}));var ObjectOM=function(){function t(){this._id=IdGenerator.generate()}return t}(),CompartmentComponent=function(){function t(t){this.pageId=t}return t}(),DisposableObjectOM=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(Disposable),Point=function(){function t(t,e){this.left=void 0!==t?t:0,this.top=void 0!==e?e:0}return t.prototype.getDistanceToPoint=function(t){var e=this.left-t.left,n=this.top-t.top;return Math.sqrt(e*e+n*n)},t}(),EdgeSegment;!function(t){t[t.Bottom=0]="Bottom",t[t.Right=1]="Right",t[t.Left=2]="Left",t[t.Top=3]="Top"}(EdgeSegment||(EdgeSegment={}));var BaseRect=function(){function t(t,e,n,o){this.left=t,this.top=e,this.width=n,this.height=o}return t.prototype.flipped=function(){return new Rect(this.top,this.left,this.height,this.width)},t.prototype.clone=function(){return new t(this.left,this.top,this.width,this.height)},t.prototype.centerScaleRectangle=function(e){return new t(this.left-this.width*(e-1)/2,this.top-this.height*(e-1)/2,this.width*e,this.height*e)},t.prototype.set=function(t){this.left=t.left,this.top=t.top,this.width=t.width,this.height=t.height},t.prototype.equals=function(t){return this.left==t.left&&this.top==t.top&&this.width==t.width&&this.height==t.height},Object.defineProperty(t.prototype,"bottom",{get:function(){return this.top+this.height},set:function(t){t>=this.top?this.height=t-this.top:(this.top=t,this.height=0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.left+this.width},set:function(t){t>=this.left?this.width=t-this.left:(this.left=t,this.width=0)},enumerable:!0,configurable:!0}),t.prototype.boundingRect=function(t){if(0===t.length)return null;for(var e=t[0],n=t.length,o=1;o<n;o++){var i=t[o];i.top<e.top&&(e.top=i.top),i.bottom>e.bottom&&(e.bottom=i.bottom),i.left<e.left&&(e.left=i.left),i.right>e.right&&(e.right=i.right)}return e},t.prototype.containsPoint=function(t,e){return!(t<this.top||t>this.top+this.height)&&!(e<this.left||e>this.left+this.width)},t.prototype.containsRect=function(t){return this.containsPoint(t.top,t.left)&&this.containsPoint(t.bottom,t.right)},t.prototype.overlapsRect=function(t){return this.left<t.right&&t.left<this.right&&this.top<t.bottom&&t.top<this.bottom},t.prototype.getCenter=function(){return new Point(this.left+this.width/2,this.top+this.height/2)},t.prototype.getDistanceToPoint=function(t){var e,n;return e=this.left<=t.left&&t.left<=this.right?0:this.right<t.left?t.left-this.right:this.left-t.left,n=this.bottom>=t.top&&t.top>=this.top?0:this.top>t.top?this.top-t.top:t.top-this.bottom,Math.sqrt(e*e+n*n)},t.prototype.getDistanceToPointFromExtendedEdge=function(t,e){var n=0;switch(e){case EdgeSegment.Bottom:n=Math.abs(this.bottom-t.top);break;case EdgeSegment.Left:n=Math.abs(this.left-t.left);break;case EdgeSegment.Right:n=Math.abs(this.right-t.left);break;case EdgeSegment.Top:n=Math.abs(this.top-t.top)}return n},t}(),Rect=function(){function t(t,e,n,o){this.left=void 0!==t?t:0,this.top=void 0!==e?e:0,this.width=void 0!==n?n:0,this.height=void 0!==o?o:0}return t.prototype.toBaseRect=function(){return new BaseRect(this.left,this.top,this.width,this.height)},t}();Object.defineProperties(Rect.prototype,{bottom:Object.getOwnPropertyDescriptor(BaseRect.prototype,"bottom"),right:Object.getOwnPropertyDescriptor(BaseRect.prototype,"right"),flipped:Object.getOwnPropertyDescriptor(BaseRect.prototype,"flipped"),set:Object.getOwnPropertyDescriptor(BaseRect.prototype,"set"),equals:Object.getOwnPropertyDescriptor(BaseRect.prototype,"equals"),containsPoint:Object.getOwnPropertyDescriptor(BaseRect.prototype,"containsPoint"),containsRect:Object.getOwnPropertyDescriptor(BaseRect.prototype,"containsRect"),overlapsRect:Object.getOwnPropertyDescriptor(BaseRect.prototype,"overlapsRect"),getCenter:Object.getOwnPropertyDescriptor(BaseRect.prototype,"getCenter"),getDistanceToPoint:Object.getOwnPropertyDescriptor(BaseRect.prototype,"getDistanceToPoint"),getDistanceToPointFromExtendedEdge:Object.getOwnPropertyDescriptor(BaseRect.prototype,"getDistanceToPointFromExtendedEdge"),boundingRect:Object.getOwnPropertyDescriptor(BaseRect.prototype,"boundingRect")});var RemoveEditor;!function(t){function e(t,e){ActionLogger.RecordClientAction(new ClientAction.RemoveEditorActionData);var n=StoryApp.Common.UrlHelper.getInstance().removeEditorUrl(e,t);return $.ajax(n,{name:"RemoveEditor",description:"Removes an editor from the list of editors",type:"POST",contentType:StoryApp.RequestManager.JsonContentType,dataType:"json"})}t.removeEditorRequest=e}(RemoveEditor||(RemoveEditor={}));var Color=function(){function t(t,e,n,o){this.tolerance=Math.pow(10,-4),"string"==typeof t?(this.a=parseInt(t.substr(1,2),16)/255,this.r=parseInt(t.substr(3,2),16),this.g=parseInt(t.substr(5,2),16),this.b=parseInt(t.substr(7,2),16)):(this.r=t,this.g=e||0,this.b=n||0,this.a=void 0===o?1:o)}return t.toHex=function(t){var e=Math.round(t).toString(16);return e.length>2?e="ff":e.length<2&&(e="0"+e),e},t.prototype.toHexString=function(){return"#"+t.toHex(this.r)+t.toHex(this.g)+t.toHex(this.b)},t.prototype.toArgbString=function(){return"#"+t.toHex(255*this.a)+t.toHex(this.r)+t.toHex(this.g)+t.toHex(this.b)},t.prototype.toRGBAString=function(){return"rgba("+this.r+","+this.g+","+this.b+","+this.a+")"},t.prototype.clone=function(){return new t(this.r,this.g,this.b,this.a)},t.prototype.blend=function(t){this.r=Math.round(t.r*t.a+this.r*this.a*(1-t.a)),this.g=Math.round(t.g*t.a+this.g*this.a*(1-t.a)),this.b=Math.round(t.b*t.a+this.b*this.a*(1-t.a)),this.a=t.a+this.a*(1-t.a)},t.prototype.hasTransparency=function(){return this.a<1},t.prototype.luminocity=function(){var t=this.r/255,e=this.g/255,n=this.b/255;return.2126*(t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4))+.7152*(e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4))+.0722*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))},t.prototype.contrastRatio=function(t){var e=this.luminocity(),n=t.luminocity(),o=(Math.max(e,n)+.05)/(Math.min(e,n)+.05);return Math.round(100*o)/100},t.prototype.equals=function(t){return!!t&&(this.r===t.r&&this.g===t.g&&this.b===t.b&&Math.abs(this.a-t.a)<=this.tolerance)},t.parse=function(e){var n=new t(0,0,0,1),o=e.match(/^\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*$/);if(o&&4===o.length)return n.r=parseInt(o[1]),n.g=parseInt(o[2]),n.b=parseInt(o[3]),n;var i=e.match(/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/i);if(i&&4===i.length)return n.r=parseInt(i[1]),n.g=parseInt(i[2]),n.b=parseInt(i[3]),n;var r=e.match(/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*([-+]?[0-9]*\.?[0-9]+(?:[eE][-+]?[0-9]+)?)\s*\)$/i);if(r&&5===r.length)return n.r=parseInt(r[1]),n.g=parseInt(r[2]),n.b=parseInt(r[3]),n.a=parseFloat(r[4]),n;var a=e.match(/^([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i);if(a&&4===a.length)return n.r=parseInt(a[1],16),n.g=parseInt(a[2],16),n.b=parseInt(a[3],16),n;var s=e.match(/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i);if(s&&4===s.length)return n.r=parseInt(s[1],16),n.g=parseInt(s[2],16),n.b=parseInt(s[3],16),n;var l=e.match(/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i);if(l&&5===l.length)return n.a=parseInt(l[1],16)/255,n.r=parseInt(l[2],16),n.g=parseInt(l[3],16),n.b=parseInt(l[4],16),n;var u=t[e=e.toLowerCase().replace(/\s/g,"").trim()];return u?n=u():void 0},t.transparent=function(){return new t(0,0,0,0)},t.black=function(){return new t(0,0,0)},t.navy=function(){return new t(0,0,128)},t.darkblue=function(){return new t(0,0,139)},t.mediumblue=function(){return new t(0,0,205)},t.blue=function(){return new t(0,0,255)},t.darkgreen=function(){return new t(0,100,0)},t.green=function(){return new t(0,128,0)},t.teal=function(){return new t(0,128,128)},t.darkcyan=function(){return new t(0,139,139)},t.deepskyblue=function(){return new t(0,191,255)},t.darkturquoise=function(){return new t(0,206,209)},t.mediumspringgreen=function(){return new t(0,250,154)},t.lime=function(){return new t(0,255,0)},t.springgreen=function(){return new t(0,255,127)},t.aqua=function(){return new t(0,255,255)},t.cyan=function(){return new t(0,255,255)},t.midnightblue=function(){return new t(25,25,112)},t.dodgerblue=function(){return new t(30,144,255)},t.lightseagreen=function(){return new t(32,178,170)},t.forestgreen=function(){return new t(34,139,34)},t.seagreen=function(){return new t(46,139,87)},t.darkslategray=function(){return new t(47,79,79)},t.limegreen=function(){return new t(50,205,50)},t.mediumseagreen=function(){return new t(60,179,113)},t.turquoise=function(){return new t(64,224,208)},t.royalblue=function(){return new t(65,105,225)},t.steelblue=function(){return new t(70,130,180)},t.darkslateblue=function(){return new t(72,61,139)},t.mediumturquoise=function(){return new t(72,209,204)},t.indigo=function(){return new t(75,0,130)},t.darkolivegreen=function(){return new t(85,107,47)},t.cadetblue=function(){return new t(95,158,160)},t.cornflowerblue=function(){return new t(100,149,237)},t.rebeccapurple=function(){return new t(102,51,153)},t.mediumaquamarine=function(){return new t(102,205,170)},t.dimgray=function(){return new t(105,105,105)},t.slateblue=function(){return new t(106,90,205)},t.olivedrab=function(){return new t(107,142,35)},t.slategray=function(){return new t(112,128,144)},t.lightslategray=function(){return new t(119,136,153)},t.mediumslateblue=function(){return new t(123,104,238)},t.lawngreen=function(){return new t(124,252,0)},t.chartreuse=function(){return new t(127,255,0)},t.aquamarine=function(){return new t(127,255,212)},t.maroon=function(){return new t(128,0,0)},t.purple=function(){return new t(128,0,128)},t.olive=function(){return new t(128,128,0)},t.gray=function(){return new t(128,128,128)},t.skyblue=function(){return new t(135,206,235)},t.lightskyblue=function(){return new t(135,206,250)},t.blueviolet=function(){return new t(138,43,226)},t.darkred=function(){return new t(139,0,0)},t.darkmagenta=function(){return new t(139,0,139)},t.saddlebrown=function(){return new t(139,69,19)},t.darkseagreen=function(){return new t(143,188,143)},t.lightgreen=function(){return new t(144,238,144)},t.mediumpurple=function(){return new t(147,112,219)},t.darkviolet=function(){return new t(148,0,211)},t.palegreen=function(){return new t(152,251,152)},t.darkorchid=function(){return new t(153,50,204)},t.yellowgreen=function(){return new t(154,205,50)},t.sienna=function(){return new t(160,82,45)},t.brown=function(){return new t(165,42,42)},t.darkgray=function(){return new t(169,169,169)},t.lightblue=function(){return new t(173,216,230)},t.greenyellow=function(){return new t(173,255,47)},t.paleturquoise=function(){return new t(175,238,238)},t.lightsteelblue=function(){return new t(176,196,222)},t.powderblue=function(){return new t(176,224,230)},t.firebrick=function(){return new t(178,34,34)},t.darkgoldenrod=function(){return new t(184,134,11)},t.mediumorchid=function(){return new t(186,85,211)},t.rosybrown=function(){return new t(188,143,143)},t.darkkhaki=function(){return new t(189,183,107)},t.silver=function(){return new t(192,192,192)},t.mediumvioletred=function(){return new t(199,21,133)},t.indianred=function(){return new t(205,92,92)},t.peru=function(){return new t(205,133,63)},t.chocolate=function(){return new t(210,105,30)},t.tan=function(){return new t(210,180,140)},t.lightgray=function(){return new t(211,211,211)},t.thistle=function(){return new t(216,191,216)},t.orchid=function(){return new t(218,112,214)},t.goldenrod=function(){return new t(218,165,32)},t.palevioletred=function(){return new t(219,112,147)},t.crimson=function(){return new t(220,20,60)},t.gainsboro=function(){return new t(220,220,220)},t.plum=function(){return new t(221,160,221)},t.burlywood=function(){return new t(222,184,135)},t.lightcyan=function(){return new t(224,255,255)},t.lavender=function(){return new t(230,230,250)},t.darksalmon=function(){return new t(233,150,122)},t.violet=function(){return new t(238,130,238)},t.palegoldenrod=function(){return new t(238,232,170)},t.lightcoral=function(){return new t(240,128,128)},t.khaki=function(){return new t(240,230,140)},t.aliceblue=function(){return new t(240,248,255)},t.honeydew=function(){return new t(240,255,240)},t.azure=function(){return new t(240,255,255)},t.sandybrown=function(){return new t(244,164,96)},t.wheat=function(){return new t(245,222,179)},t.beige=function(){return new t(245,245,220)},t.whitesmoke=function(){return new t(245,245,245)},t.mintcream=function(){return new t(245,255,250)},t.ghostwhite=function(){return new t(248,248,255)},t.salmon=function(){return new t(250,128,114)},t.antiquewhite=function(){return new t(250,235,215)},t.linen=function(){return new t(250,240,230)},t.lightgoldenrodyellow=function(){return new t(250,250,210)},t.oldlace=function(){return new t(253,245,230)},t.red=function(){return new t(255,0,0)},t.fuchsia=function(){return new t(255,0,255)},t.magenta=function(){return new t(255,0,255)},t.deeppink=function(){return new t(255,20,147)},t.orangered=function(){return new t(255,69,0)},t.tomato=function(){return new t(255,99,71)},t.hotpink=function(){return new t(255,105,180)},t.coral=function(){return new t(255,127,80)},t.darkorange=function(){return new t(255,140,0)},t.lightsalmon=function(){return new t(255,160,122)},t.orange=function(){return new t(255,165,0)},t.lightpink=function(){return new t(255,182,193)},t.pink=function(){return new t(255,192,203)},t.gold=function(){return new t(255,215,0)},t.peachpuff=function(){return new t(255,218,185)},t.navajowhite=function(){return new t(255,222,173)},t.moccasin=function(){return new t(255,228,181)},t.bisque=function(){return new t(255,228,196)},t.mistyrose=function(){return new t(255,228,225)},t.blanchedalmond=function(){return new t(255,235,205)},t.papayawhip=function(){return new t(255,239,213)},t.lavenderblush=function(){return new t(255,240,245)},t.seashell=function(){return new t(255,245,238)},t.cornsilk=function(){return new t(255,248,220)},t.lemonchiffon=function(){return new t(255,250,205)},t.floralwhite=function(){return new t(255,250,240)},t.snow=function(){return new t(255,250,250)},t.yellow=function(){return new t(255,255,0)},t.lightyellow=function(){return new t(255,255,224)},t.ivory=function(){return new t(255,255,240)},t.white=function(){return new t(255,255,255)},t}(),FlightList;!function(t){t.TopLevelRemixButtonControl="TopLevelRemixButtonControl",t.TopLevelRemixButton1="TopLevelRemixButton1",t.V2LayoutControl="V2LayoutControl",t.V2Layout1="V2Layout1",t.ModeSwitchControl="ModeSwitchControl",t.ModeSwitch1="ModeSwitch1",t.ToCPullDownViewControl="ToCPullDownViewControl",t.ToCPullDownView1="ToCPullDownView1",t.FirstClassEmbedCardControl="FirstClassEmbedCardControl",t.FirstClassEmbedCard1="FirstClassEmbedCard1",t.AnimationValidationExperimentControl="AnimationValidationExperimentControl",t.AnimationValidationExperiment1="AnimationValidationExperiment1",t.ExperimentationPlatformTestControl="ExperimentationPlatformTestControl",t.ExperimentationPlatformTest1="ExperimentationPlatformTest1",t.ExperimentationPlatformTest2="ExperimentationPlatformTest2",t.ExperimentationPlatformTest3="ExperimentationPlatformTest3",t.DoubleClickAddContentPaneExperimentControl="DoubleClickAddContentPaneExperimentControl",t.DoubleClickAddContentPaneExperiment1="DoubleClickAddContentPaneExperiment1",t.EmptySwayPreviewFREControl="EmptySwayPreviewFREControl",t.EmptySwayPreviewFRE1="EmptySwayPreviewFRE1",t.EmptySwayPreviewFRE2="EmptySwayPreviewFRE2",t.SignInDialogExperimentControl="SignInDialogExperimentControl",t.SignInDialogExperiment1="SignInDialogExperiment1",t.SignInDialogExperiment2="SignInDialogExperiment2",t.SignInDialogExperiment3="SignInDialogExperiment3",t.SignInDialogExperiment4="SignInDialogExperiment4",t.SignInDialogExperiment5="SignInDialogExperiment5",t.JackMoreButtonExperimentControl="JackMoreButtonExperimentControl",t.JackMoreButtonExperiment1="JackMoreButtonExperiment1",t.JackMoreButtonExperiment2="JackMoreButtonExperiment2",t.UpfrontFREExperimentControl="UpfrontFREExperimentControl",t.UpfrontFREExperiment1="UpfrontFREExperiment1",t.AAExperiment3Control="AAExperiment3Control",t.AAExperiment31="AAExperiment31",t.NewHomepageControl="NewHomepageControl",t.NewHomepage1="NewHomepage1",t.AA2ndExperimentControl="AA2ndExperimentControl",t.AA2ndExperiment1="AA2ndExperiment1",t.AAExperimentControl="AAExperimentControl",t.AAExperiment1="AAExperiment1",t.InsertTabRenameControl="InsertTabRenameControl",t.InsertTabRename1="InsertTabRename1",t.FocusPaneStringExpControl="FocusPaneStringExpControl",t.FocusPaneStringExp1="FocusPaneStringExp1",t.SearchboxControl="SearchboxControl",t.Searchbox1="Searchbox1",t.Searchbox2="Searchbox2",t.Searchbox3="Searchbox3",t.SwayButtonExperimentControl="SwayButtonExperimentControl",t.SwayButtonExperiment1="SwayButtonExperiment1",t.PopularityMetricsExperimentControl="PopularityMetricsExperimentControl",t.PopularityMetricsExperiment1="PopularityMetricsExperiment1",t.PopularityMetricsExperiment2="PopularityMetricsExperiment2",t.PopularityMetricsExperiment3="PopularityMetricsExperiment3",t.PopularityMetricsExperiment4="PopularityMetricsExperiment4",t.PopularityMetricsExperiment5="PopularityMetricsExperiment5",t.PopularityMetricsExperiment6="PopularityMetricsExperiment6",t.ShareStatsExperimentControl="ShareStatsExperimentControl",t.ShareStatsExperiment1="ShareStatsExperiment1",t.StoryAutomationFlight="StoryAutomationFlight"}(FlightList||(FlightList={}));var Glyphs={DownloadIconClip:"clip30x30",DownloadIconGlyph:"story_Download",StoryTileSyncIconClip:"clip36x36",StoryTileSyncIconGlyph:"story_StoryTileSyncIcon",PlatformClip:"clip80x80",PlatformiOSGlyph:"story_PlatformiOS",PlatformiPadGlyph:"story_PlatformiPad",PlatformiPhoneGlyph:"story_PlatformiPhone",PlatformWebGlyph:"story_PlatformWeb",PlatformWindowsGlyph:"story_PlatformWindows",AccountMsaIconClip:"clip32x33",AccountMsaIconGlyph:"story_AccountMsa",AccountOrgIdIconClip:"clip32x33",AccountOrgIdIconGlyph:"story_AccountOrgId",SignOutButtonClip:"clip16x16",SignOutButtonGlyph:"story_SignOut",SelectedIconGrayClip:"clip30x30",SelectedIconGrayGlyph:"story_NodeSelectedGray",SwayWatermarkClip:"clip20x21",SwayWatermarkGlyph:"story_SwayWatermark",SwayWatermarkGrayGlyph:"story_SwayWatermarkGray",AddContentCheckmarkWhiteClip:"clip20x20",AddContentCheckmarkWhiteGlyph:"story_CheckmarkWhite",PreviewSwayEmbedIconClip:"clip30x30",PreviewSwayEmbedIconGlyph:"story_LogoSway30x30x32",PreviewOneDriveEmbedIconClip:"clip30x30",PreviewOneDriveEmbedIconGlyph:"story_LogoOneDrive30x30x32",PreviewOneDriveWordEmbedIconClip:"clip30x30",PreviewOneDriveWordEmbedIconGlyph:"story_LogoWord30x30x32",PreviewOneDriveExcelEmbedIconClip:"clip30x30",PreviewOneDriveExcelEmbedIconGlyph:"story_LogoExcel30x30x32",PreviewOneDrivePowerpointEmbedIconClip:"clip30x30",PreviewOneDrivePowerpointEmbedIconGlyph:"story_LogoPowerpoint30x30x32",EmbedShareIconClip:"clip20x20",EmbedShareIconGlyph:"story_EmbedShareIcon",EmbedShareIconGlyphHover:"story_EmbedShareIconHover",ShareThisIconClip:"clip20x20",ShareThisIconGlyph:"story_ShareThisIcon",ShareThisIconGlyphHover:"story_ShareThisHoverIcon",ConsumptionWorldSwitchClip:"clip20x20",ConsumptionWorldSwitchGlyph:"story_ConsumptionWorldSwitchButton",WorldClip:"clip112x72",WorldExpoGlyph:"story_WorldExpoWorld",WorldPanoramaGlyph:"story_WorldPanoramaWorld",WorldVerticalGlyph:"story_WorldVerticalWorld",ExpandedClip:"clip12x12",CollapsedGlyph:"story_Collapsed",TwitterIconLargeClip:"clip112x112",TwitterIconLargeGlyph:"story_TwitterIconLarge",CardDeckCheckboxSelectedClip:"clip16x16",CardDeckCheckboxSelectedGlyph:"story_CheckboxSelectedCards",CardDeckCheckboxSelectedHoverGlyph:"story_CheckboxSelectedHover",CardDeckCheckboxSelectedStandardGlyph:"story_CheckboxSelectedStandard",CardDeckCheckboxUncheckedGlyph:"story_CheckboxUnchecked",CardDeckCheckboxHoverGlyph:"story_CheckboxHover",CardDeckCheckboxKeyboardGlyph:"story_CheckboxKeyboard",RecycleBinTileCheckboxClip:"clip17x17",RecycleBinTileCheckBoxSelectedFocus:"story_RecycleBinTileCheckBoxSelectedFocus",RecycleBinTileCheckBoxSelectedHover:"story_RecycleBinTileCheckBoxSelectedHover",RecycleBinTileCheckBoxSelectedPressed:"story_RecycleBinTileCheckBoxSelectedPressed",RecycleBinTileCheckBoxSelectedRest:"story_RecycleBinTileCheckBoxSelectedRest",RecycleBinTileCheckboxUnselectedFocus:"story_RecycleBinTileCheckBoxUnselectedFocus",RecycleBinTileCheckBoxUnselectedHover:"story_RecycleBinTileCheckBoxUnselectedHover",RecycleBinTileCheckBoxUnselectedPressed:"story_RecycleBinTileCheckBoxUnselectedPressed",RecycleBinTileCheckBoxUnselectedRest:"story_RecycleBinTileCheckBoxUnselectedRest",CardDeckMenuEmphasizeClip:"clip16x16",CardDeckMenuEmphasizeGlyph:"story_CardDeckMenuEmphasize",CardDeckMenuSpecialClip:"clip16x16",CardDeckMenuSpecialGlyph:"story_CardDeckMenuSpecial",WarningClip:"clip16x16",WarningGlyph:"story_Warning",VisualLinkCheckmarkWhiteClip:"clip20x20",VisualLinkCheckmarkWhiteGlyph:"story_CheckmarkWhite"},StoryApp;!function(t){!function(t){function e(){return new n}t.hash=e;var n=function(){function t(){this.dict=new o("#",function(){return location.hash})}return t.prototype.has=function(t){return this.dict.has(t)},t.prototype.fetch=function(t){return this.dict.fetch(t)},t.prototype.fetcharray=function(t){return this.dict.fetcharray(t)},t.prototype.erase=function(t,e){var n=this.dict.erase(t)||"#";e?history.pushState?history.pushState(null,"",n):location.hash=n:history.replaceState?history.replaceState(null,"",n):location.replace(n)},t.prototype.push=function(t,e){history.pushState(null,"",this.dict.add(t,e))},t.prototype.pusharray=function(t,e){history.pushState(null,"",this.dict.addarray(t,e))},t.prototype.replace=function(t,e){location.replace(this.dict.add(t,e))},t.prototype.replacearray=function(t,e){location.replace(this.dict.addarray(t,e))},t}(),o=function(){function t(t,e,n){if(void 0===n&&(n=!1),this.symbol=t,this.value=e,n){var o=this.dict();this.dict=function(){return o}}}return t.prototype.has=function(t){return t in this.dict()},t.prototype.dict=function(){var t={},e=this.value().substring(1);return e?ArrayExtensions.toDictionary(e.split("&"),function(t,e){var n=t.split("=").map(function(t){return t.trim()}),o=n[0];o&&(e[o]=n[1]||"")}):t},t.prototype.keys=function(){return Obj.keys(this.dict())},t.prototype.fetch=function(t){return this.dict()[t]||""},t.prototype.fetcharray=function(t){var e=this.dict()[t];return e?e.split(";"):[]},t.prototype.erase=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this.dict(),o=this.keys().filter(function(e){return-1==t.indexOf(e)});return o.length>0?this.symbol+o.map(function(t){return""!=n[t]?t+"="+n[t]:t}).join("&"):""},t.prototype.add=function(t,e){var n=this.dict();return n[t]=e||"",this.symbol+Obj.keys(n).map(function(t){var e=n[t];return t+(e?"="+e:"")}).join("&")},t.prototype.addarray=function(t,e){return this.add(t,e.map(function(t){return String(t)}).join(";"))},t}();t.UrlDict=o}(t.Utilities||(t.Utilities={}))}(StoryApp||(StoryApp={}));var HashMap=function(){function t(){this._map={},void 0===t.current&&(t.current=0)}return t.prototype.getKey=function(t){var e=this._hash(t);return this._map[e]},t.prototype.setValue=function(t,e){var n=this._hash(t);return this._map[n]=e,this},t.prototype.removeKey=function(t){var e=this._hash(t);return void 0!==this[e]&&delete this[e],this},t.prototype.hasKey=function(t){var e=this._hash(t);return void 0!==this._map[e]},t.prototype._hash=function(e){var n=typeof e+" ";return e instanceof Object?(e.__hash||(e.__hash=++t.current),n+=e.__hash):n+=e.toString(),n},t}(),Icons={HomeVideoPoster:CommonSettings.ContentBaseUrl+"HomeVideoPoster.jpg",CanvasArrowIcon:CommonSettings.ContentBaseUrl+"CanvasArrow.png",CardHintLineIcon:CommonSettings.ContentBaseUrl+"DashedLine.png",CheckmarkIcon:CommonSettings.ContentBaseUrl+"Checkmark.png",CheckmarkGrayIcon:CommonSettings.ContentBaseUrl+"CheckmarkGray.png",JackArrowIcon:CommonSettings.ContentBaseUrl+"JackArrow.png",FRESplashPageImage_280:CommonSettings.ContentBaseUrl+"FRESplashPageImage_280x120.png",FRESplashPageImage_404:CommonSettings.ContentBaseUrl+"FRESplashPageImage_404x173.png",FREDialogPage2ImageLarge_Bing:CommonSettings.ContentBaseUrl+"FREDialogPage2ImageLarge_Bing.png",FREDialogPage2ImageLarge_Flickr:CommonSettings.ContentBaseUrl+"FREDialogPage2ImageLarge_Flickr.png",FREDialogPage2ImageLarge_Menu:CommonSettings.ContentBaseUrl+"FREDialogPage2ImageLarge_Menu.png",FREDialogPage2ImageLarge_Menu_Rtl:CommonSettings.ContentBaseUrl+"FREDialogPage2ImageLarge_Menu_rtl.png",FREDialogPage2ImageLarge_OneDrive:CommonSettings.ContentBaseUrl+"FREDialogPage2ImageLarge_OneDrive.png",FREDialogPage2ImageLarge_PicHit:CommonSettings.ContentBaseUrl+"FREDialogPage2ImageLarge_PicHit.png",FREDialogPage2ImageLarge_Sway:CommonSettings.ContentBaseUrl+"FREDialogPage2ImageLarge_Sway.png",FREDialogPage2ImageLarge_YouTube:CommonSettings.ContentBaseUrl+"FREDialogPage2ImageLarge_YouTube.png",FREDialogPage2ImageSmall_Bing:CommonSettings.ContentBaseUrl+"FREDialogPage2ImageSmall_Bing.png",FREDialogPage2ImageSmall_Flickr:CommonSettings.ContentBaseUrl+"FREDialogPage2ImageSmall_Flickr.png",FREDialogPage2ImageSmall_Menu:CommonSettings.ContentBaseUrl+"FREDialogPage2ImageSmall_Menu.png",FREDialogPage2ImageSmall_Menu_Rtl:CommonSettings.ContentBaseUrl+"FREDialogPage2ImageSmall_Menu_rtl.png",FREDialogPage2ImageSmall_OneDrive:CommonSettings.ContentBaseUrl+"FREDialogPage2ImageSmall_OneDrive.png",FREDialogPage2ImageSmall_PicHit:CommonSettings.ContentBaseUrl+"FREDialogPage2ImageSmall_PicHit.png",FREDialogPage2ImageSmall_Sway:CommonSettings.ContentBaseUrl+"FREDialogPage2ImageSmall_Sway.png",FREDialogPage2ImageSmall_YouTube:CommonSettings.ContentBaseUrl+"FREDialogPage2ImageSmall_YouTube.png",FREDialogPage3ImageLarge_1:CommonSettings.ContentBaseUrl+"FREDialogPage3ImageLarge_1.png",FREDialogPage3ImageLarge_2:CommonSettings.ContentBaseUrl+"FREDialogPage3ImageLarge_2.png",FREDialogPage3ImageLarge_3:CommonSettings.ContentBaseUrl+"FREDialogPage3ImageLarge_3.png",FREDialogPage3ImageLarge_4:CommonSettings.ContentBaseUrl+"FREDialogPage3ImageLarge_4.png",FREDialogPage3ImageSmall_1:CommonSettings.ContentBaseUrl+"FREDialogPage3ImageSmall_1.png",FREDialogPage3ImageSmall_2:CommonSettings.ContentBaseUrl+"FREDialogPage3ImageSmall_2.png",FREDialogPage3ImageSmall_3:CommonSettings.ContentBaseUrl+"FREDialogPage3ImageSmall_3.png",FREDialogPage3ImageSmall_4:CommonSettings.ContentBaseUrl+"FREDialogPage3ImageSmall_4.png",FREDialogPage3ImageLarge_1_Rtl:CommonSettings.ContentBaseUrl+"FREDialogPage3ImageLarge_1_rtl.png",FREDialogPage3ImageLarge_2_Rtl:CommonSettings.ContentBaseUrl+"FREDialogPage3ImageLarge_2_rtl.png",FREDialogPage3ImageLarge_3_Rtl:CommonSettings.ContentBaseUrl+"FREDialogPage3ImageLarge_3_rtl.png",FREDialogPage3ImageLarge_4_Rtl:CommonSettings.ContentBaseUrl+"FREDialogPage3ImageLarge_4_rtl.png",FREDialogPage3ImageSmall_1_Rtl:CommonSettings.ContentBaseUrl+"FREDialogPage3ImageSmall_1_rtl.png",FREDialogPage3ImageSmall_2_Rtl:CommonSettings.ContentBaseUrl+"FREDialogPage3ImageSmall_2_rtl.png",FREDialogPage3ImageSmall_3_Rtl:CommonSettings.ContentBaseUrl+"FREDialogPage3ImageSmall_3_rtl.png",FREDialogPage3ImageSmall_4_Rtl:CommonSettings.ContentBaseUrl+"FREDialogPage3ImageSmall_4_rtl.png",Doughboy24Icon:CommonSettings.ContentBaseUrl+"Doughboy.24x24x32.bmp",Doughboy36Icon:CommonSettings.ContentBaseUrl+"Doughboy.36x36x32.bmp",Doughboy72Icon:CommonSettings.ContentBaseUrl+"Doughboy.72x72x32.bmp",Sway42Icon:CommonSettings.ContentBaseUrl+"Sway.42x42x32.png",AddContentCameraIcon:CommonSettings.ContentBaseUrl+"CameraIcon.png",UploadingSpinner:CommonSettings.ContentBaseUrl+"whitespinner.32x32.gif",AudioWaveform:CommonSettings.ContentBaseUrl+"AudioWaveform.svg",LoadingSpinner:CommonSettings.ContentBaseUrl+"loadingblackspinner.gif",homePageIcon_0:"homepageiconreport.png",homePageIcon_1:"homepageiconpresentations.png",homePageIcon_2:"homepageiconnewsletter.png",homePageIcon_3:"homepageiconpersonalStory.png",homePageIcon_4:"homepageiconmore.png",homePageIcon_phone_0:"homepageiconreport_phone.png",homePageIcon_phone_1:"homepageiconpresentations_phone.png",homePageIcon_phone_2:"homepageiconnewsletter_phone.png",homePageIcon_phone_3:"homepageiconpersonalStory_phone.png",homePageIcon_phone_4:"homepageiconmore_phone.png",homePageIconNewVisualDesign_0:"icons_1_newsletter.png",homePageIconNewVisualDesign_1:"icons_1_presentation.png",homePageIconNewVisualDesign_2:"icons_1_communication.png",homePageIconNewVisualDesign_phone_0:"icons_1_newsletter.png",homePageIconNewVisualDesign_phone_1:"icons_1_presentation.png",homePageIconNewVisualDesign_phone_2:"icons_1_communication.png",homePagePromoPillarIcon_0:"HomepageSlidingImage1.png",homePagePromoPillarIcon_1:"HomepageSlidingImage2.png",homePagePromoPillarIcon_2:"HomepageSlidingImage3.png",homePagePromoPillarIcon_3:"HomepageSlidingImage4.png",homePagePromoPillarIcon_4:"HomepageSlidingImage5.png",homePagePromoPillarIcon_phone_0:"HomepageSlidingImage1_phone.png",homePagePromoPillarIcon_phone_1:"HomepageSlidingImage2_phone.png",homePagePromoPillarIcon_phone_2:"HomepageSlidingImage3_phone.png",homePagePromoPillarIcon_phone_3:"HomepageSlidingImage4_phone.png",homePagePromoPillarIcon_phone_4:"HomepageSlidingImage5_phone.png",homePageTestimonials_0:"HomepageTestimonialLogoMS.png",homePageTestimonials_1:"HomepageTestimonialLogoGY.png",promoPillarVideo0_600_Tall:"Add_Contents_Tall_600.mp4",promoPillarVideo0_310_Tall:"Add_Contents_Tall_310.mp4",promoPillarVideo0_600_Regular:"Add_Contents_Regular_600.mp4",promoPillarVideo0_310_Regular:"Add_Contents_Regular_310.mp4",promoPillarVideo0_600_Image:"Add_Contents_Still_600.png",promoPillarVideo0_310_Image:"Add_Contents_Still_310.png",promoPillarVideo1_600_Tall:"Remix_v10_Tall_600.mp4",promoPillarVideo1_310_Tall:"Remix_v10_Tall_310.mp4",promoPillarVideo1_600_Regular:"Remix_v10_Regular_600.mp4",promoPillarVideo1_310_Regular:"Remix_v10_Regular_310.mp4",promoPillarVideo1_600_Image:"Remix_v10_Still_600.png",promoPillarVideo1_310_Image:"Remix_v10_Still_310.png",promoPillarVideo2_600_Tall:"simultaneousScrolling_Tall_600.mp4",promoPillarVideo2_310_Tall:"simultaneousScrolling_Tall_310.mp4",promoPillarVideo2_600_Regular:"simultaneousScrolling_Regular_600.mp4",promoPillarVideo2_310_Regular:"simultaneousScrolling_Regular_310.mp4",promoPillarVideo2_600_Image:"simultaneousScrolling_Still_600.png",promoPillarVideo2_310_Image:"simultaneousScrolling_Still_310.png",backgroundImage_3000:"newhomepagebackground_3000.jpg",backgroundImage_1920:"newhomepagebackground_1920.jpg",backgroundImage_1366:"newhomepagebackground_1366.jpg",backgroundImage_1024:"newhomepagebackground_1024.jpg",backgroundImage_768:"newhomepagebackground_768.jpg",backgroundImage_480:"newhomepagebackground_480.jpg",backgroundImage_360:"newhomepagebackground_360.jpg",homepageUpsell_768:"HomepageUpsell_768.jpg",homepageUpsell_1366:"HomepageUpsell_1366.jpg",homepageUpsell_1920:"HomepageUpsell_1920.jpg",homepageUpsell_3000:"HomepageUpsell_3000.jpg",mySwaysTopImageBusAbs_3000:"msh_bus_abs_3000.jpg",mySwaysTopImageBusAbs_1920:"msh_bus_abs_1920.jpg",mySwaysTopImageBusAbs_1366:"msh_bus_abs_1366.jpg",mySwaysTopImageBusAbs_1080:"msh_bus_abs_1080.jpg",mySwaysTopImageBusAbs_768:"msh_bus_abs_768.jpg",mySwaysTopImageBusAbs_480:"msh_bus_abs_480.jpg",mySwaysTopImageBusAbs_360:"msh_bus_abs_360.jpg",mySwaysTopImageEduAbs_3000:"msh_edu_abs_3000.jpg",mySwaysTopImageEduAbs_1920:"msh_edu_abs_1920.jpg",mySwaysTopImageEduAbs_1366:"msh_edu_abs_1366.jpg",mySwaysTopImageEduAbs_1080:"msh_edu_abs_1080.jpg",mySwaysTopImageEduAbs_768:"msh_edu_abs_768.jpg",mySwaysTopImageEduAbs_480:"msh_edu_abs_480.jpg",mySwaysTopImageEduAbs_360:"msh_edu_abs_360.jpg",mySwaysTopImageMsaAbs_3000:"msh_msa_abs_3000.jpg",mySwaysTopImageMsaAbs_1920:"msh_msa_abs_1920.jpg",mySwaysTopImageMsaAbs_1366:"msh_msa_abs_1366.jpg",mySwaysTopImageMsaAbs_1080:"msh_msa_abs_1080.jpg",mySwaysTopImageMsaAbs_768:"msh_msa_abs_768.jpg",mySwaysTopImageMsaAbs_480:"msh_msa_abs_480.jpg",mySwaysTopImageMsaAbs_360:"msh_msa_abs_360.jpg"},FREDialogPage1ImageLarge={"af-za":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_af-za.jpg","am-et":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_am-et.jpg","ar-sa":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_ar-sa.jpg","az-latn-az":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_az-latn-az.jpg","be-by":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_be-by.jpg","bg-bg":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_bg-bg.jpg","bn-bd":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_bn-bd.jpg","ca-es":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_ca-es.jpg","cs-cz":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_cs-cz.jpg","da-dk":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_da-dk.jpg","de-de":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_de-de.jpg","el-gr":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_el-gr.jpg","en-gb":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_en-gb.jpg","en-us":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_en-us.jpg","es-es":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_es-es.jpg","es-mx":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_es-mx.jpg","et-ee":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_et-ee.jpg","eu-es":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_eu-es.jpg","fa-ir":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_fa-ir.jpg","fi-fi":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_fi-fi.jpg","fil-ph":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_fil-ph.jpg","fr-ca":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_fr-ca.jpg","fr-fr":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_fr-fr.jpg","gl-es":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_gl-es.jpg","ha-latn-ng":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_ha-latn-ng.jpg","he-il":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_he-il.jpg","hi-in":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_hi-in.jpg","hr-hr":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_hr-hr.jpg","hu-hu":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_hu-hu.jpg","id-id":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_id-id.jpg","is-is":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_is-is.jpg","it-it":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_it-it.jpg","ja-jp":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_ja-jp.jpg","kk-kz":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_kk-kz.jpg","km-kh":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_km-kh.jpg","kn-in":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_kn-in.jpg","ko-kr":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_ko-kr.jpg","lo-la":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_lo-la.jpg","lt-lt":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_lt-lt.jpg","lv-lv":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_lv-lv.jpg","mk-mk":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_mk-mk.jpg","ml-in":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_ml-in.jpg","ms-my":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_ms-my.jpg","nb-no":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_nb-no.jpg","nl-nl":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_nl-nl.jpg","pl-pl":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_pl-pl.jpg","pt-br":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_pt-br.jpg","pt-pt":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_pt-pt.jpg","ro-ro":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_ro-ro.jpg","ru-ru":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_ru-ru.jpg","sk-sk":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_sk-sk.jpg","sl-si":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_sl-si.jpg","sq-al":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_sq-al.jpg","sr-cyrl-rs":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_sr-cyrl-rs.jpg","sr-latn-rs":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_sr-latn-rs.jpg","sv-se":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_sv-se.jpg","sw-ke":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_sw-ke.jpg","ta-in":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_ta-in.jpg","te-in":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_te-in.jpg","th-th":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_th-th.jpg","tr-tr":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_tr-tr.jpg","uk-ua":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_uk-ua.jpg","uz-latn-uz":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_uz-latn-uz.jpg","vi-vn":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_vi-vn.jpg","zh-cn":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_zh-cn.jpg","zh-tw":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageLarge_zh-tw.jpg"},FREDialogPage1ImageSmall={"af-za":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_af-za.jpg","am-et":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_am-et.jpg","ar-sa":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_ar-sa.jpg","az-latn-az":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_az-latn-az.jpg","be-by":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_be-by.jpg","bg-bg":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_bg-bg.jpg","bn-bd":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_bn-bd.jpg","ca-es":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_ca-es.jpg","cs-cz":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_cs-cz.jpg","da-dk":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_da-dk.jpg","de-de":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_de-de.jpg","el-gr":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_el-gr.jpg","en-gb":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_en-gb.jpg","en-us":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_en-us.jpg","es-es":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_es-es.jpg","es-mx":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_es-mx.jpg","et-ee":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_et-ee.jpg","eu-es":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_eu-es.jpg","fa-ir":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_fa-ir.jpg","fi-fi":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_fi-fi.jpg","fil-ph":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_fil-ph.jpg","fr-ca":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_fr-ca.jpg","fr-fr":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_fr-fr.jpg","gl-es":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_gl-es.jpg","ha-latn-ng":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_ha-latn-ng.jpg","he-il":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_he-il.jpg","hi-in":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_hi-in.jpg","hr-hr":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_hr-hr.jpg","hu-hu":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_hu-hu.jpg","id-id":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_id-id.jpg","is-is":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_is-is.jpg","it-it":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_it-it.jpg","ja-jp":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_ja-jp.jpg","kk-kz":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_kk-kz.jpg","km-kh":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_km-kh.jpg","kn-in":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_kn-in.jpg","ko-kr":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_ko-kr.jpg","lo-la":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_lo-la.jpg","lt-lt":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_lt-lt.jpg","lv-lv":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_lv-lv.jpg","mk-mk":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_mk-mk.jpg","ml-in":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_ml-in.jpg","ms-my":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_ms-my.jpg","nb-no":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_nb-no.jpg","nl-nl":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_nl-nl.jpg","pl-pl":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_pl-pl.jpg","pt-br":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_pt-br.jpg","pt-pt":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_pt-pt.jpg","ro-ro":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_ro-ro.jpg","ru-ru":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_ru-ru.jpg","sk-sk":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_sk-sk.jpg","sl-si":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_sl-si.jpg","sq-al":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_sq-al.jpg","sr-cyrl-rs":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_sr-cyrl-rs.jpg","sr-latn-rs":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_sr-latn-rs.jpg","sv-se":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_sv-se.jpg","sw-ke":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_sw-ke.jpg","ta-in":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_ta-in.jpg","te-in":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_te-in.jpg","th-th":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_th-th.jpg","tr-tr":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_tr-tr.jpg","uk-ua":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_uk-ua.jpg","uz-latn-uz":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_uz-latn-uz.jpg","vi-vn":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_vi-vn.jpg","zh-cn":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_zh-cn.jpg","zh-tw":CommonSettings.ContentBaseUrl+"FREDialogPage1ImageSmall_zh-tw.jpg"},UX;!function(t){function e(t,e){var n=$("<div />").addClass("clickEater");return n.click(function(t){$(document).off(".clickEater"),n.remove(),t.stopPropagation(),e&&e()}),n.insertBefore(t),n}function n(t){t.siblings(".clickEater").remove()}function o(){return void 0===C&&s(),C}function i(){return void 0===v&&s(),v}function r(){var t=document.createElement("div");t.style.cssText="visibility:hidden;width:100px;height:100px;";var e=document.createElement("p");e.style.cssText="width:100%;height:200%;",t.appendChild(e),document.body.appendChild(t);var n=e.offsetWidth;t.style.overflow="scroll";var o=e.offsetWidth;return document.body.removeChild(t),n-o}function a(){var t=!1,e=_.getCachedCanvas();if(e)try{var n=e.getContext("2d"),o=n.font;n.font="99px Test,",t=n.font!==o,n.font=o}catch(e){t=!1,StoryLog.TraceTag(596477124,Diag.ULSCat.msoulscat_Story_Preview,Diag.ULSTraceLevel.warning,"The following error was thrown while checking whether canvas contexts accept font families with an appended comma: "+e)}return t}function s(){var t=$("<div />").css({position:"absolute","line-height":"29.5px","white-space":"pre"}).text("a\na"),e=$("<div />").css({position:"absolute","font-size":"20.0px","white-space":"pre"}).text("aaaaaaaaaaaaaaa"),n=$("<div />").css({position:"absolute","font-size":"20.4px","white-space":"pre"}).text("aaaaaaaaaaaaaaa"),o=$("<iframe />").attr({scrolling:"yes",height:"150"});$("body").append(t).append(e).append(n).append(o);var i=StoryApp.Utilities.getIframeContentDocument(o[0]);if(i&&i.body){var s=i.createElement("div");s.style.width="1px",s.style.height="1000px",i.body.appendChild(s)}C=r(),y=59===t[0].clientHeight,f=e[0].clientWidth!==n[0].clientWidth,S=a(),v=o[0].clientHeight<1e3,StoryLog.TraceTag(596477125,Diag.ULSCat.msoulscat_Story_Preview,Diag.ULSTraceLevel.info,"Browser scroll bar width: "+C),StoryLog.TraceTag(596477126,Diag.ULSCat.msoulscat_Story_Preview,Diag.ULSTraceLevel.info,"Browser uses exact line height: "+y),StoryLog.TraceTag(596477127,Diag.ULSCat.msoulscat_Story_Preview,Diag.ULSTraceLevel.info,"Browser uses exact font size: "+f),StoryLog.TraceTag(596477128,Diag.ULSCat.msoulscat_Story_Preview,Diag.ULSTraceLevel.info,"Browser accepts trailing commas on font families: "+S),StoryLog.TraceTag(596477129,Diag.ULSCat.msoulscat_Story_Preview,Diag.ULSTraceLevel.info,"Browser supports scrolling iframes: "+v),t.remove(),e.remove(),n.remove(),o.remove()}function l(){return void 0===y&&s(),y}function u(){return void 0===f&&s(),f}function c(){return void 0===S&&s(),S}function d(e){return t.isFontSizeCorrect()?e:Math.round(e)}function p(e){return t.isLineHeightCorrect()?e:Math.ceil(e)}function g(t,e){var n=h(e),o=_.getCachedCanvas();if(!o)return m(t,n);var i,r;try{(r=o.getContext("2d")).font=n,i=r.measureText(t).width}catch(e){if(StoryLog.TraceTag(596477130,Diag.ULSCat.msoulscat_Story_Preview,Diag.ULSTraceLevel.warning,"The following error was thrown while setting a font to canvas context in getTextWidth method: "+e),(o=_.retryWithNewCanvas())&&o.getContext)try{(r=o.getContext("2d")).font=n,i=r.measureText(t).width}catch(e){StoryLog.TraceTag(596477131,Diag.ULSCat.msoulscat_Story_Preview,Diag.ULSTraceLevel.warning,"The following error was thrown while setting a font to just created canvas context in getTextWidth method: "+e),i=m(t,n)}else i=m(t,n)}return i}function h(t){if(StoryApp.Utilities.browser.isRedstoneEdge)for(;;){if("normal "!==t.substr(0,7).toLowerCase())break;t=t.substr(7)}return c()?((t=StoryApp.Utilities.trimEnd(t)).length>=1&&","!==t[t.length-1]&&(t+=","),t):t}function m(t,e){var n=e.indexOf("px");if(-1===n)return 0;for(var o=-1,i=n-1;i>=0;i--)if(" "==e.charAt(i)){o=i;break}if(-1==o)return 0;var r=parseFloat(e.substr(o,n-o));return isNaN(r)?0:.5*t.length*r}var y,f,S;t.CreateClickEater=e,t.RemoveClickEater=n;var C;t.GetScrollbarSize=o;var v;t.SupportsIframeScrolling=i;var _=new(function(){function t(){this._MAX_NUMBER_OF_RETRIES=10,this._numberOfCanvasRetries=0,this._cachedCanvasTimeout=new StoryApp.Utilities.ScheduledTimeout(null,300)}return t.prototype.getCachedCanvas=function(){var t=this;if(this._cachedCanvas)return this._cachedCanvasTimeout.set(function(){return t.resetCanvas()}),this._cachedCanvas;for(;this._numberOfCanvasRetries<this._MAX_NUMBER_OF_RETRIES;){if(this._cachedCanvas=document.createElement("canvas"),this._cachedCanvas)return this._cachedCanvasTimeout.set(function(){return t.resetCanvas()}),this._cachedCanvas;this._numberOfCanvasRetries++}return null},t.prototype.retryWithNewCanvas=function(){return StoryLog.TraceTag(596477123,Diag.ULSCat.msoulscat_Story_Preview,Diag.ULSTraceLevel.warning,"Current number of created canvases is: "+this._numberOfCanvasRetries),this._numberOfCanvasRetries++,this.resetCanvas(),this.getCachedCanvas()},t.prototype.resetCanvas=function(){this._cachedCanvas=null},t}());t.isLineHeightCorrect=l,t.isFontSizeCorrect=u,t.allowTrailingCommasOnFontFamilies=c,t.getAdjustedFontSize=d,t.getAdjustedLineHeight=p,t.getTextWidth=g,t.topBarHeight=50,t.notificationBarHeight=48,t.appBarButtonHeight=36,t.appBarButtonWidth=37,t.minPreviewHeight=0,t.minTopBarWidth=600,t.minChromelessTopBarWidth=100,t.swayBarHeight=40;var w=function(){function t(){}return t.show=function(){$(".loading-barrier").show()},t.hide=function(){$(".loading-barrier").hide()},t}();t.LoadingBarrier=w}(UX||(UX={}));var StoryApp;!function(t){!function(e){var n=function(){function e(){}return e.getNodesByName=function(t,n){return e.getSpecifiedNodes(t,function(t){return t.nodeName===n},[])},e.getNodesByType=function(t,n){return e.getSpecifiedNodes(t,function(t){return t.nodeType===n},[])},e.getSpecifiedNodes=function(t,n,o){if(n(t))return o.push(t),o;for(var i=t.childNodes,r=0;r<i.length;r++){var a=i[r];a instanceof Node&&e.getSpecifiedNodes(a,n,o)}return o},e.createTextRange=function(n,o,i){if(i>0)for(var r=o+i-1,a=e.getNodesByType(n,Node.TEXT_NODE),s=t.Utilities.createRange(),l=0,u=0;u<a.length;u++){var c=a[u],d=l,p=l+c.textContent.replace(e.zeroWidthRegex,"").length;if(d<=o&&p>o&&s.setStart(c,o-d),d<=r&&p>r)return s.setEnd(c,o-d+i),s;l=p}},e.removeMarks=function(t){$(t).find(e.HtmlMarkTag).each(function(t,e){var n=$(e).contents().first();n?$(n).unwrap():e.empty()})},e.HtmlMarkTag="MARK",e.zeroWidthRegex=/[\u200B-\u200D\uFEFF]/g,e}();e.TextHelpers=n}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var CookieConsent;!function(t){function e(){var e=t.CookieConsentHandler.getInstance();null!==e&&e.setConsent()}function n(e){var n=t.CookieConsentHandler.getInstance();return null!==n&&!n.isConsentGiven(e)}function o(e){var n=t.CookieConsentHandler.getInstance();return null!==n?n.getWatchedHeightOfNotificationBanner(e):0}function i(e){var n=t.CookieConsentHandler.getInstance();null!==n&&n.addHandlerOnConsentGiven(e)}function r(){var e=t.CookieConsentHandler.getInstance();return null!==e&&e.isConsentNeeded()}function a(){return null!==t.CookieConsentHandler.getInstance()}var s=function(){function t(){var t=this;this.consentEvent="consent",this.showEvent="show",this.isNonEssentialCookiesLoaded=!1;this.bannerHeight=TDB.watchableTag(596464535,this,this.getHeightOfNotificationBanner());mscc.on(this.showEvent,function(){return t.updateBannerHeight()}),StoryApp.Utilities.onResize(function(){return t.updateBannerHeight()}),mscc.on(this.consentEvent,this.logConsent),mscc.on(this.consentEvent,this.getNonEssentialCookies)}return t.getInstance=function(){return"undefined"!=typeof mscc?null===t.consentHandler||void 0===t.consentHandler?(t.consentHandler=new t,t.consentHandler):t.consentHandler:null},t.prototype.addHandlerOnConsentGiven=function(t){mscc.on(this.consentEvent,t)},t.prototype.setConsent=function(){mscc.hasConsent()||mscc.setConsent()},t.prototype.isConsentGiven=function(t){var e=this.consentGiven;if(!e){var n=mscc.hasConsent();e=this.consentGiven=TDB.watchableTag(596464536,this,n),n||this.addHandlerOnConsentGiven(function(){return TDB.applyUpdate(function(){return e.setValue(!0)})})}return e.getWatchedValue(t)},t.prototype.isConsentNeeded=function(){return!mscc.hasConsent()},t.prototype.logConsent=function(){StoryLog.StructuredTraceTag(596464796,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Cookie consent given by user",{},null)},t.prototype.getWatchedHeightOfNotificationBanner=function(t){return this.bannerHeight.getWatchedValue(t)},t.prototype.getHeightOfNotificationBanner=function(){var t=this.getBannerElement();return null!=t?t.offsetHeight:0},t.prototype.getBannerElement=function(){return document.getElementById("msccBanner")},t.prototype.updateBannerHeight=function(){var t=this;TDB.applyUpdate(function(){return t.bannerHeight.setValue(t.getHeightOfNotificationBanner())})},t.prototype.getNonEssentialCookies=function(){var t=this;return this.isNonEssentialCookiesLoaded?$.when():(Cookie.removeCookie(Cookie.CookieBlockerCookieKey),$.ajax(StoryApp.Common.UrlHelper.getInstance().getCookieUrl(),{name:"HomePing",description:"Make a home ping call so that we get needed cookies in response",type:"GET",contentType:StoryApp.RequestManager.JsonContentType,dataType:"json"}).then(function(){t.isNonEssentialCookiesLoaded=!0}))},t}();t.CookieConsentHandler=s,t.setUserConsentForCookies=e,t.isCookieConsentNotificationVisible=n,t.watchedConsentBannerHeight=o,t.addHandlerOnConsentGiven=i,t.isConsentNeeded=r,t.isMsccEnabled=a}(CookieConsent||(CookieConsent={}));var StoryApp;!function(t){!function(e){!function(n){var o=function(){function n(){}return n.prototype.initDialog=function(o){var i=this,r=t.Common.TextCopyHelper.isCopySupported(),a=[],s=o.alternateText,l=o.checkboxId,u=o.checkboxMessage,c=o.text;s&&u&&null!=l&&a.push({caption:{value:u},isCheckbox:!0,onAction:function(t,e){var n=i.dialog.getButtonVEs(),o=ArrayExtensions.firstOrDefault(n,function(t){return t&&t.getButtonArguments()==e}),r=o?o.getControl():null,a=r&&r.isChecked.getValue();return i.textBox.setText(a?s:c),ActionLogger.RecordClientAction(new ClientAction.ButtonClickAction(l,Diag.ULSCat.msoulscat_Story_Feedback)),!1},id:ClientAction.ButtonId[l],dismissOnAction:!1}),this.copyButtonCaption=TDB.watchable(this,Resources.CopyToClipboard),this.accessibilityMessage=TDB.watchable(this,void 0),this.accessibilityMessageOnCopy=o.accessibilityMessageOnCopy,r&&a.push({caption:{watchable:this.copyButtonCaption},dismissOnAction:!1,onAction:$.proxy(this.onCopyClicked,this),id:n.copyButtonId}),a.push({caption:{value:Resources.ButtonClose},isDefault:!0,dismissOnAction:!0,id:"idshButtonOK",isNeutralButton:r});var d={domId:n.textBoxId,cssClass:"copyTextBox",readOnly:!0,text:o.text,selectTextOnFocus:!0,description:o.textBoxDescription,tooltip:o.textBoxTooltip},p={title:o.title,description:o.title,messages:o.messages,noFocus:!0,dialogType:t.View.ViewElements.DialogType.Info,buttonsArgs:a,dialogWrapperCssClass:{value:"CenteredDialog"},contentArgs:new TDB.ChildArgs(e.ViewElements.TextBoxVE,d,function(t){i.textBox=t}),accessibilityMessage:{watchable:this.accessibilityMessage}};this.dialog=t.View.Common.DialogManager.createAndShow(p)},n.show=function(t){(new n).initDialog(t)},n.prototype.onCopyClicked=function(e){var o=this;return TDB.applyUpdate(function(){o.copyButtonCaption.setValue(Resources.Copied),o.accessibilityMessage.setValue(o.accessibilityMessageOnCopy)}),t.Common.TextCopyHelper.copyHTMLText($("#"+n.textBoxId)[0],$("#"+n.copyButtonId)[0],!1),TDB.EventPropagation.Bypass},n.copyButtonId="idshButtonCopy",n.textBoxId="copyTextDialogTextBoxId",n}();n.CopyTextDialog=o}(e.Common||(e.Common={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var AuthoringDisabledDialog=function(){function t(){}return t.prototype.initDialog=function(t,e){var n={title:t,description:t,messages:e,width:500,noFocus:!0,dialogType:StoryApp.View.ViewElements.DialogType.Info,buttonsArgs:[{caption:{value:Resources.ButtonOK},isDefault:!0,dismissOnAction:!0,id:"idshButtonDismiss"}]};this._dlg=StoryApp.View.Common.DialogManager.createAndShow(n)},t.show=function(e,n){(new t).show(e,n)},t.prototype.show=function(t,e){StoryLog.TraceTag(596477120,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"User attempted to edit or create a Sway while Authoring is disabled."),this.initDialog(t,e)},t}(),BRSDialog=function(){function t(){}return t.prototype.initDialog=function(t,e){var n={title:t,description:t,messages:e,width:500,noFocus:!0,dialogType:StoryApp.View.ViewElements.DialogType.Info,buttonsArgs:[{caption:{value:Resources.ButtonOK},isDefault:!0,dismissOnAction:!0,onAction:function(){return CommonMain.goToMyStoriesOrSignIn("BRS Dialog - dismiss",!0)},id:"idshButtonDismiss"}]};this._dlg=StoryApp.View.Common.DialogManager.createAndShow(n)},t.show=function(e,n){(new t).show(e,n)},t.showIfAuthoringDisabled=function(){return!!CommonSettings.InitialWatchableSwitches.authoringDisabled&&(t.show(Resources.BRSDialogTitle,[Resources.BRSDialogMessage]),!0)},t.prototype.show=function(t,e){this.initDialog(t,e)},t}(),ErrorDialog=function(){function t(){}return t.ShowErrorDialog=function(t,e,n,o,i,r){var a=this;void 0===n&&(n="Undefined"),StoryApp.Utilities.browser.isWebkit?platform.setTimeout(function(){a.ShowError(t,e,n,o,null,r)},1e3):this.ShowError(t,e,n,o,null,r)},t.ShowError=function(t,e,n,o,i,r){var a={title:t,description:t,dialogWrapperCssClass:{value:"CenteredDialog"+(r?" "+r:"")},messages:[e],noFocus:!0,dialogLogMessage:n,dialogType:StoryApp.View.ViewElements.DialogType.Error,buttonsArgs:[{caption:{value:Resources.ButtonOK},onAction:null!=o?o:void 0,isDefault:!0,dismissOnAction:!0,id:"iddlButtonOK"}],contentArgs:i};StoryApp.View.Common.DialogManager.createAndShow(a)},t}(),NyiDialog=function(){function t(){}return t.prototype.initDialog=function(){var t={title:Resources.NyiDialogTitle,description:Resources.NyiDialogTitle,messages:[Resources.NyiDialogBody],width:500,noFocus:!0,dialogType:StoryApp.View.ViewElements.DialogType.Info,buttonsArgs:[{caption:{value:Resources.ButtonCancel},isDefault:!0,dismissOnAction:!0,id:"idshButtonDismiss"}]};this._dlg=StoryApp.View.Common.DialogManager.createAndShow(t)},t.show=function(){(new t).show()},t.prototype.show=function(){this.initDialog()},t}(),StoryApp;!function(t){!function(e){!function(e){var n=function(){function n(t,e,n,o){this.lookupId=t,this.sharingManager=e,this.isPublished=n,this.onRevokeLinkSuccess=o}return n.createAndShow=function(t,e,o,i){new n(t,e,o,i).show()},n.prototype.show=function(){var n,o,i;n=Resources.SharingRevokeLinksDialogTitleNew,o=this.isPublished?[Resources.SharingRevokeLinksDialogBody,Resources.SharingRevokeLinksDialogBodyCastRemove]:[Resources.SharingRevokeLinksDialogBody],i=Resources.SharingRevokeLinksDialogOKButtonTextNew;var r={title:n,description:n,messages:o,width:500,noFocus:!0,dialogType:e.DialogType.Question,buttonsArgs:[{caption:{value:i},onAction:$.proxy(this.onButtonOK,this),isDefault:!0,dismissOnAction:!1,id:"idshButtonOK"},{caption:{value:Resources.ButtonCancel},id:"idshButtonDismiss",isNeutralButton:!0}]};this.dlg=t.View.Common.DialogManager.createAndShow(r)},n.prototype.onButtonOK=function(t){this.dlg.updateContent(new TDB.ChildArgs(e.DialogLoadingSpinnerVE,{})),this.dlg.updateButtons([]),this.dlg.updateContentMessage([]),this.sharingManager.changeAuthToken(this.lookupId,$.proxy(this.onSuccess,this),$.proxy(this.onError,this))},n.prototype.onSuccess=function(t,e,n){this.onRevokeLinkSuccess(t.viewUrl)},n.prototype.onError=function(e,n,o){var i=this;t.Utilities.browser.isWebkit&&0==e.status&&"error"==n&&""==o?platform.setTimeout(function(){i.showError(n,o)},1e3):this.showError(n,o)},n.prototype.showError=function(n,o){t.View.Common.DialogManager.closeCurrentDialog();var i={dialogType:e.DialogType.Error,title:Resources.SharingRevokeLinksErrorTitleNew,description:Resources.SharingRevokeLinksErrorTitleNew,messages:[Resources.SharingRevokeLinksErrorBody],width:500,noFocus:!0,buttonsArgs:[{caption:{value:Resources.ButtonClose},isDefault:!0,dismissOnAction:!0,id:"idshButtonClose"}]};this.dlg=t.View.Common.DialogManager.createAndShow(i)},n}();e.RevokeSharingDialog=n}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=t.View.ViewElements,o=function(){function e(){this._ready=!1,this.reset()}return e.prototype.reset=function(){this._currentDialogs=TDB.watchableTag(596477086,this,[]),this._ready=!1},e.prototype.setReady=function(){this._ready=!0},e.prototype.isReady=function(){return this._ready},e.getInstance=function(){return e._instance||(StoryLog.TraceTag(596477087,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Constructing DialogManager"),e._instance=new e),e._instance},e.createDialog=function(t){return e.getInstance().createDialog(t)},e.createAndShow=function(t){return e.getInstance().createAndShow(t)},e.showDialog=function(t){return e.getInstance().showDialog(t)},e.closeCurrentDialog=function(t){return e.getInstance().closeCurrentDialog(t)},e.getCurrentDialog=function(t){return e.getInstance().getCurrentDialog(t)},e.prototype.createAndShow=function(t){var e=this.createDialog(t);return this.showDialog(e),e},e.prototype.getCurrentDialogs=function(t){return this._currentDialogs.getWatchedValue(t)},e.prototype.showDialog=function(t){var e=this;TDB.applyUpdate(function(){var o=e.getCurrentDialogs();if(t.getType()===n.DialogType.Bug){var i=e.getCurrentDialog();o.unshift(t),i&&i.close()}else o.push(t);e._currentDialogs.notify(),t===e.getCurrentDialog()&&t.show()})},e.prototype.getCurrentDialog=function(t){var e=this.getCurrentDialogs(t);return e.length>0?e[0]:null},e.prototype.closeCurrentDialog=function(t){var e=this;TDB.applyUpdate(function(){var o=e.getCurrentDialog();o&&o.getType()!==n.DialogType.Bug&&o.close(function(){t&&t()})})},e.prototype.removeDialog=function(t){var e=this,n=this.getCurrentDialogs(),o=n.indexOf(t);o<0||TDB.applyUpdate(function(){n.splice(o,1),e._currentDialogs.notify(),t.visible.getValue()&&t.close();var i=e.getCurrentDialog();i&&0==o&&i.show()},TDB.Justification.FocusManagement)},e.prototype.createDialog=function(e){return!e.debugMessages&&e.dialogType>=n.DialogType.Warning&&(e.debugMessages=this.defaultDebugMessages(e)),new n.DialogViewModel({dialogManager:this,displayArgs:e,environment:t.Common.Environment.getInstance()})},e.prototype.defaultDebugMessages=function(t){return["DialogLogMessage: "+t.dialogLogMessage,"SessionId: "+CommonSettings.UserSessionId]},e._instance=null,e}();e.DialogManager=o}(e.Common||(e.Common={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=t.View.ViewElements,o=t.View.ViewModel,i=function(){function e(){}return e.prototype.initDialog=function(i){var r=this;this.visualLinkViewModel=i.visualLinkViewModel,this.accessibilityMessage=TDB.watchable(this,void 0);var a=new TDB.ChildArgs(n.VisualLinkVE,{viewModel:i.visualLinkViewModel}),s={title:Resources.VisualLinkButtonTitle,messages:[Resources.VisualLinkDialogDescription],noFocus:!1,dialogWrapperCssClass:{value:"CenteredDialog"},dialogContentWrapperClass:"visualLinkWrapper",dialogType:n.DialogType.Info,dialogLogMessage:Resources.VisualLinkButtonTitle,disableDismissOnClickOutside:!0,lightDismiss:!1,frostOpacity:.65,description:Resources.VisualLinkButtonDescription,buttonsArgs:[{id:e.copyButtonId,caption:{value:Resources.SocialFlyoutCopyButton},buttonId:i.copyButtonId,isDefault:!0,dismissOnAction:!1,isNeutralButton:!1,onAction:function(t,e){return r.copyVisualLink()},enabled:{compute:new TDB.ComputedOptionArgs(this,function(t){return i.visualLinkViewModel.getLoadingState(t)===o.VisualLinkLoadingState.Success})}},{caption:{value:Resources.ButtonClose},buttonId:ClientAction.ButtonId.ShareDropdown_VisualLinkDialogCloseButton,isDefault:!1,dismissOnAction:!0,isNeutralButton:!0}],context:this,contentArgs:a,accessibilityMessage:{watchable:this.accessibilityMessage}},l=t.View.Common.DialogManager.createAndShow(s);i.visualLinkViewModel.fetchThumbnailInfo(function(){return l.centerDialog()})},e.show=function(t){(new e).initDialog(t)},e.prototype.copyVisualLink=function(){var t=this;TDB.applyUpdate(function(){t.accessibilityMessage.setValue(Resources.Copied)}),this.visualLinkViewModel.copyToClipboard(),platform.setImmediate(function(){return $("#"+e.copyButtonId).focus()})},e.copyButtonId="copyVisualLinkButton",e}();e.VisualLinkDialog=i}(e.Common||(e.Common={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var SurveyDialog=function(){function t(t){this._args=t}return t.prototype.initDialog=function(){var t=this,e={questions:this._args.questions,errorMessage:this._args.errorMessage},n={title:this._args.title,description:this._args.title,messages:this._args.messages,noFocus:!0,dialogType:StoryApp.View.ViewElements.DialogType.Question,onCancel:$.proxy(this.onCancelClick,this),buttonsArgs:[{caption:{value:this._args.okText||Resources.ButtonSend},isDefault:!0,dismissOnAction:!1,id:"idButtonSubmit",onAction:$.proxy(this.onSubmitClick,this)},{caption:{value:this._args.cancelText||Resources.ButtonNotNow},dismissOnAction:!0,id:"idButtonNotNow",onAction:$.proxy(this.onCancelClick,this),isNeutralButton:!0}],dialogContentCssClass:this._args.dialogContentCssClass,contentArgs:new TDB.ChildArgs(StoryApp.View.ViewElements.SurveyBoxVE,e,function(e){t._surveyBox=e})};StoryApp.View.Common.DialogManager.createAndShow(n)},t.prototype.show=function(){StoryLog.TraceTag(596477062,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"User opened survey dialog."),this.initDialog()},t.prototype.onSubmitClick=function(t){var e=!0;ActionLogger.RecordClientAction(new ClientAction.ButtonClickAction(ClientAction.ButtonId.Survey_Submit,Diag.ULSCat.msoulscat_Story_Site)),this._args.onSubmit&&(e=!1!==this._args.onSubmit.call(this._args.context,this._surveyBox.getAnswers())),e&&StoryApp.View.Common.DialogManager.closeCurrentDialog()},t.prototype.onCancelClick=function(t){ActionLogger.RecordClientAction(new ClientAction.ButtonClickAction(ClientAction.ButtonId.Survey_Cancel,Diag.ULSCat.msoulscat_Story_Site)),this._args.onCancel&&this._args.onCancel.call(this._args.context)},t}(),OneNoteSurveyDialog=function(){function t(){var t=[{checkboxOptions:[Resources.OneNoteSurveyFirstQuestionFirstOption,Resources.OneNoteSurveyFirstQuestionSecondOption,Resources.OneNoteSurveyFirstQuestionThirdOption,Resources.OneNoteSurveyFirstQuestionFourthOption,Resources.OneNoteSurveyFirstQuestionFifthOption],hasTextBox:!0,textBoxPlaceholder:"",textBoxLabel:Resources.OneNoteSurveyFirstQuestionOtherOption,textBoxLength:240,question:Resources.OneNoteSurveyFirstQuestion,questionExplanation:Resources.OneNoteSurveyQuestionExplanation,id:"onenote-othercontent",questionType:StoryApp.View.ViewElements.QuestionType.Checkbox},{checkboxOptions:[Resources.OneNoteSurveySecondQuestionFirstOption,Resources.OneNoteSurveySecondQuestionSecondOption,Resources.OneNoteSurveySecondQuestionThirdOption],hasTextBox:!0,textBoxPlaceholder:"",textBoxLabel:Resources.OneNoteSurveySecondQuestionOtherOption,textBoxLength:240,question:Resources.OneNoteSurveySecondQuestion,questionExplanation:Resources.OneNoteSurveyQuestionExplanation,id:"onenote-contenthelp",questionType:StoryApp.View.ViewElements.QuestionType.Checkbox}],e={onSubmit:this.onSubmit,onCancel:this.onCancel,context:this,questions:t,messages:[Resources.OneNoteSurveyText]};this._surveyDialog=new SurveyDialog(e)}return t.prototype.onSubmit=function(t){var e={};for(var n in t){var o=t[n],i=o.checkboxOptions;for(var r in i)e[n+"/"+r]=i[r]?"true":"false";e[n+"/other"]=o.textboxValue}return StoryLog.StructuredTraceTag(596477063,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"Add Content : OneNote : Survey results",e),!0},t.prototype.onCancel=function(){StoryLog.TraceTag(596477064,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"Add Content : OneNote : User closed OneNote survey dialog")},t.prototype.getSurveyDialog=function(){return this._surveyDialog},t}(),StoryApp;!function(t){!function(t){!function(t){var e=function(){function t(){}return t.getInstance=function(){return t._instance||(t._instance=new t),t._instance},t.prototype.setContext=function(t){this.ve=t},t.prototype.getContext=function(){return this.ve},t.prototype.isBlocking=function(){return this.ve&&this.ve.ifBlockingProgressArgs()},t.prototype.show=function(t,e,n){void 0===n&&(n=""),null!=this.ve&&(this.ve.setOnCancel(e),this.ve.showBlockingProgress(t,n))},t.prototype.deferredShow=function(t,e,n,o){void 0===o&&(o=""),null!=this.ve&&(this.ve.setOnCancel(e),this.ve.showBlockingProgress(t,o,n))},t.prototype.hide=function(){null!=this.ve&&this.ve.hide()},t._instance=void 0,t}();t.BlockingProgressManager=e}(t.Common||(t.Common={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){var n=function(){function e(){this.dependency=null,this.listeners=[]}return e.prototype.value=function(){return this.dependency},e.prototype.addListener=function(e){if(-1!==this.listeners.indexOf(e))throw t.RethrowLogger.createError("Tried adding a listener twice");this.dependency&&e.bound(this.dependency),this.listeners.push(e)},e.prototype.removeListener=function(e){var n=this.listeners.indexOf(e);if(-1===n)throw t.RethrowLogger.createError("Tried removing a listener that wasn't registered");this.dependency&&e.unbound(this.dependency),this.listeners.splice(n,1)},e.prototype.bind=function(t){if(this.dependency){var e=this.dependency.element?this.dependency.element:this.dependency,n=e?e._context:null,o=n?n.keyframeType:null,i=t.element?t.element:t,r=i?i._context:null,a=r?r.keyframeType:null,s=t.id;StoryLog.StructuredTraceTag(596477408,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"Tried binding a dependency twice.",{"ID ":s,"Former depedency context ":n?n.toString():null,"Former keyframe type ":o,"New item context ":r?r.toString():null,"New keyframe type ":a})}this.dependency=t,this.listeners.forEach(function(e){return e.bound(t)})},e.prototype.unbind=function(e){if(this.dependency!==e)throw t.RethrowLogger.createError("Tried unbinding a dependency that wasn't bound");this.listeners.forEach(function(t){return t.unbound(e)}),this.dependency=null},e.prototype.isEmpty=function(){return null===this.dependency&&0===this.listeners.length},e}(),o=function(){function t(){this.handles={}}return t.prototype.value=function(t){var e=this.handles[t];return e?e.value():null},t.prototype.addListener=function(t,e){this.getDependency(t).addListener(e)},t.prototype.removeListener=function(t,e){var n=this.getDependency(t);n.removeListener(e),n.isEmpty()&&delete this.handles[t]},t.prototype.bind=function(t,e){this.getDependency(t).bind(e)},t.prototype.unbind=function(t,e){var n=this.getDependency(t);n.unbind(e),n.isEmpty()&&delete this.handles[t]},t.prototype.getDependency=function(t){var e=this.handles[t];return e||(e=this.handles[t]=new n),e},t}();e.AsyncDependencySet=o}(t.Utilities||(t.Utilities={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){var e=function(){function t(){this.dict={}}return t.prototype.put=function(t,e,n){var o=this.dict[t];o||(o=this.dict[t]={}),o[e]=n},t.prototype.find=function(t,e){var n=this.dict[t];return n?n[e]:void 0},t.prototype.remove=function(t,e){var n=this.dict[t];n&&(delete n[e],$.isEmptyObject(n)&&delete this.dict[t])},t.prototype.clear=function(){this.dict={}},t.prototype.enumerateValues=function(){var t=[];for(var e in this.dict){var n=this.dict[e];for(var o in n)t.push(n[o])}return t},t}();t.BiDictionary=e}(t.Utilities||(t.Utilities={}))}(StoryApp||(StoryApp={}));var WatchableSwitchesTransport=function(){function t(){}return t}(),DocumentIngestion;!function(t){function e(t,e,n){null===t||void 0===t.ingested||!1===t.ingested?(n&&n(null),ErrorDialog.ShowErrorDialog(Resources.DocumentIngestionCreateNewProcessingErrorTitle,Resources.DocumentIngestionUndefinedError,"Doc Ingestion failed")):2!=t.uploadStatus?(n&&(!t.authToken&&t.createAndJoinResponse&&(t.authToken=t.createAndJoinResponse.lookupId),n(t.authToken)),t.createAndJoinResponse?platform.setImmediate(function(){StoryApp.Common.SinglePageAppHelper.processCreateAndJoinResponse(t.createAndJoinResponse,function(){return i.createStoryFromDocument(e,n,!0)})}):platform.setImmediate(function(){return StoryApp.Utilities.assignWindowLocation(StoryApp.Common.UrlHelper.getInstance().viewUrl(t.authToken))})):(n&&n(t.error.toString()),ErrorDialog.ShowErrorDialog(Resources.DocumentIngestionCreateNewProcessingErrorTitle,i.uploadErrorMessage(t.error),"Doc Ingestion: Import Failed")),StoryApp.View.Common.BlockingProgressManager.getInstance().hide(),CommonSettings.AuthoringFromLandingPageContextEnabled&&UX.LoadingBarrier.hide()}function n(t,e,n,o){"timeout"===e?(o&&o(e),StoryLog.TraceTag(596477215,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"Document Importing reached timeout."),ErrorDialog.ShowErrorDialog(Resources.DocumentIngestionImportInProgress,Resources.DocumentIngestionTimeoutError,"Doc Ingestion: Reached timeout")):void 0!==n?(o&&o(n),ErrorDialog.ShowErrorDialog(Resources.DocumentIngestionCreateNewProcessingErrorTitle,n,"Doc Ingestion: Import failed")):(void 0!==e?StoryLog.StructuredTraceTag(596477216,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.error,"Document Importing error",{errorCode:e}):StoryLog.TraceTag(596477217,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.error,"Document Importing encountered undefined error."),ErrorDialog.ShowErrorDialog(Resources.DocumentIngestionCreateNewProcessingErrorTitle,Resources.DocumentIngestionUndefinedError,"Doc Ingestion failed"),o&&o(null)),StoryApp.View.Common.BlockingProgressManager.getInstance().hide(),CommonSettings.AuthoringFromLandingPageContextEnabled&&UX.LoadingBarrier.hide()}var o;!function(t){t[t.Success=0]="Success",t[t.InvalidArguments=1]="InvalidArguments",t[t.EngineError=2]="EngineError",t[t.ParserError=3]="ParserError",t[t.NetworkError=4]="NetworkError",t[t.StoryCreationError=5]="StoryCreationError",t[t.TimeoutError=6]="TimeoutError",t[t.DocumentTooLong=7]="DocumentTooLong",t[t.ConversionError=8]="ConversionError",t[t.CopyProtected=9]="CopyProtected",t[t.PasswordProtected=10]="PasswordProtected",t[t.StorageError=11]="StorageError",t[t.WikipediaOutlineError=12]="WikipediaOutlineError",t[t.UnknownError=13]="UnknownError",t[t.WaitingForDocument=14]="WaitingForDocument"}(o=t.IngestionResultCode||(t.IngestionResultCode={}));var i=function(){function t(){}return t.submitDocumentIngestionRequestForFiles=function(e,n,o,i,r){StoryPerformance.PerformanceManager.getInstance().markUserAction("submitDocumentIngestionRequestForFiles");var a=new FormData;a.append("file",e.getBlob(),e.getName()),n&&a.append("modelId",n),o&&a.append("fileName",o),r&&a.append("request",JSON.stringify(r));var s={description:"Method to ingest documents to story.",type:"POST",data:a,processData:!1,dataType:"json",contentType:!1,timeout:CommonSettings.SiteDocumentIngestionAjaxTimeout};return t.completeDocumentIngestionRequest(s,i)},t.submitDocumentIngestionRequestForUrls=function(e,n,o,i){var r={};r.file=e,n&&(r.modelId=n),o&&(r.fileName=o);var a={description:"Method to ingest documents to story.",type:"POST",data:r,dataType:"json",timeout:CommonSettings.SiteDocumentIngestionAjaxTimeout};return t.completeDocumentIngestionRequest(a,i)},t.completeDocumentIngestionRequest=function(t,e){e===StoryApp.Common.UrlHelper.getInstance().documentIngestionCreateUrl()&&Cookie.setPageRequestInfo(e);var n=$.ajax(e,t),o=Task.fromPromise(n);return o.then(function(t){return t},function(t,e,n){StoryLog.StructuredTraceTag(596477208,Diag.ULSCat.msoulscat_Story_DocumentImport,Diag.ULSTraceLevel.warning,"Call to ingest document failed",{ErrorStatus:e,ErrorThrown:n})}),o},t.createStoryFromDocument=function(o,i,r){var a=CommonSettings.DocumentIngestionMaximumDocumentSize;if(0===o.getSize())return ErrorDialog.ShowErrorDialog(Resources.DocumentIngestionCreateNewClientErrorTitle,Resources.DocumentIngestionFileEmptyError,"Doc Ingestion: Upload Failed, file is corrupted"),null;if(o.getSize()>a)return ErrorDialog.ShowErrorDialog(Resources.DocumentIngestionCreateNewClientErrorTitle,ResourceManager.ResolveString(Resources.DocumentIngestionFileSizeTooLargeError,[a/1048576]),"Doc Ingestion: Upload failed, file is too big"),null;if(!t.isFileExtensionSupported(o.getName()))return ErrorDialog.ShowErrorDialog(Resources.DocumentIngestionCreateNewClientErrorTitle,Resources.DocumentIngestionFileTypeErrorV2,"Doc Ingestion: Upload failed, file type unsupported"),null;StoryLog.StructuredTraceTag(596477209,Diag.ULSCat.msoulscat_Story_DocumentImport,Diag.ULSTraceLevel.info,"Creating story from document.",{fileSize:o.getSize().toString(),fileType:o.getType()});var s=StoryApp.Common.UrlHelper.getInstance().documentIngestionCreateUrl();UX.LoadingBarrier.show();var l;return!r&&CommonSettings.AuthoringFromLandingPageContextEnabled&&(s=StoryApp.Common.UrlHelper.getInstance().createAndJoinFromDocUrl(),l=StoryApp.Common.SinglePageAppHelper.buildCreateAndJoinRequest()),t.submitDocumentIngestionRequestForFiles(o,void 0,void 0,s,l).then(function(t){return e(t,o,i),t},function(t,e,o){return n(t,e,o,i)})},t.insertDocumentToStory=function(e,n){return StoryLog.StructuredTraceTag(596477210,Diag.ULSCat.msoulscat_Story_DocumentImport,Diag.ULSTraceLevel.info,"Ingesting local file to story.",{fileSize:e.getSize().toString(),fileType:e.getType()}),t.submitDocumentIngestionRequestForFiles(e,e.getModelId(),void 0,StoryApp.Common.UrlHelper.getInstance().documentIngestionInsertUrl(n))},t.insertDocumentToBlob=function(t,e){var n=new FormData;n.append("file",t.getBlob(),t.getName()),n.append("modelId",t.getModelId());var o={description:"Method to upload document to blob.",type:"POST",data:n,processData:!1,dataType:"json",contentType:!1,timeout:CommonSettings.SiteDocumentIngestionAjaxTimeout},i=$.ajax(StoryApp.Common.UrlHelper.getInstance().uploadFileToBlobUrl(e),o),r=Task.fromPromise(i);return r.then(function(t){return t},function(t,e,n){StoryLog.StructuredTraceTag(596477211,Diag.ULSCat.msoulscat_Story_DocumentImport,Diag.ULSTraceLevel.warning,"Uploading document failed",{ErrorStatus:e,ErrorThrown:n})}),r},t.insertDocumentFromBlobToStory=function(e,n,o,i,r){var a=t.getFileExtension(e),s={fileName:e,modelId:o,documentID:i};StoryLog.StructuredTraceTag(596477212,Diag.ULSCat.msoulscat_Story_DocumentImport,Diag.ULSTraceLevel.info,"Ingesting file using its Blob id to story.",{fileSize:r.toString(),fileType:a});var l={description:"Method to ingest document from Blob to Story.",type:"POST",data:s,dataType:"json",timeout:CommonSettings.SiteDocumentIngestionAjaxTimeout},u=$.ajax(StoryApp.Common.UrlHelper.getInstance().documentIngestionInsertFromBlobIdUrl(n),l),c=Task.fromPromise(u);return c.then(function(t){return t},function(t,e,n){StoryLog.StructuredTraceTag(596477213,Diag.ULSCat.msoulscat_Story_DocumentImport,Diag.ULSTraceLevel.warning,"Call to ingest document failed",{ErrorStatus:e,ErrorThrown:n})}),c},t.insertDocumentFromOneDriveToStory=function(e,n,o,i,r,a){return StoryLog.StructuredTraceTag(596477214,Diag.ULSCat.msoulscat_Story_DocumentImport,Diag.ULSTraceLevel.info,"Ingesting file from OneDrive to story.",{fileSize:a,fileType:r}),t.submitDocumentIngestionRequestForUrls(e,o,i+"."+r,StoryApp.Common.UrlHelper.getInstance().documentIngestionInsertFromOneDriveUrl(n))},t.isFileExtensionSupported=function(e){var n=t.getFileExtension(e);return ArrayExtensions.contains(CommonSettings.DocumentIngestionFormats,n)||CommonSettings.DocumentIngestionExperimentalFormatsEnabled&&ArrayExtensions.contains(CommonSettings.DocumentIngestionExperimentalFormats,n)},t.getSupportedFileFormatFilter=function(){return StoryApp.Utilities.ios||StoryApp.Utilities.isMacOsX?t.getSupportedMimeTypesList():t.getSupportedExtensionsList()},t.getSupportedExtensionsList=function(){var t=CommonSettings.DocumentIngestionFormats;return CommonSettings.DocumentIngestionExperimentalFormatsEnabled&&(t=t.concat(CommonSettings.DocumentIngestionExperimentalFormats)),(t=t.map(function(t){return"."+t})).join(",")},t.getSupportedMimeTypesList=function(){var t=CommonSettings.DocumentIngestionMimeTypes;return CommonSettings.DocumentIngestionExperimentalFormatsEnabled&&(t=t.concat(CommonSettings.DocumentIngestionExperimentalMimeTypes)),t.join(",")},t.getFileExtension=function(t){var e=t.split(".");return 1===e.length||""===e[0]&&2===e.length?"":e.pop().toLowerCase()},t.getFileNameWithoutExtension=function(t){var e=t.lastIndexOf(".");return e<=0?"":t.substr(0,e)},t.showDocumentIngestionErrorMessage=function(t,e){var n;switch(t){case o.ParserError:case o.CopyProtected:case o.PasswordProtected:n=Resources.DocumentIngestionDocumentCorruptedOrPasswordCopyProtected;break;case o.StoryCreationError:n=Resources.DocumentIngestionSwayTooLarge;break;case o.DocumentTooLong:n=Resources.DocumentIngestionDocumentTooLongMessage;break;case o.WikipediaOutlineError:n=Resources.WikipediaOutlineCreationFailed;break;case o.InvalidArguments:case o.EngineError:case o.NetworkError:case o.TimeoutError:case o.StorageError:case o.ConversionError:case o.UnknownError:n=Resources.DocumentIngestionGenericError;break;default:TDB.raiseRecoverableError("Unknown error code for document ingestion: "+n),n=Resources.DocumentIngestionGenericError}var i=t===o.WikipediaOutlineError?Resources.WikipediaOutlineCreationFailedTitle:Resources.DocumentIngestionCreateNewProcessingErrorTitle;ErrorDialog.ShowErrorDialog(i,n,"Doc Ingestion: Import Failed",e)},t.uploadErrorMessage=function(t){switch(t){case-1:case 0:return Resources.DocumentIngestionGenericError;case 1:return Resources.UploadErrorTimeout;case 2:return Resources.DocumentIngestionDocumentCorruptedOrPasswordCopyProtected;case 3:return Resources.DocumentIngestionGenericError;case 4:return Resources.DocumentIngestionDocumentTooLongMessage;case 5:return Resources.DocumentIngestionDisabled;case 6:return Resources.DocumentIngestionFormatDisabledV2;case 7:return Resources.DocumentIngestionFeatureDisabled;case 8:return Resources.DocumentIngestionFileTypeErrorV2;default:return TDB.raiseRecoverableError("Unknown error code for document upload: "+t),Resources.DocumentIngestionGenericError}},t.showPdfNotification=function(t,e){if("notified"!==Cookie.getCookie("DIPdfNotif")){var n={};Cookie.setCookie("DIPdfNotif","notified",n),e&&e.addNotification({messages:[{text:t}],notificationSource:StoryApp.View.ViewElements.NotificationSource.DocumentIngestionPdf,notificationType:StoryApp.View.ViewElements.NotificationType.Info})}},t.getCappedFilenameString=function(t){var e=t;return t.length>50&&(e=t.slice(0,47)+"..."),e},t}();t.DocumentIngestionAPI=i}(DocumentIngestion||(DocumentIngestion={}));var FeatureDetection;!function(t){function e(){Modernizr.addTest("dynamicscrollevents",function(){var t=navigator.userAgent;if(!/iphone|ipad/i.test(t)||/windows/i.test(t))return!0;var e=/OS ([\d_]+)/i.exec(t);return!(!e||2!==e.length)&&+e[1].split("_")[0]>=8}),Modernizr.addTest("videoupload",function(){var t=navigator.userAgent;if(!/iphone|ipad/i.test(t))return!0;if(!/crios/i.test(t))return!0;var e=/OS ([\d_]+)/i.exec(t);return!e||2!==e.length||+e[1].split("_")[0]<7})}t.initialize=e}(FeatureDetection||(FeatureDetection={}));var FlightClientSettings=function(){function t(){}return t}(),StoryApp;!function(t){!function(e){Error.stackTraceLimit=100;var n;!function(t){t[t.notShowing=0]="notShowing",t[t.attemptingToShow=1]="attemptingToShow",t[t.showing=2]="showing",t[t.fallbackInvoked=3]="fallbackInvoked"}(n||(n={}));var o=function(){function o(){this.exceptionDialogState=n.notShowing}return o.prototype.register=function(){var t=this;if(window.loadScriptFailure?delete window.onerror:window.onerror=function(e,n,o,i,r){t.onError(e,n,o,i,r)},void 0!==window.errorsDuringLoad&&window.errorsDuringLoad instanceof Array){for(var e=0,n=window.errorsDuringLoad;e<n.length;e++){var o=n[e];o&&this.onError(o.errorMessage,o.errorUrl,o.lineNo,o.colNo,o.error)}window.errorsDuringLoad=[]}},o.prototype.unregister=function(){delete window.onerror},o.prototype.isWhitelistDomain=function(t){return this.isUrlInDomainList(t,o.domainExceptionWhitelist)},o.prototype.isUrlInDomainList=function(t,e){if(!t)return!1;var n=t.toUpperCase();return ArrayExtensions.indexOfFirst(e,function(t){return n.indexOf(t)>=0})>=0},o.prototype.isEmbed=function(){return new RegExp("/embed$","i").test(window.location.pathname)},o.prototype.registerUndoManagerRecentActionsCallback=function(t){this.recentActionsLog=t},o.prototype.unregisterUndoManagerRecentActionsCallback=function(){this.recentActionsLog=void 0},o.prototype.onError=function(e,i,r,a,s){var l,u=this,c=!(!i||!ArrayExtensions.any(o.externalUrlErrorIndicators,function(t){return t.test(i)})),d=!(!e||0!==e.indexOf("Access is denied")||!t.Utilities.browser.isEdge&&(i||1!=r||1!=a)),p=!!(t.Utilities.browser.isIEOrEdge&&e&&o.isMiscellaneousIEOrEdgeMessage(e)),g=t.Utilities.browser.isEdge&&e&&e.indexOf("80020101")>=0&&1===r&&1===a&&this.isEmbed(),h=t.Utilities.browser.isFirefox&&e&&(e.indexOf("presentationWorkflowResolved")>=0||e.indexOf("InvalidStateError")>=0);if(e&&e.indexOf("Permission denied")>=0&&s&&s.stack){var m=s.stack;m&&m.indexOf("at Unknown script code")>=0&&(l=!0)}var y;e&&e.indexOf("Error calling method on NPObject")>=0&&(y=!0);var f=this.isWhitelistDomain(i),S=!!i&&f&&i.lastIndexOf(".js")<Math.max(0,i.length-3);t.Utilities.browser.isEdge&&(i||(f=!0));var C=e&&o.embedSandboxIndicators.every(function(t){return-1!==e.indexOf(t)}),v={errorstr:e,exceptionDialogState:n[this.exceptionDialogState],errorUrl:i};void 0!==r&&(v.errorUrl+="[line:"+r,void 0!==a&&(v.errorUrl+=", col:"+a),v.errorUrl+="]"),CommonSettings.UnsupportedBrowser?StoryLog.StructuredTraceTag(596477192,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Uncaught exception: Unsupported Browser error",v):e&&-1!==e.indexOf("887a0005")?StoryLog.StructuredTraceTag(596477193,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Uncaught exception: DXGI_ERROR_DEVICE_REMOVED",v):f?c?StoryLog.StructuredTraceTag(596455833,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Uncaught exception: external injected script",v):d?StoryLog.StructuredTraceTag(596477195,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Uncaught exception: From access denied",v):p?StoryLog.StructuredTraceTag(596455840,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Uncaught exception: miscellaneous IE/Edge error",v):l?StoryLog.StructuredTraceTag(596477196,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Uncaught exception: Permission denied for injected script.",v):y?StoryLog.StructuredTraceTag(596477197,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Uncaught exception: Error calling method on NPObject.",v):S?StoryLog.StructuredTraceTag(596477198,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Uncaught exception: Error caused by exception in external injected script.",v):"Script error"!==e||r?g?StoryLog.StructuredTraceTag(596477199,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Uncaught exception: Edge error 80020101 for embed.",v,s&&s.stack?s.stack:void 0):h?StoryLog.StructuredTraceTag(596477200,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Uncaught exception: Azure Media Player firefox specific errors",v,s&&s.stack?s.stack:void 0):C?StoryLog.StructuredTraceTag(596477201,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Uncaught exception: Blocked script(s) from embed sandbox policy",v):(this.recentActionsLog&&(v.actionlog=this.recentActionsLog()),StoryLog.StructuredTraceTag(6034319,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.error,"Uncaught exception: Unknown",v,s&&s.stack?s.stack:void 0,void 0,!1,!0)):StoryLog.StructuredTraceTag(8983362,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.error,"Uncaught exception: Script error",v,s&&s.stack?s.stack:void 0,void 0,!1,!0):StoryLog.StructuredTraceTag(596477194,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Uncaught exception: From external domain",v),UnitTestMode||!f||d||l||y||S||g||h||C||(StoryLog.SuppressThenDisable(),platform.setImmediate(function(){switch(u.exceptionDialogState){case n.notShowing:u.exceptionDialogState=n.attemptingToShow,u.createAndShowExceptionDialog(),u.exceptionDialogState=n.showing,window.ActionLogger&&ActionLogger.Flush(),State.PauseUpdates=!0,State.DisableRequestManager=!0;break;case n.attemptingToShow:u.handleDialogFailure(),u.exceptionDialogState=n.fallbackInvoked;break;case n.showing:case n.fallbackInvoked:}}))},o.prototype.navigateToError=function(t,n){location.href=e.UrlHelper.getInstance().errorUrl(t,window.location.pathname+window.location.search+window.location.hash,n)},o.prototype.handleDialogFailure=function(){this.navigateToError("ExceptionDuringErrorDialog",!0)},o.prototype.createAndShowExceptionDialog=function(){if(t.View.Common.DialogManager.getInstance().isReady()){var e={title:Resources.GenericErrorDialogTitle,description:Resources.GenericErrorDialogTitle,messages:[Resources.GenericErrorDialogText],dialogType:t.View.ViewElements.DialogType.Bug,allowCancel:!1,dialogLogMessage:"Refresh Page: Unhandled JS exception",buttonsArgs:[{caption:{value:Resources.GenericErrorDialogButtonText},isDefault:!0,dismissOnAction:!1,onAction:function(t,e){location.reload()}}]};t.View.Common.DialogManager.createAndShow(e)}else this.navigateToError("ExceptionDuringInitialization",!1)},o.isMiscellaneousIEOrEdgeMessage=function(t){for(var e=0,n=o.IEOrEdgeSpecificMessageIndicators;e<n.length;e++){var i=n[e];if(-1!==t.indexOf(i))return!0}return!1},o.domainExceptionWhitelist=["SWAY.COM","SWAY-CDN.COM","SWAY-EDOG.COM","SWAY-INT.COM","SWAY.OFFICE.COM","SWAY.OFFICEPPE.COM","SWAY.OFFICE-INT.COM"],o.embedSandboxIndicators=["Blocked a frame","sandboxed and lacks"],o.externalUrlErrorIndicators=[/(.*)\.com\/inj_js\//gi,/(.*)\.com\/(.*)\/main.js/gi],o.IEOrEdgeSpecificMessageIndicators=["A system shutdown has already been scheduled"],o}();e.GlobalExceptionHandler=o}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){var n;!function(t){t[t.aad=1]="aad",t[t.msa=2]="msa"}(n||(n={}));var o=function(){function e(t){this.window=t}return e.prototype.signIn=function(){StoryLog.TraceTag(596455559,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Starting default sign in");var t=$.Deferred();return this.shouldDefaultSignIn()?this.startDefaultSignIn(t):t.reject(),t},e.prototype.startDefaultSignIn=function(e){var o=this,i=CommonSettings.DefaultSignInSettings,r=t.Utilities.extractHostnameFromUrl(CommonSettings.IdentityDefaultSignInUrlMSA),a=t.Utilities.extractHostnameFromUrl(CommonSettings.IdentityDefaultSignInUrlAAD),s={msaConfig:void 0,aadConfig:void 0,preferredIdp:n.aad,msaFedEnabled:!1,enableConsoleLogging:t.Utilities.query.has(t.Common.UrlHelper.URLParamDSILogging),timeout:parseInt(t.Utilities.query.fetch(t.Common.UrlHelper.URLParamDefaultSignInTimeoutOverride))||i.Timeout};i.IsEnabledForAAD&&(s.aadConfig={replyUri:CommonSettings.SiteRootUrl,host:a,appId:i.AadAppId,enableWindowsSso:i.EnableWindowsSso}),i.IsEnabledForMSA&&(s.msaConfig={replyUri:CommonSettings.SiteRootUrl,host:r});var l=platform.setTimeout(function(){l&&(l=void 0,StoryLog.StructuredTraceTag(596459919,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"DefaultSignIn timeout",{timeout:s.timeout}),e.reject())},s.timeout);try{StoryLog.TraceTag(596455560,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Getting signed-in accounts"),this.window.getAccount(s,function(t){o.logDefaultSignInResult(t,!l),l&&(clearTimeout(l),l=void 0,o.handleDefaultSignInResult(t,e))})}catch(t){StoryLog.StructuredTraceTag(596457560,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.error,"Error while getting default signed in user accounts",{message:t.message},t.stack)}},e.prototype.handleDefaultSignInResult=function(t,e){if("Redirect"===t.op){var n=("msa"===t.idp?CommonSettings.IdentityDefaultSignInUrlMSA:CommonSettings.IdentityDefaultSignInUrlAAD)+(t.upn?"&login_hint="+encodeURIComponent(t.upn):"");e.resolve(n)}else e.reject()},e.prototype.shouldDefaultSignIn=function(){var t=void 0;return this.isEnabled()?CommonSettings.IsAuthenticated?t="User is already authenticated":CommonSettings.IdentityDefaultSignInUrlMSA&&CommonSettings.IdentityDefaultSignInUrlAAD?this.isIdentityPageReferrer()?t="Referrer is identity page":this.window.getAccount||(t="getAccountMethodNotDefined"):t="DefaultSignIn URL is missing":t="Disabled",void 0===t||(StoryLog.StructuredTraceTag(596459920,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"DefaultSignIn is disabled",{reason:t}),!1)},e.prototype.isEnabled=function(){return!(!CommonSettings||!CommonSettings.DefaultSignInSettings)&&(CommonSettings.DefaultSignInSettings.IsEnabledForAAD||CommonSettings.DefaultSignInSettings.IsEnabledForMSA)},e.prototype.isIdentityPageReferrer=function(){var e=this.window.document.referrer,n=t.Utilities.extractHostnameFromUrl(CommonSettings.IdentityDefaultSignInUrlMSA),o=t.Utilities.extractHostnameFromUrl(CommonSettings.IdentityDefaultSignInUrlAAD);if(!e||!n||!o)return!1;var i=t.Utilities.extractHostnameFromUrl(e);return i===n||i===o},e.prototype.logDefaultSignInResult=function(t,e){StoryLog.StructuredTraceTag(596459921,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"DefaultSignIn response received",{isTimeout:e,op:t.op,errorCode:t.errorCode,idp:t.idp,hasUpn:!!t.upn,telemetry:JSON.stringify(t.telemetry)})},e}();e.DefaultSignInAdapter=o}(t.Identity||(t.Identity={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){var n=function(){function e(t){this.dialogManager=t}return e.prototype.showIdleSessionDialog=function(){if(this.dialogManager.isReady()){var e={title:Resources.GenericErrorDialogTitle,description:Resources.GenericErrorDialogTitle,messages:[Resources.RefreshPageNotification],allowCancel:!1,dialogLogMessage:"Refresh Page: Idle Session",dialogType:t.View.ViewElements.DialogType.Warning,buttonsArgs:[{caption:{value:Resources.GenericErrorDialogButtonText},isDefault:!0,dismissOnAction:!1,onAction:function(t,e){location.reload()}}]};this.dialogManager.createAndShow(e)}return this.dialogManager.isReady()},e}();e.StoryAuthDialogManager=n}(t.Identity||(t.Identity={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){function n(){return r||(r=t.Identity.actionsFactory()),r}function o(){return new e.WebIdentityActions({dialogManager:new e.StoryAuthDialogManager(t.View.Common.DialogManager.getInstance()),navigateTo:function(e){return t.Utilities.assignWindowLocation(e)},ssoAttemptSucceeded:function(){return CommonMain.goToMyStoriesOrSignIn("Identity : Last SSO attempt succeeded, GoToMyStories")},ajaxPost:$.post,appendToBody:function(t){return $(document.body).append(t)}})}function i(t){return t&&401===t.status&&"Password Required"===t.statusText}var r;e.getActions=n,e.actionsFactory=o,e.isPasswordRequiredError=i}(t.Identity||(t.Identity={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){t[t.AAD=0]="AAD",t[t.MSA=1]="MSA"}(t.ProviderType||(t.ProviderType={}))}(t.Identity||(t.Identity={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){t[t.AAD=0]="AAD",t[t.MSA=1]="MSA",t[t.UnknownOrBoth=2]="UnknownOrBoth",t[t.Invalid=3]="Invalid"}(t.EmailProviderType||(t.EmailProviderType={}));!function(t){t[t.OrgId=0]="OrgId",t[t.MSAccount=1]="MSAccount",t[t.Neither=2]="Neither",t[t.Both=3]="Both",t[t.Error=4]="Error",t[t.Throttled=5]="Throttled",t[t.MSAccountNonEmail=6]="MSAccountNonEmail"}(t.OdcsmProviderType||(t.OdcsmProviderType={}))}(t.Identity||(t.Identity={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){function n(){return i||(i=t.Common.PageCompartmentManager.getInstance().createAccessor("PeriodicTokenRenewer")),i}var o=function(){function t(t){this.dependencies=t}return t.prototype.start=function(){var e=this;this.intervalId=this.dependencies.setInterval(function(){return e.periodicRenewal()},t.RenewalFrequencyMilliseconds)},t.prototype.stop=function(){this.intervalId&&this.dependencies.clearInterval(this.intervalId),this.intervalId=void 0},t.prototype.dispose=function(){this.stop(),this.dependencies=void 0},t.prototype.periodicRenewal=function(){if(this.dependencies.commonSettings.IsAuthenticated){var t=this.dependencies.allowAuthRenewalForIdleUsers||this.userStillActive(),e=this.currentTokenIsExpired();StoryLog.StructuredTraceTag(596455514,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Performing periodic token renewal.",{allowRenewal:t,currentTokenIsExpired:e}),t&&this.dependencies.actions.tryRenewAuthToken(),e&&(this.stop(),this.dependencies.actions.handleAuthExpiry())}},t.prototype.userStillActive=function(){return this.dependencies.activityMonitor.getMillisecondsSinceActive()<t.MaxIdleKeepRenewal},t.prototype.currentTokenIsExpired=function(){var e=this.dependencies.commonSettings.IsAADUser?t.AadLifetime:t.MsaLifetime;return platform.now()-this.dependencies.actions.getAuthTokenRenewalTime()>e},t.RenewalFrequencyMilliseconds=12e5,t.AadLifetime=33e5,t.MsaLifetime=828e5,t.MaxIdleKeepRenewal=288e5,t}();e.PeriodicTokenRenewer=o;var i;e.currentPeriodicTokenRenewer=n}(t.Identity||(t.Identity={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){var n=function(){function e(){var t=this;this.ssoStatus=!1,this.messageHandler=function(e){return t.ssoMessageHandler(e)},window.addEventListener("message",this.messageHandler)}return e.prototype.start=function(){var t=this;this.performSSO(),this.intervalId=platform.setInterval(function(){return t.performSSO()},e.c_ssoPeriodicTaskInterval)},e.prototype.getSsoStatus=function(){return this.ssoStatus},e.prototype.performSSO=function(){StoryLog.StructuredTraceTag(596477014,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Attempting SSO",{"SSO enabled":CommonSettings.SSOEnabled.toString(),"SSO status":this.ssoStatus.toString(),IsAuthenticated:CommonSettings.IsAuthenticated.toString(),PeriodicSSOTaskInterval:e.c_ssoPeriodicTaskInterval.toString(),PeriodicSSOTaskId:this.intervalId}),CommonSettings.IsAuthenticated||(this.ssoStatus=!1,this.disposeSSOIFrame(),this.iFrame=$("<iframe>"),this.iFrame.attr("id",e.c_ssoIFrameId),this.iFrame.css("display","none"),this.iFrame.attr("src",t.Common.UrlHelper.getInstance().getSSOUrl()),UnitTestMode||$(document.body).append(this.iFrame))},e.prototype.ssoMessageHandler=function(t){var n=e.verifySSOPostMessage(t.origin,t.data);StoryLog.StructuredTraceTag(596477015,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"SSO POST message event handler",{"Current SSO status":this.ssoStatus.toString(),"Event origin":t.origin,"Root Url":CommonSettings.SiteRootUrl.slice(0,-1),"SSO message verification result":n.toString()}),n&&(t.stopImmediatePropagation(),this.disposeSSOIFrame(),this.ssoStatus=n)},e.verifySSOPostMessage=function(t,e){return t!==CommonSettings.SiteRootUrl.slice(0,-1)?(StoryLog.StructuredTraceTag(596477016,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"SSO POST message event invalid origin",{"Event origin":t,"Root Url":CommonSettings.SiteRootUrl.slice(0,-1)}),!1):"SSOSuccessful"===e},e.prototype.dispose=function(){this.intervalId&&clearInterval(this.intervalId),this.messageHandler&&window.removeEventListener("message",this.messageHandler),this.disposeSSOIFrame()},e.prototype.disposeSSOIFrame=function(){this.iFrame&&this.iFrame.remove()},e.c_ssoIFrameId="ssoIFrame",e.c_ssoPeriodicTaskInterval=6e5,e}();e.SSO=n}(t.Identity||(t.Identity={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){var n=function(){function n(t){this.lastTokenRenewalTime=platform.now(),this.dependencies=t}return n.prototype.signIn=function(e){if(CommonSettings.IsAuthenticated)StoryLog.TraceTag(596477003,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"Sign in attempted while already signed in");else{if(this.sso&&this.sso.getSsoStatus())return StoryLog.StructuredTraceTag(596477004,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"SSO sign-in method selected",{ssoStatus:this.sso.getSsoStatus().toString(),IsAuthenticated:CommonSettings.IsAuthenticated.toString()}),this.sso.dispose(),void this.dependencies.ssoAttemptSucceeded();var n=t.Common.UrlHelper.getInstance().getHRDv2PageUrl()+(null!=e?"?redirectUrl="+encodeURIComponent(e):"");this.dependencies.navigateTo(n)}},n.prototype.signOut=function(){this.dependencies.navigateTo(CommonSettings.SignOutUrl)},n.prototype.signUp=function(t){StoryLog.TraceTag(596465678,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Redirecting user to Sign Up"),this.dependencies.navigateTo(AppendOrReplaceQueryParameter(CommonSettings.SignUpUrlMSA,"username",t))},n.prototype.redirectToSignIn=function(n,o,i){var r=this;StoryLog.StructuredTraceTag(596477005,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Redirecting user to Sign In",{ProviderType:e.ProviderType[o]});var a={email:n,providerType:o==e.ProviderType.MSA?e.OdcsmProviderType[e.OdcsmProviderType.MSAccount]:e.OdcsmProviderType[e.OdcsmProviderType.OrgId]};this.dependencies.ajaxPost(t.Common.UrlHelper.getInstance().signInUrlRedirect(i),JSON.stringify(a)).done(function(t){r.dependencies.navigateTo(t.signInUrl)}).fail(function(t,e,n){"timeout"===e||t&&0===t.status?StoryLog.StructuredTraceTag(596477006,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"Timeout or terminated request getting redirect sign-in url. Redirecting to the default sign-in page",{ErrorStatus:e,ErrorThrown:n,Status:t?t.status.toString():null}):StoryLog.StructuredTraceTag(596477007,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.error,"Error getting redirect sign-in url. Redirecting to the default sign-in page",{ErrorStatus:e,ErrorThrown:n,Status:t?t.status.toString():null}),r.dependencies.navigateTo(CommonSettings.IsTenantUser?CommonSettings.IdentityDefaultSignInUrlAAD:CommonSettings.IdentityDefaultSignInUrlMSA)})},n.prototype.tryRenewAuthToken=function(){var e=this,n=$.Deferred();if(CommonSettings.IsAuthenticated){var o=$("<iframe />").attr({id:"RenewTokenIFrame",src:t.Common.UrlHelper.getInstance().redirectSilentSignInUrl()}).css("display","none"),i=platform.setTimeout(function(){return e.renewTokenIFrameOnTimeOut(o,n)},CommonSettings.DefaultAjaxTimeout);n.then(function(){return clearTimeout(i)}),o.on("load",null,null,function(t){return e.renewTokenIFrameOnLoad(o,n)}),this.dependencies.appendToBody(o)}else n.resolve(!1);return n.promise()},n.prototype.renewTokenIFrameOnLoad=function(t,e){var n=void 0;try{n=t[0].contentWindow.IsAuthenticated}catch(t){}!0!==n&&!1!==n||(t.remove(),n&&(this.lastTokenRenewalTime=platform.now()),e.resolve(n))},n.prototype.renewTokenIFrameOnTimeOut=function(t,e){StoryLog.TraceTag(596477008,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.warning,"RPS ticket renewal timed out"),e.resolve(!1),t.remove()},n.prototype.getAuthTokenRenewalTime=function(){return this.lastTokenRenewalTime},n.prototype.handleAuthExpiry=function(){this.dependencies.dialogManager.showIdleSessionDialog()||"string"==typeof pageID&&-1===pageID.indexOf("ErrorPage")&&StoryLog.StructuredTraceTag(596477009,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"Failed to display the idle refresh dialog on a non-error page",{PageID:pageID})},n.prototype.registerSSO=function(t){this.sso=t,this.sso.start()},n.prototype.isAuthenticatedOrSSO=function(){return CommonSettings.IsAuthenticated||this.sso&&this.sso.getSsoStatus()},n}();e.WebIdentityActions=n}(t.Identity||(t.Identity={}))}(StoryApp||(StoryApp={}));var IdGenerator;!function(t){function e(){return o(r-1)+"A"}function n(t,e){var n=String.fromCharCode("A".charCodeAt(0)+e+1),o=r-1<t.length?r-1:t.length;return t.substring(0,o)+n}function o(t){for(var e=[],n=0;n<t;n++)e.push(i.charAt(Math.floor(Math.random()*i.length)));return e.join("")}var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=20;t.generate=e,t.generateChild=n,t.generateId=o}(IdGenerator||(IdGenerator={}));var ImageUtils;!function(t){function e(t,e,n){var o=t.width/t.height;if(!(o<=n.width/n.height)){var i=n.left,r=e.width-n.left-n.width,a=o*n.height-n.width,s=Math.min(i,a/2),l=Math.min(r,a/2);n.left-=s,n.width+=s+l,i=n.left,r=e.width-n.left-n.width,(a=o*n.height-n.width)>0&&(i>0?(s=Math.min(i,a),n.left-=s,n.width+=s):r>0&&(l=Math.min(r,a),n.width+=l))}}function n(e,n,o){var i=e.flipped(),r=n.flipped(),a=o.flipped();t.expandWidth(i,r,a),o.set(a.flipped())}function o(e,n,o){var i=e.width/e.height,r=o.width/o.height;i>r?t.expandWidth(e,n,o):i<r&&t.expandHeight(e,n,o)}function i(t,e,n,o){var i=new Size,r=e.width/Math.max(1,e.height),a=o.width/Math.max(1,o.height),s=0;!t&&r>a||t&&r<a?(i.width=e.width,s=o.width/(0==i.width?1:i.width),i.height=o.height/(0==s?1:s)):(i.height=e.height,s=o.height/(0==i.height?1:i.height),i.width=o.width/(0==s?1:s));var l=new Rect,u=i.width/o.width,c=i.height/o.height;return l.width=n.width*u,l.height=n.height*c,l.left=-o.left*u+(e.width-i.width)/2,l.top=-o.top*c+(e.height-i.height)/2,l}t.expandWidth=e,t.expandHeight=n,t.expandRegion=o,t.scaleDimensionsToRect=i}(ImageUtils||(ImageUtils={}));var Containers;!function(t){!function(t){function e(t,e){t.next=e,e.prev=t}function n(t){return!!t.prev}function o(t){var e=t.prev,n=t.next;e&&(e.next=n),n&&(n.prev=e),t.prev=t.next=void 0}var i=function(){function t(){this.hook=new a}return t.prototype.push=function(t){this.hook.push(t)},t.prototype.pop=function(){var t=this.hook.next;return t&&o(t),t},t.prototype.top=function(){return this.hook.next},t.prototype.empty=function(){return!this.hook.next},t.prototype.removeAt=function(t){for(var e=this.itr(),n=0;e.valid();e.advance(),n++)if(t===n)return o(e.current()),!0;return!1},t.prototype.length=function(){for(var t=0,e=this.itr();e.valid();e.advance(),t++);return t},t.prototype.toArray=function(){for(var t=[],e=this.itr();e.valid();e.advance())t.push(e.current());return t},t.prototype.itr=function(){return new r(this.hook.next)},t}();t.Stack=i;var r=function(){function t(t){this.iter=t}return t.prototype.current=function(){return this.iter},t.prototype.advance=function(){if(this.iter){var t=this.iter;return this.iter=this.iter.next,t}},t.prototype.valid=function(){return!!this.iter},t}();t.StackIter=r;var a=function(){function t(){}return t.prototype.push=function(t){o(t),this.next?(e(t,this.next),e(this,t)):this.hook(t)},t.prototype.hook=function(t){this.next=t,t.prev=this},t}();t.contained=n,t.disconnect=o}(t.Intrinsic||(t.Intrinsic={}))}(Containers||(Containers={}));var CommonMain;!function(t){function e(){StoryApp.RethrowLogger.logIfError(function(){StoryLog.BufferedTraceTag(596444928,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Common::Main::init");var e=new Date;StoryLog.init(),StoryPerformance.init(),platform.setTimeout(StoryLog.LogPlt,0,e),IsPerformanceModeOn=null!=PerformanceMetrics,StoryApp.Utilities.addUnloadEventListener(function(){StoryLog.BufferedTraceTag(596444929,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Common::Main::init::addUnloadEventListener"),State.DocumentUnloading=!0,State.PauseUpdates=!0},!0),StoryApp.Utilities.addUnloadEventListener(function(){return StoryPerformance.PerformanceManager.getInstance().saveToStorage()},!0,!0),FeatureDetection.initialize(),StoryLog.BufferedTraceTag(596444930,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Common::Main::init end"),CommonSettings.FlightSettings&&CommonSettings.FlightSettings.areInternalFeaturesEnabled&&StoryApp.Utilities.query.fetch(StoryApp.Common.UrlHelper.URLParamTelemetryMode).toLowerCase()===StoryApp.Common.UrlHelper.URLParamValueTrue&&t.TelemetryModeWindow.openTelemetryModeDialog()})}function n(t,e){void 0===e&&(e=!1),StoryLog.BufferedTraceTag(596444931,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Common::Main::goToMyStoriesOrSignIn"),StoryLog.StructuredTraceTag(596477188,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"CommonMain : goToMyStories",{CurrentPage:window.location.pathname,EntryPoint:t,IsAuthenticated:CommonSettings.IsAuthenticated.toString(),AnonUserId:CommonSettings.AnonUserId}),StoryApp.View.Common.DialogManager.closeCurrentDialog(),StoryApp.Identity.getActions().isAuthenticatedOrSSO()?o.NavigationContext.HomePageInitialize&&!e?(StoryPerformance.PerformanceManager.getInstance().markUserAction("goToMyStoriesOrSignIn"),o.NavigationContext.HomePageInitialize().then(function(){var t=StoryApp.Common.UrlHelper.getInstance().mySwaysUrl();t!==window.location.pathname&&HistoryManager.getHistoryManagerInstance().navigate(t,o.NavigationContext.HomePageInitialize,null,Resources.MySwaysTitle)})):(Cookie.setPageRequestInfo(StoryApp.Common.UrlHelper.getInstance().mySwaysUrl()),StoryApp.Utilities.assignWindowLocation(StoryApp.Common.UrlHelper.getInstance().mySwaysUrl())):StoryApp.Identity.getActions().signIn(),StoryLog.BufferedTraceTag(596444932,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Common::Main::goToMyStoriesOrSignIn end")}var o=StoryApp.Common;t.goToMyStoriesOrSignIn=n,StoryApp.Preload.driver.queueOnLoad().then(e).fail(function(t){StoryLog.StructuredTraceTag(596477189,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Something has gone wrong with a page load.",{error:t&&t.message||t+""||"Unknown error",CurrentPage:window.location.pathname,IsAuthenticated:CommonSettings.IsAuthenticated.toString(),AnonUserId:CommonSettings.AnonUserId}),StoryApp.Utilities.tryRefreshOnce("InitCommonFailed")})}(CommonMain||(CommonMain={}));var PerformanceMetrics,IsPerformanceModeOn,StoryApp;!function(t){!function(e){var n=function(){function e(t,e,n){this.url=e.url,this.verb=e.type,this.data=e.data,this.contentType=e.contentType,this.responseType=e.dataType,this.name=e.name,this.description=e.description,this.requestId=e.requestId,this.time=new Date,this.callstack=n,this.omitLog=e.omitLog,this.ignoreDisabled=e.ignoreDisabled}return e.prototype.getLoggingData=function(){return{URL:t.Utilities.removeQueryFromUrl(this.url),Verb:this.verb,"Content type":this.contentType,"Expected response type":this.responseType,"Request name":this.name,"Request description":this.description,"Request ID":this.requestId.toString(),"Request time":t.Utilities.getShortTimeStringUTC(this.time),Callstack:this.callstack,"Canary:":CommonSettings.Canary}},e}();e.Request=n}(t.RequestManager||(t.RequestManager={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){function n(){var t=$(document);t.on("ajaxStart"+h,i),t.on("ajaxSend"+h,r),t.on("ajaxSuccess"+h,a),t.on("ajaxError"+h,s),t.on("ajaxComplete"+h,l),t.on("ajaxStop"+h,u),$.ajaxPrefilter(function(t,e,n){e.retryCount=void 0==e.retryCount?0:++e.retryCount;var o=$.Deferred(),i=t.error;delete t.error,n.done(o.resolve),n.fail(function(r,a,s){e.retryCount<y?c(r,a,s,i,t.url,e,o):(i&&o.fail(i),o.rejectWith(e.context||n,[r,a,s]))}),o.promise(e.context||n)})}function o(){$(document).off(h)}function i(){}function r(n,o,i){if(void 0===i&&(i={}),e.ServerDomainOverride&&e.ServerDomainOverride.length>0&&g(i.url)){var r=0===i.url.indexOf("/")?"":"/";i.url=""+e.ServerDomainOverride+r+i.url,i.xhrFields={withCredentials:!0}}if(State.DisableRequestManager&&!i.ignoreDisabled)return o.abort(),!1;i.requestId=m++,!1!==i.setInternalHeaders&&e.CommonRequestHeaders.setCommonHeaders(o,CommonSettings.Canary&&("POST"===i.type||"PUT"===i.type||"DELETE"===i.type),!0),void 0===i.timeout&&(i.timeout=CommonSettings.DefaultAjaxTimeout);var a=new e.Request(o,i,t.Utilities.getStackTrace());return e.Data&&e.LogToDiagnosticPane&&e.Data.AppendRequest(a),i.storyRequest=a,i.omitLog||StoryLog.StructuredTraceTag(596477144,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.verbose,"Request",a.getLoggingData()),!0}function a(n,o,i){if(i&&i.storyRequest){CommonSettings.UserSessionId||(CommonSettings.UserSessionId=o.getResponseHeader(t.Common.CommonRequestHeaders.UserSessionIdHeader));var r=new e.Response(i.storyRequest,o,i,void 0);platform.setTimeout(function(){e.Data&&e.Data.RemoveRequest(i.storyRequest)},5e3),e.Data&&e.LogToDiagnosticPane&&e.Data.AppendResponse(r),i.omitLog||StoryLog.StructuredTraceTag(3781847,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.info,"Response",r.getLoggingData(),void 0,!0)}}function s(t,n,o,i){if(o&&o.storyRequest){var r=new e.Response(o.storyRequest,n,o,i);e.Data&&(e.Data.RemoveRequest(o.storyRequest),e.LogToDiagnosticPane&&e.Data.AppendResponse(r)),State.DocumentUnloading||State.DisableRequestManager&&!o.ignoreDisabled?t.stopImmediatePropagation():o.omitLog||StoryLog.StructuredTraceTag(596477145,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.warning,"Response",r.getLoggingData(),void 0,!0)}}function l(e,n,o){CommonSettings.AnonUserId||(CommonSettings.AnonUserId=n.getResponseHeader(t.Common.CommonRequestHeaders.AnonUserKeyHeader));var i=n.getResponseHeader(t.Common.CommonRequestHeaders.UserSessionIdHeader);CommonSettings.UserSessionId&&i===CommonSettings.UserSessionId||(CommonSettings.UserSessionId=i)}function u(){}function c(n,o,i,r,a,s,l){switch(n.status){case 401:var u=t.Utilities.extractHostnameFromUrl(a);if((""===u||u===location.hostname)&&"User unauthenticated"===n.statusText&&CommonSettings.IsAuthenticated)return StoryLog.TraceTag(596477146,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.info,"AJAX request failed with 401 response.  Sending user to MSA sign-in page."),void d(a,s,l);break;case 403:var c=n.getResponseHeader(e.RPSTicketExpirationHeader);if(null!==c)return StoryLog.TraceTag(596477147,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.info,"AJAX request failed because RPS ticket expired.  Attempting to renew the ticket and replay the request.  Header value = "+c),void d(a,s,l);if("Unable to acquire Graph information"==n.statusText)return StoryLog.TraceTag(596477148,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.info,"AJAX request failed because server failed to acquire Graph information. Attempting silent sign-in to refresh tokens."),void d(a,s,l);StoryLog.TraceTag(596477149,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.info,"403, but no OdsiHttpModule header or known statusText found");break;case 412:if(CommonSettings&&CommonSettings.NewCanaryHeader){var g=n.getResponseHeader(CommonSettings.NewCanaryHeader);if(g)return StoryLog.TraceTag(596477150,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.verbose,"412, canary validation failed"),CommonSettings.Canary=g,void p(a,s,l)}break;case 503:if("BRS"==n.getResponseHeader("X-Sway503Reason"))return BRSDialog.show(Resources.BRSDialogTitle,[Resources.BRSDialogMessage]),void l.rejectWith(s.context||n,[n,o,i]);if("Feature unavailable"!=n.statusText)return void p(a,s,l)}r&&l.fail(r),l.rejectWith(s.context||n,[n,o,i])}function d(e,n,o){if(null===f){var i=$.Deferred();f=i.promise(),t.Identity.getActions().tryRenewAuthToken().then(function(e){e?(i.resolve(),f=null):(t.Identity.getActions().handleAuthExpiry(),i.reject())})}else StoryLog.TraceTag(596477151,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.verbose,"RPS ticket renewal already in progress, queuing another failed AJAX request for replay.");f.then(function(){return p(e,n,o)})}function p(e,n,o){var i=t.Utilities.removeQueryStringFromUrl(e);return StoryLog.TraceTag(596477152,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.info,"Replaying request to "+i),$.ajax(e,n).then(o.resolve,o.reject)}function g(t){return!/^http(s?):\/\//.test(t)}e.JsonContentType="application/json; charset=utf-8",e.ContentTypeHeader="Content-Type",e.RPSTicketExpirationHeader="odsiHttpModule",e.LogToDiagnosticPane=!0;var h=".storyRequestManager",m=1,y=2,f=null;e.CommonRequestHeaders=new t.Common.CommonRequestHeaders,e.ServerDomainOverride="",e.init=n,e.Unregister=o,n()}(t.RequestManager||(t.RequestManager={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){var n=function(){function n(n,o,i,r){this.request=n,this.data=o.responseText,this.contentType=o.getResponseHeader(e.ContentTypeHeader),this.allHeaders=o.getAllResponseHeaders(),this.statusCode=o.status,this.statusText=o.statusText,this.correlationId=o.getResponseHeader(t.Common.CommonRequestHeaders.CorrelationIdHeader),this.time=new Date}return n.prototype.getLoggingData=function(){return{"Request ID":this.request.requestId.toString(),URL:t.Utilities.removeQueryFromUrl(this.request.url),"Response time":t.Utilities.getShortTimeStringUTC(this.time),"Content type":this.contentType,"Status code":this.statusCode.toString(),"Status text":this.statusText,"Correlation ID":this.correlationId}},n}();e.Response=n}(t.RequestManager||(t.RequestManager={}))}(StoryApp||(StoryApp={}));var StoryAudience;!function(t){t[t.Unknown=0]="Unknown",t[t.Owner=1]="Owner",t[t.TenantWithLink=2]="TenantWithLink",t[t.AnyoneWithLink=3]="AnyoneWithLink",t[t.Public=4]="Public",t[t.Published=5]="Published"}(StoryAudience||(StoryAudience={}));var StoryApp;!function(t){!function(e){e.SharingReferrers={Facebook:"Facebook",Twitter:"Twitter",LinkedIn:"LinkedIn",Link:"Link",Email:"email"},e.SharingButtonLocations={Edit:"",Play:"play",EndOfStory:"endofstory",MySways:"mysways",Swsp:"swsp"};var n=function(){function n(t,e,n,o,i){this.changeSharingLevelQueue=[],this.currentSharingLevel=TDB.watchableTag(596477137,null,e),this.storyDefaultSharingLevel=n,this.sharingManagerApi=t,this.currentlyHasPassword=TDB.watchable(this,o),this.currentPasswordScope=TDB.watchable(this,i)}return n.prototype.getCurrentSharingLevel=function(t){return this.currentSharingLevel.getWatchedValue(t)},n.prototype.getStoryDefaultSharingLevel=function(){return this.storyDefaultSharingLevel},n.prototype.isPublicSharingAllowed=function(t){var e=this.getCurrentSharingLevel(t);return e!=StoryAudience.TenantWithLink&&e!=StoryAudience.Owner},n.prototype.shareToFacebook=function(t,o,i){var r=e.UrlHelper.getInstance().trackedShareLinkUrl(t,e.SharingReferrers.Facebook,o);this.sharingManagerApi.openPopup(e.UrlHelper.getInstance().getShareToFacebookUrl(r),"location=1,resizable=1",n.facebookPopupSize),this.auditShareStory(t,i)},n.prototype.shareToLinkedIn=function(t,o,i,r){var a=e.UrlHelper.getInstance().trackedShareLinkUrl(o,e.SharingReferrers.LinkedIn,i);this.sharingManagerApi.openPopup(e.UrlHelper.getInstance().getShareToLinkedInUrl(a,t,Resources.CatchPhrase2),"location=1,resizable=1,scrollbars=1",n.linkedInPopupSize),this.auditShareStory(o,r)},n.prototype.shareToTwitter=function(t,o,i,r){var a=e.UrlHelper.getInstance().trackedShareLinkUrl(o,e.SharingReferrers.Twitter,i);this.sharingManagerApi.openPopup(e.UrlHelper.getInstance().getShareToTwitterUrl(a,t),"location=1,resizable=1,scrollbars=1",n.twitterPopupSize),this.auditShareStory(o,r)},n.prototype.auditShareStory=function(t,e){var n=ClientAction.ButtonId[e];t=t||"",CommonSettings.IsAuthenticated&&this.sharingManagerApi.dispatchAuditShareStoryRequest(t,n)},n.prototype.shareViewLink=function(e,n){var o=CommonSettings.ContentNavigationEnabled,i={title:Resources.LinkSwayTitle,messages:[Resources.LinkSwayBodyV2],text:e,textBoxDescription:Resources.ShareByLinkTextBoxDescription,alternateText:o?n:void 0,checkboxMessage:o?Resources.LinkSwayAlternateCheckBoxText:void 0,checkboxId:o?ClientAction.ButtonId.ShareLink_AlternateUrl:void 0,textBoxTooltip:Resources.ShareByLinkTextBoxTooltip,accessibilityMessageOnCopy:Resources.ContextMenuCopyLinkButtonCalloutReader};t.View.Common.CopyTextDialog.show(i)},n.prototype.shareEditLink=function(e){var n={title:Resources.EditLinkSwayTitle,messages:[Resources.EditLinkSwayBody],text:e,textBoxDescription:Resources.ShareEditLinkTextBoxDescription,textBoxTooltip:Resources.ShareEditLinkTextBoxTooltip,accessibilityMessageOnCopy:Resources.ContextMenuCopyLinkButtonCalloutReader};t.View.Common.CopyTextDialog.show(n)},n.prototype.changeAuthToken=function(t,e,n){var o=new ChangeLinkRequest;o.newViewAuthToken=!0,o.newEditAuthToken=!0,this.sendChangeSharingRequest(o,t,e,n)},n.prototype.changeEditToken=function(t,e,n){var o=new ChangeLinkRequest;o.newEditAuthToken=!0,this.sendChangeSharingRequest(o,t,e,n)},n.prototype.changeBlockDuplication=function(t,e,n,o){var i=new ChangeLinkRequest;i.blockDuplication=t,CommonSettings.IsExportStoryEnabled&&(StoryLog.StructuredTraceTag(596477138,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Toggled print and export sharing checkboxes using duplication checkbox",{NewValue:t}),i.blockExport=t,i.blockPrint=t),this.sendChangeSharingRequest(i,e,n,o)},n.prototype.changeBlockPrint=function(t,e,n,o){var i=new ChangeLinkRequest;i.blockPrint=t,StoryLog.StructuredTraceTag(596477139,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Toggled print sharing checkbox successfuly",{NewValue:t}),this.sendChangeSharingRequest(i,e,n,o)},n.prototype.changeBlockExport=function(t,e,n,o){var i=new ChangeLinkRequest;i.blockExport=t,StoryLog.StructuredTraceTag(596477140,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Toggled export sharing checkbox successfuly",{NewValue:t}),this.sendChangeSharingRequest(i,e,n,o)},n.prototype.changeBlockConsumptionWorldSwitch=function(t,e,n,o){var i=new ChangeLinkRequest;i.blockConsumptionWorldSwitch=t,this.sendChangeSharingRequest(i,e,n,o)},n.prototype.changeBlockShareButton=function(t,e,n,o){var i=new ChangeLinkRequest;i.blockShareButton=t,this.sendChangeSharingRequest(i,e,n,o)},n.prototype.publishSwayToCast=function(t,e,n){var o=this;if(CommonSettings.SitePublishToCastFeatureEnabled){TDB.applyUpdate(function(){return o.currentSharingLevel.setValue(StoryAudience.Public)});var i=new ChangeLinkRequest;i.publishToCast=!0,this.sendChangeSharingRequest(i,t,e,n)}},n.prototype.unpublishFromCast=function(t,e,n,o){var i=this;if(CommonSettings.SitePublishToCastFeatureEnabled){var r=e;r==StoryAudience.Unknown&&(r=this.getStoryDefaultSharingLevel()),TDB.applyUpdate(function(){return i.currentSharingLevel.setValue(r)});var a=new ChangeLinkRequest;a.unpublishFromCast=!0,a.audience=StoryAudience[r],this.sendChangeSharingRequest(a,t,n,o)}},n.prototype.changeSharingLevel=function(t,e,n,o){var i=this,r=this.currentSharingLevel.getValue();TDB.applyUpdate(function(){return i.currentSharingLevel.setValue(t)});var a=function(e,n,a){return i.onChangeAudienceError(t,r,o,e,n,a)},s=function(){return i.onChangeAudienceSuccess(t,r,n)};StoryLog.StructuredTraceTag(596477141,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Queueing up change audience request",{newAudience:t.toString(),oldAudience:r.toString()});var l=new ChangeLinkRequest;l.audience=StoryAudience[t],this.queueChangeAudienceRequest(l,e,s,a)},n.prototype.getSuggestedUsers=function(t,e,n,o){this.sharingManagerApi.sendGetSuggestedUsers(t,e,n,o)},n.prototype.getGroupMembers=function(t,e,n){this.sharingManagerApi.sendGetGroupMembersRequest(t,e,n)},n.prototype.queueChangeAudienceRequest=function(t,e,n,o){var i=this,r=function(){return i.currentChangeSharingLevelPromise=i.sendChangeSharingRequest(t,e,n,o)};this.currentChangeSharingLevelPromise?this.changeSharingLevelQueue.push(r):r()},n.prototype.sendChangeSharingRequest=function(t,e,n,o){var i=this;return this.sharingManagerApi.sendChangeSharingRequest(t,e,function(t,e,o){i.onChangeSharingRequestSuccess(t,e,o,n)},o)},n.prototype.onChangeSharingRequestSuccess=function(t,e,n,o){var i=this,r=StoryAudience[t.audience];null==this.currentChangeSharingLevelPromise&&t.audience&&this.getCurrentSharingLevel()!=r&&TDB.applyUpdate(function(){i.currentSharingLevel.setValue(r)}),o&&o(t,e,n)},n.prototype.onChangeAudienceSuccess=function(t,e,n){StoryLog.StructuredTraceTag(596477142,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Audience change request succeeded",{newAudience:t.toString(),oldAudience:e.toString()}),this.currentChangeSharingLevelPromise=null,this.changeSharingLevelQueue.length>0&&this.changeSharingLevelQueue.shift()(),n()},n.prototype.onChangeAudienceError=function(t,e,n,o,i,r){var a=this;StoryLog.StructuredTraceTag(596477143,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Audience change request failed",{newAudience:t.toString(),oldAudience:e.toString(),textStatus:i,errorThrown:r}),this.changeSharingLevelQueue=[],this.currentChangeSharingLevelPromise=null,TDB.applyUpdate(function(){return a.currentSharingLevel.setValue(e)}),n(o,i,r)},n.prototype.visualLinkSharingEnabled=function(t,e){if(!n.isVisualLinkCopySupported())return!1;switch(t){case VisualLinkMode.Disabled:return!1;case VisualLinkMode.PublicStoriesOnly:return this.isPublicSharingAllowed(e);case VisualLinkMode.Enabled:return!0}},n.isVisualLinkCopySupported=function(){if(t.Common.UserState.getInstance().isUserOnFlight(FlightList.StoryAutomationFlight))return!0;var e=t.Utilities.browser;return!(e.isFirefox&&e.majorVersion<=45)},n.prototype.getThumbnail=function(t,e,n){this.sharingManagerApi.getThumbnail(t,e,n)},n.prototype.createPublicThumbnail=function(t,e,n,o){this.sharingManagerApi.createPublicThumbnail(t,e,n,o)},n.prototype.hasPassword=function(t){return this.currentlyHasPassword.getWatchedValue(t)},n.prototype.getPasswordScope=function(t){return this.currentPasswordScope.getWatchedValue(t)},n.prototype.setPassword=function(t,e,n,o){var i=this,r=function(t,o,r){return i.onPasswordSetSuccess(t,o,r,n,e.Scope)};this.sharingManagerApi.setPassword(t,e,r,o)},n.prototype.onPasswordSetSuccess=function(t,e,n,o,i){var r=this;TDB.applyUpdate(function(){r.currentlyHasPassword.setValue(!0),r.currentPasswordScope.setValue(i)}),o(t,e,n)},n.prototype.removePassword=function(t,e,n){var o=this,i=function(t,n,i){return o.onPasswordRemoveSuccess(t,n,i,e)};this.sharingManagerApi.removePassword(t,i,n)},n.prototype.onPasswordRemoveSuccess=function(t,e,n,o){var i=this;TDB.applyUpdate(function(){i.currentlyHasPassword.setValue(!1)}),o(t,e,n)},n.facebookPopupSize=new Size(670,340),n.twitterPopupSize=new Size(550,420),n.linkedInPopupSize=new Size(520,570),n}();e.SharingManager=n}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var StoryLog;!function(t){function e(t,e,n){V=t,U=e,k=n}function n(){V=void 0,U=void 0,k=void 0}function o(t){switch(t){case TDB.LogLevel.verbose:return Diag.ULSTraceLevel.verbose;case TDB.LogLevel.info:return Diag.ULSTraceLevel.info;case TDB.LogLevel.warning:return Diag.ULSTraceLevel.warning;case TDB.LogLevel.error:return Diag.ULSTraceLevel.error;default:return Diag.ULSTraceLevel.spam}}function i(){var e=new L;Diag.ULS.setUlsHost(e);var n,i=function(e){if(["visibilitychange","focus","blur"].indexOf(e.type)>-1){var n="visibilitychange"==e.type?!document.hidden:"focus"==e.type;F!=n&&(F=n,t.StructuredTraceTag(595993429,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Visibility change happened",{IsVisible:F}))}else t.StructuredTraceTag(595993297,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Unexpected event type called",{eventType:e.type})},a=function(){e._asyncOverride=!0,n||(ActionLogger&&ActionLogger.Flush(),n=!0,e.dispose(),window.removeEventListener("message",r,!1)),document.removeEventListener("visibilitychange",i),window.removeEventListener("focus",i),window.removeEventListener("blur",i)};StoryApp.Utilities.addUnloadEventListener(a,!0),StoryApp.Utilities.browser.isIEOrEdge||window.addEventListener("unload",a),window.addEventListener("message",r,!1),document.addEventListener("visibilitychange",i),window.addEventListener("focus",i),window.addEventListener("blur",i),t.StructuredTraceTag(596477134,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Instantiated UploadingUlsHost.",{UserSessionId:CommonSettings?CommonSettings.UserSessionId:"CommonSettings not available"});var s=new I;StoryApp.Preload.resourceLoaderFactory.setLoggerRegistration(s),StoryApp.Preload.resourceLoaderFactory.setLogIfErrorRegistration(StoryApp.RethrowLogger),TDB.setLoggingFunction(function(e,n){var i=o(e);t.TraceTag(596477135,Diag.ULSCat.msoulscat_Story_Site,i,n)}),TDB.setLogIfErrorFunction(StoryApp.RethrowLogger.logIfError),TDB.setRaiseRecoverableErrorFunction(t.RaiseRecoverableError),TDB.setCreateErrorFunction(StoryApp.RethrowLogger.createError),t.initialized=!0}function r(e){if("setImmediate"!==e.data&&"string"==typeof e.data&&"StoryLog:"===e.data.substr(0,9)){var n=JSON.parse(e.data.substr(9)),o=Diag.ULSCat[n.category],i=Diag.ULSTraceLevel[n.level];"number"!=typeof n.tag||n.tag<=0||"string"!=typeof n.category||"number"!=typeof o||"string"!=typeof n.level||"number"!=typeof i||"string"!=typeof n.message||t.TraceTag(n.tag,o,i,n.message)}}function a(e){var n=new Date,o=window.PageExecutionBegin,i=CommonSettings.RequestTime,r=top!=window;if(o&&n&&e){var a=(e.getTime()-o.getTime()).toString(),s=(n.getTime()-o.getTime()).toString(),l=void 0;i&&(l=(n.getTime()-i).toString()),l&&(Number(l)>6e4||Number(l)<0)&&(t.TraceTag(4789061,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Anomalous inclusive page load time: "+l+" ms. Likely to be caused by stale URL or subsequently-resumed action."),l=void 0);var u=CommonSettings.IsNewlyCreated?"CreateStory":CommonSettings.Action;t.StructuredTraceTag(4587730,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Page loaded.",{Action:u,Mode:StoryViewMode[k],DocumentReadyMs:a,PageResponsiveMs:s,LatencyInclusiveTimeMs:l,StoryId:V,IsInIFrame:r?"true":"false",DocumentHasFocus:document.hasFocus(),DocumentIsVisible:F})}else{var c=void 0!==o&&null!=o?o.toJSON():"null",d=void 0!==n&&null!=n?n.toJSON():"null",p=void 0!==e&&null!=e?e.toJSON():"null";t.StructuredTraceTag(595993116,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Missing needed time.",{PageExecutionBegin:c,DocReadyTimeoutTime:d,DocReadyTime:p,Mode:StoryViewMode[k],StoryId:V,isInIFrame:r,DocumentHasFocus:document.hasFocus(),DocumentIsVisible:F})}t.FlushClientData()}function s(t){t.StoryId=V,k===StoryViewMode.Edit&&t.setEditOccured(),t.ViewMode=StoryViewMode[k]}function l(e,n,o,i,r){t.TraceTag(e,n,o,i,r)}function u(e,n,o,i,r,a,s,l){t.TraceTag(0,e,n,o,i,r,a,s,l)}function c(t,e,n,o,i,r,a,s,l){if(2!==x){1!==x&&!0!==CommonSettings.IsSpider||(n=T(n)),CommonSettings.AnonUserId&&(o+=" [AnonUserId="+CommonSettings.AnonUserId+"]"),!CommonSettings.UnsupportedBrowser||n!=Diag.ULSTraceLevel.error&&n!=Diag.ULSTraceLevel.warning||(o+=" [Unsupported Browser error. Previous log level was "+(n==Diag.ULSTraceLevel.error?"error]":"warning]"),n=Diag.ULSTraceLevel.info);var u=window.StoryPageSettings;if(u&&StoryApp.Common.NavigationContext.CurrentType===StoryApp.Common.NavigationContextType.Story&&"{"!=o.charAt(0)&&(o+="#ViewMode:"+StoryViewMode[u.Mode]),n==Diag.ULSTraceLevel.error&&void 0===r)try{throw new Error}catch(t){r=t.stack}if(r&&!UnitTestMode){var c=void 0;n===Diag.ULSTraceLevel.error&&(c=d(r,t,o)),o+="\nStack Trace"+(c?" #"+c:"")+":\n"+r}s&&(o="EXTENDED=["+(new Date).toISOString()+"] "+o);var p=[t,e,v(n),o];i&&i.length>0&&(p=p.concat(i));var g=new b;s?g.storeLogArgs(p):(l&&g.flushArgs().forEach(function(t){return Diag.ULS.sendTraceTag.apply(null,t)}),Diag.ULS.sendTraceTag.apply(null,p))}}function d(t,e,n){var o=Math.abs(ClientAction.getHashCode(t));if(!ArrayExtensions.contains(P,o))try{"string"!=typeof n&&(n=""),"string"!=typeof t&&(t="");var i={stackTraceHash:o,tagId:e,message:n.replace(/=/g,"%3D"),stackTrace:t.replace(/=/g,"%3D")},r=window.StoryPageSettings,a=r?r.LookupId:void 0,s={url:StoryApp.Common.UrlHelper.getInstance().logStackTraceUrl(a),type:"POST",timeout:CommonSettings.LoadTimeoutMilliseconds,data:JSON.stringify(i),cache:!1,traditional:!0,ignoreDisabled:!0,contentType:StoryApp.RequestManager.JsonContentType};Task.fromPromise($.ajax(s)).then(function(t){if(t){var e="Deminified stack trace:  SessionId="+CommonSettings.UserSessionId+"  Slice="+t.sliceName;t.errorSet&&(e+="  ErrorSet="+t.errorSet,e+="\nBug Report: https://avocado/reports/147932?ErrorSet="+t.errorSet),console.error(e+"\n"+t.stackTrace)}}),P.push(o)>R&&P.shift()}catch(t){}return o}function p(e,n,o,i,r,a,s,l){t.StructuredTraceTag(0,e,n,o,i,r,a,s,l)}function g(e,n,o,i,r,a,s,l,u){if(void 0===r&&(r={}),r.Purpose=i,r.UnsupportedBrowser=CommonSettings.UnsupportedBrowser?"true":"false",!r.ViewMode){var c=window.StoryPageSettings;c&&StoryApp.Common.NavigationContext.CurrentType===StoryApp.Common.NavigationContextType.Story&&(r.ViewMode=StoryViewMode[c.Mode])}t.TraceTag(e,n,o,JSON.stringify(r),null,a,s,l,u)}function h(e,n,o,i){void 0===i&&(i={}),t.BufferedTraceTag(0,e,n,o,i)}function m(e,n,o,i,r){void 0===r&&(r={}),t.StructuredTraceTag(e,n,o,i,r,void 0,void 0,!StoryApp.OM.inAutomation)}function y(e,n,o,i,r,a){t.StructuredActivityTag(0,e,n,o,i,r,a)}function f(e,n,o,i,r,a,s){var l=S(s);l.TELEM_ACTIVITY_ACTIONNAME=i,l.StoryId=a,l.Purpose=r,t.TraceTag(e,n,o,JSON.stringify(l))}function S(t){var e=Obj.properties(t).sort();return ArrayExtensions.toDictionary(e.map(function(e){return e+":"+t[e]}),function(t,e,n){return e["Column"+(n+1)]=t})}function C(t,e){var n=[];n.push('data: [{ "LogType:"'+t);for(var o in e){var i=e[o];if("string"==typeof i&&-1!=i.indexOf("\n"))i=(i="\n"+i).replace(/(\r\n|\n|\r)/gm,"\n        ");else if(void 0===i)continue;n.push('"'+o+":"+i+",")}return n.push("}]"),n.join("\n")}function v(t){return CommonSettings&&CommonSettings.FlightSettings&&CommonSettings.FlightSettings.logVerboseTraces&&t==Diag.ULSTraceLevel.verbose?Diag.ULSTraceLevel.info:t}function _(t,e){if(void 0===e&&(e=TDB.LogLevel.error),u(Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Recoverable error stack trace: "+StoryApp.Utilities.getStackTrace(!0)),!StoryApp.Common.Environment.getInstance().isProductionEnvironment())throw new Error(t);c(7120353,Diag.ULSCat.msoulscat_Story_Site,o(e),t)}function w(){0===x&&(x=1,platform.setTimeout(function(){x=2},E))}function T(t){return t===Diag.ULSTraceLevel.error?Diag.ULSTraceLevel.warning:t}function A(){var t=Diag.ULS.get_host();t&&t.flushAsynchronous()}function D(){return V}function B(){return U}var I=StoryApp.Common.Logging.PreloadLogger,b=StoryApp.Common.Logging.PersistentBufferLogger;t.assumedMaxLogLength=3e3;var E=1e4,x=0,P=new Array,R=10;t.initialized=!1;var L=function(t){function e(){var e="SessionId0";return CommonSettings&&CommonSettings.UserSessionId&&(e=CommonSettings.UserSessionId),t.call(this,e,StoryApp.Common.UrlHelper.getInstance().remoteUlsUrl())||this}return __extends(e,t),e.prototype.modifyHttpRequestBeforeUploading=function(t){StoryApp.RequestManager&&StoryApp.RequestManager.CommonRequestHeaders.setCommonHeaders(t)},e}(Diag.UploadingUlsHost);t.StoryUlsHost=L;var V,U,k,F;t.setupForStoryPage=e,t.resetForStoryPage=n,t.init=i,t.handlePostMessageLog=r,t.LogPlt=a,t.SetupUlsLogData=s,t.ClientActionTrace=l,t.Trace=u,t.TraceTag=c,t.StructuredTrace=p,t.StructuredTraceTag=g,t.BufferedTrace=h,t.BufferedTraceTag=m,t.StructuredActivity=y,t.StructuredActivityTag=f,t.FromDictionary=C,t.RaiseRecoverableError=_,t.SuppressThenDisable=w,t.FlushClientData=A,t.GetStoryId=D,t.GetLookupId=B}(StoryLog||(StoryLog={}));var StoryLogUtilities;!function(t){function e(t){t.click(function(t){return Cookie.setPageRequestInfo($(t.currentTarget).attr("href")),!0}),t.mouseup(function(t){return Cookie.setPageRequestInfo($(t.currentTarget).attr("href")),!0})}function n(){e($("a.homeLink"))}t.WriteRequestTimeOnClick=e,t.SetupTimestampEvents=n}(StoryLogUtilities||(StoryLogUtilities={})),$(document).ready(function(){StoryLogUtilities.SetupTimestampEvents()});var StoryManager;!function(t){function e(t,e){t([])}t.loadMyStories=e}(StoryManager||(StoryManager={}));var MonitoredScope;!function(t){function e(t,e){return n(0,t,e)}function n(t,e,n){if(!e)throw StoryApp.RethrowLogger.createError("StoryMonitoredScope.CreateTag: Monitored scopes must be initialized with a descriptive name.");var i=new o;return i._stopped=!1,i._name=e,i._tag=t,i._category=n,i._begin=new Date,StoryLog.TraceTag(596477133,n,Diag.ULSTraceLevel.info,"Scope started: {0}",[i._name]),i}var o=function(){function t(){}return t.prototype.End=function(){if(!this._name)throw StoryApp.RethrowLogger.createError("StoryMonitoredScope.End: Monitored scopes must be initialized through either Create or CreateTag, not the no-argument constructor.");if(!this._stopped){this._end=new Date;var t=(this._end.getTime()-this._begin.getTime()).toString(),e=this._tag,n=this._category,o=this._name;StoryLog.TraceTag(e,n,Diag.ULSTraceLevel.info,"Scope ended: Scope='"+o+"'; Time="+t+" milliseconds"),console.log("Scope ended: Scope ='"+this._name+"'; Time="+(this._end.getTime()-this._begin.getTime()).toString()+"."),this._stopped=!0}},t}();t.StoryMonitoredScope=o,t.Create=e,t.CreateTag=n}(MonitoredScope||(MonitoredScope={}));var StoryReference=function(){function t(){this.title="",this.id="",this.created="",this.lastModified="",this.owner="",this.token=""}return t}(),StoryApp;!function(t){!function(e){!function(e){var n=function(){function n(){}return n.shareAADStoryToDocsDotCom=function(t,o,i){if(CommonSettings.SitePublishToCastFeatureEnabled){ActionLogger.RecordClientAction(new ClientAction.ShareStoryData(ClientAction.ShareTargetId.DocsDotCom));var r={callback:null,sharingManager:i};e.PublishCastDialog.createAndShowPublish(t,r),i.auditShareStory(t,o)}else n.showSharingDisabledDialog()},n.shareToFacebook=function(t,e,o,i){CommonSettings.SiteFacebookSharingEnabled?(ActionLogger.RecordClientAction(new ClientAction.ShareStoryData(ClientAction.ShareTargetId.Facebook)),i.shareToFacebook(t,e,o)):n.showSharingDisabledDialog()},n.shareToTwitter=function(t,e,o,i,r,a){if(a||(a=""),CommonSettings.SiteTwitterSharingEnabled){ActionLogger.RecordClientAction(new ClientAction.ShareStoryData(ClientAction.ShareTargetId.Twitter));var s=void 0;s=e?Resources.SharingTwitterAuthorMessage:Resources.SharingTwitterConsumerMessage,r.shareToTwitter(ResourceManager.ResolveString(s,[a]),t,o,i)}else n.showSharingDisabledDialog()},n.shareToLinkedIn=function(t,e,o,i,r){r||(r=""),CommonSettings.SiteLinkedInSharingEnabled?(ActionLogger.RecordClientAction(new ClientAction.ShareStoryData(ClientAction.ShareTargetId.LinkedIn)),i.shareToLinkedIn(r,t,e,o)):n.showSharingDisabledDialog()},n.shareViewLink=function(t,e,n,o){var i=o&&o!=t;ActionLogger.RecordClientAction(new ClientAction.ShareStoryData(ClientAction.ShareTargetId.Link,i)),n.shareViewLink(t,i?o:null)},n.shareEditLink=function(t,e,n,o){ActionLogger.RecordClientAction(new ClientAction.ShareStoryData(ClientAction.ShareTargetId.Edit)),t?n.shareEditLink(t):n.changeEditToken(e,function(t,e,i){o&&o(t.editUrl),n.shareEditLink(t.editUrl)},function(t,e,n){ErrorDialog.ShowErrorDialog(Resources.EditLinkErrorTitle,Resources.EditLinkErrorBody,"Sharing: Edit Link failed to load")})},n.embed=function(e,n){if(CommonSettings.SiteEmbeddedSwaysEnabled){ActionLogger.RecordClientAction(new ClientAction.ShareStoryData(ClientAction.ShareTargetId.Embed));var o={title:Resources.EmbedSway,messages:[],text:n,textBoxDescription:Resources.EmbedSwayTextBoxDescription,textBoxTooltip:Resources.EmbedSwayTextBoxDescription,accessibilityMessageOnCopy:Resources.SharedSwayDialogContentCopiedButton};t.View.Common.CopyTextDialog.show(o)}else NyiDialog.show()},n.showSharingDisabledDialog=function(){SharingDisabledDialog.show()},n}();e.StoryShareAction=n}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryViewMode;!function(t){t[t.Preview=1]="Preview",t[t.Edit=2]="Edit",t[t.Embedded=3]="Embedded",t[t.AuthoringDisabled=4]="AuthoringDisabled"}(StoryViewMode||(StoryViewMode={}));var Task=function(){function t(t){this._promise=t}return t.fromPromise=function(e){return new t(e)},t.fromResult=function(t){var e=new DeferredTask;return e.resolve(t),e},t.unwrap=function(e){var n=new DeferredTask;return e.thenWithoutUnwrapping(function(e){e instanceof t?e.thenWithoutUnwrapping(function(t){n.resolve(t)},function(){n.reject()}):n.resolve(e)},function(){n.reject()}),n},t.prototype.thenWithoutUnwrapping=function(e,n){return t.fromPromise(this._promise.then(e,n))},t.prototype.then=function(e,n){var o=t.fromPromise(this._promise.then(e,n));return t.unwrap(o)},t.prototype.toPromise=function(){return this._promise},t.TaskFromCollection=function(t){var e=new Array(t.length),n=0,o=t.length,i=new DeferredTask;return 0===t.length&&i.resolve(e),t.forEach(function(t,r){t.then(function(t){e[r]=t,++n===o&&i.resolve(e)},function(){++n===o&&i.resolve(e)})}),i},t}(),DeferredTask=function(t){function e(){var e=this,n=$.Deferred();return e=t.call(this,n)||this,e._deferred=n,e}return __extends(e,t),e.prototype.reject=function(){this._deferred.reject()},e.prototype.resolve=function(t){this._deferred.resolve(t)},e}(Task),TaskPool=function(){function t(t){this._maxTaskCount=t,this._currentTaskCount=0,this._queuedTasks=[]}return t.createTaskMutex=function(){return new t(1)},t.prototype.onTaskComplete=function(){this._queuedTasks.length>0?this._queuedTasks.shift().resolve(void 0):this._currentTaskCount--},t.prototype.continueTask=function(t){var e=this;return t().then(function(t){return e.onTaskComplete(),t},function(){e.onTaskComplete()})},t.prototype.runTask=function(t){var e=this;if(this._currentTaskCount<this._maxTaskCount)return this._currentTaskCount++,this.continueTask(t);var n=new DeferredTask,o=n.then(function(n){return e.continueTask(t)},function(){throw StoryApp.RethrowLogger.createError("Task pool deferred task failed")});return this._queuedTasks.push(n),Task.unwrap(o)},t}(),DropShadow;!function(t){function e(t){var e="";return e+=StoryApp.Utilities.cvtServerToPxStr(t.scale,t.xOffset),e+=" "+StoryApp.Utilities.cvtServerToPxStr(t.scale,t.yOffset),t.blur<=0&&(t.blur=0),e+=" "+StoryApp.Utilities.cvtServerToPxStr(t.scale,t.blur),t.spread<=0&&(t.spread=0),e+=" "+StoryApp.Utilities.cvtServerToPxStr(t.scale,t.spread),t.color&&(e+=" "+t.color.toRGBAString()),t.inset&&(e+=" inset"),e}function n(t){return 0==t.xOffset&&0==t.yOffset&&0==t.blur&&"#00000000"==t.color.toArgbString()&&0==t.spread&&0==t.inset}function o(t){return t.color.a>0&&(0!=t.xOffset||0!=t.yOffset||0!=t.blur||0!=t.spread)}t.cssFromDropShadow=e,t.isDropShadowDefault=n,t.isDropShadowVisible=o}(DropShadow||(DropShadow={}));var TextShadow;!function(t){function e(t,e){var n="";return n+=StoryApp.Utilities.toPxStr(e.xOffset),n+=" "+StoryApp.Utilities.toPxStr(e.yOffset),e.blur<=0&&(e.blur=0),n+=" "+StoryApp.Utilities.toPxStr(e.blur),e.color&&(n+=" "+new Color(e.color).toRGBAString()),n}function n(t){return 0==t.xOffset&&0==t.yOffset&&0==t.blur&&"#00000000"==t.color}t.cssFromTextShadow=e,t.isTextShadowDefault=n,$(function(){$.cssHooks.textShadow={get:function(t){return t.textShadow||{xOffset:0,yOffset:0,blur:0,color:"#00000000"}},set:function(t,o){if(!n(o)){var i=e(t,o);t.style.textShadow=i,t.textShadow=o}}},$.cssNumber.textShadow=!0})}(TextShadow||(TextShadow={}));var StoryApp;!function(t){!function(e){function n(){return e.ios&&!Modernizr.dynamicscrollevents}function o(){}function i(t){if(!(t instanceof Array))return!1;if(t&&0!==t.length){var e=t.length;if(t[0])return!0;for(;e--;)if(t[e])return!0;return!1}return!1}function r(e){if(!e&&!t.OM.inAutomation)return"";try{throw new Error}catch(t){return t.stack?t.stack.replace("Error\n",""):""}}function a(t,e){for(var n=""+t;n.length<e;)n="0"+n;return n}function s(t){return a(t.getUTCHours(),2)+":"+a(t.getUTCMinutes(),2)+":"+a(t.getUTCSeconds(),2)+"."+a(t.getUTCMilliseconds(),3)}function l(t,e){if(e)for(var n=e.length,o=0;o<n;++o){var i=ut[o];i||(i=ut[o]=new RegExp("\\{"+o+"\\}","g"));var r=e[o];null!==r&&void 0!==r&&(r=r.toString().replace(/\$/g,"$$$$")),t=t.replace(i,r)}return t}function u(t){return t.replace(/^\s+/,"")}function c(t){return t.replace(/\s+$/,"")}function d(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return l(t,e)}function p(t,e,n){if(void 0===n&&(n=!1),!t||!e)return!1;if(e.length>t.length)return!1;var o=n?t.toLowerCase():t,i=n?e.toLowerCase():t;return-1!==o.indexOf(i,o.length-i.length)}function g(t){return t.toFixed(2)+"px"}function h(t){return t=Math.floor(100*t)/100,g(t)}function m(t){return t=Math.ceil(100*t)/100,g(t)}function y(t,e){return g(t*e)}function f(t,e){return S(t*e)}function S(t){return ct(100*t)/100}function C(t){var e=t.toString(),n=e.indexOf("e");if(n>=0){var o="-"===e[0];o&&(e=e.substr(1),--n);var i=e.substr(0,1)+e.substr(2,n-2),r=parseInt(e.substr(n+1),10),a=void 0;if(r<0){for(e="0.",a=-1;a>r;--a)e+="0";e+=i}else if(r<i.length-1)n=r+1,e=i.substr(0,n)+"."+i.substr(n);else for(e=i,a=i.length-1;a<r;++a)e+="0";o&&(e="-"+e)}return e}function v(t,e){for(var n in e)t[n]=e[n];return t}function _(t){var e={};for(var n in t)e[n]=t[n];return e}function w(t,e,n){for(var o=[],i=0,r=0,a=t.length,s=e.length;i<a||r<s;){if(i===a){o=o.concat(e.slice(r));break}if(r===s){o=o.concat(t.slice(i));break}var l=void 0;n(t[i],e[r])?(l=t[i],i++):(l=e[r],r++),o.push(l)}return o}function T(t,e){for(var n in t)if(t[n]==e)return n;return null}function A(t,e){if(null===t&&null===e||null===t&&null!==e&&0===e.length||null===e&&null!==t&&0===t.length)return!0;for(n=0;n<t.length;n++)if(-1===e.indexOf(t[n]))return!1;for(var n=0;n<e.length;n++)if(-1===t.indexOf(e[n]))return!1;return!0}function D(t,e){if(null===t&&null===e||null===t&&null!==e&&0===e.length||null===e&&null!==t&&0===t.length)return!0;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(e[n]!==t[n])return!1;return!0}function B(t,e,n){for(var o=0;o<t.length&&!n(e,t[o]);++o);t.splice(o,0,e)}function I(t){return(new Date).toLocaleDateString(CommonSettings.UserLocaleString,{day:"2-digit",month:"long",year:"numeric"})}function b(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(var n in t)if(t[n]&&"object"==typeof t[n]){var o=t[n],i=e[n];if("function"==typeof o.serialize&&(o=o.serialize()),"function"==typeof i.serialize&&(i=i.serialize()),!b(o,i))return!1}else if(t[n]!==e[n])return!1;return!0}function E(t){var e=[];for(var n in t)e.push(t[n]);return e}function x(t,e){var n,o=$.Deferred();return e&&e.registerOnCancelled(o,function(){clearTimeout(n),o.reject()}),n=platform.setTimeout(function(){o.resolve()},t),o}function P(t){var e=t.split("//"),n=/[\/\?#]/;return e.length>1?e[1].split(n)[0]:""}function R(t){if(!t)return t;var e=t.indexOf("?");return-1==e?t:t.substring(0,e)}function L(t,e,n,o,i){function r(e){a&&clearTimeout(a),a=J(void 0!==e?e:n,void 0,function(){i&&i.call(t),a=null})}var a=null;e.call(t,function(e){o?o.call(t).then(function(){return r(e)}):r(e)})}function V(t,e,n){var o=0;return 0===t?n.bind(e):function(i){o<platform.now()-t&&(o=platform.now(),n.call(e,i))}}function U(t,e){return function(){try{return t.apply(this,arguments)}catch(t){return platform.setImmediate(function(){throw t}),e}}}function k(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];platform.setImmediate(function(){return t.apply(null,e)})}}function F(t){return M(t.src)}function M(t){var e;try{e=t.split(",")[0].indexOf("base64")>=0?window.atob(t.split(",")[1]):decodeURI(t.split(",")[1])}catch(t){return}for(var n=t.split(",")[0].split(":")[1].split(";")[0],o=new ArrayBuffer(e.length),i=new DataView(o),r=e.length;r--;)i.setUint8(r,e.charCodeAt(r));return new Blob([o],{type:n})}function O(t,e,n){n&&$.ajax(t,n)}function N(t,n,o){void 0===n&&(n=!0),void 0===o&&(o=!1),n?at.push({handler:t,fired:!1,unloadOnly:o}):st.push(t),lt||(TDB.leakDetectionHandler?(window.removeEventListener("beforeunload",TDB.leakDetectionHandler),window.addEventListener("beforeunload",z),window.addEventListener("beforeunload",TDB.leakDetectionHandler)):window.addEventListener("beforeunload",z),window.addEventListener(e.ios?"pagehide":"unload",G),lt=!0)}function W(t){ArrayExtensions.removeFirst(st,t),ArrayExtensions.removeFirstWhere(at,function(e){return e.handler===t})}function H(){st.forEach(function(t){return t()}),st=[]}function z(t){for(var n=0,o=st;n<o.length;n++){var i=(0,o[n])();if("string"==typeof i)return t.returnValue=i,t.stopImmediatePropagation(),i}if(!e.ios&&!e.browser.isIEOrEdge)for(var r=0,a=at;r<a.length;r++){var s=a[r];s.unloadOnly||(s.handler(),s.fired=!0)}}function G(){for(var t=0,e=at;t<e.length;t++){var n=e[t];n.fired||n.handler()}}function q(n){window.location.href=e.query.has(t.Common.UrlHelper.URLParamRetry)?t.Common.UrlHelper.getInstance().errorUrl(n):window.location.pathname+e.query.add(t.Common.UrlHelper.URLParamRetry)}function j(){try{return!(!window.clipboardData||!window.clipboardData.setData)}catch(t){return!1}}function K(){return e.browser.isFirefox?e.browser.majorVersion>45:e.browser.isChrome||e.browser.isIEOrEdge||e.browser.isSafari10OrLater}function J(t,e,n){for(var o=[],i=3;i<arguments.length;i++)o[i-3]=arguments[i];return t?platform.setTimeout(function(){n.apply(e,o)},t):void n.apply(e,o)}function Q(t,e){for(var n=[],o=0,i=t.length;o<i;o++)ArrayExtensions.contains(e,t[o])||n.push(t[o]);return n}function Y(t,e){for(var n=[],o=0,i=t.length;o<i;o++)e(t[o])&&n.push(t[o]);return n}function X(n){var o=window.StoryPageSettings;if(!o||o.Mode!==StoryViewMode.Preview)return!0;var i=e.query.fetch(t.Common.UrlHelper.URLParamDebugState);if(!i)return!0;var r=dt[i];return void 0===r||r===dt.None||"number"!=typeof r||n!==dt.None&&n<=r}function Z(){if(e.browser.isIE){var t=document.body.createTextRange();t.collapse(),t.select()}document.getSelection().removeAllRanges()}function tt(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var o;try{var i=(o=t.Utilities.query).erase.apply(o,e);i!=window.location.search&&window.history.replaceState(null,document.title,window.location.pathname+i+location.hash)}catch(t){StoryLog.StructuredTraceTag(595956247,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"Failed to remove query parameters.",{message:t.message})}}function et(){try{var e=t.Utilities.query.has(t.Common.UrlHelper.URLParamMRURef),n=t.Utilities.query.fetch(t.Common.UrlHelper.URLParamMRURef).toLowerCase()===t.Common.UrlHelper.URLParamMRURefExpectedValue;e&&n&&window.history.replaceState(null,document.title,window.location.pathname+t.Utilities.query.erase(t.Common.UrlHelper.URLParamMRURef)+location.hash)}catch(t){StoryLog.StructuredTraceTag(596477132,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"Failed to remove mru parameter from URL.",{message:t.message},t.stack)}}function nt(t){var e=document.createElement("a");e.href=t;var n=e.pathname;return"/"!==n[0]&&(n="/"+n),n}function ot(t){var e=document.createElement("a");"/"===t[0]||/^http(s?):\/\//.test(t)||(t="/"+t),e.href=t;var n=e.pathname+e.search+e.hash;return"/"!==n[0]&&(n="/"+n),n}function it(t,e){return isNaN(Number(t))&&-1!==Object.keys(e).indexOf(t)?e[t]:void 0}function rt(t){return t.split("?")[0]}e.eventWrapperSelector=".eventWrapper",e.query=new e.UrlDict("?",function(){return location.search}),e.ios=/iphone|ipad/i.test(navigator.userAgent),e.ipad=/ipad/i.test(navigator.userAgent),e.safari=/Safari/i.test(navigator.userAgent),e.chrome=/Chrome/i.test(navigator.userAgent),e.isMacOsX=/mac os x/i.test(navigator.userAgent),e.isWindows10=/Windows NT 10.0/i.test(navigator.userAgent),e.isTeams=/Teams/i.test(navigator.userAgent);var at=[],st=[],lt=!1;e.ios7=n,e.defaultEventThrottleDelay=500,e.noop=o,e.arrayContainsAtLeastOneNonNullValue=i,e.getStackTrace=r,e.getShortTimeStringUTC=s;var ut=[];e.formatString=l,e.trimStart=u,e.trimEnd=c,e.format=d,e.endsWith=p,e.toPxStr=g,e.toPxStrFloor=h,e.toPxStrCeil=m,e.cvtServerToPxStr=y,e.cvtServerToPx=f;var ct=Math.round;e.roundPx=S,e.toNonExponential=C,e.mergeDictionaries=v,e.shallowClone=_,e.mergeSortedLists=w,e.findKeyForValue=T,e.setEquals=A,e.sequenceEquals=D,e.insertInOrder=B,e.adjustDateToUserTime=I,e.collectionEquals=b,e.collectionToArray=E,e.weblog=function(){var n=new e.UrlDict("&",function(){return location.search});if(!n.has(t.Common.UrlHelper.URLParamWebLog))return function(t,e){};var o=n.fetch(t.Common.UrlHelper.URLParamWebLog).split(";");return function(t,e){ArrayExtensions.contains(o,t)&&console.log("["+t.toUpperCase()+"] "+e)}}(),e.waitForTimer=x,e.extractHostnameFromUrl=P,e.removeQueryFromUrl=R,e.throttledEvent=L,e.debounce=V,e.safeCallback=U,e.deferredEventHandler=k,e.convertBase64ImageToBlob=F,e.getBlobFromDataUri=M,e.sendBeacon=O,e.addUnloadEventListener=N,e.removeUnloadEventListener=W,e.invokeNondestructiveHandlersOnPageDestruction=H,e.tryRefreshOnce=q,e.supportsClipboard=j,e.supportsClipboard_Experimental=K,e.setTimeoutIfSpecified=J,e.except=Q,e.where=Y;var dt;!function(t){t[t.None=0]="None",t[t.DocumentReady=1]="DocumentReady",t[t.InitializeApplication=2]="InitializeApplication",t[t.CreateRenderModel=3]="CreateRenderModel",t[t.CreateChrome=4]="CreateChrome"}(dt=e.DebugState||(e.DebugState={})),e.checkDebugState=X,e.removeAllRanges=Z,e.removeQueryParams=tt,e.RemoveMruRefQueryParam=et,e.getUrlPathname=nt,e.getDomainRelativeUrl=ot,e.toEnum=it,e.removeQueryStringFromUrl=rt}(t.Utilities||(t.Utilities={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){function n(t){return new i(t)}function o(t){return new i(function(e){e?t.reject(e):t.resolve()})}e.sequence=n,e.autoResolvedSequence=o;var i=function(){function e(t){this.delegates=[],this.onComplete=t}return e.prototype.run=function(t,e){var n=this;return this.checkAllowed(),this.delegates.push(function(){t(e),n.next()}),this},e.prototype.runAndWait=function(t,e){var n=this;return this.checkAllowed(),this.delegates.push(function(){var o=t(e);n.insertWaitForPromise(o),n.next()}),this},e.prototype.defer=function(){var t=this;return this.checkAllowed(),this.delegates.push(function(){platform.setImmediate(function(){return t.next()})}),this},e.prototype.wait=function(t){var e=this;return this.checkAllowed(),this.delegates.push(function(){platform.setTimeout(function(){return e.next()},t)}),this},e.prototype.waitfor=function(e,n,o,i){var r=this;this.checkAllowed();var a=o||Number.MAX_VALUE,s=function(){if(e())r.next();else{if(a--<=0){var o="";if(i)try{o=i()}catch(t){o="Exception caught while generating error message after retries: "+t.message+"."}throw t.RethrowLogger.createError("Maximum number of retries exceeded while waiting for '"+e.toString()+"'. Error message: '"+o+"'")}r.delegates.unshift(s),platform.setTimeout(function(){return r.next()},n)}};return this.delegates.push(s),this},e.prototype.waitForPromise=function(t){var e=this.barrier();return this.waitingForPromiseCallbackHelper(t,e),this},e.prototype.insertWaitForPromise=function(t){var e=this.barrierHelper(!0);return this.waitingForPromiseCallbackHelper(t,e),this},e.prototype.waitingForPromiseCallbackHelper=function(t,e){var n=this;t.then(function(){return e()},function(t){n.complete(t)})},e.prototype.barrierHelper=function(e){var n=this,o=0,i=function(){2===o?n.next():o=1};if(e){var r=this.delegates[0];this.delegates[0]=i,this.delegates.unshift(r)}else this.delegates.push(i);return function(){if(1===o)n.next();else{if(0!==o)throw t.RethrowLogger.createError("Unblocked barrier more than once.");o=2}}},e.prototype.barrier=function(){return this.checkAllowed(),this.barrierHelper(!1)},e.prototype.start=function(){this.checkAllowed(),this.started=!0,this.current()},e.prototype.current=function(){if(0!==this.delegates.length)try{this.delegates[0]()}catch(t){this.complete(t)}else this.complete()},e.prototype.startAsPromise=function(){var t=$.Deferred(),e=this.onComplete;return this.onComplete=function(n){e&&e(n),n?t.reject(n):t.resolve()},this.start(),t.promise()},e.prototype.finally=function(e){if(this.finallyFunction)throw t.RethrowLogger.createError("Sequence already has a finally function set");return this.finallyFunction=e,this},e.prototype.stop=function(t){this.complete(t||new Error("Sequence terminated early"))},e.prototype.next=function(){this.delegates.shift(),this.current()},e.prototype.complete=function(t){if(!this.completed){if(this.completed=!0,this.finallyFunction)try{this.finallyFunction()}catch(e){t=t||e}this.handleError(t)}},e.prototype.handleError=function(e){if(this.onComplete)this.onComplete(e);else if(e)throw t.RethrowLogger.createError(e)},e.prototype.checkAllowed=function(){if(this.started)throw t.RethrowLogger.createError("Sequence is already started and no changes to it are allowed at this point.")},e}()}(t.Utilities||(t.Utilities={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){var e=function(){function e(){this.rules=[]}return e.prototype.rule=function(e){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];return this.rules.push(t.formatString(e,n)),this},e}();t.StyleFactory=e;var n=function(t){function n(e){var n=t.call(this,e)||this,o=n.el=window.document.createElement("style");return o.type="text/css",window.document.head.appendChild(o),n}return __extends(n,t),n.prototype.define=function(t){var n=new e;t(n);var o=n.rules.join("\n");o!==this.el.innerHTML&&(this.el.innerHTML=o)},n.prototype.dispose=function(){window.document.head.removeChild(this.el),t.prototype.dispose.call(this)},n}(Disposable);t.DynamicStyle=n;var o=function(t){function n(e){var n=t.call(this,e)||this;return n.elements={},n}return __extends(n,t),n.prototype.define=function(t){var n=this,o=new e;t(o);var i=[],r={};o.rules.forEach(function(t){var e=n.elements[t];e?(delete n.elements[t],r[t]=e):i.push(t)});var a=[];for(var s in this.elements)a.push(this.elements[s]);i.forEach(function(t){var e;a.length>0?e=a.pop():((e=window.document.createElement("style")).type="text/css",document.head.appendChild(e)),e.innerHTML=t,r[t]=e}),a.forEach(function(t){window.document.head.removeChild(t)}),this.elements=r},n.prototype.dispose=function(){for(var e in this.elements)document.head.removeChild(this.elements[e]);t.prototype.dispose.call(this)},n}(Disposable);t.EditableDynamicStyle=o}(t.Utilities||(t.Utilities={}))}(StoryApp||(StoryApp={}));var AudioStreamingInfoRequest=function(){function t(){}return t}(),AudioStreamingInfoResponse=function(){function t(){}return t.CreateForUnencrypted=function(e){var n=new t;return n.StreamingUrl=e,n.StreamingUrlType="application / vnd.ms - sstr + xml",n},t}(),ChangeLinkErrorCode;!function(t){t[t.Unknown=0]="Unknown",t[t.CastProfileRequired=1]="CastProfileRequired"}(ChangeLinkErrorCode||(ChangeLinkErrorCode={}));var ChangeLinkErrorResponse=function(){function t(t){this.errorCode=t}return t}(),ChangeLinkRequest=function(){function t(){}return t}(),ChangeLinkResponse=function(){function t(t,e,n,o,i,r,a,s,l,u,c){this.viewUrl=t,this.editUrl=e,this.authTokens=n,this.audience=o,this.blockDuplication=i,this.blockPrint=r,this.blockExport=a,this.castId=s,this.castViewUrl=l,this.blockConsumptionWorldSwitch=u,this.blockShareButton=c}return t}(),CreateAndJoinRequest=function(){function t(){}return t}(),CreateAndJoinResponse=function(){function t(){}return t}(),EnabledLanguagesResponse=function(){function t(){}return t}(),RemoveViewedStories;!function(t){var e=function(){function t(t){this.lookupId=t}return t.RemoveViewedStoryRequest=function(e){return new t(e)},t}();t.RemoveViewedSwayRequest=e}(RemoveViewedStories||(RemoveViewedStories={}));var RemoveViewedStories;!function(t){var e=function(){function t(){}return t}();t.RemoveViewedSwayResponse=e}(RemoveViewedStories||(RemoveViewedStories={}));var StoryApp;!function(t){!function(t){!function(t){t[t.Everybody=0]="Everybody",t[t.Editors=1]="Editors"}(t.StoryPasswordScope||(t.StoryPasswordScope={}))}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var Delete;!function(t){var e=function(){function e(){}return e.MoveToRecycleBinRequest=function(n){var o=new e;return o.swayIds=n,o.deleteType=t.DeleteType.DeleteActive,o},e.DeleteFromRecycleBinRequest=function(n){var o=new e;return o.swayIds=n,o.deleteType=t.DeleteType.DeleteFromPrimaryRecycleBin,o},e}();t.DeleteSwaysRequest=e}(Delete||(Delete={}));var Delete;!function(t){!function(t){t[t.DeleteActive=0]="DeleteActive",t[t.DeleteFromPrimaryRecycleBin=1]="DeleteFromPrimaryRecycleBin"}(t.DeleteType||(t.DeleteType={}))}(Delete||(Delete={}));var DocumentIngestion;!function(t){var e=function(){function t(){}return t}();t.DI_Response=e}(DocumentIngestion||(DocumentIngestion={}));var DynamicStyleInfo=function(){function t(){}return t}(),EmbeddedOneDriveInfo=function(){function t(){}return t}(),EmbeddedStoryInfo=function(){function t(){}return t}(),EmbeddedOneDriveInfoRequest=function(){function t(){}return t}(),LogStackTraceResponse=function(){function t(){}return t}(),LogStackTraceRequest=function(){function t(){}return t}(),MakeOutlineResponseType;!function(t){t[t.Hit=0]="Hit",t[t.Disambiguation=1]="Disambiguation",t[t.Error=2]="Error"}(MakeOutlineResponseType||(MakeOutlineResponseType={}));var MakeOutlineErrorType;!function(t){t[t.Unknown=0]="Unknown",t[t.NoResults=1]="NoResults"}(MakeOutlineErrorType||(MakeOutlineErrorType={}));var MakeOutlineResponse=function(){function t(){}return t}(),Delete;!function(t){var e=function(){function e(){}return e.RestoreFromRecycleBinRequest=function(n){var o=new e;return o.swayIds=n,o.restoreType=t.RestoreType.RestoreFromPrimaryRecycleBin,o},e}();t.RestoreSwaysRequest=e}(Delete||(Delete={}));var Delete;!function(t){!function(t){t[t.RestoreFromPrimaryRecycleBin=0]="RestoreFromPrimaryRecycleBin"}(t.RestoreType||(t.RestoreType={}))}(Delete||(Delete={}));var StoryApp;!function(t){!function(t){var e=function(){function t(){}return t}();t.SignInRequest=e}(t.Identity||(t.Identity={}))}(StoryApp||(StoryApp={}));var FacebookConnectUrlResponse=function(){function t(){}return t}(),StoryApp;!function(t){!function(t){var e=function(){function t(){}return t}();t.SignInResponse=e}(t.Identity||(t.Identity={}))}(StoryApp||(StoryApp={}));var ImageCropsResponse=function(){function t(){}return t}(),ImageCropRequest=function(){function t(){}return t}(),ImageCropsRequest=function(){function t(){}return t}(),O365ShellServiceResponse=function(){function t(){}return t}(),OneDriveEmbedType;!function(t){t[t.Unknown=0]="Unknown",t[t.Word=1]="Word",t[t.Excel=2]="Excel",t[t.Powerpoint=3]="Powerpoint"}(OneDriveEmbedType||(OneDriveEmbedType={}));var StoryTileBase=function(){function t(){}return t}(),StoryTile=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(StoryTileBase),StoryApp;!function(t){!function(t){!function(t){t[t.LeftToRight=0]="LeftToRight",t[t.RightToLeft=1]="RightToLeft",t[t.None=2]="None"}(t.TitleTextDirection||(t.TitleTextDirection={}))}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var ThumbnailResponse=function(){function t(){}return t}(),VideoStreamingInfoRequest=function(){function t(){}return t}(),VideoStreamingInfoResponse=function(){function t(){}return t.RegularStreamingUrlType="application/vnd.ms-sstr+xml",t.IosStreamingUrlType="application/vnd.apple.mpegurl",t}(),AnalyticsStoryTile=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(StoryTileBase),ViewedStoryTile=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(StoryTileBase),ViewOptionOverrides=function(){function t(t,e,n,o){this.UseLayoutV2=StoryApp.Utilities.query.has(StoryApp.Common.UrlHelper.URLParamLayoutV2),this.setConsumptionWorldId(t),this.setFontScale(e),this.setUseLayoutRounding(n),this.setValidateStoryboards(o)}return t.prototype.reset=function(){this.setConsumptionWorldId(void 0),this.setFontScale(void 0),this.setUseLayoutRounding(void 0),this.setValidateStoryboards(void 0)},t.prototype.areAnyOverridesSet=function(){return void 0!==this.ConsumptionWorldId||void 0!==this.FontScale||void 0!==this.UseLayoutRounding||void 0!==this.ValidateStoryboards},t.prototype.getConsumptionWorldId=function(){return this.ConsumptionWorldId},t.prototype.setConsumptionWorldId=function(t){this.ConsumptionWorldId=t||void 0},t.prototype.getFontScale=function(){return this.FontScale},t.prototype.setFontScale=function(e){this.FontScale=e||t.getDefaultFontScale()},t.prototype.shouldUseLayoutRounding=function(){return this.UseLayoutRounding},t.prototype.setUseLayoutRounding=function(e){this.UseLayoutRounding=e||t.getDefaultLayoutRounding()},t.getDefaultLayoutRounding=function(){return StoryApp.Utilities.query.fetch(StoryApp.Common.UrlHelper.URLParamLayoutRounding)===StoryApp.Common.UrlHelper.URLParamValueTrue||void 0},t.prototype.getValidatingStoryboards=function(){return this.ValidateStoryboards},t.prototype.setValidateStoryboards=function(t){this.ValidateStoryboards=t},t.prototype.toJson=function(){return JSON.stringify(this)},t.getDefaultFontScale=function(){var t=parseFloat(StoryApp.Utilities.query.fetch(StoryApp.Common.UrlHelper.URLParamFontScale));return t>=.1&&t<=10?t:void 0},t}(),StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(e){var n=t.call(this)||this;return n.model=e,n.isTileBlocked=TDB.watchableTag(596476869,n,!1),n}return __extends(e,t),e.prototype.getLookupId=function(){return this.model.id},e.prototype.getTitle=function(){return this.model.title},e.prototype.getTitleDirection=function(){return this.model.titleDirection},e.prototype.getThumbnail=function(){return this.model.thumbnail},e.prototype.getUrl=function(){return this.model.url},e.prototype.getTarget=function(){return this.model.urlTarget},e.prototype.setBlocked=function(t){var e=this;TDB.applyUpdate(function(){e.isTileBlocked.setValue(t)})},e.prototype.isBlocked=function(t){return this.isTileBlocked.getWatchedValue(t)},e.prototype.isShareButtonBlocked=function(){return this.model.shareButtonBlocked},e.prototype.isUserTemplate=function(){return this.model.isUserTemplate},e.prototype.getSwayVersion=function(){return void 0===this.model.swayVersion?0:this.model.swayVersion},e}(t.AbstractStoryTileBaseModel);t.StoryTileBaseModel=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(e){var n=t.call(this,e)||this;return n.selected=TDB.watchableTag(596455938,n,!1),n.model=e,n.movedToRecycleBinTime=TDB.watchableTag(596476866,n,e.movedToRecycleBinTime),n.movedToRecycleBinTimeDisplayString=TDB.watchableTag(596476867,n,e.movedToRecycleBinTimeDisplayString),n.viewCount=TDB.watchableTag(596476868,n,0),n}return __extends(e,t),e.prototype.setSetSize=function(t){this.setSize=t},e.prototype.setPositionInSet=function(t){this.positionInSet=t},e.prototype.getSetSize=function(){return this.setSize},e.prototype.getPositionInSet=function(){return this.positionInSet},e.prototype.setMoveToRecycleBinTime=function(t,e){var n=this;TDB.applyUpdate(function(){n.movedToRecycleBinTime.setValue(t),n.movedToRecycleBinTimeDisplayString.setValue(e)})},e.prototype.getMovedToRecycleBinTime=function(t){return this.movedToRecycleBinTime.getWatchedValue(t)},e.prototype.getMovedToRecycleBinTimeDisplayString=function(t){return this.movedToRecycleBinTimeDisplayString.getWatchedValue(t)},e.prototype.isSelected=function(t){return this.selected.getWatchedValue(t)},e.prototype.setSelected=function(t){var e=this;TDB.applyUpdate(function(){e.selected.setValue(t)})},e.prototype.getEditId=function(){return this.model.editId},e.prototype.getStoryId=function(){return this.model.trackingId},e.prototype.getViewCount=function(t){return this.viewCount.getWatchedValue(t)},e.prototype.setViewCount=function(t){var e=this;TDB.applyUpdate(function(){e.viewCount.setValue(t)})},e.prototype.isCreatedBeforeViewCountingStarted=function(){return this.model.createdBeforeViewCountingStarted},e.prototype.getEditorCount=function(){return this.model.editorCount},e.prototype.getIsOwned=function(){return this.model.isOwned},e.prototype.getEditUrl=function(){return this.model.editUrl},e.prototype.setEditUrl=function(t){this.model.editUrl=t},e.prototype.getLastModified=function(){return this.model.lastModified},e.prototype.getLastModifiedDisplayString=function(){return this.model.lastModifiedDisplayString},e.prototype.getHasPendingSync=function(){return this.model.hasPendingSync},e.prototype.isDuplicationAllowed=function(){return!CommonSettings.BlockDuplicationFeature&&(!this.model.duplicationBlocked||this.getIsOwned())},e.createStoryTileModels=function(t){return t.map(function(t){return new e(t)})},e.prototype.getDateForSorting=function(){return this.getLastModified()},e.prototype.shouldShowDeleteButton=function(){return this.getIsOwned()},e}(t.StoryTileBaseModel);t.StoryTileModel=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(e){var n=t.call(this,e)||this;return n.model=e,n}return __extends(e,t),e.createStoryTileModels=function(t){return t.map(function(t){return new e(t)})},e.prototype.getDateForSorting=function(){return this.model.lastModified},e.prototype.getDisplayDate=function(){return new Date(this.model.lastModified).toLocaleDateString()},e.prototype.getIsOwned=function(){return!0},e.prototype.isDuplicationAllowed=function(){return!CommonSettings.BlockDuplicationFeature&&!this.model.duplicationBlocked},e.prototype.shouldShowDeleteButton=function(){return!1},e.prototype.getEditId=function(){return TDB.raiseRecoverableError("AnalyticsStoryTileModel: getEditId(): This method should never be called for analytics story tiles",TDB.LogLevel.info),""},e.prototype.setEditUrl=function(t){TDB.raiseRecoverableError("AnalyticsStoryTileModel: setEditUrl(): This method should never be called for analytics story tiles",TDB.LogLevel.info)},e.prototype.getEditUrl=function(){return TDB.raiseRecoverableError("AnalyticsStoryTileModel: getEditUrl(): This method should never be called for analytics story tiles",TDB.LogLevel.info),""},e.prototype.getTotalViews=function(){return this.model.totalViews},e.prototype.getAverageTimeRead=function(){var t=this.model.averageTimeSpent/1e3/60;return t<1?0:Math.round(t)},e.prototype.getAveragePercentageCompletion=function(){return Math.round(100*this.model.percentageRead)},e.prototype.getGlancedReads=function(){return this.model.glancedReads},e.prototype.getQuickReads=function(){return this.model.quickReads},e.prototype.getDeepReads=function(){return this.model.deepReads},e}(t.StoryTileBaseModel);t.AnalyticsStoryTileModel=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){!function(t){var e=function(t){function e(e){var n=t.call(this,e)||this;return n.model=e,n}return __extends(e,t),e.prototype.getLastViewTime=function(){return this.model.lastViewTime},e.prototype.getLastViewTimeDisplayString=function(){return this.model.lastViewTimeDisplayString},e.createStoryTileModels=function(t){return t.map(function(t){return new e(t)})},e.prototype.getDateForSorting=function(){return this.getLastViewTime()},e.prototype.getIsOwned=function(){return!1},e.prototype.isDuplicationAllowed=function(){return!CommonSettings.BlockDuplicationFeature&&!this.model.duplicationBlocked},e.prototype.shouldShowDeleteButton=function(){return CommonSettings.SiteViewedStoriesRemovalOnMySwaysPageV2Enabled},e.prototype.getEditId=function(){return TDB.raiseRecoverableError("ViewedStoryTileModel: getEditId(): This method should never be called for viewed story tiles",TDB.LogLevel.info),""},e.prototype.setEditUrl=function(t){TDB.raiseRecoverableError("ViewedStoryTileModel: setEditUrl(): This method should never be called for viewed story tiles",TDB.LogLevel.info)},e.prototype.getEditUrl=function(){return TDB.raiseRecoverableError("ViewedStoryTileModel: getEditUrl(): This method should never be called for viewed story tiles",TDB.LogLevel.info),""},e}(t.StoryTileBaseModel);t.ViewedStoryTileModel=e}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(e){!function(e){var n=t.View.Common.FRE,o=t.Utilities.ActivityMonitor,i=function(){function i(n,r){if(this._eventHandlers=[],this.gesturemanager=new TDB.Touch.GestureAnalyzer(i.minimumSwipeInPixels,i.tapToleranceInPixels),this.activityMonitor=new o,this.touchEnabled=!0,this.authoringStateModes={},i._instance)throw t.RethrowLogger.createError("Error: Do not use constructor. Use DomEventRegister.getInstance() instead.");this._rootElement=n,this._mousedownObjectId=void 0,this.currentAuthoringState=e.AuthoringState.Canvas,this.tapNumberCounter=0,this.CookieConsenSetter=r}return i.setRoot=function(e,n,o){if(i._instance){if(n.isCreationAllowed(!0)){var r=i.getInstance();return r._rootElement=e,r}throw t.RethrowLogger.createError("Error: Cannot set root twice")}var a=i._instance=new i(e,o);return a.initializeMouseEvents(),a.initializeKeyboardEvents(),a.initializeTouch(),a.initializeDragDropEvents(),a.initializePrintEvents(),i.getInstance()},i.getInstance=function(){if(!i._instance)throw t.RethrowLogger.createError("Error: setRoot should be called before getting an instance of DomEventRegister");return i._instance},i.isInitialized=function(){return!!i._instance},i.prototype.getPageRootVE=function(){return this._rootElement},i.prototype.disableTouch=function(){this.touchEnabled&&(this.touchEnabled=!1,this.touchmanager.unregister())},i.prototype.enableTouch=function(){this.touchEnabled||(this.touchEnabled=!0,this.touchmanager.register())},i.prototype.enableFocusNotificationInEmbed=function(){window.StoryPageSettings.Mode===window.StoryViewMode.Embedded&&this.registerFocusNotificationEvent()},i.prototype.setTouchForAuthoringState=function(t,n){this.authoringStateModes[e.AuthoringState[t]]=n,this.currentAuthoringState==t&&this.setAuthoringState(t)},i.prototype.setAuthoringState=function(t){this.currentAuthoringState=t,e.AuthoringState[t]in this.authoringStateModes&&(this.authoringStateModes[e.AuthoringState[t]]?this.enableTouch():this.disableTouch())},i.prototype.registerEventHandler=function(t){this._eventHandlers.push(t)},i.prototype.unregisterEventHandler=function(t){var e=this._eventHandlers.indexOf(t);e>=0&&this._eventHandlers.splice(e,1)},i.prototype.unregisterAllHandlers=function(){this._eventHandlers=[]},i.prototype.initializeMouseEvents=function(){this.registerMouseDownEvent(),this.registerMouseUpEvent(),this.registerClickEvent(),this.registerdblclickEvent(),this.registerMouseScrollEvent(),CommonSettings.SettingSite_IframeVelumEnabled&&this.registerMouseMoveEvent()},i.prototype.initializeKeyboardEvents=function(){this.registerKeyDownEvent(),this.registerKeyPressEvent(),this.registerKeyUpEvent()},i.prototype.initializeTouch=function(){this.touchmanager=TDB.Touch.CreateTouchManager(),this.touchmanager.addTouchListener(this),this.touchmanager.addTouchListener(this.gesturemanager),this.gesturemanager.addGestureListener(this)},i.prototype.initializeDragDropEvents=function(){this.registerDragOverEvent(),this.registerDragLeaveEvent(),this.registerDropEvent()},i.prototype.initializePrintEvents=function(){var t=function(){ActionLogger.RecordClientAction(new ClientAction.PrintTriggered)};if(void 0!==window.onbeforeprint)window.addEventListener("beforeprint",t);else if(void 0!==window.matchMedia)try{window.matchMedia("print").addListener(function(e){e.matches&&t()})}catch(t){}},i.prototype.focusedMouseEventHandler=function(t,e,n){var o=this.getInputTarget();return o&&o!==n?o.firstChanceMouseEvent(t,e,n):TDB.EventPropagation.Bubble},i.prototype.registerMouseDownEvent=function(){var t=this;$(document).mousedown(function(e){var n=TDB.ViewElement.dataFor(e.target);t._mousedownObjectId=n?n.id:void 0,t.handleMouseEvent(t,e,TDB.ViewElementMouseEventType.MouseDownEvent)})},i.prototype.registerMouseUpEvent=function(){var t=this;$(document).mouseup(function(e){t.handleMouseEvent(t,e,TDB.ViewElementMouseEventType.MouseUpEvent)})},i.prototype.registerClickEvent=function(){var e=this;$(t.Utilities.eventWrapperSelector).click(function(n){e.activityMonitor.receiveActivity();var o=TDB.ViewElement.dataFor(n.target),r=e._mousedownObjectId;if(e._mousedownObjectId=void 0,!(t.Utilities.browser.isIE&&r&&o&&o.id!==r)){var a=e._swipeTime;e._swipeTime=void 0,a&&platform.now()-a<i.doubleTapTimeTolerance||e.handleMouseEvent(e,n,TDB.ViewElementMouseEventType.MouseClickEvent)}})},i.prototype.registerdblclickEvent=function(){var t=this;$(document).dblclick(function(e){t.handleMouseEvent(t,e,TDB.ViewElementMouseEventType.MouseDoubleClickedEvent)})},i.prototype.registerMouseScrollEvent=function(){var t=this;$(document).on("scroll",function(){return t.activityMonitor.receiveActivity()}),$(document).on("mousewheel DOMMouseScroll",function(e){t.handleScrollEvt(e)}),$(document).on("MozMousePixelScroll",function(e){e.originalEvent.isMozilla=!0,e.originalEvent.wheelDelta=-e.originalEvent.detail/2,t.handleScrollEvt(e)})},i.prototype.registerMouseMoveEvent=function(){var e=this;$(document).mousemove(t.Utilities.debounce(250,this,function(t){e.handleMouseEvent(e,t,TDB.ViewElementMouseEventType.MouseMove)}))},i.prototype.handleScrollEvt=function(e){var n=this;t.RethrowLogger.logIfError(function(){n.activityMonitor.receiveActivity();var t=TDB.ViewElement.dataFor(e.target);if(n.notifyMouseHandlers(e.originalEvent,t,TDB.ViewElementMouseEventType.MouseScroll),null!=t){var o=t.handleMouseEvent(e.originalEvent,TDB.ViewElementMouseEventType.MouseScroll);i.applyEventPropagationToEvent(o,e)}})},i.handleKeyEvent=function(e,o,r){t.RethrowLogger.logIfError(function(){if(e.notifyKeyHandlers(o,r),!o.isPropagationStopped()){var t=e.getInputTarget();if(t){var a=t.handleKeyEvent(o,r);a!==TDB.EventPropagation.Bubble&&i.setUserConsentIfValidKeyInteraction(e,o,r),i.applyEventPropagationToEvent(a,o),n.getFirstRunManager().handleKeyEvent(o)}}})},i.prototype.handleMouseEvent=function(e,o,r){var a=this;t.RethrowLogger.logIfError(function(){var t=TDB.ViewElement.dataFor(o.target);a.notifyMouseHandlers(o,t,r);var s=a.focusedMouseEventHandler(o,r,t);i.applyEventPropagationToEvent(s,o),s===TDB.EventPropagation.Bubble&&t&&t.handleMouseEvent&&(s=t.handleMouseEvent(o,r),i.applyEventPropagationToEvent(s,o),r===TDB.ViewElementMouseEventType.MouseClickEvent&&n.getFirstRunManager().handleClick(o)),s!==TDB.EventPropagation.Bubble&&TDB.ViewElementMouseEventType.MouseClickEvent===r&&e.CookieConsenSetter()})},i.setUserConsentIfValidKeyInteraction=function(t,e,n){n===TDB.ViewElementKeyEventType.KeyDownEvent&&e.keyCode===KeyCodeType.EnterKey&&t.CookieConsenSetter()},i.applyEventPropagationToEvent=function(t,e){t===TDB.EventPropagation.PreventDefault&&e.preventDefault()},i.prototype.registerKeyDownEvent=function(){var t=this;$(document).keydown(function(e){return i.handleKeyEvent(t,e,TDB.ViewElementKeyEventType.KeyDownEvent)})},i.prototype.registerKeyPressEvent=function(){var t=this;$(document).keypress(function(e){return i.handleKeyEvent(t,e,TDB.ViewElementKeyEventType.KeyPressEvent)})},i.prototype.registerKeyUpEvent=function(){var t=this;$(document).keyup(function(e){i.handleKeyEvent(t,e,TDB.ViewElementKeyEventType.KeyUpEvent)})},i.prototype.registerDragOverEvent=function(){$(document).on("dragover",function(t){var e=TDB.ViewElement.dataFor(t.target);return null!=e&&e.handleDragOrDropEvent(t,TDB.ViewElementDragDropEventType.DragOverEvent),t.preventDefault(),!1})},i.prototype.registerDragLeaveEvent=function(){$(document).on("dragleave",function(t){var e=TDB.ViewElement.dataFor(t.target);null!=e&&e.handleDragOrDropEvent(t,TDB.ViewElementDragDropEventType.DragLeaveEvent)})},i.prototype.registerDropEvent=function(){window.addEventListener("drop",function(t){var e=TDB.ViewElement.dataFor(t.target);null!=e&&e.handleDragOrDropEvent(t,TDB.ViewElementDragDropEventType.DropEvent)},!0)},i.prototype.registerFocusNotificationEvent=function(){var e=this;window.addEventListener("message",function(n){t.Common.UrlHelper.getInstance().supportsNotifications(n.origin)&&e._rootElement.setFocusFromNotification(n)},!1)},i.prototype.notifyMouseHandlers=function(t,e,n){for(var o=0;o<this._eventHandlers.length;o++)this._eventHandlers[o].handleGlobalMouseEvent(t,e,n)},i.prototype.notifyKeyHandlers=function(t,e){this.activityMonitor.receiveActivity();for(var n=0;n<this._eventHandlers.length;n++)this._eventHandlers[n].handleGlobalKeyEvent(t,e)},i.prototype.notifyTouchMoveHandlers=function(t){for(var e=0;e<this._eventHandlers.length;e++)this._eventHandlers[e].touchMove(t)},i.prototype.notifyTouchStartHandlers=function(t){for(var e=0;e<this._eventHandlers.length;e++)this._eventHandlers[e].touchStart(t)},i.prototype.notifyTouchStopHandlers=function(t){this.activityMonitor.receiveActivity();for(var e=0;e<this._eventHandlers.length;e++)this._eventHandlers[e].touchStop(t)},i.prototype.dispatchTouchStart=function(t){this.notifyTouchStartHandlers(t);var e=TDB.ViewElement.dataFor(t.originalEvent.target);e&&e.handleTouchStartEvent&&e.handleTouchStartEvent(t)},i.prototype.dispatchTouchMove=function(t){var e=TDB.ViewElement.dataFor(t.originalEvent.target);this.notifyTouchMoveHandlers(t),e&&e.handleTouchMoveEvent&&e.handleTouchMoveEvent(t)},i.prototype.dispatchTouchStop=function(t){this.notifyTouchStopHandlers(t);var e=TDB.ViewElement.dataFor(t.originalEvent.target);e&&e.handleTouchStopEvent&&e.handleTouchStopEvent(t)},i.prototype.dispatchSwipe=function(t){var e=TDB.ViewElement.dataFor(t.target);e&&e.handleSwipeEvent&&e.handleSwipeEvent(t)!==TDB.EventPropagation.Bubble&&(this._swipeTime=platform.now())},i.prototype.dispatchTap=function(t){var e=this,o=TDB.ViewElement.dataFor(t.target);o&&o.handleTapEvent&&(o.handleTapEvent(t),2==++this.tapNumberCounter?(this.tapNumberCounter=0,o.handleDoubleTapEvent(t)):platform.setTimeout(function(){e.tapNumberCounter=0},i.doubleTapTimeTolerance),n.getFirstRunManager().handleClick(t))},i.prototype.getInputTarget=function(){var e=TDB.FocusableViewElement.getFocusedElement();if(e)return e;var n=t.Utilities.getDocumentActiveElement();if(!(n instanceof HTMLElement&&n!==document.body))return this.getActivationChainTarget()||this.getDefaultInputTarget()},i.prototype.getActivationChainTarget=function(){var t=this._rootElement,e=t?t.lastActivationChain:void 0;if(e)return ArrayExtensions.firstOrDefault(e,function(t){return t._inDom&&t instanceof TDB.ControlBase&&t.canActivate()})},i.prototype.getDefaultInputTarget=function(){var t=[];return this._rootElement?this._rootElement.traverseFocusable(function(t){return t.isDefaultInputTarget?t:null},function(e){return 0===t.length},t)[0]:void 0},i.prototype.updateMouseclickTarget=function(t){var e=TDB.ViewElement.dataFor(t);this._mousedownObjectId=e?e.id:void 0},i.prototype.getRootPanelElement=function(){return this._rootElement},i.prototype.getActivityMonitor=function(){return this.activityMonitor},i.tapToleranceInPixels=30,i.minimumSwipeInPixels=100,i.doubleTapTimeTolerance=200,i}();e.DomEventRegister=i}(e.ViewElements||(e.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var FileUploader;!function(t){var e;!function(t){t[t.Ok=0]="Ok",t[t.EmptyFileError=1]="EmptyFileError",t[t.FileTooLargeError=2]="FileTooLargeError"}(e=t.FileStatus||(t.FileStatus={}));var n=function(t){function n(e,n){var o=t.call(this,e)||this;return o._args=n,o._fileHandles=[],o._currentUploadCount=0,o}return __extends(n,t),n.prototype.upload=function(t,n,o){for(var i=0;i<t.length;i++){StoryLog.TraceTag(596477206,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"File Uploader : upload : Uploading file of size "+t[i].size);var r=this.checkFile(t[i],o);r==e.Ok?this._fileHandles.push({file:t[i],descriptor:n}):void 0!=this._args.context&&void 0!=this._args.onInvalidFile&&this._args.onInvalidFile.call(this._args.context,t[i],r)}this.startNewFileBatch()},n.prototype.checkFile=function(t,n){var o=CommonSettings.MaxHttpRequestLength;n&&(o=n);var i=e.Ok;return t.size>o?i=e.FileTooLargeError:0===t.size&&(i=e.EmptyFileError),i},n.prototype.startNewFileBatch=function(){for(;this._currentUploadCount<n._maxConcurrentUploads&&this._fileHandles.length>0;){this._currentUploadCount++;var t=this._fileHandles.splice(0,1)[0];this.uploadFile(t)}},n.prototype.onSuccess=function(t,e,n,o){var i=o.file;void 0!=this._args.context&&void 0!=this._args.onUploadComplete&&this._args.onUploadComplete.call(this._args.context,i,e),this._currentUploadCount--,this.startNewFileBatch()},n.prototype.onError=function(t,e,n,o){var i=o.file;StoryLog.TraceTag(596477207,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.error,"Failed to upload file type : "+i.type+" : file size : "+i.size,null),void 0!=this._args.context&&void 0!=this._args.onUploadError&&this._args.onUploadError.call(this._args.context,e,n,i),this._currentUploadCount--,this.startNewFileBatch()},n.prototype.uploadFile=function(t){var e=this,n=t.file,o=function(n,o,i){e.onSuccess(i,n,o,t)},i=function(n,o,i){e.onError(n,o,i,t)},r=new FormData;r.append("file",n),$.ajax({name:"FileUploader: uploadFile",description:"Uploading "+n.name+" ("+n.size+" bytes) to "+t.descriptor,type:"POST",url:t.descriptor,data:r,dataType:"json",processData:!1,contentType:!1,timeout:12e4,success:o,error:i})},n._maxConcurrentUploads=5,n}(Disposable);t.FileUploader=n}(FileUploader||(FileUploader={}));var StoryApp;!function(t){!function(t){!function(t){var e=ClientAction.AggregationCounter,n=function(){function t(t){this.args=t,ActionLogger.CreateClientCounter(e[t.counterScrollbarClick]),ActionLogger.CreateClientCounter(e[t.counterMouseWheel]),ActionLogger.CreateClientCounter(e[t.counterMouseDown]),ActionLogger.CreateClientCounter(e[t.counterKeyboard]),ActionLogger.CreateClientCounter(e[t.counterClick]),ActionLogger.CreateClientCounter(e[t.counterTouch]),this.enabled=t.enabled,this.loggedUserInteraction=!1}return t.prototype.setEnabled=function(t){this.enabled=t},t.prototype.scrollbarClicked=function(){this.enabled&&this.increaseCounterAndLog(e[this.args.counterScrollbarClick])},t.prototype.handleGlobalMouseEvent=function(t,n,o){if(this.enabled)switch(o){case TDB.ViewElementMouseEventType.MouseScroll:this.increaseCounterAndLog(e[this.args.counterMouseWheel]);break;case TDB.ViewElementMouseEventType.MouseDownEvent:this.increaseCounterAndLog(e[this.args.counterMouseDown]);break;case TDB.ViewElementMouseEventType.MouseClickEvent:this.increaseCounterAndLog(e[this.args.counterClick])}},t.prototype.handleGlobalKeyEvent=function(t,n){this.enabled&&this.increaseCounterAndLog(e[this.args.counterKeyboard])},t.prototype.touchStart=function(t){return this.enabled&&this.increaseCounterAndLog(e[this.args.counterTouch]),!0},t.prototype.touchMove=function(t){return!0},t.prototype.touchStop=function(t){return!0},t.prototype.recordScrollPosition=function(t,e){},t.prototype.setTelemetryContext=function(t){ActionLogger.SetContext(e[this.args.counterScrollbarClick],t),ActionLogger.SetContext(e[this.args.counterKeyboard],t),ActionLogger.SetContext(e[this.args.counterMouseDown],t),ActionLogger.SetContext(e[this.args.counterMouseWheel],t),ActionLogger.SetContext(e[this.args.counterClick],t),ActionLogger.SetContext(e[this.args.counterTouch],t),this.loggedUserInteraction=!1},t.prototype.increaseCounterAndLog=function(t){ActionLogger.IncrementClientCounter(t),this.loggedUserInteraction||(this.loggedUserInteraction=!0,StoryLog.StructuredTraceTag(595986564,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"First users interaction",{clientActionCounter:t,StoryId:StoryLog.GetStoryId(),LookupId:StoryLog.GetLookupId()}),StoryLog.FlushClientData())},t}();t.UserInteractionTelemetry=n}(t.ViewElements||(t.ViewElements={}))}(t.View||(t.View={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){var e=function(){function t(t){this.watchables={},this.loadResource=t.loadResource.bind(t),this.resourceFactory=t}return t.prototype.loadResourceWithWatchable=function(t,e,n){if(this.watchables[t])return this.watchables[t].getWatchedValue(e);var o=this.watchables[t]=TDB.watchableTag(596477122,void 0,!1);return this.loadResource(t).then(function(){return TDB.applyUpdate(function(){return o.setValue(!0)},n)}),o.getWatchedValue(e)},t}();t.WatchableResourceFactory=e}(t.Common||(t.Common={}))}(StoryApp||(StoryApp={}));var CommonMain;!function(t){var e,n=function(){function t(){}return t.createActionNamesLinks=function(){var t=$("<div />").attr("id","hActionNamesLinks").attr("title","Action names list");return $("<ul />").attr("id","hActionNamesLinksList").appendTo(t),t},t.openTelemetryModeDialog=function(){0==$("#hActionNamesLinks").length&&(this.createActionNamesLinks().appendTo(document.body),ActionLogger.RegisterActionCallback(this.updateActionName)),$("#hActionNamesLinks").dialog({close:function(t,e){$(this).dialog("destroy").remove(),ActionLogger.UnregisterActionCallback(this.updateActionName)},create:function(t,e){var n=$(this).dialog("widget");$(n).addClass("actionNameDialog")},width:"800px",maxHeight:"600px"})},t.updateActionName=function(e,n){if(!n&&-1==t.excludedActionNames.indexOf(e.getActionType())){var o=$("#hActionNamesLinksList"),i=$("<li />"),r=ClientAction.ActionType[e.getActionType()],a=r,s=r;if(t.featuresDescribedWithColumn1Keys[r]){var l=e.getTelemetryDataColumns(),u=t.featuresDescribedWithColumn1Keys[r],c=u+":"+l[u];a+="#"+c,s+="_"+c}var d="https://avocado/reports/226291?FeatureName="+s+"&UserType=Any&Endpoint=Any",p=$("<a />").attr("href",d).attr("target","_blank").text(a);i.append(p),i.prependTo(o),$("#hActionNamesLinks ul").children().length>15&&$("#hActionNamesLinksList").children().last().remove()}},t.featuresDescribedWithColumn1Keys=(e={},e[ClientAction.ActionType[ClientAction.ActionType.ButtonClicked]]="Target",e[ClientAction.ActionType[ClientAction.ActionType.ButtonRightClicked]]="Target",e[ClientAction.ActionType[ClientAction.ActionType.Edit_CardGallery_AddCard]]="CardType",e[ClientAction.ActionType[ClientAction.ActionType.Edit_CardGallery_DragCard]]="CardType",e[ClientAction.ActionType[ClientAction.ActionType.ContentAdded]]="ContentSource",e[ClientAction.ActionType[ClientAction.ActionType.Storyline_JackCardClicked]]="CardType",e),t.excludedActionNames=[ClientAction.ActionType.PageLoad,ClientAction.ActionType.Client_UserRequestedFlight,ClientAction.ActionType.AuthorsManager_IPLocation],t}();t.TelemetryModeWindow=n}(CommonMain||(CommonMain={}));