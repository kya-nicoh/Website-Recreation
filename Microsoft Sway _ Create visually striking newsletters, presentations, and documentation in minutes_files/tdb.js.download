var __extends=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),StoryApp;!function(t){!function(t){function e(t){t=t.toLowerCase();var e=/(edge)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||/(trident)(?:.*? rv:([\w.]+)|)/.exec(t)||/(chrome)[ \/]([\w.]+)/.exec(t)||/(crios)[ \/]([\w.]+)/.exec(t)||/(fxios)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(firefox)[ \/]([\w.]+)/.exec(t)||[],n=/mobi/.exec(t),i=/ipad|iphone/.exec(t);return{browser:e[1]||"",version:e[2]||"0",mobile:n&&n.length>0?n[0]:"",ios:i&&i.length>0?i[0]:""}}function n(n){var i=e(n?n:navigator.userAgent),r={name:"",version:"",mobile:!1,ios:!1};return i.browser&&(r.name=i.browser,r.name==t.BrowserNames.ChromeIOS&&(r.name=t.BrowserNames.Chrome),r.name==t.BrowserNames.FirefoxIOS&&(r.name=t.BrowserNames.Firefox),r.name==t.BrowserNames.Trident&&(r.name=t.BrowserNames.Msie),r.version=i.version,r.mobile="mobi"===i.mobile,r.ios=""!==i.ios&&r.name!==t.BrowserNames.Msie),r}function i(){var t=document.createElement("div");t.style.color="rgb(55,66,88)",document.body.appendChild(t);var e=document.defaultView.getComputedStyle(t,null).color;return document.body.removeChild(t),"rgb(55,66,88)"!==e.replace(/ /g,"")}function r(){try{return sessionStorage.setItem("sway::utilities::localStorageTest","1"),"1"===sessionStorage.getItem("sway::utilities::localStorageTest")}catch(t){return!1}}t.BrowserNames={Msie:"msie",Edge:"edge",Trident:"trident",Chrome:"chrome",ChromeIOS:"crios",Firefox:"firefox",FirefoxIOS:"fxios",Safari:"safari",Webkit:"webkit"};var o=n(),s=function(){function e(e){this.isIE=!1,this.isIE10=!1,this.isEdge=!1,this.isRedstoneEdge=!1,this.isWebkit=!1,this.isChrome=!1,this.isChrome51=!1,this.isChrome53=!1,this.isChrome61OrEarlier=!1,this.isIEOrEdge=!1,this.isSafari=!1,this.isSafari10OrLater=!1,this.isSafari10OrEarlier=!1,this.isFirefox=!1,this.isMobile=!1,this.isiOS=!1,this.majorVersion=parseInt(e.version),this.isIE=e.name===t.BrowserNames.Msie||e.name===t.BrowserNames.Trident,this.isIE10=this.isIE&&10===this.majorVersion,this.isEdge=e.name===t.BrowserNames.Edge,this.isRedstoneEdge=this.isEdge&&this.majorVersion>=14,this.isWebkit=e.name===t.BrowserNames.Chrome||e.name===t.BrowserNames.Webkit,this.isChrome=e.name===t.BrowserNames.Chrome,this.isChrome51=this.isChrome&&51===this.majorVersion,this.isChrome53=this.isChrome&&53===this.majorVersion,this.isChrome61OrEarlier=this.isChrome&&this.majorVersion<=61,this.isIEOrEdge=e.name===t.BrowserNames.Msie||e.name===t.BrowserNames.Edge,this.isSafari=e.name===t.BrowserNames.Webkit,this.isSafari10OrLater=this.isSafari&&this.majorVersion>=602,this.isSafari10OrEarlier=this.isSafari&&this.majorVersion<=602,this.isFirefox=e.name===t.BrowserNames.Firefox,this.isiOS=e.ios,this.isMobile=e.mobile}return e}();t.BrowserCheck=s,t.browser=new s(o),t.getBrowserInfo=n,t.isHighContrastMode=i,t.SessionStorageEnabled=r}(t.Utilities||(t.Utilities={}))}(StoryApp||(StoryApp={}));var TDB;!function(t){!function(e){!function(e){!function(e){var n=function(){function e(e,n,i){if(this._loaded=!1,this._position=t.watchableTag(596473165,this,0),this._el=e,!(this._el instanceof HTMLAudioElement))throw t.createError("The audio binding only works on audio elements.")}return e.prototype.init=function(t){this._duration=t.duration,this._position=t.position,this._playing=t.playing;var e={loadedmetadata:this.loadedMetaData,timeupdate:this.timeUpdate,ended:this.onEnd};for(var n in e)this.setupEventListener(e[n],n)},e.prototype.loadedMetaData=function(e){var n=this;return this._loaded=!0,t.applyUpdate(function(){n._duration.setValue(n._el.duration)}),!1},e.prototype.timeUpdate=function(e){var n=this;return t.applyUpdate(function(){n._position.setValue(n._el.currentTime)}),!1},e.prototype.onEnd=function(e){var n=this;return t.applyUpdate(function(){n._playing.setValue(!1)}),!1},e.prototype.setupEventListener=function(t,e){var n=this,i=function(e){var i=t.call(n,e);return i||(e.stopPropagation(),e.preventDefault()),i};$(this._el).on(e,i)},e.prototype.updateSource=function(t,e){this._el.src=e,this._loaded=!1},e.prototype.updatePosition=function(t,e){this._loaded&&isFinite(e)&&(this._el.currentTime=e)},e.prototype.updateVolume=function(t,e){this._loaded&&(this._el.volume=e)},e.prototype.updatePlaying=function(t,e){e?this._el.play():this._el.pause()},e}();e.BindingBase=n}(e.Audio||(e.Audio={}))}(e.Bindings||(e.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={}));var TDB;!function(t){!function(t){!function(t){!function(t){var e=function(){function t(t,e,n){this._element=t}return t.prototype.getPosition=function(){return this._element.getBoundingClientRect()},t.prototype.getWidth=function(){return this._element.offsetWidth},t}();t.BindingBase=e}(t.Position||(t.Position={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={}));var TDB;!function(t){!function(e){!function(e){!function(e){var n=function(){function e(e,n,i){this.loaded=!1,this.playing=t.watchableTag(596473164,this,!1),this.loaded=!1,this.el=e,this.el instanceof HTMLVideoElement||t.raiseRecoverableError("The video binding works only on video elements",t.LogLevel.error)}return e.prototype.init=function(t){var e=this;this.playing=t.playing,this.args=t;var n={canplay:this.canPlay,ended:this.onEnd,pause:this.videoPaused,suspend:this.suspended};for(var i in n)this.setupEventListener(n[i],i);t.playCallbackHandler&&this.el.addEventListener("play",function(){t.playCallbackHandler.onVideoPlayCallback(e.el)})},e.prototype.setupEventListener=function(t,e){var n=this,i=function(e){var i=t.call(n,e);return i||(e.stopPropagation(),e.preventDefault()),i};$(this.el).on(e,i)},e.prototype.suspended=function(e){var n=this;return this.loaded&&!this.el.paused||t.applyUpdate(function(){n.playing.setValue(!1)}),!0},e.prototype.videoPaused=function(e){var n=this;return t.applyUpdate(function(){n.playing.setValue(!1)}),!0},e.prototype.canPlay=function(e){var n=this,i=this.loaded;return this.loaded=!0,StoryApp.Utilities.browser.isMobile&&StoryApp.Utilities.browser.isEdge||t.applyUpdate(function(){n.playing.setValue(!0)}),this.args.playCallbackHandler&&!i&&this.args.playCallbackHandler.onVideoPlayCallback(this.el),!0},e.prototype.onEnd=function(e){var n=this;return t.applyUpdate(function(){n.playing.setValue(!1)}),!1},e.prototype.updateSource=function(t,e){this.el.src=e,this.loaded=!1},e.prototype.updatePlaying=function(e,n){var i=this;if(this.loaded)if(n){this.el.muted=this.args.muted;var r=this.el.play();void 0!==r&&r.catch(function(e){t.applyUpdate(function(){i.playing.setValue(!1)})})}else this.el.pause()},e}();e.BindingBase=n}(e.Video||(e.Video={}))}(e.Bindings||(e.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={}));var TDB;!function(t){!function(e){!function(e){!function(e){var n=function(){function e(t,e,n){this.element=t}return e.prototype.init=function(e){var n=this;if(e&&(this.type=this.element.type.toLowerCase(),this.isTypeText())){this.context=e.context,this.getSelectionStartHandler=e.getSelectionStart,this.setSelectionStartHandler=e.setSelectionStart,this.getSelectionEndHandler=e.getSelectionEnd,this.setSelectionEndHandler=e.setSelectionEnd;var i=this.element.tagName.toLowerCase();"input"!==i&&"select"!==i&&"option"!==i&&"textarea"!==i&&t.raiseRecoverableError("The value binding only works on input elements.",t.LogLevel.error),this.onChangeHandler=function(){n.commitSelection()},$(this.element).on("keydown",this.onChangeHandler),$(this.element).on("mousedown",this.onChangeHandler)}},e.prototype.commitSelection=function(){var e=this;t.applyUpdate(function(){var t=StoryApp.Utilities.getElementSelectionStart(e.element),n=StoryApp.Utilities.getElementSelectionEnd(e.element);t!==e.getSelectionStartHandler.call(e.context)&&e.setSelectionStartHandler.call(e.context,t),n!==e.getSelectionEndHandler.call(e.context)&&e.setSelectionEndHandler.call(e.context,n)},t.Justification.InitialConversion)},e.prototype.updateInputSelection=function(t){if(this.isTypeText()&&this.context&&this.getSelectionStartHandler){var e=this.getSelectionStartHandler.call(this.context,t);StoryApp.Utilities.getElementSelectionStart(this.element)!==e&&StoryApp.Utilities.setElementSelectionStart(this.element,e)}},e.prototype.getSelectionStart=function(){return this.isTypeText()?(this.commitSelection(),this.getSelectionStartHandler.call(this.context)):null},e.prototype.getSelectionEnd=function(){return this.isTypeText()?(this.commitSelection(),this.getSelectionEndHandler.call(this.context)):null},e.prototype.dispose=function(){$(this.element).off("keydown",this.onChangeHandler),$(this.element).off("mousedown",this.onChangeHandler)},e.prototype.isTypeText=function(){return"text"==this.type},e}();e.BindingBase=n}(e.InputSelection||(e.InputSelection={}))}(e.Bindings||(e.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={}));var TDB;!function(t){!function(t){var e=function(){function t(t,e){this.index=t,this.count=e}return t.prototype.applyTo=function(t,e){if("string"==typeof t)return t.slice(0,this.index)+t.slice(this.index+this.count);var n=t.slice(0);return n.splice(this.index,this.count),n},t.prototype.toString=function(){return"d("+this.index+", "+this.count+")"},t}();t.Deletion=e}(t.Diff||(t.Diff={}))}(TDB||(TDB={}));var TDB;!function(t){!function(t){var e=function(){function t(t,e,n){void 0===n&&(n=null),this.rows=t,this.columns=e,this.elements=n;var i=t*e;this.elements=n&&n.length>=i?n:new Array(i),this.stride=e}return t.prototype.get=function(t,e){return this.elements[t*this.stride+e]},t}();t.Matrix=e}(t.Diff||(t.Diff={}))}(TDB||(TDB={}));var TDB;!function(t){!function(t){var e=function(){function t(t,e){this.index=t,this.count=e}return t.prototype.applyTo=function(t,e){if("string"==typeof t)return t.slice(0,this.index)+e.slice(this.index,this.index+this.count)+t.slice(this.index);var n=t.slice(0);return n.splice.apply(n,[this.index,0].concat(e.slice(this.index,this.index+this.count))),n},t.prototype.toString=function(){return"i("+this.index+", "+this.count+")"},t}();t.Insertion=e}(t.Diff||(t.Diff={}))}(TDB||(TDB={}));var TDB;!function(t){!function(t){var e=function(){function e(t){this.edits=t}return e.fromSequences=function(n,i,r){for(var o,s,a=e.getEditDistanceMatrix(n,i,r),u=a.elements,c=a.stride,l=[],h=n.length,d=i.length;h>0||d>0;){var p=u[h*c+d];d>0&&u[h*c+(d-1)]===p-1?(--d,o&&o.index===h?++o.count:(o=new t.Insertion(h,1),l.push(o))):h>0&&u[(h-1)*c+d]===p-1?(--h,s&&s.index===h+1?(--s.index,++s.count):(s=new t.Deletion(h,1),l.push(s))):(--h,--d)}l.reverse();for(var f=0,v=0;v<l.length;++v){var g=l[v];g.index+=f,f+=g instanceof t.Insertion?g.count:-g.count}return a.elements.length<=e.maxReusableBufferLength&&(!e.reusableMatrixBuffer||e.reusableMatrixBuffer.length<a.elements.length)&&(e.reusableMatrixBuffer=a.elements),new e(l)},e.prototype.applyTo=function(t,e){for(var n="string"==typeof t?t:t.slice(),i=0,r=this.edits;i<r.length;i++)n=r[i].applyTo(n,e);return n},e.prototype.toString=function(){return this.edits.map(function(t){return t.toString()}).join(" ")},e.getEditDistanceMatrix=function(n,i,r){for(var o=n.length,s=i.length,a=new t.Matrix(o+1,s+1,e.reusableMatrixBuffer),u=a.elements,c=a.stride,l=0;l<=o;++l)u[l*c+0]=l;for(h=1;h<=s;++h)u[0*c+h]=h;for(l=1;l<=o;++l)for(var h=1;h<=s;++h)u[l*c+h]=r(n[l-1],i[h-1])?u[(l-1)*c+(h-1)]:1+Math.min(u[(l-1)*c+h],u[l*c+(h-1)]);return a},e.maxReusableBufferLength=1e4,e}();t.Diff=e}(t.Diff||(t.Diff={}))}(TDB||(TDB={}));var TDB;!function(t){!function(t){var e=function(){function e(t,e){this.deletions=t,this.insertions=e}return e.fromSequences=function(n,i,r){for(var o,s=t.Diff.fromSequences(n,i,r).edits,a=[],u=[],c=0,l=0;l<s.length;++l){var h=s[l];if(h instanceof t.Deletion){var d=h.index+c;o&&o.index===d?o.count+=h.count:(o=new t.Deletion(d,h.count),a.push(o))}else c-=h.count,u.push(h)}return new e(a,u)},e.fromKeyedSequences=function(n,i,r,o){for(var s=e.getKeptKeys(n,i,r,o),a=n.length,u=i.length,c=[],l=0,h=0;h<a;++h)if(!s[r(n[h])]){var d=h-l,p=c[c.length-1];p&&p.index===d?++p.count:c.push(new t.Deletion(d,1)),++l}for(var f=[],v=0;v<u;++v)if(!s[o(i[v])]){var g=f[f.length-1];g&&g.index+g.count===v?++g.count:f.push(new t.Insertion(v,1))}return new e(c,f)},e.getKeptKeys=function(t,e,n,i){for(var r=t.length,o=e.length,s=Object.create(null),a=0;a<r;++a)s[n(t[a])]=a;for(var u=new Array(o),c=new Array(o),l=0,h=0;h<o;++h){var d=s[i(e[h])];if("number"==typeof d){var p=void 0;if(0===l||d>s[i(e[u[l-1]])])p=l,++l;else{for(var f=0,v=l-2;f<=v;){var g=Math.ceil((f+v)/2);d>s[i(e[u[g]])]?f=g+1:v=g-1}p=f}u[p]=h,p>0&&(c[h]=u[p-1])}}for(var y={},m=u[l-1];void 0!==m;)y[i(e[m])]=!0,m=c[m];return y},e.prototype.applyTo=function(t,e){for(var n="string"==typeof t?t:t.slice(),i=0,r=this.deletions;i<r.length;i++)n=r[i].applyTo(n,e);for(var o=0,s=this.insertions;o<s.length;o++)n=s[o].applyTo(n,e);return n},e.prototype.toString=function(){return this.deletions.concat(this.insertions).map(function(t){return t.toString()}).join(" ")},e}();t.OrderedDiff=e}(t.Diff||(t.Diff={}))}(TDB||(TDB={}));var StoryApp;!function(t){!function(t){function e(t,e,n){try{return document.execCommand(t,e,n)}catch(t){return!1}}function n(){try{return document.activeElement}catch(t){return document.body}}function i(){try{return TDB.logIfError(function(){return document.createRange()})}catch(t){try{return TDB.logIfError(function(){return new Range})}catch(t){return}}}function r(t){try{return t.selectionEnd}catch(t){return 0}}function o(t){try{return t.selectionStart}catch(t){return 0}}function s(t,e){try{t.selectionStart=e}catch(t){}}function a(t){try{return t.contentDocument}catch(t){return}}function u(t){try{return t.textContent.trim().replace(/[\u200B]/g,"")}catch(t){return}}function c(t){for(var e=[],n=0;n<t.length;n++)e.push(t.item(n));return e}function l(t){return"none"!==t.style.display}function h(t){for(var e=document.activeElement;t!==e&&t!==document.body;)e=e.parentElement;return e===t}t.execDocumentCommand=e,t.getDocumentActiveElement=n,t.createRange=i,t.getElementSelectionEnd=r,t.getElementSelectionStart=o,t.setElementSelectionStart=s,t.getIframeContentDocument=a,t.getTrimmedTextContent=u,t.nodeListToArray=c,t.isElementVisible=l,t.isFocusUnder=h}(t.Utilities||(t.Utilities={}))}(StoryApp||(StoryApp={}));var TDB;!function(t){function e(t,e,i,r){return new n(t,e,i,r)}var n=function(){function e(e,n,i,r){this.jElement=n,this.eventName=i,e&&e.addResource(this),this.handler=function(){var e=Array.prototype.slice.call(arguments),n=this;return t.logIfError(function(){var i;return t.applyUpdate(function(){i=r.apply(n,e)},t.Justification.SynchronousBrowserEvent),i})},n.on(i,this.handler)}return e.prototype.dispose=function(){this.jElement.off(this.eventName,this.handler)},e}();t.on=e}(TDB||(TDB={})),Object.defineProperties(Array.prototype,{first:{value:function(t){if(0===this.length)throw TDB.createError("tried fetching first of an empty array");if(!t)return this[0];for(var e=0;e<this.length;++e){var n=this[e];if(t(n))return n}throw TDB.createError("predicate didn't match any element in the array")}},firstOrDefault:{value:function(t){if(0===this.length)return null;if(!t)return this[0];for(var e=0;e<this.length;++e){var n=this[e];if(t(n))return n}return null}},last:{value:function(t){var e=ArrayExtensions.lastOrDefault(this,t);if(null===e)throw 0===this.length?TDB.createError("tried fetching last of an empty array"):TDB.createError("predicate didn't match any element in the array");return e}},addunique:{value:function(t){return!ArrayExtensions.contains(this,t)&&(this.push(t),!0)}},mapmany:{value:function(t){for(var e=[],n=0;n<this.length;++n)e.push.apply(e,t(this[n]));return e}},groupby:{value:function(t){for(var e={},n=0;n<this.length;++n){var i=this[n],r=t(i),o=e[r];o||(e[r]=o=[]),o.push(i)}return e}},removefirst:{value:function(t){var e=this.indexOf(t);return-1!==e&&(this.splice(e,1),!0)}},notNullOrUndefined:{value:function(){return this.filter(function(t){return null!==t&&void 0!==t})}},truthy:{value:function(){return this.filter(function(t){return!!t})}},indexOfLast:{value:function(t){for(var e=this.length-1;e>=0;e--)if(t(this[e]))return e;return-1}},mapSome:{value:function(t){for(var e=[],n=0,i=this.length;n<i;++n){var r=t(this[n]);r&&e.push(r)}return e}},bubbleSort:{value:function(t){var e=this.length,n=!1;do{n=!1;for(var i=1;i<e;i++)if(t(this[i-1],this[i])>0){var r=this[i-1];this[i-1]=this[i],this[i]=r,n=!0}e--}while(!0===n);return this}}});var ArrayExtensions;!function(t){function e(t,e){return!!i(t,e)}function n(t,e){return t.first(e)}function i(t,e){return t.firstOrDefault(e)}function r(t,e){return t.last(e)}function o(t,e){if(0!==t.length){if(!e)return t[t.length-1];for(var n=t.length-1;n>=0;n-=1)if(e(t[n]))return t[n]}}function s(t,e){return-1!==t.indexOf(e)}function a(t,e){return t.addunique(e)}function u(t,e){for(var n=0,i=0,r=t;i<r.length;i++)e(r[i])&&(n+=1);return n}function c(t,e){return t.mapSome(e)}function l(t,e){return t.mapmany(e)}function h(t,e){for(var n={},i=0;i<t.length;i+=1)e(t[i],n,i);return n}function d(e){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];if(0===e.length)return!0;if(0===n.length){var r=e.map(function(t){return Obj.properties(t)});if(!t.homogeneous(r,"length"))return!1;n=r[0]}var o=e[0];return e.every(function(t){return n.every(function(e){return o[e]===t[e]})})}function p(t,e){return t.groupby(e)}function f(t,e){for(var n={},i=[],r=0,o=t;r<o.length;r++){var s=o[r],a=e(s);n[a]||(n[a]=!0,i.push(s))}return i}function v(t,e){return t.removefirst(e)}function g(t,e){for(var n=0,i=t.length;n<i;n+=1)if(e(t[n]))return t.splice(n,1),!0;return!1}function y(t){return t.notNullOrUndefined()}function m(t,e){for(var n=0;n<t.length;n+=1)if(e(t[n]))return n;return-1}function _(t,e){return t.indexOfLast(e)}function b(t,e){return t.bubbleSort(e)}t.any=e,t.first=n,t.firstOrDefault=i,t.last=r,t.lastOrDefault=o,t.contains=s,t.addUnique=a,t.count=u,t.mapAndFilter=c,t.mapMany=l,t.toDictionary=h,t.homogeneous=d,t.groupBy=p,t.unique=f,t.removeFirst=v,t.removeFirstWhere=g,t.notNullOrUndefined=y,t.indexOfFirst=m,t.indexOfLast=_,t.bubbleSort=b}(ArrayExtensions||(ArrayExtensions={}));var Obj;!function(t){function e(t){var e=[];for(var n in t)e.push(n.toString());return e}function n(t){var e=[];for(var n in t)e.push(t[n]);return e}function i(t,e){if(null==t||null==e)return!1;for(var n in t)if(t[n]!=e[n])return!1;for(var i in e)if(t[i]!=e[i])return!1;return!0}function r(e,n){if(null==e||null==n)return!1;var i=e,r=n;return t.equals(i,r)}function o(t,e){for(var n in e)t[n]=e[n];return t}function s(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.reduce(o,{})}function a(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];for(var i={},r=0,o=e;r<o.length;r++){var s=o[r];i=t.extend(i,s)}return i}function u(t,e){for(var n={},i=0;i<t.length;++i)n[t[i]]=e[i];return n}function c(t,e){for(var n in e){var i=e[n];e[n]=i.bind(t)}return e}function l(t,e,n,i){i||(i=[]);var r=e(t);r&&i.push(r);var o=n(t);return o&&o.forEach(function(t){return l(t,e,n,i)}),i}function h(t,e){for(var n=0,i=e;n<i.length;n++)if(void 0===t[i[n]])return!1;return!0}t.properties=e,t.keys=e,t.values=n,t.equals=i,t.equalsObj=r,t.extend=o,t.extendAll=s,t.combine=a,t.keyval=u,t.implement=c;if("toJSON"in Object.prototype){var d=Object.getOwnPropertyDescriptor(Object.prototype,"toJSON");d.configurable&&d.enumerable&&(d.enumerable=!1,Object.defineProperty(Object.prototype,"toJSON",d))}else Object.defineProperty(Object.prototype,"toJSON",{enumerable:!1,configurable:!0,writable:!0});t.traverse=l,t.hasProperties=h}(Obj||(Obj={}));var StringExtensions;!function(t){function e(t,e){return t.substr(t.length-e.length)===e}function n(t){var e=0;if(!t||0===t.length)return e;for(var n=0;n<t.length;n++)e=(e<<5)-e+t.charCodeAt(n),e|=0;return e}t.endsWith=e,t.hashCode=n}(StringExtensions||(StringExtensions={}));var DictionaryExtensions;!function(t){function e(t){var e=0;for(var n in t)e+=t[n].length;return e}function n(t){for(var e={},n=0,i=t;n<i.length;n++){var r=i[n];for(var o in r){if(e[o]&&e[o]!=r[o])throw TDB.createError("Collision merging dictionaries on key "+o);e[o]=r[o]}}return e}t.length=e,t.merge=n}(DictionaryExtensions||(DictionaryExtensions={})),function(){var t=jQuery.parseJSON;jQuery.parseJSON=function(e){return e||null===e?t.apply(this,arguments):null}}();var DisposableHolder=function(){function t(e){e?e.addResource(this):t.orphanDisposable(this)}return t.orphanDisposable=function(t){},t.prototype.addResource=function(t){t&&(this.resources?this.resources.push(t):this.resources=[t])},t.prototype.removeResource=function(t){t&&this.resources&&(ArrayExtensions.removeFirst(this.resources,t),0===this.resources.length&&(this.resources=void 0))},t.prototype.dispose=function(){if(this.resources){for(var t=this.resources.shift();t;)t.dispose(),t=this.resources&&this.resources.shift();this.resources=void 0}},t}(),Disposable=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(DisposableHolder),EnumParser;!function(t){function e(t,e){for(var n=0,i=Object.keys(e).map(function(t){return e[t]}).filter(function(t){return"string"==typeof t});n<i.length;n++){var r=i[n];if(r.toLowerCase()===t.toLowerCase())return e[r]}throw TDB.createError("Invalid value of "+t+" for type "+e)}function n(t,e){return e[t]}function i(t){for(var e=[],i=0,r=Object.keys(t).map(function(e){return t[e]}).filter(function(t){return"string"==typeof t});i<r.length;i++){var o=r[i];e.push(n(o,t))}return e}t.getValueFromString=e,t.fromString=n,t.allValues=i}(EnumParser||(EnumParser={}));var TDB;!function(t){!function(t){t[t.InitialConversion=1]="InitialConversion",t[t.TestCode=2]="TestCode",t[t.SynchronousBrowserEvent=3]="SynchronousBrowserEvent",t[t.FocusManagement=4]="FocusManagement",t[t.DynamicMenu=5]="DynamicMenu",t[t.TextMeasurement=6]="TextMeasurement",t[t.SyncResponse=7]="SyncResponse",t[t.CalloutUpdate=8]="CalloutUpdate",t[t.UploadManagement=9]="UploadManagement",t[t.Dispose=10]="Dispose",t[t.Initialization=11]="Initialization"}(t.Justification||(t.Justification={}))}(TDB||(TDB={}));var TDB;!function(t){var e;!function(t){t[t.Ctrl=1]="Ctrl",t[t.Alt=2]="Alt",t[t.Shift=4]="Shift",t[t.Meta=8]="Meta"}(e=t.ShortcutModifier||(t.ShortcutModifier={}));var n;!function(t){t[t.Standard=0]="Standard",t[t.Left=1]="Left",t[t.Right=2]="Right",t[t.Numpad=3]="Numpad"}(n||(n={}));var i=function(){function i(){}return i.createShortcutIdentifier=function(r){var o=new i;o.modifier=0;for(var s=0,a=r.split("+");s<a.length;s++){var u=a[s],c=e[u];c&&(o.modifier|=c);var l=KeyCodes[u];l&&(o.keyCode=l);var h=n[u];if(void 0!==h&&(o.location=h),!c&&!l&&void 0===h)throw t.createError("Invalid part: "+u+" of key code: "+r)}if(!o.keyCode)throw t.createError("Invalid key code: "+r);return o},i.createShortcutIdentifierFromEvent=function(t){var n=new i,r=0;return t.ctrlKey&&(r|=e.Ctrl),t.altKey&&(r|=e.Alt),t.shiftKey&&(r|=e.Shift),t.metaKey&&(r|=e.Meta),n.modifier=r,n.keyCode=t.keyCode,n.location=t.originalEvent&&t.originalEvent.location,n},i.prototype.shouldHandle=function(t){return this.keyCode===t.keyCode&&this.modifier===t.modifier&&(void 0===this.location||this.location===t.location)},i.prototype.matches=function(t){return this.keyCode===t.keyCode&&this.modifier===t.modifier&&this.location===t.location},i.prototype.hashCode=function(){return 256*this.modifier+this.keyCode},i.prototype.isModifierSet=function(t){return(this.modifier&t)===t},i.prototype.toString=function(){var t="",i=function(t){return t?"+":""};if(this.modifier&e.Meta)return"";if(this.modifier&e.Ctrl&&(t+=i(t)+"Ctrl"),this.modifier&e.Alt&&(t+=i(t)+"Alt"),this.modifier&e.Shift&&(t+=i(t)+"Shift"),void 0!==this.location)for(var r in n)this.location===n[r]&&(t+=i(t)+r);t+=i(t);for(var o in KeyCodeType)if(this.keyCode===KeyCodes[o]){t+=""+o;break}return t},i}();t.ShortcutIdentifier=i}(TDB||(TDB={}));var PlatformPolyFill;!function(t){function e(){return{setImmediate:n.create(),setInterval:r.createSetInterval(),setTimeout:r.createSetTimeout(),now:i.create()}}var n;!function(t){function e(){if("undefined"==typeof postMessage)return!1;var t=!0,e=window.onmessage;return window.onmessage=function(){return t=!1},window.postMessage("","*"),window.onmessage=e,t}function n(){return!(!window.setImmediate&&!window.msSetImmediate)}function i(){return window.addEventListener("message",function(t){"setImmediate"===t.data&&a.runImmediates()},!1),function(t){a.scheduleImmediate(t,function(){window.postMessage("setImmediate","*")})}}function r(){var t=window.setImmediate||window.msSetImmediate;return function(e){a.scheduleImmediate(e,function(){t(a.runImmediates)})}}function o(){return function(t){a.scheduleImmediate(t,function(){platform.setTimeout(a.runImmediates,0)})}}function s(){return n()?r():e()?i():o()}var a;!function(t){function e(){i=!1;for(var t=r.splice(0,r.length),e=0,n=t.length;e<n;++e)t[e]()}function n(t,e){r.push(t),i||(e(),i=!0)}var i=!1,r=[];t.runImmediates=e,t.scheduleImmediate=n}(a||(a={})),t.create=s}(n||(n={}));var i;!function(t){function e(){return window.performance&&window.performance.now&&isFinite(window.performance.now())?function(){return performance.now()}:Date.now?Date.now.bind(Date):function(){return(new Date).getTime()}}t.create=e}(i||(i={}));var r;!function(t){function e(t){return void 0===t&&(t=setInterval),function(e,n){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];var s=t(function(){TDB.logIfError(function(){return e.apply(void 0,i)})},n);return o.push(s),s}}function n(t){return void 0===t&&(t=setTimeout),function(e,n){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];var o=t(function(){TDB.logIfError(function(){return e.apply(void 0,i)})},n);return s.push(o),o}}function i(t){void 0===t&&(t=clearInterval),o.forEach(function(e){return t(e)}),o=[]}function r(t){void 0===t&&(t=clearTimeout),s.forEach(function(e){return t(e)}),s=[]}var o=[],s=[];t.createSetInterval=e,t.createSetTimeout=n,t.clearIntervals=i,t.clearTimeouts=r}(r=t.Timing||(t.Timing={})),t.create=e}(PlatformPolyFill||(PlatformPolyFill={}));var platform=PlatformPolyFill.create(),StoryApp;!function(t){!function(t){var e=function(){function t(){}return t.retryUntil=function(t,e,n,i,r){void 0===r&&(r=platform.setTimeout);var o=$.Deferred(),s=1,a=function(){t().then(function(t){s>=i||e(t)?o.resolve(t):r(function(){++s,a()},n)},function(){return o.reject()})};return a(),o},t}();t.Promises=e}(t.Utilities||(t.Utilities={}))}(StoryApp||(StoryApp={}));var StoryApp;!function(t){!function(t){function e(t,e){var n=new r(t,e);return i.push(n),n}function n(){i=[]}var i=[];addEventListener("resize",function(){platform.setImmediate(function(){for(var t=0,e=i.length;t<e;++t)i[t].run()})});var r=function(){function t(t,e){this.fn=t,this.context=e}return t.prototype.dispose=function(){ArrayExtensions.removeFirst(i,this)},t.prototype.run=function(){this.fn.call(this.context)},t}();t.onResize=e,t.resetResizeCallbacks=n}(t.Utilities||(t.Utilities={}))}(StoryApp||(StoryApp={}));var TDB;!function(t){function e(){if(I=-1,P)throw P=!1,t.createError("previous update was canceled")}function n(e){if(A.indexOf(e)>-1)throw t.createError("The updater, "+e.toString()+", is already registered.")}function i(t){n(t),A.push(t)}function r(t){n(t),A.unshift(t)}function o(e){var n=A.indexOf(e);if(-1===n)throw t.createError("The updater is not currently registered.");A.splice(n,1)}function s(){return V>0?O.ApplyingUpdate:P?O.ProcessingResults:O.Normal}function a(n,i){P&&0===V&&null==i&&t.raiseRecoverableError("un-justified update while applying the results of another update",t.LogLevel.warning),++V;try{n()}finally{--V}if(!P&&0===V){-1===I&&(I=platform.setTimeout(e,1e3)),P=!0;try{for(var r=0,o=A.length,s=0;s<o;s++){A[s].onUpdate();for(var a=0;a<=s;++a)if(A[a].needsUpdate()){if(s=a-1,++r>1e3)throw t.createError("infinite update loop detected");break}}}finally{P=!1,-1!==I&&(clearTimeout(I),I=-1)}}}function u(e){if(P)throw t.createError("An update is already in progress.");P=!0;try{e()}finally{P=!1}}function c(t){return new F(null,t)}function l(t,e){return new F(t,e)}function h(t,e){return new R(null,t,e)}function d(t,e,n){return new R(t,e,n)}function p(t){return t instanceof R?t:null}function f(t,e,n){return new L(null,t,e,n)}function v(t,e,n,i){return new L(t,e,n,i)}function g(t,e,n){return new N(null,t,e,n)}function y(t,e,n,i){return new N(t,e,n,i)}function m(t,e,n){return new U(null,t,e,n)}function _(t,e,n,i){return new U(t,e,n,i)}function b(t,e,n,i){return w(null,t,e,n,i)}function w(t,e,n,i,r){return new k(t,e,n,i,r,!1)}function T(t,e,n,i){return B(null,t,e,n,i)}function B(t,e,n,i,r){return new k(t,e,n,i,r,!0)}function E(t,e,n){var i=e&&e.watchable;if(i)return i;var r=e&&e.compute;if(r)return r.makeWatcher(t);var o=e&&e.value;return null!==o&&void 0!==o||(o=n),new j(o)}function D(e,n){var i=e&&(e.watchable||e.compute);if(i)return{compute:new t.ComputedOptionArgs(null,function(t){return n(i.getWatchedValue(t))})};var r=e&&e.value;return{value:n(r)}}function x(t,e,n){var i=t&&(t.watchable||t.compute);if(i)return i.getWatchedValue(e);var r=t&&t.value;return null===r||void 0===r?n:r}function C(t){return new j(t)}var S=0,V=0,P=!1,A=[],I=-1;t.registerUpdater=i,t.registerFirstUpdater=r,t.unregisterUpdater=o;var O;!function(t){t[t.Normal=0]="Normal",t[t.ApplyingUpdate=1]="ApplyingUpdate",t[t.ProcessingResults=2]="ProcessingResults"}(O=t.ExecutionMode||(t.ExecutionMode={})),t.getExecutionMode=s,t.applyUpdate=a,t.ensureNoUpdatesDuring=u;var M=function(t){function e(e){var n=t.call(this,e)||this;return n.id="s"+S++,n}return __extends(e,t),e.prototype._subscribeTo=function(t){t.subscribe(this)},e.prototype._unsubscribeFrom=function(t){t.unsubscribe(this)},e}(Disposable);t.Subscriber=M,t.notifier=c,t.notifierTag=l,t.watchable=h,t.watchableTag=d,t.asRW=p,t.watcher=f,t.watcherTag=v,t.statefulWatcher=g,t.statefulWatcherTag=y,t.watcherOwner=m,t.watcherOwnerTag=_,t.mappedWatcher=b,t.mappedWatcherTag=w,t.mappedWatcherOwner=T,t.mappedWatcherOwnerTag=B;var W,F=function(){function e(t,e){this._tag=t,this._context=e,this._subscribers={}}return e.prototype.notify=function(){if(0===V)throw t.createError("Can only notify when applying an update.");this.notifyInternal(!0)},e.prototype.notifyInternal=function(t){var e=this._subscribers;for(var n in e)e[n].receiveNotification(t)},e.prototype.subscribe=function(t){var e=t.id,n=this._subscribers;return!n[e]&&(n[e]=t,!0)},e.prototype.unsubscribe=function(t){delete this._subscribers[t.id]},e.prototype.resolveIfActive=function(){},e}(),R=function(e){function n(t,n,i){var r=e.call(this,t,n)||this;return r._value=i,r}return __extends(n,e),n.prototype.getValue=function(){return this._value},n.prototype.getWatchedValue=function(t){return t?t.watchValue(this):this.getValue()},n.prototype.setValue=function(e){if(0===V)throw t.createError("Can only set a watchable's value when applying an update.");this._value!=e&&(this._value=e,this.notifyInternal(!0))},n}(F);!function(t){t[t.dirty=0]="dirty",t[t.clean=1]="clean",t[t.maybeDirty=2]="maybeDirty"}(W||(W={}));var L=function(t){function e(e,n,i,r){var o=t.call(this,e,n)||this;return o.id="w"+S++,o._calculateValue=r,o._dirty=W.dirty,o._watching=[],i&&i.addResource(o),o}return __extends(e,t),e.prototype.clean=function(){return this._dirty===W.clean},e.prototype.updateMaybeDirty=function(){if(this._dirty===W.maybeDirty){for(var t=this._watching,e=0,n=t.length;e<n&&this._dirty===W.maybeDirty;++e)t[e].resolveIfActive();this._dirty===W.maybeDirty&&(this._dirty=W.clean)}},e.prototype.resolve=function(){if(this.updateMaybeDirty(),this._dirty===W.dirty){this.stopWatchingAll();var t=this._currentValue;this._dirty=W.clean,(this._currentValue=this._calculateNewValue())!==t&&this.notifyInternal(!0)}},e.prototype._calculateNewValue=function(){return this._calculateValue.call(this._context,this)},e.prototype.resolveIfActive=function(){this._disposed||this.resolve()},e.prototype.watchValue=function(t){var e=t.getValue();return this.watchSubscribable(t),e},e.prototype.watch=function(t){this.watchSubscribable(t)},e.prototype.watchSubscribable=function(t){t.subscribe(this)&&this._watching.push(t)},e.prototype.getValue=function(){return this.resolve(),this._currentValue},e.prototype.getWatchedValue=function(t){return t?t.watchValue(this):this.getValue()},e.prototype.receiveNotification=function(t){var e=this._dirty;e===W.clean?(this._dirty=t?W.dirty:W.maybeDirty,this.notifyInternal(!1)):e===W.maybeDirty&&t&&(this._dirty=W.dirty)},e.prototype.dispose=function(){this.stopWatchingAll(),this._disposed=!0},e.prototype.stopWatchingAll=function(){for(var t=this._watching,e=t.length,n=0;n<e;n++)t[n].unsubscribe(this);t.length=0},e}(F),N=function(t){function e(e,n,i,r){var o=t.call(this,e,n,i,void 0)||this;return o._updateValue=r,o}return __extends(e,t),e.prototype._calculateNewValue=function(){return this._updateValue.call(this._context,this._currentValue,this)},e}(L),U=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.resolve=function(){this.updateMaybeDirty(),!this.clean()&&this._currentValue&&(this._currentValue.dispose(),this._currentValue=null),t.prototype.resolve.call(this)},e.prototype.dispose=function(){this._currentValue&&this._currentValue.dispose(),t.prototype.dispose.call(this)},e}(L),k=function(t){function e(e,n,i,r,o,s){var a=t.call(this,e,n,i,void 0)||this;return a._ownObjects=s,a._getKeys=r,a._curKeys=[],a._curValues=[],a._valueConstructor=o,a}return __extends(e,t),e.prototype._calculateNewValue=function(){var t,e=this._ownObjects,n=this._context,i=this._curValues,r=i.length,o=this._getKeys.call(n,this),s=o.length,a=[];e&&(t={});for(var u=0;u<s;u++){var c=o[u],l=this.getValueIndex(c),h=void 0;void 0!==l?(h=i[l],e&&(t[l]=!0)):h=this._valueConstructor.call(n,c),a.push(h)}if(e)for(var d=0;d<r;d++)t[d]||i[d].dispose();return this._curKeys=o.slice(0),this._curValues=a.slice(0),a},e.prototype.getValueIndex=function(t){for(var e=this._curKeys,n=e.length,i=0;i<n;i++)if(e[i]===t)return i},e.prototype.dispose=function(){t.prototype.dispose.call(this);var e=this._currentValue;if(void 0!==e){var n=e.length,i=this._curKeys;if(this._ownObjects)for(var r=0;r<n;r++)e[r].dispose();i.length=0,e.length=0}},e}(L),K=function(){function t(t,e){this.context=t,this.compute=e}return t.prototype.makeWatcher=function(t){return f(this.context,t,this.compute)},t.prototype.getWatchedValue=function(t){return this.compute.call(this.context,t)},t}();t.ComputedOptionArgs=K;var H=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.makeWatcher=function(e){return this.watcher||(this.watcher=t.prototype.makeWatcher.call(this,e)),this.watcher},e}(K);t.ReusingComputedOptionArgs=H,t.watchableOption=E,t.extendOption=D,t.getOptionValue=x,t.immutableWatchable=C;var j=function(){function t(t){this.value=t}return t.prototype.getWatchedValue=function(t){return this.value},t.prototype.getValue=function(){return this.value},t.prototype.notify=function(){},t.prototype.subscribe=function(t){return!1},t.prototype.unsubscribe=function(t){},t.prototype.resolveIfActive=function(){},t}()}(TDB||(TDB={}));var TDB;!function(t){!function(t){t[t.DeleteOnly=1]="DeleteOnly",t[t.WriteOnly=2]="WriteOnly",t[t.ReadWrite=4]="ReadWrite"}(t.UpdatePhase||(t.UpdatePhase={}))}(TDB||(TDB={}));var TDB;!function(t){!function(t){var e=function(){function t(t,e,n){this.x=e,this.y=n,this.isTwoFingerSwipe=!1,this.id="c"+t}return t}();t.Contact=e;var n=function(){function t(t,e,n,i){this.ismain=t,this.touch=e,this.activeTouches=n,this.originalEvent=i}return t}();t.ContactStart=n;var i=function(){function t(t,e,n,i,r,o){this.ismain=t,this.touch=e,this.delx=n,this.dely=i,this.activeTouches=r,this.originalEvent=o}return t}();t.ContactMove=i;var r=function(){function t(t,e,n,i){this.ismain=t,this.touch=e,this.activeTouches=n,this.originalEvent=i}return t}();t.ContactStop=r}(t.Touch||(t.Touch={}))}(TDB||(TDB={}));var TDB;!function(t){!function(e){function n(){return navigator.pointerEnabled||StoryApp.Utilities.browser.isEdge&&window.PointerEvent}function i(){var t;return(t=navigator.msPointerEnabled||n()?new s:new a).register(),t}function r(t){return"touch"===t.pointerType||2===t.pointerType}e.shouldUsePointerEvents=n,e.CreateTouchManager=i,e.isTouchType=r;var o=function(){function e(){this.alltouches={},this.listeners=[]}return e.prototype.addTouchListener=function(t){this.listeners.push(t)},e.prototype.removeTouchListener=function(e){var n=this.listeners.indexOf(e);-1!=n?this.listeners.splice(n,1):t.logMessage(t.LogLevel.warning,"Trying to remove listener that doesn't exist")},e.prototype.dispatchTouchStart=function(t){for(var e=0;e<this.listeners.length;++e)this.listeners[e].dispatchTouchStart(t)},e.prototype.dispatchTouchMove=function(t){for(var e=0;e<this.listeners.length;++e)this.listeners[e].dispatchTouchMove(t)},e.prototype.dispatchTouchStop=function(t){for(var e=0;e<this.listeners.length;++e)this.listeners[e].dispatchTouchStop(t)},e}(),s=function(i){function o(){var t=null!==i&&i.apply(this,arguments)||this;return t.events=t.getEvents(),t.tolerance=15,t}return __extends(o,i),o.prototype.getEvents=function(){return n()?{pointerdown:this.onTouchStart.bind(this),pointermove:this.onTouchMove.bind(this),pointerup:this.onTouchStop.bind(this),pointercancel:this.onTouchStop.bind(this),lostpointercapture:this.onTouchStop.bind(this)}:navigator.msPointerEnabled?{MSPointerDown:this.onTouchStart.bind(this),MSPointerMove:this.onTouchMove.bind(this),MSPointerUp:this.onTouchStop.bind(this),MSPointerCancel:this.onTouchStop.bind(this)}:void t.logMessage(t.LogLevel.warning,"PointerManager should only be used in a browser that supports pointer events")},o.prototype.register=function(){for(var t in this.events)document.addEventListener(t,this.events[t])},o.prototype.unregister=function(){for(var t in this.events)document.removeEventListener(t,this.events[t])},o.prototype.onTouchStart=function(n){if(r(n)){try{var i=n.target;i.msSetPointerCapture?i.msSetPointerCapture(n.pointerId):i.setPointerCapture(n.pointerId)}catch(e){t.logMessage(t.LogLevel.info,"Error happened when setting pointer capture. Error: "+e.message)}var o=new e.Contact(n.pointerId,n.clientX,n.clientY);this.alltouches[o.id]&&t.logMessage(t.LogLevel.warning,"Tried overwriting touch object, we're not catching all events that represent TouchStop"),this.alltouches[o.id]=o,this.maintouch?this.maintouch.x===o.x&&this.maintouch.y===o.y&&(this.maintouch.isTwoFingerSwipe=!0,o.isTwoFingerSwipe=!0):this.maintouch=o,this.dispatchTouchStart(new e.ContactStart(o===this.maintouch,o,Obj.extend({},this.alltouches),n))}},o.prototype.onTouchMove=function(t){if(r(t)){var n=new e.Contact(t.pointerId,t.clientX,t.clientY),i=this.alltouches[n.id];if(i){var o=t.clientX-i.x,s=t.clientY-i.y,a=this.maintouch&&n.id===this.maintouch.id;(this.allowMove||!a||(this.allowMove=Math.abs(o)>this.tolerance||Math.abs(s)>this.tolerance,this.allowMove))&&(i.x=t.clientX,i.y=t.clientY,a&&(this.maintouch=i),(o||s)&&this.dispatchTouchMove(new e.ContactMove(i===this.maintouch,i,o,s,Obj.extend({},this.alltouches),t)))}}},o.prototype.onTouchStop=function(t){var n=new e.Contact(t.pointerId,t.clientX,t.clientY),i=this.alltouches[n.id];if(i){delete this.alltouches[n.id],n.isTwoFingerSwipe=i.isTwoFingerSwipe,i.isTwoFingerSwipe&&this.preventImmediateClick();var r=!1;this.maintouch&&n.id===this.maintouch.id&&(r=!0,this.maintouch=null,this.allowMove&&this.preventImmediateClick(),this.allowMove=!1),this.dispatchTouchStop(new e.ContactStop(r,n,Obj.extend({},this.alltouches),t))}},o.prototype.preventImmediateClick=function(){var t=function(t){t.preventDefault(),t.stopPropagation()};addEventListener("click",t,!0),platform.setImmediate(function(){removeEventListener("click",t,!0)})},o}(o),a=function(n){function i(){var t=null!==n&&n.apply(this,arguments)||this;return t.events={touchstart:t.onTouchStart.bind(t),touchmove:t.onTouchMove.bind(t),touchend:t.onTouchStop.bind(t),touchcancel:t.onTouchStop.bind(t),touchleave:t.onTouchStop.bind(t)},t}return __extends(i,n),i.prototype.register=function(){for(var t in this.events)document.addEventListener(t,this.events[t])},i.prototype.unregister=function(){for(var t in this.events)document.removeEventListener(t,this.events[t])},i.prototype.toTouches=function(t){return t?Array.prototype.map.call(t,function(t){return new e.Contact(t.identifier,t.clientX,t.clientY)}):[]},i.prototype.onTouchStart=function(n){this.filterTouches(this.toTouches(n.touches));var i=this.toTouches(n.changedTouches);this.maintouch||(this.maintouch=i[0]);for(var r=0;r<i.length;++r){var o=i[r];this.alltouches[o.id]&&t.logMessage(t.LogLevel.warning,"Tried overwriting touch object, we're not catching all events that represent TouchStop"),this.alltouches[o.id]=o,this.dispatchTouchStart(new e.ContactStart(o===this.maintouch,o,Obj.extend({},this.alltouches),n))}},i.prototype.onTouchMove=function(n){this.filterTouches(this.toTouches(n.touches));for(var i=this.toTouches(n.changedTouches),r=0;r<i.length;++r){var o=i[r],s=this.alltouches[o.id];if(!s)return void t.logMessage(t.LogLevel.warning,"Received a touch move from touch that wasn't registered");var a=s.x,u=s.y;s.x=o.x,s.y=o.y,this.dispatchTouchMove(new e.ContactMove(s===this.maintouch,s,s.x-a,s.y-u,Obj.extend({},this.alltouches),n))}},i.prototype.onTouchStop=function(t){for(var n=this.toTouches(t.changedTouches),i=0;i<n.length;++i){var r=n[i];if(this.alltouches[r.id]){delete this.alltouches[r.id];var o=!1;this.maintouch&&this.maintouch.id===r.id&&(o=!0,this.maintouch=null),this.dispatchTouchStop(new e.ContactStop(o,r,Obj.extend({},this.alltouches),t))}}},i.prototype.filterTouches=function(t){var e={},n=this;for(var i in this.alltouches)!function(i){t.some(function(t){return i===t.id})?e[i]=n.alltouches[i]:n.maintouch&&n.maintouch.id===i&&(n.maintouch=null)}(i);this.alltouches=e},i}(o)}(t.Touch||(t.Touch={}))}(TDB||(TDB={}));var TDB;!function(t){!function(e){function n(t,e){return t[0]*e[0]+t[1]*e[1]}var i;!function(t){t[t.UP=0]="UP",t[t.RIGHT=1]="RIGHT",t[t.LEFT=2]="LEFT",t[t.DOWN=3]="DOWN"}(i=e.SwipeDirection||(e.SwipeDirection={}));var r=function(){function t(t,e,n){this.direction=t,this.amount=e,this.target=n}return t}();e.Swipe=r;var o=function(){function t(t){this.target=t}return t}();e.Tap=o;var s=function(){function e(t,e){this.swipemin=t,this.tapTolerance=e,this.axis=[{type:i.UP,vec:[0,-1]},{type:i.DOWN,vec:[0,1]},{type:i.LEFT,vec:[-1,0]},{type:i.RIGHT,vec:[1,0]}],this.target=null,this.movement=new a,this.listeners=[]}return e.prototype.dispatchTouchStart=function(t){this.movement.hasTouches()||(this.target=t.originalEvent.target),this.movement.update(t.activeTouches)},e.prototype.dispatchTouchMove=function(t){this.movement.update(t.activeTouches),this.movement.motion[0]+=t.delx,this.movement.motion[1]+=t.dely},e.prototype.dispatchTouchStop=function(t){if(this.movement.update(t.activeTouches),!this.movement.hasTouches()){var e=this.target;this.target=null,this.checkTap(e),this.checkSwipe(e),this.movement.motion=[0,0]}},e.prototype.checkSwipe=function(t){if(!(this.movement.length()<this.swipemin)){for(var e={axis:this.axis[0],val:0},i=0;i<this.axis.length;++i){var o=this.axis[i],s=n(o.vec,this.movement.motion);s<=e.val||(e.axis=o,e.val=s)}this.fireSwipe(new r(e.axis.type,e.val,t))}},e.prototype.checkTap=function(t){this.movement.length()>this.tapTolerance||this.fireTap(new o(t))},e.prototype.addGestureListener=function(t){this.listeners.push(t)},e.prototype.removeGestureListener=function(e){var n=this.listeners.indexOf(e);if(-1==n)throw t.createError("trying to remove listener that doesn't exist");this.listeners.splice(n,1)},e.prototype.fireSwipe=function(t){for(var e=0;e<this.listeners.length;++e)this.listeners[e].dispatchSwipe(t)},e.prototype.fireTap=function(t){for(var e=0;e<this.listeners.length;++e)this.listeners[e].dispatchTap(t)},e}();e.GestureAnalyzer=s;var a=function(){function t(){this.touches={},this.motion=[0,0]}return t.prototype.update=function(t){this.touches=t},t.prototype.length=function(){var t=this.motion;return Math.sqrt(n(t,t))},t.prototype.hasTouches=function(){return Object.keys(this.touches).length>0},t}()}(t.Touch||(t.Touch={}))}(TDB||(TDB={}));var TDB;!function(t){var e=function(){function e(){this.disposed=!1,this.domlisteners=[]}return e.prototype.active=function(){return this.domlisteners.length>0},e.prototype.add=function(e){if(this.disposed)throw t.createError("trying to add a dom listener to a disposed element");this.domlisteners.push(e)},e.prototype.remove=function(e){if(!this.disposed){var n=this.domlisteners.indexOf(e);-1!==n?this.domlisteners.splice(n,1):t.raiseRecoverableError("Tried removing dom listener that wasn't registered")}},e.prototype.notifyAttached=function(t){for(var e=this.domlisteners,n=0,i=e.length;n<i;++n)e[n].domAttached(t)},e.prototype.notifyDetached=function(t){for(var e=this.domlisteners,n=0,i=e.length;n<i;++n)e[n].domDetached(t)},e.prototype.dispose=function(){this.disposed=!0,this.domlisteners.length=0},e.emptyDomAttached=function(){},e.emptyDomDetatched=function(){},e}();t.DomListenerManager=e}(TDB||(TDB={}));var TDB;!function(t){function e(t){return"<"+t.tagName+' class="'+t.className+'">'}function n(n,i){var r=n.parentElement;return r?!i||i===r||(t.raiseRecoverableError("attempted to remove element from the wrong parent. Element: "+e(n)+", parent via VE tree: "+e(i)+", actual parent: "+e(r),t.LogLevel.warning),!1):(t.raiseRecoverableError("attempted to remove element that was already removed: "+e(n),t.LogLevel.warning),!1)}function i(n,i,r){return!(n&&i&&r)||(t.raiseRecoverableError("failed to insert "+e(i)+" in "+e(n)+" before "+e(r)+". DOM relations: el-next: "+i.compareDocumentPosition(r)+", el-parent: "+i.compareDocumentPosition(n)+", next-parent: "+r.compareDocumentPosition(n),t.LogLevel.warning),!1)}var r=0,o=$.expando,s=$.cache;t.leakDetectionHandler=void 0;var a=function(){function t(t,e){this.ve=t,this.phase=e,this.id="v"+r++}return t.prototype.receiveNotification=function(){this.ve.receivePhaseNotification(this.phase)},t}();!function(t){t[t.Bubble=1]="Bubble",t[t.Bypass=2]="Bypass",t[t.PreventDefault=3]="PreventDefault"}(t.EventPropagation||(t.EventPropagation={}));var u=function(e){function u(n){var i=e.call(this,null)||this;return i._culled=!1,i._chainInDom=!1,i._listeningToChain=!1,i._veSubs={},i.domlisteners=new t.DomListenerManager,i.domlistener=Obj.implement(i,{domAttached:i._onParentDomAttached,domDetached:i._onParentDomDetached}),i.id="v"+r++,n&&(i.parent=n,i.pageId=n.pageId),i.children=[],i._dirty=0,i.registerBuiltObject(),i}return __extends(u,e),u.prototype.registerBuiltObject=function(){},u.prototype.unregisterBuiltObject=function(){},u.prototype.getAnimatedElement=function(){return null},u.prototype.getModelObjectId=function(){return null},u.prototype.getPageId=function(){return this.pageId},u.prototype._create=function(e,n){throw t.createError("subclass should implement create")},u.prototype.add=function(e,n,i){var r=this._initialized;if(r&&(this.update(t.UpdatePhase.DeleteOnly),this.unhookParentDomNotifications()),e.receivePhaseNotification(this._dirty),this._directParent=e,this.pageId=e.pageId,r)this._addToDom(n,i),this.domlisteners.active()&&this.hookUpParentDomNotifications();else{try{this._create(n,i)}finally{this._initialized=!0}this.setRef(),this._inDom=!this._culled,this.domlisteners.active()&&this.hookUpParentDomNotifications(),this.unculled()&&this.domlisteners.notifyAttached(this),this.onCreated()}},u.prototype.onCreated=function(){},u.prototype.addChild=function(t,e,n){t.add(this,e,n),this.children.push(t)},u.prototype.createRoot=function(e,n){var i=this;t.ensureNoUpdatesDuring(function(){var r=new u(null);r.pageId=n,r.domElement=e,r._chainInDom=!0,r._inDom=!0,r._initialized=!0,r.children.push(i),r.unregisterBuiltObject(),t.ViewElementUpdater.register(i),i.add(r,e,null)}),t.applyUpdate(function(){})},u.prototype.update=function(t){if(this._dirty&=~t,this.onUpdate(t),!this.isDirty(t))for(var e=this.children,n=e.length,i=0;i<n;i++){var r=e[i];r.isDirty(t)&&r.update(t)}},u.prototype.onUpdate=function(t){},u.prototype.clearChildren=function(t){for(var e=this.children,n=e.length,i=0;i<n;++i){var r=e[i];r.removeFromDOM(),t&&r.dispose()}e.length=0},u.prototype.disposeBindings=function(){},u.prototype.isDisposed=function(){return this.disposed},u.prototype.dispose=function(t){if(this.disposed=!0,this.clearRef(),t||this.removeFromDOM(),!this._externalChildren)for(var n=this.children,i=n.length,r=0;r<i;++r)n[r].dispose(t||!this._inDom);this.unhookParentDomNotifications(),this._chainInDom&&!this._culled&&this.domlisteners.notifyDetached(this),this.domlisteners.dispose(),this.disposeBindings(),e.prototype.dispose.call(this);var a=this.domElement;if(a){var u=a[o];u&&delete s[u],a._context=void 0}this.unregisterBuiltObject()},u.prototype.clearRef=function(){var t=this.tdbRef;t&&t(void 0)},u.prototype.setRef=function(){var t=this.tdbRef;t&&t(this)},u.prototype.containsElement=function(t){for(;t;){if(t===this)return!0;t=t._directParent}return!1},u.prototype.removeFromDOM=function(){var e=t.FocusableViewElement.getFocusedElement();if(this.removeFromDOMNoFocus(),this.containsElement(e)){var n=this.findFocusableParent();n&&n.onFocusedElementRemoval(e)}},u.prototype.removeFromDOMNoFocus=function(){if(this._inDom){this._inDom=!1;var e=this.domElement;if(e){var i=this.findParentElement();try{i.removeChild(e)}catch(r){if(n(e,i))throw r;t.Repairer.queueRepair(this)}}else for(var r=this.children,o=r.length,s=0;s<o;++s)r[s].removeFromDOMNoFocus()}},u.prototype.findFocusableParent=function(){for(var e=this._directParent;e;){if(e instanceof t.FocusableViewElement)return e;e=e._directParent}},u.prototype.addDomListener=function(t){var e=this.domlisteners.active();return this.domlisteners.add(t),!e&&this._initialized&&this.hookUpParentDomNotifications(),!!this._initialized&&!this._culled&&this._chainInDom},u.prototype.hookUpParentDomNotifications=function(){this._directParent&&(this._listeningToChain||(this._chainInDom=this._directParent.addDomListener(this.domlistener),this._listeningToChain=!0))},u.prototype.removeDomListener=function(t){this.domlisteners.remove(t),this.domlisteners.active()||this.unhookParentDomNotifications()},u.prototype.unhookParentDomNotifications=function(){this._listeningToChain&&(this._listeningToChain=!1,this._directParent.removeDomListener(this.domlistener))},u.prototype._onParentDomAttached=function(t){this._chainInDom=!0,this._culled||this.domlisteners.notifyAttached(this)},u.prototype._onParentDomDetached=function(t){this._chainInDom=!1,this._culled||this.domlisteners.notifyDetached(this)},u.prototype.unculled=function(){return!this._culled&&this._chainInDom},u.prototype.cull=function(){this._culled||(this._culled=!0,this._initialized&&(this.removeFromDOM(),this._chainInDom&&this.domlisteners.notifyDetached(this)))},u.prototype.uncull=function(t){this._culled&&(this._culled=!1,this._initialized&&(this._addToDom(this.findParentElement(),this.findNextNode()),this._chainInDom&&this.domlisteners.notifyAttached(this))),t&&this.parent&&this.parent.uncull(t)},u.prototype.findParentElement=function(){for(var t=this._directParent;t&&!t.domElement;)t=t._directParent;return t.domElement},u.prototype.findNextNode=function(){var t=this;do{for(var e=t._directParent,n=e.children,i=n.indexOf(t)+1,r=n.length;i<r;++i){var o=n[i].findFirstNode();if(o)return o}t=e}while(!t.domElement);return null},u.prototype.findFirstNode=function(t){if(this._inDom){var e=this.domElement;if(e&&(!t||t(e)))return e;for(var n=this.children,i=0,r=n.length;i<r;++i)if(e=n[i].findFirstNode(t))return e}},u.prototype.findNodeAtOrAfter=function(t){for(var e=this.children,n=t,i=e.length;n<i;++n){var r=e[n].findFirstNode();if(r)return{node:r,index:n}}},u.prototype._addToDom=function(e,n){if(!this._culled){var r=this.domElement;if(r){try{e.insertBefore(r,n)}catch(o){if(i(e,r,n))throw o;t.Repairer.queueRepair(this)}StoryApp.Utilities.browser.isSafari&&!StoryApp.Utilities.browser.isChrome&&StoryApp.Utilities.browser.isMobile&&!r.style.transform&&(r.style.transform="translate3d(0,0,0)",r.style.transform="")}else for(var o=this.children,s=0,a=o.length;s<a;++s)o[s]._addToDom(e,n);this._inDom=!0}},u.prototype.receivePhaseNotification=function(t){if(!this.isDirty(t)){this._dirty|=t;var e=this._directParent;e&&e.receivePhaseNotification(t)}},u.prototype.isDirty=function(t){return(this._dirty&t)===t},u.prototype._subscribeToWatchable=function(t,e){var n=this._veSubs[e];n||(n=this._veSubs[e]=new a(this,e)),t.subscribe(n)},u.prototype._unsubscribeFromWatchable=function(t,e){var n=this._veSubs[e];n&&t.unsubscribe(n)},u.prototype.traverse=function(t,e,n){return Obj.traverse(this,t,function(t){return!e||e(t)?t.children:null},n)},u.dataFor=function(t){if(!t)return null;for(var e=t;void 0==e._context&&void 0!=e.parentElement;)e=e.parentElement;return e._context},u.prototype.keyDown=function(e){return t.EventPropagation.Bubble},u.prototype.keyPress=function(e){return t.EventPropagation.Bubble},u.prototype.keyUp=function(e){return t.EventPropagation.Bubble},u.prototype.handleKeyEvent=function(e,n){var i,r=t.EventPropagation.Bubble;switch(n){case t.ViewElementKeyEventType.KeyDownEvent:i=this.keyDown;break;case t.ViewElementKeyEventType.KeyPressEvent:i=this.keyPress;break;case t.ViewElementKeyEventType.KeyUpEvent:i=this.keyUp}return void 0!==i&&(r=i.call(this,e)),null==r&&(t.raiseRecoverableError("handleKeyEvent returned null or undefined: "+{eventHandler:i&&i.toString().substring(0,50),mouseEventType:t.ViewElementKeyEventType[n],target:e.target instanceof HTMLElement&&e.target.innerHTML.substring(0,50),this:this.toString().substring(0,50)}),r=t.EventPropagation.Bubble),r===t.EventPropagation.Bubble&&this.parent&&(r=this.parent.handleKeyEvent(e,n)),r},u.prototype.mouseDown=function(e){return t.EventPropagation.Bubble},u.prototype.mouseUp=function(e){return t.EventPropagation.Bubble},u.prototype.mouseClicked=function(e){return t.EventPropagation.Bubble},u.prototype.mouseDoubleClicked=function(e){return t.EventPropagation.Bubble},u.prototype.mouseScrolled=function(e){return t.EventPropagation.Bubble},u.prototype.mouseMoved=function(e){return t.EventPropagation.Bubble},u.prototype.handleMouseEvent=function(e,n){var i,r=t.EventPropagation.Bubble;switch(n){case t.ViewElementMouseEventType.MouseDownEvent:i=this.mouseDown;break;case t.ViewElementMouseEventType.MouseUpEvent:i=this.mouseUp;break;case t.ViewElementMouseEventType.MouseClickEvent:i=this.mouseClicked;break;case t.ViewElementMouseEventType.MouseDoubleClickedEvent:i=this.mouseDoubleClicked;break;case t.ViewElementMouseEventType.MouseScroll:i=this.mouseScrolled;break;case t.ViewElementMouseEventType.MouseMove:i=this.mouseMoved}return void 0!==i&&(r=i.call(this,e)),null==r&&(t.raiseRecoverableError("handleMouseEvent returned null or undefined: "+{handler:i&&i.toString().substring(0,50),mouseEventType:t.ViewElementMouseEventType[n],target:e.target instanceof HTMLElement&&e.target.innerHTML.substring(0,50),this:this.toString().substring(0,50)}),r=t.EventPropagation.Bubble),r===t.EventPropagation.Bubble&&null!=this.parent?this.parent.handleMouseEvent(e,n):r},u.prototype.handleTouchStartEvent=function(t){return!!this.touchStart(t)&&(!this.parent||this.parent.handleTouchStartEvent(t))},u.prototype.handleTouchMoveEvent=function(t){return!!this.touchMove(t)&&(!this.parent||this.parent.handleTouchMoveEvent(t))},u.prototype.handleTouchStopEvent=function(t){return!!this.touchStop(t)&&(!this.parent||this.parent.handleTouchStopEvent(t))},u.prototype.touchStart=function(t){return!0},u.prototype.touchMove=function(t){return!0},u.prototype.touchStop=function(t){return!0},u.prototype.handleSwipeEvent=function(e){var n=this.swipe(e);return n!==t.EventPropagation.Bubble?n:this.parent?this.parent.handleSwipeEvent(e):t.EventPropagation.Bubble},u.prototype.swipe=function(e){return t.EventPropagation.Bubble},u.prototype.handleTapEvent=function(e){var n=this.tap(e);return n!==t.EventPropagation.Bubble?n:this.parent?this.parent.handleTapEvent(e):n},u.prototype.handleDoubleTapEvent=function(e){var n=this.doubleTap(e);return n!==t.EventPropagation.Bubble?n:this.parent?this.parent.handleDoubleTapEvent(e):n},u.prototype.tap=function(e){return t.EventPropagation.Bubble},u.prototype.doubleTap=function(e){return t.EventPropagation.Bubble},u.prototype.dragOver=function(t){return!0},u.prototype.dragLeave=function(t){return!0},u.prototype.drop=function(t){return t.preventDefault(),!0},u.prototype.handleDragOrDropEvent=function(e,n){var i=!0;switch(n){case t.ViewElementDragDropEventType.DragOverEvent:i=this.dragOver(e);break;case t.ViewElementDragDropEventType.DragLeaveEvent:i=this.dragLeave(e);break;case t.ViewElementDragDropEventType.DropEvent:i=this.drop(e)}return void 0==i&&(i=!0),i&&null!=this.parent&&(i=this.parent.handleDragOrDropEvent(e,n)),i},u.enableLeakDetection=function(){var e={};u.prototype.registerBuiltObject=function(){e[this.id]=this},u.prototype.unregisterBuiltObject=function(){delete e[this.id]};var n=u.prototype.add;u.prototype.add=function(e,i,r){if(this.disposed){var o=this.id,s=this.constructor.name||"No Constructor",a=this.parent?this.parent.constructor.name||"No Constructor":"No Parent";throw t.createError("Attemped to add a VE that has been disposed.  Id: "+o+", Name: "+s+", Parent: "+a)}n.call(this,e,i,r)},t.leakDetectionHandler=function(n){t.ViewElementUpdater.clean();for(var i in e){var r=void 0!==e[i].constructor?e[i].constructor.name:void 0;return n.returnValue=r?"Leaked view element: "+r:"Leaked view elements but we don't have a constructor name to display."}},addEventListener("beforeunload",t.leakDetectionHandler,!1),t.NewForeachInstructionVE.prototype.verifyRecentData=t.NewForeachInstructionVE.prototype.debugVerifyRecentData,t.NewForeachInstructionVE.prototype.checkForUnusedElements=t.NewForeachInstructionVE.prototype.debugCheckForUnusedElements,t.KeyedNewForeachInstructionVE.prototype.checkForDuplicateKeys=t.KeyedNewForeachInstructionVE.prototype.debugCheckForDuplicateKeys},u.prototype.isInitialized=function(){return this._initialized},u.prototype.className=function(){var t="VE",e=this.constructor;if(e){var n=/function\s(.+)\(/.exec(e.toString());n&&n.length>1&&(t=n[1])}return t},u.prototype.toString=function(){return this.className()+": Id='"+this.id+"' Culled="+this._culled+" InDom="+this._inDom+" ModelObjectId='"+this.getModelObjectId()+"'"},u.prototype.dump=function(){return this.dumpImp(0)},u.prototype.dumpImp=function(t){var e=u.getIndent(t)+this.toString();return this.children&&this.children.every(function(n){return e+="\n",e+=n.dumpImp(t+1),!0}),e},u.getIndent=function(t){return Array(t+1).join("\t")},u.prototype.registerShortcut=function(e,n,i){var r=this;i?i.addShortcutElement(e,n):r instanceof t.ControlSet?r.addShortcutElement(e,n):r.parent?r.parent.registerShortcut(e,n):t.raiseRecoverableError("Failed to register shortcuts: "+e)},u.prototype.unregisterShortcut=function(e,n,i){var r=this;i?i.removeShortcutElement(e,n):r instanceof t.ControlSet?r.removeShortcutElement(e,n):r.parent?r.parent.unregisterShortcut(e,n):t.raiseRecoverableError("Failed to unregister shortcuts: "+e)},u.prototype.findParent=function(t,e){void 0===e&&(e=!1);for(var n=e?this:this.parent;n&&!(n instanceof t);)n=n.parent;return n},u.prototype.isInDom=function(){return this._inDom},u.prototype.getFocusableSurrogate=function(){},u}(Disposable);t.ViewElement=u}(TDB||(TDB={}));var TDB;!function(t){var e=function(e){function n(t){var i=e.call(this,t)||this;return n.focusListeners||(n.focusListeners=[]),i}return __extends(n,e),n.prototype.add=function(t,n,i){e.prototype.add.call(this,t,n,i),this.parent&&this.parent.addFocusableChild(this)},n.prototype._addToDom=function(t,n){e.prototype._addToDom.call(this,t,n),this.parent&&this.parent.addFocusableChild(this)},n.prototype.addFocusableChild=function(t){t&&(this.focusableChildren?ArrayExtensions.contains(this.focusableChildren,t)||this.focusableChildren.push(t):this.focusableChildren=[t])},n.prototype.removeFocusableChild=function(t){t&&this.focusableChildren&&(ArrayExtensions.removeFirst(this.focusableChildren,t),0===this.focusableChildren.length&&(this.focusableChildren=void 0))},n.prototype.getFocusableChildren=function(){return this.focusableChildren},n.prototype.onFocusedElementRemoval=function(t){this.parent&&this.parent.onFocusedElementRemoval(t)},n.prototype.removeFromDOMNoFocus=function(){e.prototype.removeFromDOMNoFocus.call(this),this.parent&&this.parent.removeFocusableChild(this)},n.prototype.onChildActiveStateChanged=function(e,n){if(!this.notifying){this.notifying=!0;var i=this.findParent(t.ControlSet);i&&i.onChildActiveStateChanged(e,n),this.notifying=!1}},n.prototype.traverseFocusable=function(t,e,n){return Obj.traverse(this,t,function(t){return!e||e(t)?t.getFocusableChildren():null},n)},n.addFocusListener=function(t,e){n.removeFocusListener(t),n.focusListeners.push({context:t,focusChanged:e})},n.prototype.notifyFocusListeners=function(){for(var t=n.focusListeners.length,e=0;e<t;e++)n.focusListeners[e].focusChanged.call(n.focusListeners[e].context,this)},n.removeFocusListener=function(t){for(var e=n.focusListeners.length,i=0;i<e;i++)if(n.focusListeners[i].context===t)return void n.focusListeners.splice(i,1)},n.getFocusedElement=function(){var e=void 0,n=StoryApp.Utilities.getDocumentActiveElement();if(n&&n instanceof HTMLElement)for(var i=t.ViewElement.dataFor(n);i;){if(i instanceof t.ControlBase){e=i;break}var r=i.getFocusableSurrogate();if(r){e=r;break}i=i.parent}return e},n.prototype.isFocusUnder=function(){var e=StoryApp.Utilities.getDocumentActiveElement();if(e&&e instanceof HTMLElement){var n=t.ViewElement.dataFor(e);return this.isElementUnder(n)}return!1},n.prototype.isElementUnder=function(t){for(;t;){if(t.parent===this)return!0;t=t.parent}return!1},n.prototype.firstChanceMouseEvent=function(e,n,i){return this.parent?this.parent.firstChanceMouseEvent(e,n,i):t.EventPropagation.Bubble},n.prototype.dumpFocusable=function(){return this.dumpFocusableImp(0)},n.prototype.dumpFocusableImp=function(e){var n=t.ViewElement.getIndent(e)+this.toString();return this.focusableChildren&&this.focusableChildren.every(function(t){return n+="\n",n+=t.dumpFocusableImp(e+1),!0}),n},n}(t.ViewElement);t.FocusableViewElement=e}(TDB||(TDB={}));var TDB;!function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.handleShortcutKey=function(e){return t.EventPropagation.Bubble},n.prototype.getControlPosition=function(){},n.prototype.getTabIndex=function(){return this.tabIndex},n.prototype.isTabbable=function(){return this.getTabIndex()!==t.NonFocusableTabIndex},n.prototype.compareTabbingOrderTo=function(e,n,i,r){var o=(this.getTabIndex()?this.getTabIndex():Number.MAX_VALUE)-(e.getTabIndex()?e.getTabIndex():Number.MAX_VALUE),s=this.getControlPosition(),a=e.getControlPosition();if(0!==o||!s||!a)return o;if(this.getTabIndex()&&this.getTabIndex()>0&&this.getTabIndex()===e.getTabIndex()){var u="TabIndex, other than -1 and 0, needs to be unique., self: "+this.toString()+", other: "+e.toString();i&&r&&(u+=", focusableElements: "+JSON.stringify(r.map(function(t){return t.toString()}))+", dumpFocusable: "+i.dumpFocusable()),t.raiseRecoverableError(u)}return this.verticalOverlap(s,a)<50?s.top-a.top:o=n===t.ContentFlowDirection.RightToLeft?a.right-s.right:s.left-a.left},n.prototype.verticalOverlap=function(t,e){var n=t.height>e.height?t:e,i=t.height>e.height?e:t,r=function(t,e){return e>=t.top&&e<=t.bottom},o=0;return r(n,i.top)?o=Math.min(n.bottom,i.bottom)-i.top:r(n,i.bottom)&&(o=i.bottom-Math.max(n.top,i.top)),0!==i.height?100*o/i.height:0},n}(t.FocusableViewElement);t.ControlBase=e}(TDB||(TDB={}));var TDB;!function(t){t.NonFocusableTabIndex=-1;var e=function(e){function n(n,i){var r=e.call(this,n)||this;return r.focusEnabled=t.watchableOption(r,i&&i.domFocusable?i.domFocusable:{watchable:t.watchableTag(596473167,r,!0)},!0),r.enabled=t.watchableOption(r,i?i.enabled:void 0,!0),r.tabIndex=i?i.tabIndex:void 0,r}return __extends(n,e),n.prototype.isActivated=function(t){return this.isFocused()},n.prototype.canActivate=function(){return!this.disposed&&this.focusableBinding&&this.focusableBinding.canFocus()&&this.isFocusable()&&this.isEnabled()},n.prototype.activate=function(){return this.setFocus()},n.prototype.deactivate=function(){return!0},n.prototype.isEnabled=function(t){return this.enabled.getWatchedValue(t)},n.prototype.isVisible=function(t){return!0},n.prototype.FocusableInitArgs=function(){return{onfocus:this.focused,onblur:this.blurred,focusable:this.focusEnabled}},n.prototype.getControlPosition=function(){return this.focusableBinding?this.focusableBinding.getPosition():void 0},n.prototype.isFocused=function(){return this.focusableBinding&&this.focusableBinding.isFocused()},n.prototype.isFocusable=function(t){return this.focusEnabled.getWatchedValue(t)},n.prototype.setFocus=function(){return!!this.canActivate()&&(this.focusableBinding.focus(),!0)},n.prototype.setFocusable=function(e){var n=this;t.applyUpdate(function(){var i=t.asRW(n.focusEnabled);i?i.setValue(e):t.raiseRecoverableError("setFocusable isn't allowed for this control. Failed to convert focusEnabled watchable to RW watchable.")},t.Justification.FocusManagement)},n.prototype.onGainingFocus=function(){},n.prototype.onLosingFocus=function(){},n.prototype.toString=function(){return e.prototype.toString.call(this)+" DomFocusEnabled="+this.focusEnabled.getValue()+" DomFocus="+this.isFocused()+" TabIndex="+this.getTabIndex()},n.prototype.focused=function(){this.onGainingFocus(),this.onChildActiveStateChanged([this],!0),this.notifyFocusListeners()},n.prototype.blurred=function(){this.onLosingFocus(),this.onChildActiveStateChanged([this],!1)},n.prototype.mouseDown=function(e){return t.EventPropagation.Bypass},n.prototype.mouseClicked=function(e){return t.EventPropagation.Bypass},n.prototype.handleMouseEvent=function(n,i){return i!==t.ViewElementMouseEventType.ContextMenuEvent||this.contextMenu(n)?e.prototype.handleMouseEvent.call(this,n,i):t.EventPropagation.Bypass},n.prototype.contextMenu=function(t){return!0},n}(t.ControlBase);t.Control=e}(TDB||(TDB={}));var TDB;!function(t){var e;!function(t){t[t.None=0]="None",t[t.Isolated=1]="Isolated",t[t.VerticalList=2]="VerticalList",t[t.HorizontalList=4]="HorizontalList",t[t.NoWrappingNavigation=8]="NoWrappingNavigation",t[t.HomeEndNavigation=16]="HomeEndNavigation",t[t.PreserveFocusContext=32]="PreserveFocusContext",t[t.TabDisabled=64]="TabDisabled",t[t.TabInto=128]="TabInto",t[t.AutoEnter=256]="AutoEnter",t[t.ExitOnEscape=512]="ExitOnEscape",t[t.VisibleAsCoveringRectangle=1024]="VisibleAsCoveringRectangle"}(e=t.ControlSetFeatures||(t.ControlSetFeatures={}));var n;!function(t){t[t.LeftToRight=0]="LeftToRight",t[t.RightToLeft=1]="RightToLeft"}(n=t.ContentFlowDirection||(t.ContentFlowDirection={}));!function(t){t[t.Current=0]="Current",t[t.Begin=1]="Begin",t[t.End=2]="End",t[t.Initial=3]="Initial",t[t.RemovedCurrent=4]="RemovedCurrent"}(t.OffsetOrigin||(t.OffsetOrigin={}));var i;!function(t){t[t.ClickOutside=0]="ClickOutside",t[t.EscapeButtonPressed=1]="EscapeButtonPressed"}(i=t.ExitReason||(t.ExitReason={}));var r=function(){function t(t,e){this.shortcut=t,this.element=e}return t.prototype.equals=function(t,e){return this.element===e&&this.shortcut.matches(t)},t}(),o=function(o){function s(e,n){var i=o.call(this,e)||this;return i.entered=t.watchableTag(596473166,i,!1),i.features=n.features,i.tabIndex=n.tabIndex,i.activeChildIndex=-1,i}return __extends(s,o),s.getFocusedControlSet=function(){var e=StoryApp.Utilities.getDocumentActiveElement(),n=void 0;if(e&&e instanceof HTMLElement)for(var i=t.ViewElement.dataFor(e);i;){if(i instanceof s){n=i;break}i=i.parent}return n},s.prototype.isActivated=function(t){return this.isEntered(t)},s.prototype.canActivate=function(){return this.canEnter()},s.prototype.activate=function(){return this.enter()},s.prototype.deactivate=function(){return this.exit()},s.prototype.isEntered=function(t){return this.entered.getWatchedValue(t)},s.prototype.canEnter=function(){return!this.disposed},s.prototype.enterNoFocus=function(){return this.canEnter()&&(this.getEnteredValue()||(this.setEntered(!0),this.onEntering())),this.getEnteredValue()},s.prototype.enter=function(){return!!this.enterNoFocus()&&this.updateActiveChild(t.OffsetOrigin.Initial,0)},s.prototype.reenter=function(){return!!this.enterNoFocus()&&(this.features&e.PreserveFocusContext?this.updateActiveChild(t.OffsetOrigin.Current,0):this.updateActiveChild(t.OffsetOrigin.Initial,0))},s.prototype.exit=function(){return this.getEnteredValue()&&(this.setEntered(!1),this.onExiting()),!0},s.prototype.add=function(e,n,i){var r=this;o.prototype.add.call(this,e,n,i),this.features&t.ControlSetFeatures.AutoEnter&&platform.setImmediate(function(){return r.enter()})},s.prototype.onFocusedElementRemoval=function(t){var e=this;this.isElementUnder(t)&&(this.canEnter()&&!this.disposed&&this._inDom?platform.setImmediate(function(){var t=StoryApp.Utilities.getDocumentActiveElement();t&&t!==document.body||e.canEnter()&&!e.disposed&&e._inDom&&e.reenter()}):o.prototype.onFocusedElementRemoval.call(this,this))},s.prototype.onChildActiveStateChanged=function(t,e,n){void 0===n&&(n=!1);var i=ArrayExtensions.last(t);if(e&&this.canActivate()&&(!this.isEntered()||this.activeChild!==i)&&!n){var r=this.getActivatableChildren();ArrayExtensions.contains(r,i)&&(this.setActiveChild(i),this.enter())}i!==this&&t.push(this),o.prototype.onChildActiveStateChanged.call(this,t,e)},s.prototype.onEntering=function(){},s.prototype.onExiting=function(){},s.prototype.escape=function(){this.features&t.ControlSetFeatures.Isolated&&this.exit()},s.prototype.onNavigateList=function(n,i,r){var o=this.activeChild;return this.updateActiveChild(n,i+r),n===t.OffsetOrigin.Current&&this.features&e.NoWrappingNavigation&&!(this.features&e.Isolated)&&this.activeChild===o?t.EventPropagation.Bubble:t.EventPropagation.PreventDefault},s.prototype.shouldExit=function(t){return 0!=(this.features&e.Isolated)&&!(t===i.EscapeButtonPressed&&0==(this.features&e.ExitOnEscape))},s.prototype.keyDown=function(e){var n=this.handleNavigationKey(e);return n!==t.EventPropagation.Bubble?n:(n=this.handleShortcutKey(e),n===t.EventPropagation.Bubble?o.prototype.keyDown.call(this,e):n)},s.prototype.toString=function(){return o.prototype.toString.call(this)+" Type="+this.features+" Entered="+this.getEnteredValue()},s.prototype.getActivatableChildren=function(){return s.getActivatableChildren(this)},s.getActivatableChildren=function(e){var n=e.traverseFocusable(function(n){return n!==e&&n instanceof t.ControlBase&&n.isTabbable()&&n.canActivate()?n:void 0},function(n){return!(n instanceof t.ControlBase)||n===e});return n.sort(function(t,i){return t.compareTabbingOrderTo(i,s.contentFlowDirection,e,n)})},s.prototype.getControlPosition=function(){if(this.features&e.VisibleAsCoveringRectangle)return this.getMinimalCoveringRectangle();var t=this.activeChild&&this.activeChild.canActivate()?this.activeChild.getControlPosition():void 0;if(!t){var n=this.getActivatableChildren(),i=n&&n[0];t=i?i.getControlPosition():void 0}return t},s.prototype.getMinimalCoveringRectangle=function(){var t,e=this.getActivatableChildren();if(e&&e[0]){t=e[0].getControlPosition();for(var n=1;n<e.length;n++)if(e[n]){var i=e[n].getControlPosition();t=this.getCoverForTwoRectangles(t,i)}return t}},s.prototype.getCoverForTwoRectangles=function(t,e){var n=Math.min(t.left,e.left),i=Math.max(t.right,e.right),r=Math.min(t.top,e.top),o=Math.max(t.bottom,e.bottom);return{left:n,right:i,top:r,bottom:o,width:i-n,height:o-r}},s.prototype.updateActiveChild=function(e,n,i){var r=i||this.getActivatableChildren();if(!r){var o=["Falsy activatableElements from this.getActivatableChildren:",e,n,this.getActivatableChildren.toString(),this.toString()].join(" ");t.raiseRecoverableError(o,t.LogLevel.error),r=[]}return r.length>0&&this.pickActiveChild(r,e,n),this.activeChild&&this.activeChild.isActivated()},s.prototype.onActivateChild=function(t){t&&t.activate()},s.prototype.onDeactivateChild=function(t){t&&this!==t&&t.deactivate()},s.prototype.getInitialActiveChild=function(){},s.prototype.setActiveChild=function(t){this.onActivateChild(t),this.activeChild&&this.activeChild!==t&&this.onDeactivateChild(this.activeChild),this.activeChild=t},s.prototype.getActiveChildIndex=function(){return this.activeChildIndex},s.prototype.pickActiveChild=function(n,i,r){var o=this.activeChild;if(i===t.OffsetOrigin.Initial)o&&(o.isActivated()||this.features&e.PreserveFocusContext)||(o=this.getInitialActiveChild()),o&&!ArrayExtensions.contains(n,o)&&(o=null),o||(o=n[0]);else{var s=this.getStartingIndex(n,i,r)+r;this.features&e.NoWrappingNavigation?s<0?s=0:s>=n.length&&(s=n.length-1):(s%=n.length)<0&&(s+=n.length),o=n[s]}this.setActiveChild(o),this.activeChildIndex=n.indexOf(this.activeChild)},s.prototype.getStartingIndex=function(e,n,i){var r=0;switch(n){case t.OffsetOrigin.Current:return(r=e.indexOf(this.activeChild))<0&&(r=this.activeChildIndex-i),r;case t.OffsetOrigin.End:return e.length-1;case t.OffsetOrigin.Begin:return 0;case t.OffsetOrigin.RemovedCurrent:return(r=e.indexOf(this.activeChild))>=0&&r<e.length&&(e.splice(r,1),r-=1),r}return r},s.prototype.isTabbable=function(){return 0!=(this.features&e.TabInto)&&o.prototype.isTabbable.call(this)},s.prototype.getEnteredValue=function(){return this.entered.getValue()},s.prototype.setEntered=function(e){var n=this;t.applyUpdate(function(){return n.entered.setValue(e)},t.Justification.FocusManagement)},s.prototype.handleNavigationKey=function(r){if(!this.getEnteredValue())return t.EventPropagation.Bubble;switch(r.keyCode){case KeyCodeType.EscapeKey:if(this.shouldExit(i.EscapeButtonPressed))return this.escape(),t.EventPropagation.PreventDefault;break;case KeyCodeType.TabKey:if(this.features&e.Isolated&&!(this.features&e.TabDisabled))return this.onNavigateList(t.OffsetOrigin.Current,r.shiftKey?-1:1,0);break;case KeyCodeType.DownArrowKey:case KeyCodeType.UpArrowKey:if(this.features&e.VerticalList)return this.onNavigateList(t.OffsetOrigin.Current,0,r.keyCode===KeyCodeType.UpArrowKey?-1:1);break;case KeyCodeType.LeftArrowKey:case KeyCodeType.RightArrowKey:if(this.features&e.HorizontalList){var o=s.contentFlowDirection===n.RightToLeft?KeyCodeType.LeftArrowKey:KeyCodeType.RightArrowKey,a=r.keyCode===o?1:-1;return this.onNavigateList(t.OffsetOrigin.Current,a,0)}break;case KeyCodeType.HomeKey:case KeyCodeType.EndKey:if(this.features&e.HomeEndNavigation)return this.onNavigateList(r.keyCode===KeyCodeType.HomeKey?t.OffsetOrigin.Begin:t.OffsetOrigin.End,0,0)}return t.EventPropagation.Bubble},s.prototype.addShortcutElement=function(t,e){!this.shortcutElements&&t.length>0&&(this.shortcutElements={});for(var n=this,i=0;i<t.length;i++)!function(i){var o=t[i],s=o.hashCode();n.shortcutElements[s]||(n.shortcutElements[s]=[]),n.shortcutElements[s].some(function(t){return t.equals(o,e)})||(n.shortcutElements[s].push(new r(o,e)),e.shortcutCallback&&e.shortcutCallback())}(i)},s.prototype.removeShortcutElement=function(t,e){if(this.shortcutElements){for(var n=this,i=0;i<t.length;i++)!function(i){var r=t[i],o=r.hashCode(),s=n.shortcutElements[o];s&&(ArrayExtensions.removeFirstWhere(s,function(t){return t.equals(r,e)}),0===s.length&&delete n.shortcutElements[o])}(i);$.isEmptyObject(this.shortcutElements)&&(this.shortcutElements=void 0)}},s.prototype.reorderShortcuts=function(){for(var t in this.shortcutElements)this.shortcutElements[t].reverse()},s.prototype.getShortcutElements=function(t){return(this.shortcutElements&&this.shortcutElements[t.hashCode()]||[]).filter(function(e){return e.shortcut.shouldHandle(t)}).map(function(t){return t.element})},s.prototype.executeShortcutElements=function(e,n){for(var i=t.EventPropagation.Bubble,r=0;r<e.length;r++)if((i=e[r].handleShortcutKey(n))!==t.EventPropagation.Bubble)return i;return i},s.prototype.dispose=function(t){o.prototype.dispose.call(this,t),this.shortcutElements=void 0},s.contentFlowDirection=n.LeftToRight,s}(t.ControlBase);t.ControlSet=o}(TDB||(TDB={}));var TDB;!function(t){var e=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.args=n,e&&e.addResource(i),i}return __extends(e,t),e.prototype.getTabIndex=function(){return this.args.getTabIndex?this.args.getTabIndex.call(this.getPrimary()):t.prototype.getTabIndex.call(this)},e.prototype.getPrimary=function(){return this.args.primary||this.parent},e.prototype.getTakesFocus=function(){return this.focusEnabled},e.prototype.dispose=function(e){t.prototype.dispose.call(this,e),this.args=void 0},e}(t.Control);t.FocusableSurrogate=e}(TDB||(TDB={}));var TDB;!function(t){!function(t){t[t.DragOverEvent=1]="DragOverEvent",t[t.DragLeaveEvent=2]="DragLeaveEvent",t[t.DropEvent=3]="DropEvent"}(t.ViewElementDragDropEventType||(t.ViewElementDragDropEventType={}))}(TDB||(TDB={}));var TDB;!function(t){!function(t){t[t.KeyDownEvent=1]="KeyDownEvent",t[t.KeyPressEvent=2]="KeyPressEvent",t[t.KeyUpEvent=3]="KeyUpEvent"}(t.ViewElementKeyEventType||(t.ViewElementKeyEventType={}))}(TDB||(TDB={}));var TDB;!function(t){!function(t){t[t.MouseDownEvent=1]="MouseDownEvent",t[t.MouseUpEvent=2]="MouseUpEvent",t[t.MouseClickEvent=3]="MouseClickEvent",t[t.MouseDoubleClickedEvent=4]="MouseDoubleClickedEvent",t[t.ContextMenuEvent=5]="ContextMenuEvent",t[t.MouseScroll=6]="MouseScroll",t[t.MouseMove=7]="MouseMove"}(t.ViewElementMouseEventType||(t.ViewElementMouseEventType={}))}(TDB||(TDB={}));var TDB;!function(t){var e=function(e){function n(n){var i=e.call(this,null)||this;return i._data=n,i._subscribeToWatchable(n,t.UpdatePhase.DeleteOnly|t.UpdatePhase.WriteOnly),i}return __extends(n,e),n.prototype._create=function(t,e){var n=this._data.getValue();this.handleChange(n,t,e)},n.prototype.onUpdate=function(e){var n=e===t.UpdatePhase.DeleteOnly;if(n||e===t.UpdatePhase.WriteOnly){var i=this._data.getValue();if(!this.inCorrectState(i))if(n)this.handleRemoval(i);else{if(this.isDirty(t.UpdatePhase.DeleteOnly))return void this.receivePhaseNotification(t.UpdatePhase.WriteOnly|t.UpdatePhase.DeleteOnly);this.handleChange(i,this.findParentElement(),this.findNextNode())}}},n.prototype.dispose=function(n){e.prototype.dispose.call(this,n),this._unsubscribeFromWatchable(this._data,t.UpdatePhase.DeleteOnly|t.UpdatePhase.WriteOnly)},n}(t.ViewElement);t.InstructionViewElement=e}(TDB||(TDB={}));var TDB;!function(t){function e(t){h=t}function n(t,e){h&&h(t,e)}function i(t){d=t}function r(t){p=t}function o(t){f=t}function s(t,e){p&&p(t,e)}function a(t){return void 0!==d?d(t):t()}function u(t){return void 0!==f?f(t):("string"==typeof t&&(t=new Error(t)),t)}function c(t){v=t}function l(t,e){v?v(t,e):e()}var h,d,p,f,v;!function(t){t[t.verbose=0]="verbose",t[t.info=1]="info",t[t.warning=2]="warning",t[t.error=3]="error"}(t.LogLevel||(t.LogLevel={})),t.setLoggingFunction=e,t.logMessage=n,t.setLogIfErrorFunction=i,t.setRaiseRecoverableErrorFunction=r,t.setCreateErrorFunction=o,t.raiseRecoverableError=s,t.logIfError=a,t.createError=u,t.setPerfMeasurementFunction=c,t.perfMeasurement=l}(TDB||(TDB={}));var TDB;!function(t){function e(t,e){return t===e}var n=function(n){function i(t,e){var i=n.call(this,e)||this;return i._externalChildren=t,i.recentNewData=null,i}return __extends(i,n),i.prototype.inCorrectState=function(t){return this.compareData(t,this.children)},i.prototype.compareData=function(t,e){var n=e.length;if(n!==t.length)return!1;for(var i=0;i<n;i++)if(e[i]!==t[i])return!1;return!0},i.prototype.handleChange=function(n,i,r){var o=this.recentNewData&&this.compareData(n,this.recentNewData)?this.diff:t.Diff.OrderedDiff.fromSequences(this.children,n,e);this.diff=null,this.recentNewData=null;for(var s,a=0,u=o.insertions.length;a<u;++a){for(var c=o.insertions[a],l=(s=s&&c.index<=s.index?s:0===a||s?this.findNodeAtOrAfter(c.index):null)?s.node:null,h=c.index,d=c.count;d>0;++h,--d)n[h].add(this,i,l||r);this.children.splice.apply(this.children,[c.index,0].concat(n.slice(c.index,c.index+c.count)))}},i.prototype.handleRemoval=function(n){for(var i=this.children,r=!this._externalChildren,o={},s=0,a=n.length;s<a;++s)o[n[s].id]=!0;this.diff=t.Diff.OrderedDiff.fromSequences(i,n,e),this.recentNewData=n.slice();for(var u=0,c=this.diff.deletions.length;u<c;++u){for(var l=this.diff.deletions[u],h=l.index,d=l.count,p=h+d-1;p>=h;--p){var f=i[p];f.removeFromDOM(),!r||f.id in o||f.dispose()}this.children.splice(h,d)}},i.prototype.dispose=function(t){n.prototype.dispose.call(this,!1)},i}(t.InstructionViewElement);t.ForeachInstructionVE=n}(TDB||(TDB={}));var TDB;!function(t){var e=function(t){function e(e,n){var i=t.call(this,n)||this;return i._externalChildren=e,i}return __extends(e,t),e.prototype.inCorrectState=function(t){return t?this.children[0]===t:0===this.children.length},e.prototype.handleChange=function(t,e,n){t&&(t.add(this,e,n),this.children.push(t))},e.prototype.handleRemoval=function(t){this.clearChildren(!this._externalChildren)},e.prototype.dispose=function(e){t.prototype.dispose.call(this,!1)},e}(t.InstructionViewElement);t.SubTemplateInstructionVE=e}(TDB||(TDB={}));var TDB;!function(t){var e=function(){function t(t){this.ref=t}return t.prototype.trySetRecycled=function(t){return!(this.ve||!this.wouldBuild(t))&&(this.ve=t,!0)},t.prototype.clearRecycled=function(){var t=this.ve;return t&&(this.ve=void 0),t},t.prototype.disposeRecycled=function(){var t=this.clearRecycled();t&&t.dispose()},t.prototype.hasRecycled=function(){return!!this.ve},t}();t.BaseChildArgs=e;var n=function(){function e(t){this.original=t,this.own=!0}return e.prototype.trySetRecycled=function(t){var e=this.prebuilt===t;return e&&(this.own=!0),e},e.prototype.clearRecycled=function(){return null},e.prototype.disposeRecycled=function(){},e.prototype.hasRecycled=function(){return!1},e.prototype.prebuild=function(t){var e=this.prebuilt;return e||(e=this.prebuilt=this.original.build(t),this.own=!0),e},e.prototype.build=function(t){var e=this.prebuild(t);return this.own=!1,e},e.prototype.wouldBuild=function(t){var e=this.prebuilt;return e?e===t:this.original.wouldBuild(t)},e.prototype.reclaimIfMatch=function(t){var e=this.prebuilt;if(e){var n=e.id;t[n]&&(delete t[n],this.own=!0)}},e.prototype.reclaim=function(t){var e=this.prebuilt===t;return e&&(this.own=!0),e},e.prototype.disposePrebuilt=function(){var t=this.prebuilt;t&&this.own&&(t.dispose(),this.prebuilt=void 0)},e.prototype.stealFrom=function(e){if(this.prebuilt)throw t.createError("can't steal if you already prebuilt");var n=e&&e.prebuilt;return!!this.original.wouldBuild(n)&&(this.prebuilt=n,this.own=e.own,e.prebuilt=void 0,!0)},e.prototype.getType=function(){return this.original.getType()},e}();t.PrebuiltChildArgs=n;var i=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.getKey=function(){return this.original.getKey()},e}(n);t.KeyedPrebuiltChildArgs=i;var r=function(t){function e(e,n){var i=t.call(this,n)||this;return i.builder=e,i}return __extends(e,t),e.prototype.build=function(t){var e=new this.builder(t);return e.tdbRef=this.ref,e},e.prototype.wouldBuild=function(t){return t&&this.builder===t.constructor},e.prototype.getType=function(){return this.builder},e}(e);t.ChildArgsNoModel=r;var o=function(t){function e(e,n,i){var r=t.call(this,i)||this;return r.builder=e,r.model=n,r}return __extends(e,t),e.prototype.getModel=function(){return this.model},e.prototype.build=function(t){var e=new this.builder(t,this.model);return e.dataModel=this.model,e.tdbRef=this.ref,e},e.prototype.wouldBuild=function(t){return t&&this.builder===t.constructor&&(this.builder.areEqual?this.builder.areEqual(this.model,t.dataModel):this.model===t.dataModel)},e.prototype.getType=function(){return this.builder},e}(e);t.ChildArgs=o;var s=function(t){function e(e,n,i,r){var o=t.call(this,e,n,r)||this;return o.key=i,o}return __extends(e,t),e.prototype.build=function(e){var n=t.prototype.build.call(this,e),i=this.key;return i&&(n.dataKey=i),n},e.prototype.getKey=function(){return this.key},e}(o);t.KeyedChildArgs=s}(TDB||(TDB={}));var TDB;!function(t){function e(t,e){return t===e}function n(t,e){return e.wouldBuild(t)}function i(t,e,n){for(var i=e.insertions,r=0,o=i.length;r<o;++r)for(var s=i[r],a=s.index,u=s.count;u>0;--u,++a)if(t[a].trySetRecycled(n))return;n.dispose()}function r(t,e,n){var i=t.length;if(i!==e.length)return!1;for(var r=0;r<i;r++)if(!n(t[r],e[r]))return!1;return!0}var o=function(o){function s(t,e,n,i){var r=o.call(this,e)||this;return r.context=t,r.refName=n,r.watchableRef=i,r.recentNewData=null,r.diff=null,n&&(t[n]=r.children),r}return __extends(s,o),s.prototype.inCorrectState=function(t){return r(this.children,t,n)},s.prototype.handleChange=function(t,e,n){var i;this.recentNewData?(this.verifyRecentData(t),i=this.diff,this.recentNewData=null):i=this.computeDiff(t),this.diff=null;for(var r,o=0,s=i.insertions.length;o<s;++o){for(var a=i.insertions[o],u=(r=r&&a.index<=r.index?r:0===o||r?this.findNodeAtOrAfter(a.index):null)?r.node:null,c=a.count,l=new Array(c),h=a.index,d=0;d<c;++h,++d){var p=t[h],f=p.clearRecycled()||p.build(this.context);f.add(this,e,u||n),l[d]=f}this.children.splice.apply(this.children,[a.index,0].concat(l))}this.checkForUnusedElements(t)},s.prototype.handleRemoval=function(t){var e=this.children,n=this.diff=this.computeDiff(t);if(!this.watchableRef){var r=this.recentNewData;if(r)for(var o=0,s=r.length;o<s;++o){var a=r[o].clearRecycled();a&&i(t,n,a)}}this.recentNewData=t.slice();for(var u=0,c=n.deletions.length;u<c;++u){for(var l=n.deletions[u],h=l.index,d=l.count,p=h+d-1;p>=h;--p){var f=e[p];f.removeFromDOM(),i(t,n,f)}this.children.splice(h,d)}},s.prototype.dispose=function(t){var e=this.watchableRef;if(this.refName&&(this.context[this.refName]=null),e){var n=e.reclaim(this.children);this.removeFromDOM();for(var i=this.children,r=i.length,s=0;s<r;++s)n[i[s].id]&&i[s].dispose(!0);i.length=0}if(o.prototype.dispose.call(this,!1),!e){var a=this.recentNewData;if(a){this.recentNewData=null;for(var u=0,c=a.length;u<c;++u)a[u].disposeRecycled()}}},s.prototype.verifyRecentData=function(t){},s.prototype.debugVerifyRecentData=function(n){if(!r(this.recentNewData,n,e))throw t.createError("deletion phase should have happened before write phase for this data set")},s.prototype.checkForUnusedElements=function(t){},s.prototype.debugCheckForUnusedElements=function(e){for(var n=0,i=e.length;n<i;++n)if(e[n].hasRecycled())throw t.createError("all recycled view elements should have been placed back into the dom")},s.prototype.computeDiff=function(e){return t.Diff.OrderedDiff.fromSequences(this.children,e,n)},s}(t.InstructionViewElement);t.NewForeachInstructionVE=o}(TDB||(TDB={}));var TDB;!function(t){function e(t){return t.dataKey}function n(t){return t.getKey()}function i(e,n){for(var i=Object.create(null),r=0,o=e;r<o.length;r++){var s=n(o[r]);if(i[s])throw t.createError("duplicate key detected in children");i[s]=!0}}var r=function(r){function o(){return null!==r&&r.apply(this,arguments)||this}return __extends(o,r),o.prototype.checkForDuplicateKeys=function(t){},o.prototype.debugCheckForDuplicateKeys=function(r){i(this.children,e),i(r,n);for(var o=0,s=this.children;o<s.length;o++)for(var a=s[o],u=0,c=r;u<c.length;u++){var l=c[u];if(a.dataKey===l.getKey()!==l.wouldBuild(a))throw t.createError("key equality doesn't match model equality")}},o.prototype.computeDiff=function(i){return this.checkForDuplicateKeys(i),t.Diff.OrderedDiff.fromKeyedSequences(this.children,i,e,n)},o}(t.NewForeachInstructionVE);t.KeyedNewForeachInstructionVE=r}(TDB||(TDB={}));var TDB;!function(t){function e(t,e){return new l(t,e)}function n(t,e){return new c(t,e)}function i(t,e){return new p(t,e)}function r(t,e){return new d(t,e)}var o=function(){function e(e){this.context=e,e.addResource(this),this.result=t.watcher(this,this.context,this.recalc)}return e.prototype.dispose=function(){var t=this.lastOutput;if(t)for(var e=0,n=t.length;e<n;++e)t[e].disposePrebuilt()},e.prototype.recalc=function(t){var e=this,n=this.lastOutput,i=this.getSourceData(t).map(function(t){return e.prebuildChildArgs(t)}),r=n?n.length:0;this.steal(n,i);for(var o=0;o<r;++o)n[o].disposePrebuilt();return this.lastOutput=i,i},e.prototype.getChildren=function(t){var e=this;return this.result.getWatchedValue(t).map(function(t){return t.prebuild(e.context)})},e.prototype.raw=function(){return this.result},e.prototype.reclaim=function(t){var e=this.lastOutput;if(e){for(var n={},i=0,r=t.length;i<r;++i)n[t[i].id]=!0;for(var o=0,s=e.length;o<s;++o)e[o].reclaimIfMatch(n);return n}},e}(),s={prebuildChildArgs:function(e){return new t.KeyedPrebuiltChildArgs(e)},steal:function(t,e){for(var n=t?t.length:0,i=Object.create(null),r=0;r<n;++r){var o=t[r];i[o.getKey()]=o}for(var s=0,a=e.length;s<a;++s){var u=e[s];u.stealFrom(i[u.getKey()])}}},a={prebuildChildArgs:function(e){return new t.PrebuiltChildArgs(e)},steal:function(t,e){for(var n=t?t.length:0,i=0,r=e.length;i<r;++i)for(var o=e[i],s=0;s<n&&!o.stealFrom(t[s]);++s);}},u=function(t){function e(e,n){var i=t.call(this,e)||this;return i.source=n,i}return __extends(e,t),e.prototype.getSourceData=function(t){return t.watchValue(this.source)},e}(o),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(u);c.prototype.prebuildChildArgs=s.prebuildChildArgs,c.prototype.steal=s.steal;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(u);l.prototype.prebuildChildArgs=a.prebuildChildArgs,l.prototype.steal=a.steal;var h=function(t){function e(e,n){var i=t.call(this,e)||this;return i.source=n,i}return __extends(e,t),e.prototype.getSourceData=function(t){return this.source.call(this.context,t)},e}(o),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(h);d.prototype.prebuildChildArgs=s.prebuildChildArgs,d.prototype.steal=s.steal;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(h);p.prototype.prebuildChildArgs=a.prebuildChildArgs,p.prototype.steal=a.steal,t.watchableNewForeachState=e,t.watchableNewForeachStateKeyed=n,t.methodNewForeachState=i,t.methodNewForeachStateKeyed=r}(TDB||(TDB={}));var TDB;!function(t){var e=function(t){function e(e,n,i,r){var o=t.call(this,n)||this;return o.context=e,o.refName=i,o.watchableRef=r,o}return __extends(e,t),e.prototype.inCorrectState=function(t){return t?t.wouldBuild(this.children[0]):0===this.children.length},e.prototype.handleChange=function(t,e,n){if(t){var i=t.build(this.context);this.addChild(i,e,n),this.refName&&(this.context[this.refName]=i)}},e.prototype.handleRemoval=function(t){this.clearChildren(!0),this.refName&&(this.context[this.refName]=void 0)},e.prototype.dispose=function(e){this.refName&&(this.context[this.refName]=void 0);var n=this.watchableRef;n&&n.reclaim(this.children[0])&&this.clearChildren(!1),t.prototype.dispose.call(this,!1)},e}(t.InstructionViewElement);t.NewSubTemplateInstructionVE=e}(TDB||(TDB={}));var TDB;!function(t){function e(t,e){return new r(t,e)}function n(t,e){return new o(t,e)}var i=function(){function e(e){this.context=e,e.addResource(this),this.result=t.watcher(this,this.context,this.recalc)}return e.prototype.dispose=function(){var t=this.lastOutput;t&&t.disposePrebuilt()},e.prototype.recalc=function(e){var n,i=this.lastOutput,r=this.getSourceData(e);return r&&(n=new t.PrebuiltChildArgs(r)).stealFrom(i),i&&i.disposePrebuilt(),this.lastOutput=n,n},e.prototype.getChild=function(t){var e=this.result.getWatchedValue(t);return e&&e.prebuild(this.context)},e.prototype.raw=function(){return this.result},e.prototype.reclaim=function(t){var e=this.lastOutput;return e&&t&&e.reclaim(t)},e}(),r=function(t){function e(e,n){var i=t.call(this,e)||this;return i.source=n,i}return __extends(e,t),e.prototype.getSourceData=function(t){return t.watchValue(this.source)},e}(i),o=function(t){function e(e,n){var i=t.call(this,e)||this;return i.source=n,i}return __extends(e,t),e.prototype.getSourceData=function(t){return this.source.call(this.context,t)},e}(i);t.watchableNewSubtemplateState=e,t.methodNewSubtemplateState=n}(TDB||(TDB={}));var TDB;!function(t){var e=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.inCorrectState=function(t){return this.children.length>0?!!t:!t},e.prototype.handleChange=function(t,e,n){t&&this.buildChildren(e,n)},e.prototype.handleRemoval=function(t){t||this.clearChildren(!0)},e}(t.InstructionViewElement);t.IfInstructionVE=e}(TDB||(TDB={}));var TDB;!function(t){var e=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.inCorrectState=function(t){return t===this._currentValue&&this.children.length>0},e.prototype.handleChange=function(t,e,n){this._currentValue=t,this.buildChildren(t,e,n)},e.prototype.handleRemoval=function(t){this.clearChildren(!0)},e}(t.InstructionViewElement);t.SwitchInstructionVE=e}(TDB||(TDB={}));var TDB;!function(t){var e=function(){function e(t){this._phase=t}return e.prototype.onUpdate=function(){for(var t=e.s_viewElements,n=t.length,i=this._phase,r=0;r<n;++r)t[r].update(i)},e.prototype.needsUpdate=function(){for(var t=e.s_viewElements,n=t.length,i=this._phase,r=0;r<n;++r)if(t[r].isDirty(i))return!0;return!1},e.register=function(n){var i=e.s_viewElements;if(i){if(-1!==i.indexOf(n))throw t.createError("The given view element has already been registered for updates")}else i=e.s_viewElements=[],t.registerUpdater(new e(t.UpdatePhase.DeleteOnly)),t.registerUpdater(new e(t.UpdatePhase.WriteOnly)),t.registerUpdater(new e(t.UpdatePhase.ReadWrite));i.push(n)},e.unregister=function(n){var i=e.s_viewElements;if(!i)throw t.createError("No view elements have yet been registered, so none can unregister");var r=i.indexOf(n);if(-1===r)throw t.createError("The given view element wasn't registered for updates, so can't be removed");i.splice(r,1)},e.clean=function(){var t=e.s_viewElements;if(t){e.s_viewElements=[];for(var n=0,i=t.length;n<i;++n)t[n].dispose()}},e}();t.ViewElementUpdater=e}(TDB||(TDB={}));var Size=function(){function t(t,e){this.width=void 0!==t?t:0,this.height=void 0!==e?e:0}return t.prototype.flipped=function(){return new t(this.height,this.width)},t.prototype.plus=function(e){return new t(this.width+e.width,this.height+e.height)},t.prototype.minus=function(e){return new t(this.width-e.width,this.height-e.height)},t.prototype.leq=function(t){return this.width<=t.width&&this.height<=t.height},t}(),TDB;!function(t){!function(e){function n(t){var e=o;for(o=!0;t._directParent;)t=t._directParent;s.addunique(t),e||platform.setImmediate(i)}function i(){var e=s.slice();s.length=0,o=!1,t.ensureNoUpdatesDuring(function(){e.forEach(function(t){(new a).repairTree(t)})})}function r(t,e){return e?e.nextSibling:t.firstChild}var o=!1,s=[];e.queueRepair=n;var a=function(){function e(){}return e.prototype.repairTree=function(e){if(e.isDisposed()||!e.domElement)return{};this.visitedIds=Object.create(null),this.errors=Object.create(null),this.root=e,this.repairChildren(e,null,null);var n=this.errors;return t.logMessage(Obj.keys(n).length>0?t.LogLevel.warning:t.LogLevel.info,"Repaired tree. Errors: "+JSON.stringify(n)),n},e.prototype.addError=function(t){var e=this.errors;e[t]=(e[t]||0)+1},e.prototype.repairChildren=function(t,e,n){var i=this;return t.domElement&&(e=t.domElement,n=null),t.children.forEach(function(t){var r=i.repairNode(t,e,n);r&&(n=r)}),n},e.prototype.repairNode=function(e,n,i){var o=this.visitedIds;if(o[e.id])throw t.createError("not a tree");if(o[e.id]=!0,!e._inDom)return null;var s=e.domElement;if(!s)return this.repairChildren(e,n,i);if(s.parentNode!==n)this.addError(4),n.insertBefore(s,r(n,i));else if(n!==this.root.domElement)for(var a=void 0;(a=r(n,i))!==s;)this.addError(a._context?1:0),n.removeChild(a);var u=this.repairChildren(e,n,i);if(u)for(;s.lastChild!==u;)this.addError(s.lastChild._context?3:2),s.removeChild(s.lastChild);return s},e}();e.Repairer=a}(t.Repairer||(t.Repairer={}))}(TDB||(TDB={}));var TDB;!function(t){!function(t){!function(t){!function(t){var e=function(){function t(t,e,n){this._el=t}return t.prototype.updateAttr=function(t,e){for(var n in e){var i=e[n];null===i||void 0===i?this._el.removeAttribute(n):this._el.getAttribute(n)!==i&&this._el.setAttribute(n,i)}},t}();t.BindingBase=e}(t.Attr||(t.Attr={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={}));var TDB;!function(t){!function(e){!function(e){!function(e){var n=function(){function e(t,e,n){this._element=t,this._viewElement=n}return e.prototype.init=function(t){this._initArgs=t},e.prototype.updateAutoDownload=function(e){var n=this,i=e.watchValue(this._initArgs.url);if(i){t.applyUpdate(function(){n._initArgs.url.setValue(null)},t.Justification.InitialConversion);var r=$("<iframe />").css("display","none").attr("src",i).appendTo(document.body);platform.setTimeout(function(){var t=r.get(0);document.body.removeChild(t)},1e4)}},e}();e.BindingBase=n}(e.AutoDownload||(e.AutoDownload={}))}(e.Bindings||(e.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={}));var TDB;!function(t){!function(e){!function(e){!function(e){e.IframeId="print-iframe";var n=function(){function n(t,e,n){this._element=t,this._viewElement=n}return n.prototype.init=function(t){this._initArgs=t},n.prototype.updateAutoPrint=function(n){var i=this,r=n.watchValue(this._initArgs.url);if(r){t.applyUpdate(function(){i._initArgs.url.setValue(null)},t.Justification.InitialConversion);var o=$("<iframe />").css("display","none").attr("src",r).attr("id",e.IframeId).on("load",null,null,function(){i._initArgs.onLoadAction(),i.invokePrintDialog(o)}).appendTo(document.body)}},n.prototype.invokePrintDialog=function(t){var e=t.get(0);try{e.contentWindow.focus(),e.contentWindow.print()}catch(t){}},n}();e.BindingBase=n}(e.AutoPrint||(e.AutoPrint={}))}(e.Bindings||(e.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={}));var TDB;!function(t){!function(e){!function(e){!function(e){var n=function(){function e(e,n,i){if(this._element=e,this._viewElement=i,!(this._element instanceof HTMLInputElement)||"file"!==this._element.type.toLowerCase())throw t.createError("The auto upload binding only works on file input elements.")}return e.prototype.init=function(t){var e=this;this.changeHandler=function(n){var i=n.target.files;""===e._element.value&&0==i.length||(t.filesReadyForUpload.call(e._viewElement,i),e._element.form.reset())},$(this._element).change(this.changeHandler)},e.prototype.dispose=function(){this.changeHandler&&($(this._element).off("change",this.changeHandler),this.changeHandler=void 0)},e}();e.BindingBase=n}(e.AutoUpload||(e.AutoUpload={}))}(e.Bindings||(e.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={}));var TDB;!function(t){!function(t){!function(t){!function(t){var e=function(t){function e(e,n,i){var r=t.call(this,null)||this;return r.element=e,r}return __extends(e,t),e.prototype.init=function(t){this.args=t,this.adjustLayout(),this.addResource(StoryApp.Utilities.onResize(this.adjustLayout,this))},e.prototype.adjustLayout=function(){var t=this.element;if(this.args.horizontal){var e=$(t).outerWidth(),n=Math.max((window.innerWidth-e)/2,0);$(t).css(this.args.isRtl?"right":"left",n+"px")}if(this.args.vertical){var i=$(t).outerHeight(),r=Math.max((window.innerHeight-i)/2,0);$(t).css("top",r+"px")}},e.prototype.updateCenter=function(t,e){e&&this.adjustLayout()},e}(Disposable);t.BindingBase=e}(t.Center||(t.Center={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={}));var TDB;!function(t){!function(e){!function(e){!function(e){var n=function(){function e(t,e,n){this._element=t}return e.prototype.init=function(e){var n=this;if(e){var i=this._element.type.toLowerCase();if(!(this._element instanceof HTMLInputElement)&&"checkbox"!==i&&"radio"!==i)throw t.createError("The checked binding only works on checkboxes and radio buttons.");this._checked=e;var r=t.asRW(e);r&&(this._readWrite=!0,this._onChangeHandler=function(){n._element.checked!=n._checked.getValue()&&t.applyUpdate(function(){r.setValue(n._element.checked)})},$(this._element).on("change",this._onChangeHandler))}},e.prototype.updateChecked=function(t){if(this._checked){var e=t.watchValue(this._checked);this._element.checked=e}},e.prototype.dispose=function(){this._readWrite&&$(this._element).off("change",this._onChangeHandler)},e}();e.BindingBase=n}(e.Checked||(e.Checked={}))}(e.Bindings||(e.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={}));var TDB;!function(t){!function(e){!function(e){!function(e){var n=function(){function e(t,e,n){this.element=t,this.viewElement=n,this.addedEventHandlers={}}return e.prototype.init=function(){var e=this;StoryApp.Utilities.browser.isIE10?(this.setupEventListener(function(n){return e.handleEvent(n,t.ViewElementMouseEventType.MouseDownEvent)},"mousedown"),this.setupEventListener(function(n){return e.handleEvent(n,t.ViewElementMouseEventType.MouseUpEvent)},"mouseup"),this.setupEventListener(function(n){return e.handleEvent(n,t.ViewElementMouseEventType.MouseClickEvent)},"click"),this.setupEventListener(function(n){return e.handleEvent(n,t.ViewElementMouseEventType.MouseDoubleClickedEvent)},"dblclick"),this.setupEventListener(function(n){return e.handleEvent(n,t.ViewElementMouseEventType.ContextMenuEvent)},"contextmenu"),this.setupEventListener(function(n){return e.handleEvent(n,t.ViewElementMouseEventType.MouseScroll)},"scroll")):this.element.style.pointerEvents="none"},e.prototype.setupEventListener=function(t,e){var n=this,i=function(e){var i=t.call(n.viewElement,e);return i||(e.stopPropagation(),e.preventDefault()),i};$(this.element).on(e,i),this.addedEventHandlers[e]=i},e.prototype.handleEvent=function(e,n){var i=$(e.srcElement||e.target);i.hide();var r=document.elementFromPoint(e.clientX,e.clientY);i.show();var o=t.ViewElement.dataFor(r);if(o&&o.handleMouseEvent){var s=document.createEvent("MouseEvent");return s.initMouseEvent(e.type,e.bubbles,e.cancelable,e.view,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,r),r.dispatchEvent(s)}return!1},e.prototype.dispose=function(){for(var t in this.addedEventHandlers)$(this.element).off(t,this.addedEventHandlers[t]),delete this.addedEventHandlers[t];this.addedEventHandlers=void 0},e}();e.BindingBase=n}(e.ClickThrough||(e.ClickThrough={}))}(e.Bindings||(e.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={}));var TDB;!function(t){!function(t){!function(t){!function(t){var e=function(){function t(t,e,n){this._el=t}return t.prototype.updateCss=function(t,e){var n=this._el.className.match(/\S+/g);n=null!==n?n:[];for(var i in e){var r=e[i],o=n.indexOf(i);r?-1===o&&n.push(i):o>=0&&n.splice(o,1)}this._el.className=n.join(" ")},t}();t.BindingBase=e}(t.Css||(t.Css={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={}));var TDB;!function(t){!function(t){!function(t){!function(t){var e=function(){function t(t,e,n){this._el=t}return t.prototype.updateDangerousInnerHtml=function(t,e){this._el.innerHTML=e||""},t}();t.BindingBase=e}(t.DangerousInnerHtml||(t.DangerousInnerHtml={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={}));var TDB;!function(t){!function(t){!function(t){!function(t){var e=function(){function t(t,e,n){this._element=t}return t.prototype.init=function(){this._dragStartHandler=function(){return!1},$(this._element).on("dragstart",this._dragStartHandler),this._dragHandler=function(t){return t.originalEvent.dataTransfer.dropEffect="none",t.stopPropagation(),t.preventDefault(),!1},$(this._element).on("dragenter",this._dragHandler),$(this._element).on("dragover",this._dragHandler),$(this._element).on("drop",this._dragHandler)},t.prototype.dispose=function(){$(this._element).off("dragstart",this._dragStartHandler),$(this._element).off("dragenter",this._dragHandler),$(this._element).off("dragover",this._dragHandler),$(this._element).off("drop",this._dragHandler)},t}();t.BindingBase=e}(t.DisableDragDrop||(t.DisableDragDrop={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={}));var TDB;!function(t){!function(t){!function(t){!function(t){var e=function(){function t(t,e,n){this._timeoutId=null,this._element=t,this._viewElement=n}return t.prototype.init=function(t){var e=this;if(!t.disable){var n=void 0!==t.appendTo?t.appendTo:"#pane-holder",i=void 0!==t.cursor?t.cursor:"move",r=void 0!==t.opacity?t.opacity:1,o=void 0!==t.handle?t.handle:"",s=void 0!==t.helper?t.helper:"clone",a=void 0===t.scroll||t.scroll,u=void 0!==t.axis?t.axis:"",c=void 0!==t.containment?t.containment:"",l=t.start,h=t.stop,d=t.revert,p=t.drag;this._args={zIndex:2998,cursor:i,cursorAt:t.cursorAt,distance:10,refreshPositions:!0,handle:o,helper:s,appendTo:n,opacity:r,scroll:a,scrollSensitivity:100,axis:u,containment:c,cancel:t.cancel,drag:function(n,i){void 0!==t.drag&&p(n,i,$(e._element))},start:function(t,n){void 0!==l&&l(t,n,$(e._element))},stop:function(t,n){void 0!==h&&h(t,n,$(e._element))},revert:function(t){return d&&d(t,$(e._element)),$("body").css("cursor","auto"),t?(null===e._timeoutId&&(e._timeoutId=platform.setTimeout(function(){e.resetDraggable()},0)),!1):null!==d}},this._previousOptions={},this.createDraggable()}},t.prototype.createDraggable=function(){$(this._element).draggable&&$(this._element).draggable(this._args)},t.prototype.updateOptions=function(t,e){var n=this;if(this._previousOptions=e,$(this._element).draggable&&$(this._element).draggable("instance")){var i=this;for(var r in e)!function(t){"disabled"==t&&"false"==e[t]?$(i._element).draggable("enable"):"start"==t?$(i._element).draggable("option","start",function(i,r){void 0!==e[t]&&e[t](i,r,$(n._element))}):$(i._element).draggable("option",t,e[t])}(r)}},t.prototype.resetDraggable=function(){null!==this._timeoutId&&(this.clearFromDDManager(),$(this._element).draggable&&$(this._element).draggable("instance")&&$(this._element).draggable("destroy"),this._disposed||(this.createDraggable(),this.updateOptions(null,this._previousOptions),this._timeoutId=null))},t.prototype.clearFromDDManager=function(){var t=$.ui.ddmanager;t.current==$(this._element).draggable("instance")&&(t.current=null)},t.prototype.dispose=function(){if(!this._disposed){this._disposed=!0;var t=$.ui.ddmanager;if(t&&$(this._element).draggable){var e=$(this._element).draggable("instance");e&&t.current!=e&&$(this._element).draggable("destroy")}this._previousOptions=null,this._args=null}},t}();t.BindingBase=e}(t.Draggable||(t.Draggable={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={}));var TDB;!function(t){!function(t){!function(t){!function(t){var e=function(){function t(t,e,n){this._el=t}return t.prototype.updateEnable=function(t,e){e?this._el.removeAttribute("disabled"):this._el.setAttribute("disabled","disabled")},t}();t.BindingBase=e}(t.Enable||(t.Enable={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={}));var TDB;!function(t){!function(t){!function(t){!function(t){var e=function(){function t(t,e,n){this._element=t,this._viewElement=n,this._addedEvents={}}return t.prototype.init=function(t){for(var e in t)this.setupEventListener(t[e],e)},t.prototype.setupEventListener=function(t,e){var n=this,i=function(e){var i=t.call(n._viewElement,e);return i||(e.stopPropagation(),e.preventDefault()),i};$(this._element).on(e,i),this._addedEvents[e]=i},t.prototype.dispose=function(){for(var t in this._addedEvents)$(this._element).off(t,this._addedEvents[t]),this._addedEvents[t]=null;this._addedEvents={}},t}();t.BindingBase=e}(t.Events||(t.Events={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={}));var TDB;!function(t){!function(t){!function(t){!function(t){var e=function(){function t(t,e,n){this._el=t}return t.prototype.init=function(t){this._context=t.context,this._htmlDispose=t.onDispose},t.prototype.dispose=function(){this._context&&this._htmlDispose&&this._htmlDispose.call(this._context,this._el),this._htmlDispose=null,this._context=null},t}();t.BindingBase=e}(t.HtmlDispose||(t.HtmlDispose={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={}));var TDB;!function(t){!function(e){!function(e){!function(e){var n=function(e){function n(t,n,i){var r=e.call(this,null)||this;return r.element=t,r.ve=i,r}return __extends(n,e),n.prototype.init=function(e){var n=this;e?(e.surrogate?(this.surrogate=e.surrogate,this.focusable=e.surrogate.getTakesFocus(),this.onfocus=e.surrogate.focused,this.onblur=e.surrogate.blurred,this.surrogate.focusableBinding=this):(this.focusable=e.focusable,this.onfocus=e.onfocus,this.onblur=e.onblur),this.onfocus&&this.addResource(t.on(this,$(this.element),"focus",function(){n.onfocus.call(n.surrogate||n.ve)})),this.onblur&&this.addResource(t.on(this,$(this.element),"blur",function(){n.onblur.call(n.surrogate||n.ve)}))):this.disabled=!0},n.prototype.focus=function(){this.element.focus()},n.prototype.scrollToParent=function(){var t=this.element.getBoundingClientRect();t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)||this.element.parentElement.scrollIntoView()},n.prototype.blur=function(){try{this.element.blur()}catch(t){}},n.prototype.updateFocusable=function(e){if(!this.disabled){var n=!this.focusable||e.watchValue(this.focusable);!n&&this.element instanceof HTMLDivElement?this.element.removeAttribute("tabIndex"):this.element.tabIndex=n?0:t.NonFocusableTabIndex}},n.prototype.getPosition=function(){return this.element.getBoundingClientRect()},n.prototype.isFocused=function(){return this.element===StoryApp.Utilities.getDocumentActiveElement()},n.prototype.canFocus=function(){return n.isElementFocusable(this.element)},n.prototype.dispose=function(){e.prototype.dispose.call(this),this.onfocus=void 0,this.ve=void 0,this.surrogate&&(this.surrogate.focusableBinding=void 0,this.surrogate=void 0)},n.isElementFocusable=function(t){if(!t||!t.parentElement||t.tabIndex<0||t.getAttribute("disabled"))return!1;try{var e=t.getBoundingClientRect();if(e.width<=0||e.height<=0)return!1;var n=window.getComputedStyle(t,null);if(!n)return!1;var i="visible"===n.visibility,r="none"!==n.display;return i&&r}catch(t){}return!1},n}(Disposable);e.BindingBase=n}(e.Focusable||(e.Focusable={}))}(e.Bindings||(e.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={}));var TDB;!function(t){!function(e){!function(e){!function(e){var n=function(){function e(e,n,i){var r=this;if(this.loaded=!1,this._el=e,!(this._el instanceof HTMLIFrameElement)&&"iframe"!==this._el.nodeName.toLowerCase())throw t.createError("The iframe binding should only be used on iframe elements.");$(e).load(function(){r.loaded||(r.loaded=!0,void 0!==r.pendingHTML&&(r.updateHtml(r.pendingHTML),r.pendingHTML=void 0))})}return e.prototype.updateHtml=function(t){$(this._el).contents().find("html").html(t)},e.prototype.updateIframe=function(t,e){var n=this._el;e.width&&$(n).attr({width:e.width}),e.height&&$(n).attr({height:e.height}),e.html&&(this.loaded?(this.updateHtml(e.html),this.pendingHTML=void 0):this.pendingHTML=e.html)},e}();e.BindingBase=n}(e.Iframe||(e.Iframe={}))}(e.Bindings||(e.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={}));var TDB;!function(t){!function(t){!function(t){!function(t){var e=function(t){function e(e,n,i){var r=t.call(this,null)||this;return r._element=e,r._viewElement=i,r._scrollbarBuffer=20,r}return __extends(e,t),e.prototype.init=function(t){var e=this;t.checkHeightReference.checkHeight=function(){return e.checkHeight()},this.addResource(StoryApp.Utilities.onResize(function(){e.checkHeight()||t.bottomReached.call(e._viewElement)})),this._scrollHandler=function(){var n=$(e._element).scrollTop()+$(e._element).outerHeight();$(e._element).prop("scrollHeight")-n<200&&t.bottomReached.call(e._viewElement)},$(this._element).on("scroll",this._scrollHandler)},e.prototype.checkHeight=function(){var t=$(this._element).prop("scrollHeight"),e=$(this._element).height();return 0==e||t>e},e.prototype.dispose=function(){$(this._element).off("scroll",this._scrollHandler),t.prototype.dispose.call(this)},e}(Disposable);t.BindingBase=e}(t.InfinitelyScrollableArea||(t.InfinitelyScrollableArea={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={}));var TDB;!function(t){!function(t){!function(t){!function(t){var e=function(){function t(t,e,n){this._element=t}return t.prototype.updateStyle=function(t,e){$(this._element).css(e)},t}();t.BindingBase=e}(t.JQStyle||(t.JQStyle={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={}));var TDB;!function(t){!function(e){!function(e){!function(e){var n=function(e){function n(t,n,i){var r=e.call(this,null)||this;return r._element=t,r._scrollbarBuffer=22,r._layoutRecentlyRan=!1,r._layoutRequestPending=!1,r._layoutOnResizeDelay=50,r}return __extends(n,e),n.prototype.init=function(t){this._desiredRowHeight=t,this.addResource(StoryApp.Utilities.onResize(this.requestLayoutContent,this))},n.prototype.updateElements=function(t,e){this._viewElements=e,this.layoutContent(t)},n.prototype.requestLayoutContent=function(t){var e=this;if(!this._layoutRecentlyRan)return this._layoutRecentlyRan=!0,void this.layoutContent(t);this._layoutRequestPending||(this._layoutRequestPending=!0,platform.setTimeout(function(){e._layoutRequestPending=!1,e._layoutRecentlyRan=!1,e.requestLayoutContent(t)},this._layoutOnResizeDelay))},n.prototype.layoutContent=function(e){var n=$(this._element).width();if(this._viewElements&&0!==this._viewElements.length&&!(n<=0)){n-=this._scrollbarBuffer;for(var i=[].filter.call(this._element.children,function(t){return"none"!=$(t).css("display")}),r=i.length,o=0,s=0,a=this,u=0;u<r;u++)!function(r){var u=i[r],c=t.ViewElement.dataFor(u);if(!a._viewElements.some(function(t){return t.wouldBuild(c)})){if(!c)return t.raiseRecoverableError("Found unknown DOM element as liquid layout child",t.LogLevel.warning),"continue";t.raiseRecoverableError("Invalid liquid layout element",t.LogLevel.error)}var l=a.getNaturalSize(c,e),h=c.getMarginWidth(),d=a.scaleWidth(l,a._desiredRowHeight)+h;if(o+d>=n){var p=n-o;d/2<p?(p-=d,a.adjustRow(i,s,r,n),s=r+1,o=0):(a.adjustRow(i,s,r-1,n),s=r,(o=d)>=n&&(p=n-o,a.adjustRow(i,r,r,n),s=r+1,o=0))}else o+=d}(u);r!=s&&this.adjustRow(i,s,r-1,0)}},n.prototype.adjustRow=function(e,n,i,r){for(var o=this._desiredRowHeight,s=0,a=0,u=[],c=n;c<=i;c++){var l=e[c],h=t.ViewElement.dataFor(l);u[c]=this.getNaturalSize(h);var d=h.getMarginWidth();s+=this.scaleWidth(u[c],this._desiredRowHeight),a+=d}r>0&&(o=(r-a)/s*this._desiredRowHeight);for(c=n;c<=i;c++){var l=e[c],p=this.scaleWidth(u[c],o);l.style.height=o+"px",l.style.width=p+"px"}},n.prototype.getNaturalSize=function(t,e){var i;return void 0!==(i=e?e.watchValue(t.naturalSize):t.naturalSize.getValue())&&void 0!==i.width&&0!==i.width&&void 0!==i.height&&0!==i.height||(i=new Size(this._desiredRowHeight,this._desiredRowHeight)),i.width/i.height>n._maxImageRatio?i.width=i.height*n._maxImageRatio:i.height/i.width>n._maxImageRatio&&(i.height=i.width*n._maxImageRatio),i},n.prototype.scaleWidth=function(t,e){return 0===t.height?t.width:e*(t.width/t.height)},n._maxImageRatio=3,n}(Disposable);e.BindingBase=n}(e.LiquidLayout||(e.LiquidLayout={}))}(e.Bindings||(e.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={}));var TDB;!function(t){!function(e){!function(e){!function(e){var n;!function(t){t[t.All=0]="All",t[t.Images=1]="Images",t[t.Videos=2]="Videos"}(n=e.FilterType||(e.FilterType={}));var i=function(e){function i(t,n,i){var r=e.call(this,null)||this;return r._element=t,r._scrollbarBuffer=22,r._layoutRecentlyRan=!1,r._layoutRequestPending=!1,r._layoutDelay=50,r}return __extends(i,e),i.prototype.init=function(t){this._allViewElement=t.allContentPieces,this._hasDisplayedElements=t.hasDisplayedElements,this._nextProvider=t.nextProvider,this._providerDecompNexts=t.providerDecompNexts,this._providerRules=t.providerRules,this._elementTopMargin=t.elementTopMargin,this._crossClipTypeSectionPadding=t.crossClipTypeSectionPadding,this._elementBottomMargin=t.elementBottomMargin,this._elementLeftPadding=t.elementLeftPadding,this.filterType=t.filterType,this.addResource(StoryApp.Utilities.onResize(this.requestLayoutContent,this))},i.prototype.updateElements=function(t,e){this._liquidElementsSet=e.contentByProvider,this._builtElements=e.builtContent,this.requestLayoutContent(t)},i.prototype.requestLayoutContent=function(t){var e=this;if(!this._layoutRecentlyRan)return this._layoutRecentlyRan=!0,void this.layoutContent(t);this._layoutRequestPending||(this._layoutRequestPending=!0,platform.setTimeout(function(){e._layoutRequestPending=!1,e._layoutRecentlyRan=!1,e.requestLayoutContent(t)},this._layoutDelay))},i.prototype.getViewElementsForArgs=function(){for(var t=this._liquidElementsSet,e=0,n={},i=0,r=this._builtElements;i<r.length;i++){var o=r[i];n[o.dataKey]=o}var s={},a={};for(var u in t)if(t.hasOwnProperty(u)){var c=t[u];e+=c.length,s[u]=c.map(function(t){return n[t.getKey()]});for(var l=0,h=c;l<h.length;l++){var d=h[l];a[d.getKey()]=d}}return{liquidElementsSet:s,argsByKey:a,allElementsTotal:e}},i.prototype.layoutContent=function(e){var i=this;this._currentTop=0;var r=$(this._element).width();if(!((r-=this._scrollbarBuffer)<=0)&&this._hasDisplayedElements.getWatchedValue(e)&&this._liquidElementsSet){var o=this._liquidElementsSet;if(!jQuery.isEmptyObject(o)){var s,a=this._providerRules.getWatchedValue(e),u=[],c={};for(s=0;s<a.length;s++){var l=o[a[s].provider];l?(l.length>0&&u.push(a[s]),c[a[s].provider]=0):t.logMessage(t.LogLevel.warning,"currentLiquidElementSet is undefined. Current provider: "+a[s].provider)}if(null!=u&&0!==u.length){for(var h,d,p,f=0,v=[],g=0,y=0,m=0,_=[],b=0,w=g,T=!1,B=this.getViewElementsForArgs(),E=B.liquidElementsSet,D=B.argsByKey,x=B.allElementsTotal,C=!1;_.length<x;)if(h=u[g].provider,d=E[h],c[h]>=d.length){if(null!=this._providerDecompNexts.getValue()[h]){for(this.updateNextProvider(this._providerDecompNexts.getValue()[h]),C=!0,s=0;s<v.length;s++)this.setHidden(v[s]);break}v.length>0&&(this.contentPieceMatchesFilter(v[0],e)&&this.adjustRow(v,0,v.length,0,g,0===y,!0),y=0,m=0,v=[],f=0),w=g,g=(g+1)%u.length}else{p=d[c[h]++],m++;var S=ArrayExtensions.last(p.children).domElement,V=p.clipType;if(w!==g&&(T=!1,this.filterType.getWatchedValue(e)===n.All&&(T=V!==b),w=g),b=V,S.style.visibility="hidden",S.style.top="0px",p.isSelfAdjusting)this.contentPieceMatchesFilter(p,e)&&(v.length>0&&this.adjustRow(v,0,v.length,0,g,0===y,T),this._currentTop+=this._elementTopMargin+(T?this._crossClipTypeSectionPadding:0),S.style.visibility="visible",S.style.width=r+"px",S.style.top=this._currentTop+"px",S.style.left=this._elementLeftPadding+"px",S.style.marginTop="0px",this._currentTop+=S.clientHeight+this._elementBottomMargin),_.push(p),m>=u[g].minNumberOfItems&&(y=0,f=0,m=0,g=(g+1)%u.length);else{var P=this.getNaturalSize(p,e),A=p.getMarginWidth(),I=this.scaleWidth(P,u[g].preferedSize)+A;if(f+I>=r){var O=r-f;I/2<O?(O-=I,v.push(p),_.push(p),this.contentPieceMatchesFilter(p,e)&&(this.adjustRow(v,0,v.length,r,g,0===y,T),this._currentTop+=this._elementBottomMargin),y++,v=[],m>=u[g].minNumberOfItems&&y>=u[g].minNumberOfItems&&(y=0,m=0,g=(g+1)%u.length),f=0):(this.contentPieceMatchesFilter(v[0],e)&&(this.adjustRow(v,0,v.length,r,g,0===y,T),f=I,this._currentTop+=this._elementBottomMargin),y++,m>=u[g].minNumberOfItems&&y>=u[g].minNumberOfItems?(y=0,m=0,f=0,v=[],c[h]--,g=(g+1)%u.length):(v=[p],_.push(p)))}else f+=I,v.push(p),_.push(p)}}for(s=0;s<u.length;s++)for(d=E[h=u[s].provider];c[h]<d.length;)p=d[c[h]++],this.setHidden(p),_.push(p);for(s=0;s<_.length;s++)_[s].setIndex(s);if(t.applyUpdate(function(){i._allViewElement.setValue(_.map(function(t){return D[t.dataKey]}))}),!C){for(s=0;s<u.length;s++)null!=this._providerDecompNexts.getValue()[u[s].provider]?(this.updateNextProvider(this._providerDecompNexts.getValue()[u[s].provider]),C=!0):v.length>0&&h==u[s].provider&&this.contentPieceMatchesFilter(v[0],e)&&this.adjustRow(v,0,v.length,0,g,0===y,T);C||this.updateNextProvider(null)}}}}},i.prototype.setHidden=function(t){var e=ArrayExtensions.last(t.children).domElement;e.style.visibility="hidden",e.style.top="0px"},i.prototype.updateNextProvider=function(e){var n=this;t.applyUpdate(function(){n._nextProvider.setValue(e)},t.Justification.InitialConversion)},i.prototype.adjustRow=function(t,e,n,i,r,o,s){var a,u,c=this._providerRules.getValue(),l=c[r].preferedSize,h=0,d=0,p=[],f=0,v=0;for(a=e;a<n;a++){var g=t[a];p[a]=this.getNaturalSize(g),v=g.getMarginWidth(),a===e&&(v=0),h+=this.scaleWidth(p[a],c[r].preferedSize),d+=v}for(i>0&&(l=(i-d)/h*c[r].preferedSize),a=e;a<n;a++){u=ArrayExtensions.last(t[a].children).domElement,a===e?(f+=this._elementLeftPadding,this._currentTop+=(o?this._elementTopMargin:this._elementBottomMargin)+(s?this._crossClipTypeSectionPadding:0)):f+=v;var y=this.scaleWidth(p[a],l);u.style.visibility="visible",u.style.height=l+"px",u.style.width=y+"px",u.style.top=this._currentTop+"px",u.style.left=f+"px",u.style.marginTop="0px",f+=y}this._currentTop+=l},i.prototype.getNaturalSize=function(t,e){var n;return void 0!==(n=e?e.watchValue(t.naturalSize):t.naturalSize.getValue())&&void 0!==n.width&&0!==n.width&&void 0!==n.height&&0!==n.height||(n=new Size(0,0)),n.width/n.height>i._maxImageRatio?n.width=n.height*i._maxImageRatio:n.height/n.width>i._maxImageRatio&&(n.height=n.width*i._maxImageRatio),n},i.prototype.scaleWidth=function(t,e){return 0===t.height?t.width:e*(t.width/t.height)},i.prototype.contentPieceMatchesFilter=function(t,e){var i=this.filterType.getWatchedValue(e);return i===n.All||i===n.Images&&2===t.clipType||i===n.Videos&&3===t.clipType},i._maxImageRatio=3,i}(Disposable);e.BindingBase=i}(e.MagazineLiquidLayout||(e.MagazineLiquidLayout={}))}(e.Bindings||(e.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={}));var TDB;!function(t){!function(t){!function(t){!function(t){var e=function(){function t(t,e,n){this._element=t}return t.prototype.updateNamespaceAttr=function(t,e){for(var n=e.length,i=0;i<n;i++){var r=e[i];this._element.setAttributeNS(void 0===r.namespaceUri?null:r.namespaceUri,r.qualifiedName,r.value)}},t}();t.BindingBase=e}(t.NamespaceAttr||(t.NamespaceAttr={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={}));var TDB;!function(t){!function(t){!function(t){!function(t){var e=function(){function t(t,e,n){this._el=t}return t.prototype.updateProps=function(t,e){var n=this._el;for(var i in e)n[i]=e[i]},t}();t.BindingBase=e}(t.Props||(t.Props={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={}));var TDB;!function(t){!function(t){!function(t){!function(t){var e=function(){function t(t,e,n){this._el=t}return t.prototype.updateStyle=function(t,e){for(var n in e){var i=e[n];this._el.style[Modernizr.prefixed(n)]=i||"","float"==n?this._el.style.cssFloat=i||"":"flex-shrink"==n?(this._el.style.flexShrink=i||"",this._el.style["-ms-flex-negative"]=i||"",this._el.style["-webkit-flex-shrink"]=i||""):"flex-grow"==n?(this._el.style.flexGrow=i||"",this._el.style["-ms-flex-positive"]=i||"",this._el.style["-webkit-flex-grow"]=i||""):"background-color"==n?this._el.style.backgroundColor=i||"":"background-image"==n?this._el.style.backgroundImage=i||"":"margin-left"==n?this._el.style.marginLeft=i||"":"margin-right"==n?this._el.style.marginRight=i||"":"margin-top"==n?this._el.style.marginTop=i||"":"margin-bottom"==n&&(this._el.style.marginBottom=i||"")}},t}();t.BindingBase=e}(t.Style||(t.Style={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={}));var TDB;!function(t){!function(t){!function(t){!function(t){var e=function(){function t(t,e,n){this._el=t}return t.prototype.updateText=function(t,e){this._el.textContent=e||""},t}();t.BindingBase=e}(t.Text||(t.Text={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={}));var TDB;!function(t){!function(e){!function(e){!function(e){var n=function(){function e(t,e,n){this._element=t}return e.prototype.init=function(e){var n=this;if(null!==e){this._context=e.context,this._getValue=e.getValue,this._setValue=e.setValue;var i=this._element.tagName.toLowerCase();if("input"!==i&&"select"!==i&&"option"!==i&&"textarea"!==i)throw t.createError("The value binding only works on input elements.");this._onChangeHandler=function(){n.commitValue()},$(this._element).on("change",this._onChangeHandler)}},e.prototype.commitValue=function(){var e=this;this._element.value!=this._getValue.call(this._context)&&t.applyUpdate(function(){e._setValue.call(e._context,e._element.value)},t.Justification.InitialConversion)},e.prototype.updateValue=function(t){if(void 0!==this._context&&void 0!==this._getValue){var e=this._getValue.call(this._context,t);this._element.value!==e&&(this._element.value=e)}},e.prototype.getValue=function(t){return this.commitValue(),this._getValue.call(this._context,t)},e.prototype.dispose=function(){$(this._element).off("change",this._onChangeHandler)},e}();e.BindingBase=n}(e.Value||(e.Value={}))}(e.Bindings||(e.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={}));var TDB;!function(t){!function(t){!function(t){!function(t){var e=function(){function t(t,e,n){this._el=t}return t.prototype.updateVisible=function(t,e){this._el.style.display=e?"":"none"},t}();t.BindingBase=e}(t.Visible||(t.Visible={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={}));var KeyCodeType={BackspaceKey:8,TabKey:9,EnterKey:13,ShiftKey:16,CtrlKey:17,AltKey:18,PauseBreakKey:19,CapsLockKey:20,EscapeKey:27,SpaceKey:32,PageUpKey:33,PageDownKey:34,EndKey:35,HomeKey:36,LeftArrowKey:37,UpArrowKey:38,RightArrowKey:39,DownArrowKey:40,InsertKey:45,DeleteKey:46,OneKey:49,EqualFFKey:61,AKey:65,BKey:66,CKey:67,DKey:68,EKey:69,FKey:70,GKey:71,HKey:72,IKey:73,JKey:74,KKey:75,LKey:76,MKey:77,NKey:78,PKey:80,RKey:82,SKey:83,TKey:84,UKey:85,VKey:86,WKey:87,XKey:88,YKey:89,ZKey:90,OSKey:91,ContextMenuKey:93,AddKey:107,SubtractKey:109,F1Key:112,F6Key:117,F12Key:123,NumLockKey:144,ScrollLockKey:145,MinusFFKey:173,EqualKey:187,MinusKey:189,PeriodKey:190,SlashKey:191},KeyCodes=KeyCodeType,StoryApp;!function(t){!function(t){function e(t){try{window.location.assign(t)}catch(e){try{window.location.href=t}catch(t){}}}t.assignWindowLocation=e}(t.Utilities||(t.Utilities={}))}(StoryApp||(StoryApp={}));var TDB;!function(t){!function(e){!function(e){!function(e){var n=function(e){function n(n,i,r,o,s){var a=e.call(this,n,i,r)||this;a._ve=r,a._attrArgs=s;var u=a._attrWatcher=t.watcherTag(4800663,a,o,a._resolveAttr);return o._subscribeToWatchable(u,t.UpdatePhase.WriteOnly),a._attrWatcher.resolve(),a}return __extends(n,e),n.prototype.update=function(e){var n=this;e==t.UpdatePhase.WriteOnly&&n._attrWatcher.resolve()},n.prototype._resolveAttr=function(t){var e=this,n=e._attrArgs.call(e._ve,t);e.updateAttr(t,n)},n}(e.BindingBase);e.Binding=n}(e.Attr||(e.Attr={}))}(e.Bindings||(e.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(n,i,r,o,s,a,u,c,l){var h=e.call(this,n,i,r)||this;h._ve=r,h.init(s),h._sourceArgs=a;d=h._sourceWatcher=t.watcherTag(4800663,h,o,h._resolveSource);o._subscribeToWatchable(d,t.UpdatePhase.WriteOnly),h._volumeArgs=u;d=h._volumeWatcher=t.watcherTag(4800663,h,o,h._resolveVolume);o._subscribeToWatchable(d,t.UpdatePhase.WriteOnly),h._positionArgs=c;d=h._positionWatcher=t.watcherTag(4800663,h,o,h._resolvePosition);o._subscribeToWatchable(d,t.UpdatePhase.WriteOnly),h._playingArgs=l;var d=h._playingWatcher=t.watcherTag(4800663,h,o,h._resolvePlaying);return o._subscribeToWatchable(d,t.UpdatePhase.WriteOnly),h._sourceWatcher.resolve(),h._volumeWatcher.resolve(),h._positionWatcher.resolve(),h._playingWatcher.resolve(),h}return __extends(n,e),n.prototype.update=function(e){var n=this;e==t.UpdatePhase.WriteOnly&&(n._sourceWatcher.resolve(),n._volumeWatcher.resolve(),n._positionWatcher.resolve(),n._playingWatcher.resolve())},n.prototype._resolveSource=function(t){var e=this,n=e._sourceArgs.call(e._ve,t);e.updateSource(t,n)},n.prototype._resolveVolume=function(t){var e=this,n=e._volumeArgs.call(e._ve,t);e.updateVolume(t,n)},n.prototype._resolvePosition=function(t){var e=this,n=e._positionArgs.call(e._ve,t);e.updatePosition(t,n)},n.prototype._resolvePlaying=function(t){var e=this,n=e._playingArgs.call(e._ve,t);e.updatePlaying(t,n)},n}(e.BindingBase);e.Binding=n}(e.Audio||(e.Audio={}))}(e.Bindings||(e.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(n,i,r,o,s){var a=e.call(this,n,i,r)||this;a._ve=r,a.init(s);var u=a._autoDownloadWatcher=t.watcherTag(4800663,a,o,a._resolveAutoDownload);return o._subscribeToWatchable(u,t.UpdatePhase.WriteOnly),a._autoDownloadWatcher.resolve(),a}return __extends(n,e),n.prototype.update=function(e){var n=this;e==t.UpdatePhase.WriteOnly&&n._autoDownloadWatcher.resolve()},n.prototype._resolveAutoDownload=function(t){this.updateAutoDownload(t)},n}(e.BindingBase);e.Binding=n}(e.AutoDownload||(e.AutoDownload={}))}(e.Bindings||(e.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(n,i,r,o,s){var a=e.call(this,n,i,r)||this;a._ve=r,a.init(s);var u=a._autoPrintWatcher=t.watcherTag(4800663,a,o,a._resolveAutoPrint);return o._subscribeToWatchable(u,t.UpdatePhase.WriteOnly),a._autoPrintWatcher.resolve(),a}return __extends(n,e),n.prototype.update=function(e){var n=this;e==t.UpdatePhase.WriteOnly&&n._autoPrintWatcher.resolve()},n.prototype._resolveAutoPrint=function(t){this.updateAutoPrint(t)},n}(e.BindingBase);e.Binding=n}(e.AutoPrint||(e.AutoPrint={}))}(e.Bindings||(e.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(e,n,i,r,o){var s=t.call(this,e,n,i)||this;return s._ve=i,s.init(o),s}return __extends(e,t),e.prototype.update=function(t){},e}(t.BindingBase);t.Binding=e}(t.AutoUpload||(t.AutoUpload={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(n,i,r,o,s,a){var u=e.call(this,n,i,r)||this;u._ve=r,u.init(s),u._centerArgs=a;var c=u._centerWatcher=t.watcherTag(4800663,u,o,u._resolveCenter);return o._subscribeToWatchable(c,t.UpdatePhase.ReadWrite),u}return __extends(n,e),n.prototype.update=function(e){var n=this;e==t.UpdatePhase.ReadWrite&&n._centerWatcher.resolve()},n.prototype._resolveCenter=function(t){var e=this,n=e._centerArgs.call(e._ve,t);e.updateCenter(t,n)},n}(e.BindingBase);e.Binding=n}(e.Center||(e.Center={}))}(e.Bindings||(e.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(n,i,r,o,s){var a=e.call(this,n,i,r)||this;a._ve=r,a.init(s);var u=a._checkedWatcher=t.watcherTag(4800663,a,o,a._resolveChecked);return o._subscribeToWatchable(u,t.UpdatePhase.WriteOnly),a._checkedWatcher.resolve(),a}return __extends(n,e),n.prototype.update=function(e){var n=this;e==t.UpdatePhase.WriteOnly&&n._checkedWatcher.resolve()},n.prototype._resolveChecked=function(t){this.updateChecked(t)},n}(e.BindingBase);e.Binding=n}(e.Checked||(e.Checked={}))}(e.Bindings||(e.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(e,n,i,r){var o=t.call(this,e,n,i)||this;return o._ve=i,o.init(),o}return __extends(e,t),e.prototype.update=function(t){},e}(t.BindingBase);t.Binding=e}(t.ClickThrough||(t.ClickThrough={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(n,i,r,o,s){var a=e.call(this,n,i,r)||this;a._ve=r,a._cssArgs=s;var u=a._cssWatcher=t.watcherTag(4800663,a,o,a._resolveCss);return o._subscribeToWatchable(u,t.UpdatePhase.ReadWrite),a}return __extends(n,e),n.prototype.update=function(e){var n=this;e==t.UpdatePhase.ReadWrite&&n._cssWatcher.resolve()},n.prototype._resolveCss=function(t){var e=this,n=e._cssArgs.call(e._ve,t);e.updateCss(t,n)},n}(e.BindingBase);e.Binding=n}(e.Css||(e.Css={}))}(e.Bindings||(e.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(n,i,r,o,s){var a=e.call(this,n,i,r)||this;a._ve=r,a._dangerousInnerHtmlArgs=s;var u=a._dangerousInnerHtmlWatcher=t.watcherTag(4800663,a,o,a._resolveDangerousInnerHtml);return o._subscribeToWatchable(u,t.UpdatePhase.WriteOnly),a._dangerousInnerHtmlWatcher.resolve(),a}return __extends(n,e),n.prototype.update=function(e){var n=this;e==t.UpdatePhase.WriteOnly&&n._dangerousInnerHtmlWatcher.resolve()},n.prototype._resolveDangerousInnerHtml=function(t){var e=this,n=e._dangerousInnerHtmlArgs.call(e._ve,t);e.updateDangerousInnerHtml(t,n)},n}(e.BindingBase);e.Binding=n}(e.DangerousInnerHtml||(e.DangerousInnerHtml={}))}(e.Bindings||(e.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(e,n,i,r){var o=t.call(this,e,n,i)||this;return o._ve=i,o.init(),o}return __extends(e,t),e.prototype.update=function(t){},e}(t.BindingBase);t.Binding=e}(t.DisableDragDrop||(t.DisableDragDrop={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(n,i,r,o,s,a){var u=e.call(this,n,i,r)||this;u._ve=r,u.init(s),u._optionsArgs=a;var c=u._optionsWatcher=t.watcherTag(4800663,u,o,u._resolveOptions);return o._subscribeToWatchable(c,t.UpdatePhase.ReadWrite),u}return __extends(n,e),n.prototype.update=function(e){var n=this;e==t.UpdatePhase.ReadWrite&&n._optionsWatcher.resolve()},n.prototype._resolveOptions=function(t){var e=this,n=e._optionsArgs.call(e._ve,t);e.updateOptions(t,n)},n}(e.BindingBase);e.Binding=n}(e.Draggable||(e.Draggable={}))}(e.Bindings||(e.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(n,i,r,o,s){var a=e.call(this,n,i,r)||this;a._ve=r,a._enableArgs=s;var u=a._enableWatcher=t.watcherTag(4800663,a,o,a._resolveEnable);return o._subscribeToWatchable(u,t.UpdatePhase.WriteOnly),a._enableWatcher.resolve(),a}return __extends(n,e),n.prototype.update=function(e){var n=this;e==t.UpdatePhase.WriteOnly&&n._enableWatcher.resolve()},n.prototype._resolveEnable=function(t){var e=this,n=e._enableArgs.call(e._ve,t);e.updateEnable(t,n)},n}(e.BindingBase);e.Binding=n}(e.Enable||(e.Enable={}))}(e.Bindings||(e.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(e,n,i,r,o){var s=t.call(this,e,n,i)||this;return s._ve=i,s.init(o),s}return __extends(e,t),e.prototype.update=function(t){},e}(t.BindingBase);t.Binding=e}(t.Events||(t.Events={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(e,n,i,r,o){var s=t.call(this,e,n,i)||this;return s._ve=i,s.init(o),s}return __extends(e,t),e.prototype.update=function(t){},e}(t.BindingBase);t.Binding=e}(t.HtmlDispose||(t.HtmlDispose={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(n,i,r,o,s){var a=e.call(this,n,i,r)||this;a._ve=r,a.init(s);var u=a._focusableWatcher=t.watcherTag(4800663,a,o,a._resolveFocusable);return o._subscribeToWatchable(u,t.UpdatePhase.WriteOnly),a._focusableWatcher.resolve(),a}return __extends(n,e),n.prototype.update=function(e){var n=this;e==t.UpdatePhase.WriteOnly&&n._focusableWatcher.resolve()},n.prototype._resolveFocusable=function(t){this.updateFocusable(t)},n}(e.BindingBase);e.Binding=n}(e.Focusable||(e.Focusable={}))}(e.Bindings||(e.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(n,i,r,o,s){var a=e.call(this,n,i,r)||this;a._ve=r,a._iframeArgs=s;var u=a._iframeWatcher=t.watcherTag(4800663,a,o,a._resolveIframe);return o._subscribeToWatchable(u,t.UpdatePhase.ReadWrite),a}return __extends(n,e),n.prototype.update=function(e){var n=this;e==t.UpdatePhase.ReadWrite&&n._iframeWatcher.resolve()},n.prototype._resolveIframe=function(t){var e=this,n=e._iframeArgs.call(e._ve,t);e.updateIframe(t,n)},n}(e.BindingBase);e.Binding=n}(e.Iframe||(e.Iframe={}))}(e.Bindings||(e.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(e,n,i,r,o){var s=t.call(this,e,n,i)||this;return s._ve=i,s.init(o),s}return __extends(e,t),e.prototype.update=function(t){},e}(t.BindingBase);t.Binding=e}(t.InfinitelyScrollableArea||(t.InfinitelyScrollableArea={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(n,i,r,o,s){var a=e.call(this,n,i,r)||this;a._ve=r,a.init(s);var u=a._inputSelectionWatcher=t.watcherTag(4800663,a,o,a._resolveInputSelection);return o._subscribeToWatchable(u,t.UpdatePhase.WriteOnly),a._inputSelectionWatcher.resolve(),a}return __extends(n,e),n.prototype.update=function(e){var n=this;e==t.UpdatePhase.WriteOnly&&n._inputSelectionWatcher.resolve()},n.prototype._resolveInputSelection=function(t){this.updateInputSelection(t)},n}(e.BindingBase);e.Binding=n}(e.InputSelection||(e.InputSelection={}))}(e.Bindings||(e.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(n,i,r,o,s){var a=e.call(this,n,i,r)||this;a._ve=r,a._styleArgs=s;var u=a._styleWatcher=t.watcherTag(4800663,a,o,a._resolveStyle);return o._subscribeToWatchable(u,t.UpdatePhase.ReadWrite),a}return __extends(n,e),n.prototype.update=function(e){var n=this;e==t.UpdatePhase.ReadWrite&&n._styleWatcher.resolve()},n.prototype._resolveStyle=function(t){var e=this,n=e._styleArgs.call(e._ve,t);e.updateStyle(t,n)},n}(e.BindingBase);e.Binding=n}(e.JQStyle||(e.JQStyle={}))}(e.Bindings||(e.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(n,i,r,o,s,a){var u=e.call(this,n,i,r)||this;u._ve=r,u.init(s),u._elementsArgs=a;var c=u._elementsWatcher=t.watcherTag(4800663,u,o,u._resolveElements);return o._subscribeToWatchable(c,t.UpdatePhase.ReadWrite),u}return __extends(n,e),n.prototype.update=function(e){var n=this;e==t.UpdatePhase.ReadWrite&&n._elementsWatcher.resolve()},n.prototype._resolveElements=function(t){var e=this,n=e._elementsArgs.call(e._ve,t);e.updateElements(t,n)},n}(e.BindingBase);e.Binding=n}(e.LiquidLayout||(e.LiquidLayout={}))}(e.Bindings||(e.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(n,i,r,o,s,a){var u=e.call(this,n,i,r)||this;u._ve=r,u.init(s),u._elementsArgs=a;var c=u._elementsWatcher=t.watcherTag(4800663,u,o,u._resolveElements);return o._subscribeToWatchable(c,t.UpdatePhase.ReadWrite),u}return __extends(n,e),n.prototype.update=function(e){var n=this;e==t.UpdatePhase.ReadWrite&&n._elementsWatcher.resolve()},n.prototype._resolveElements=function(t){var e=this,n=e._elementsArgs.call(e._ve,t);e.updateElements(t,n)},n}(e.BindingBase);e.Binding=n}(e.MagazineLiquidLayout||(e.MagazineLiquidLayout={}))}(e.Bindings||(e.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(n,i,r,o,s){var a=e.call(this,n,i,r)||this;a._ve=r,a._namespaceAttrArgs=s;var u=a._namespaceAttrWatcher=t.watcherTag(4800663,a,o,a._resolveNamespaceAttr);return o._subscribeToWatchable(u,t.UpdatePhase.WriteOnly),a._namespaceAttrWatcher.resolve(),a}return __extends(n,e),n.prototype.update=function(e){var n=this;e==t.UpdatePhase.WriteOnly&&n._namespaceAttrWatcher.resolve()},n.prototype._resolveNamespaceAttr=function(t){var e=this,n=e._namespaceAttrArgs.call(e._ve,t);e.updateNamespaceAttr(t,n)},n}(e.BindingBase);e.Binding=n}(e.NamespaceAttr||(e.NamespaceAttr={}))}(e.Bindings||(e.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={})),function(t){!function(t){!function(t){!function(t){var e=function(t){function e(e,n,i,r){var o=t.call(this,e,n,i)||this;return o._ve=i,o}return __extends(e,t),e.prototype.update=function(t){},e}(t.BindingBase);t.Binding=e}(t.Position||(t.Position={}))}(t.Bindings||(t.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(n,i,r,o,s){var a=e.call(this,n,i,r)||this;a._ve=r,a._propsArgs=s;var u=a._propsWatcher=t.watcherTag(4800663,a,o,a._resolveProps);return o._subscribeToWatchable(u,t.UpdatePhase.WriteOnly),a._propsWatcher.resolve(),a}return __extends(n,e),n.prototype.update=function(e){var n=this;e==t.UpdatePhase.WriteOnly&&n._propsWatcher.resolve()},n.prototype._resolveProps=function(t){var e=this,n=e._propsArgs.call(e._ve,t);e.updateProps(t,n)},n}(e.BindingBase);e.Binding=n}(e.Props||(e.Props={}))}(e.Bindings||(e.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(n,i,r,o,s){var a=e.call(this,n,i,r)||this;a._ve=r,a._styleArgs=s;var u=a._styleWatcher=t.watcherTag(4800663,a,o,a._resolveStyle);return o._subscribeToWatchable(u,t.UpdatePhase.WriteOnly),a._styleWatcher.resolve(),a}return __extends(n,e),n.prototype.update=function(e){var n=this;e==t.UpdatePhase.WriteOnly&&n._styleWatcher.resolve()},n.prototype._resolveStyle=function(t){var e=this,n=e._styleArgs.call(e._ve,t);e.updateStyle(t,n)},n}(e.BindingBase);e.Binding=n}(e.Style||(e.Style={}))}(e.Bindings||(e.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(n,i,r,o,s){var a=e.call(this,n,i,r)||this;a._ve=r,a._textArgs=s;var u=a._textWatcher=t.watcherTag(4800663,a,o,a._resolveText);return o._subscribeToWatchable(u,t.UpdatePhase.WriteOnly),a._textWatcher.resolve(),a}return __extends(n,e),n.prototype.update=function(e){var n=this;e==t.UpdatePhase.WriteOnly&&n._textWatcher.resolve()},n.prototype._resolveText=function(t){var e=this,n=e._textArgs.call(e._ve,t);e.updateText(t,n)},n}(e.BindingBase);e.Binding=n}(e.Text||(e.Text={}))}(e.Bindings||(e.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(n,i,r,o,s){var a=e.call(this,n,i,r)||this;a._ve=r,a.init(s);var u=a._valueWatcher=t.watcherTag(4800663,a,o,a._resolveValue);return o._subscribeToWatchable(u,t.UpdatePhase.WriteOnly),a._valueWatcher.resolve(),a}return __extends(n,e),n.prototype.update=function(e){var n=this;e==t.UpdatePhase.WriteOnly&&n._valueWatcher.resolve()},n.prototype._resolveValue=function(t){this.updateValue(t)},n}(e.BindingBase);e.Binding=n}(e.Value||(e.Value={}))}(e.Bindings||(e.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(n,i,r,o,s,a,u){var c=e.call(this,n,i,r)||this;c._ve=r,c.init(s),c._sourceArgs=a;l=c._sourceWatcher=t.watcherTag(4800663,c,o,c._resolveSource);o._subscribeToWatchable(l,t.UpdatePhase.WriteOnly),c._playingArgs=u;var l=c._playingWatcher=t.watcherTag(4800663,c,o,c._resolvePlaying);return o._subscribeToWatchable(l,t.UpdatePhase.WriteOnly),c._sourceWatcher.resolve(),c._playingWatcher.resolve(),c}return __extends(n,e),n.prototype.update=function(e){var n=this;e==t.UpdatePhase.WriteOnly&&(n._sourceWatcher.resolve(),n._playingWatcher.resolve())},n.prototype._resolveSource=function(t){var e=this,n=e._sourceArgs.call(e._ve,t);e.updateSource(t,n)},n.prototype._resolvePlaying=function(t){var e=this,n=e._playingArgs.call(e._ve,t);e.updatePlaying(t,n)},n}(e.BindingBase);e.Binding=n}(e.Video||(e.Video={}))}(e.Bindings||(e.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={})),function(t){!function(e){!function(e){!function(e){var n=function(e){function n(n,i,r,o,s){var a=e.call(this,n,i,r)||this;a._ve=r,a._visibleArgs=s;var u=a._visibleWatcher=t.watcherTag(4800663,a,o,a._resolveVisible);return o._subscribeToWatchable(u,t.UpdatePhase.WriteOnly),a._visibleWatcher.resolve(),a}return __extends(n,e),n.prototype.update=function(e){var n=this;e==t.UpdatePhase.WriteOnly&&n._visibleWatcher.resolve()},n.prototype._resolveVisible=function(t){var e=this,n=e._visibleArgs.call(e._ve,t);e.updateVisible(t,n)},n}(e.BindingBase);e.Binding=n}(e.Visible||(e.Visible={}))}(e.Bindings||(e.Bindings={}))}(t.View||(t.View={}))}(TDB||(TDB={}));